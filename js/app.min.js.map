{"version":3,"sources":["activity-graph.js","chain-map.js","ckeditor.js","comments.js","global-hooks.js","dialogs/admin-dialog.js","dialogs/options-dialog.js","dialogs/signature-add-dialog.js","dialogs/signature-dialog.js","dialogs/signature-edit-dialog.js"],"names":["activity","this","graph","options","view","span","columns","id","label","role","type","calc","d","r","getValue","sourceColumn","column","title","getData","cache","json","$","ajax","url","data","systemID","viewingSystemID","time","dataType","async","responseJSON","rows","reverse","google","visualization","DataView","DataTable","setColumns","selectHandler","selections","getSelection","row","c","animation","duration","draw","init","AreaChart","document","getElementById","isStacked","backgroundColor","hAxis","textStyle","color","fontName","fontSize","showTextEvery","vAxis","viewWindowMode","viewWindow","min","maxValue","gridlineColor","pointSize","lineWidth","chartArea","left","top","width","height","legend","position","easing","tooltip","showColorCode","annotations","style","domain","focusTarget","events","addListener","redraw","refresh","setOnLoadCallback","chain","map","drawing","newView","addClass","x","shipJumps","podKills","shipKills","npcKills","$node","find","removeClass","attr","jBox","y","occupied","html","count","OccupiedToolTips","attach","flares","flare","parent","index","next","grid","gridlines","length","lines","system","mode","signatureID","nodeIndex","Math","ceil","cellIndex","$connector","prev","children","$parent","nodeCol","connectorCell","each","colSpan","parentIndex","newparentIndex","i","checkSystem","replace","node","v","$connecte","col","me","value","tempCol","breaker","skip","hasClass","nodes","topLevel","tripwire","systems","systemType","class","security","effectClass","effect","chainNode","name","tabs","active","f","findLinks","parentID","parseInt","childID","chainList","chainData","link","inArray","usedLinks","life","mass","sig2Type","typeBM","type2BM","classBM","class2BM","nth","nth2","sig2ID","child","connectionID","connection","chainLinks","push","jumps","guidance","findShortestPath","shortest","calcNode","favorites","regionID","cols","frigTypes","connections","toString","split","hide","nodeClass","nodeSecurity","wormholes","leadsTo","sigFormat","Array","extend","rawMap","evescout","masks","mask","Object","sort","collapsed","collapse","WormholeTypeToolTips","last_modified","getCollapsedNodes","save","OrgChart","allowHtml","allowCollapse","size","CKConfig","skin","allowedContent","extraPlugins","enterMode","CKEDITOR","ENTER_BR","removeDialogTabs","autoGrow_onStartup","autoGrow_minHeight","toolbar_minToolbar","items","toolbar_maxToolbar","toolbar","smallToolbar","maximizedToolbar","fontSize_style","element","styles","font-size","overrides","attributes","on","cke","editor","e","keyCode","closest","click","domEvent","altKey","focus","s","selected_ranges","getRanges","startContainer","parents","getParents","getFirst","getNext","selectElement","selectRanges","ev","definition","getContents","get","preventDefault","removeAllRanges","$comment","show","editComment","$this","commentID","comment","instances","done","result","modifiedBy","modifiedDate","createdBy","createdDate","Tooltips","destroy","removeAttr","remove","dialog","resizable","minHeight","my","at","of","dialogClass","buttons","Delete","button","always","Cancel","clone","before","window","location","href","indexOf","Notify","trigger","systemChange","val","undo","redo","keydown","metaKey","ctrlKey","activeElement","is","refreshWindow","$ajax","abort","$total","results","ids","l","$row","$col","numFormat","append","refreshTimer","setTimeout","autoOpen","modal","Close","create","$menuItem","clearTimeout","tablesorter","sortReset","widgets","sortList","parentElement","open","close","Save","JSON","stringify","maskChange","typeFormat","classFormat","parse","signatures","pasteLife","background","apply","countdown","empty","list","client","Reset","reset","stat","text","response","owner","admin","img","optional","filter","prop","accordion","heightStyle","collapsible","submit","serialize","error","direction","Add","css","characterName","corporationName","allianceName","Remove","send","Create","selectmenu","corporationID","characterID","checked","EVE","systemName","ValidationTooltips","inlinecomplete","source","aSigSystems","maxSize","delay","whList","blur","select","trim","target","setContent","toLowerCase","toUpperCase","sig","form","serializeObject","lifeLength","whType","sigClass","viewingSystem","connectionName","class2","request","add","resultSet","action","sessionStorage","setItem","aSigWormholes","item","splice","durationPicker","test","substring","not","change","slideUp","slideDown","valid","isNaN","console","log","payload","signatureType","signatureID_Alpha","signatureID_Numeric","signatureName","method","openSigEdit","editSig","ui","side","whLife","update"],"mappings":"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","file":"app.min.js","sourcesContent":["var activity = new function() {\r\n\tthis.graph;\r\n\tthis.options;\r\n\tthis.view;\r\n\tthis.span = 24;\r\n\tthis.columns = [\r\n\t\t{id: \"time\", label: \"Time\", role: \"domain\", type: \"string\", calc: function(d, r) { return d.getValue(r, 0) + \"h\"; }},\r\n\t\t{id: \"jumps\", label: \"Jumps\", role: \"data\", type: \"number\", sourceColumn: 1, column: 1, title: \"Jumps\"},\r\n\t\t{id: \"podkills\", label: \"Pod Kills\", role: \"data\", type: \"number\", sourceColumn: 2, column: 2, title: \"Pod Kills\"},\r\n\t\t{id: \"shipkills\", label: \"Ship Kills\", role: \"data\", type: \"number\", sourceColumn: 3, column: 3, title: \"Ship Kills\"},\r\n\t\t{id: \"npckills\", label: \"NPC Kills\", role: \"data\", type: \"number\", sourceColumn: 4, column: 4, title: \"NPC Kills\"},\r\n\t\t//{id: \"annotationLabel\", label: \"Test\", role: \"annotation\", type: \"string\", sourceColumn: 5, title: \"Test\"},\r\n\t\t//{id: \"annotationText\", label: \"Test\", role: \"annotationText\", type: \"string\", sourceColumn: 6, title: \"Test\"}\r\n\t];\r\n\r\n\tthis.getData = function(span, cache) {\r\n\t\tvar span = typeof(span) !== \"undefined\" ? span : this.span;\r\n\t\tvar cache = typeof(cache) !== \"undefined\" ? cache : true;\r\n\r\n\t\tvar json = $.ajax({\r\n\t\t\t\t\turl: \"activity_graph.php\",\r\n\t\t\t\t\tdata: {systemID: viewingSystemID, time: span},\r\n\t\t\t\t\ttype: \"GET\",\r\n\t\t\t\t\tdataType: \"JSON\",\r\n\t\t\t\t\tasync: false,\r\n\t\t\t\t\tcache: cache\r\n\t\t\t\t}).responseJSON;\r\n\r\n\t\tjson.rows.reverse();\r\n\r\n\t\tthis.view = new google.visualization.DataView(new google.visualization.DataTable(json));\r\n\t\tthis.view.setColumns(this.columns);\r\n\t\treturn this.view;\r\n\t};\r\n\r\n\tthis.selectHandler = function() {\r\n\t\tvar selections = activity.graph.getSelection();\r\n\r\n\t\tif (selections[0] && selections[0].row == null) {\r\n\t\t\tvar c = selections[0].column;\r\n\r\n\t\t\tif (activity.columns[c].sourceColumn) {\r\n\t\t\t\t//activity.columns[c].calc = function() { return null };\r\n\t\t\t\tactivity.columns[c].label = activity.columns[c].title + \" (off)\";\r\n\t\t\t\tdelete activity.columns[c].sourceColumn;\r\n\t\t\t} else {\r\n\t\t\t\tactivity.columns[c].sourceColumn = activity.columns[c].column;\r\n\t\t\t\tactivity.columns[c].label = activity.columns[c].title;\r\n\t\t\t\t//delete activity.columns[c].calc;\r\n\t\t\t}\r\n\r\n\t\t\tactivity.view.setColumns(activity.columns);\r\n\t\t\tactivity.options.animation.duration = 0;\r\n\t\t\tactivity.graph.draw(activity.view, activity.options);\r\n\t\t\tactivity.options.animation.duration = 500;\r\n\t\t}\r\n\t}\r\n\r\n\tthis.init = function() {\r\n\t\tthis.graph = new google.visualization.AreaChart(document.getElementById(\"activityGraph\"));\r\n\t\tthis.options = {\r\n\t\t\tisStacked: false,\r\n\t\t\tbackgroundColor: \"transparent\",\r\n\t\t\thAxis: {textStyle: {color: \"#999\", fontName: \"Verdana\", fontSize: 10}, showTextEvery: 3},\r\n\t\t\tvAxis: {textStyle: {color: \"#666\", fontName: \"Verdana\", fontSize: 10}, viewWindowMode: \"maximized\", viewWindow: {min: 0}, maxValue: 5},\r\n\t\t\tgridlineColor: \"#454545\",\r\n\t\t\tpointSize: 2,\r\n\t\t\tlineWidth: 1,\r\n\t\t\tchartArea: {left: \"10%\", top: \"5%\", width: \"88%\", height: \"85%\"},\r\n\t\t\tlegend: {position: \"in\", textStyle: {color: \"#CCC\", fontName: \"Verdana\", fontSize: 8.5}},\r\n\t\t\tanimation: {duration: 500, easing: \"inAndout\"},\r\n\t\t\ttooltip: {showColorCode: true},\r\n\t\t\tannotations: {style: \"line\", textStyle: {fontSize: 12, color: \"#ccc\"}, domain: 0},\r\n\t\t\tfocusTarget: \"category\"\r\n\t\t}\r\n\r\n\t\tgoogle.visualization.events.addListener(this.graph, \"select\", this.selectHandler);\r\n\r\n\t\tthis.graph.draw(this.getData(this.span), this.options);\r\n\t}\r\n\r\n\tthis.time = function(span) {\r\n\t\tswitch(span) {\r\n\t\t\tcase 24:\r\n\t\t\t\tthis.options.hAxis.showTextEvery = 3;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 48:\r\n\t\t\t\tthis.options.hAxis.showTextEvery = 6;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 168:\r\n\t\t\t\tthis.options.hAxis.showTextEvery = 24;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tthis.span = span;\r\n\t\tthis.graph.draw(this.getData(span), this.options);\r\n\t}\r\n\r\n\tthis.redraw = function() {\r\n\t\tthis.graph.draw(this.view, this.options);\r\n\t}\r\n\r\n\tthis.refresh = function(cache) {\r\n\t\tthis.graph.draw(this.getData(this.span, cache), this.options);\r\n\t}\r\n\r\n\tgoogle.setOnLoadCallback(this.init());\r\n\t//this.init();\r\n}\r\n","var chain = new function() {\r\n\tthis.map, this.view, this.options, this.drawing, this.data = {};\r\n\r\n\tthis.newView = function(json) {\r\n\t\tthis.view = new google.visualization.DataView(new google.visualization.DataTable(json));\r\n\t\treturn this.view;\r\n\t};\r\n\r\n\tthis.activity = function(data) {\r\n\t\t/*\tfunction for adding recent activity to chain map nodes\t*/\r\n\t\t//var data = typeof(data) !== \"undefined\" ? data : this.data.activity;\r\n\r\n\t\t// Hide all activity colored dots instead of checking each one\r\n\t\t$(\"#chainMap .nodeActivity > span:not(.invisible)\").addClass(\"invisible\");\r\n\r\n\t\t// Loop through passed data and show dots by system\r\n\t\tfor (var x in data) {\r\n\t\t\tvar systemID = data[x].systemID;\r\n\t\t\tvar shipJumps = data[x].shipJumps;\r\n\t\t\tvar podKills = data[x].podKills;\r\n\t\t\tvar shipKills = data[x].shipKills;\r\n\t\t\tvar npcKills = data[x].npcKills;\r\n\t\t\tvar $node = $(\"#chainMap [data-nodeid=\"+systemID+\"] > .nodeActivity\");\r\n\r\n\t\t\tif (shipJumps > 0) {\r\n\t\t\t\t$node.find(\".jumps\").removeClass(\"invisible\").attr(\"title\", shipJumps+\" Jumps\");\r\n\t\t\t}\r\n\r\n\t\t\tif (podKills > 0) {\r\n\t\t\t\t$node.find(\".pods\").removeClass(\"invisible\").attr(\"title\", podKills+\" Pod Kills\");\r\n\t\t\t}\r\n\r\n\t\t\tif (shipKills > 0) {\r\n\t\t\t\t$node.find(\".ships\").removeClass(\"invisible\").attr(\"title\", shipKills+\" Ship Kills\");\r\n\t\t\t}\r\n\r\n\t\t\tif (npcKills > 0) {\r\n\t\t\t\t$node.find(\".npcs\").removeClass(\"invisible\").attr(\"title\", npcKills+\" NPC Kills\");\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t$(\"#chainMap .nodeActivity > span[title]\").jBox(\"Tooltip\", {position: {y: \"bottom\"}});\r\n\r\n\t\treturn data;\r\n\t}\r\n\r\n\tthis.occupied = function(data) {\r\n\t\t/*\tfunction for showing occupied icon  */\r\n\r\n\t\t// Hide all icons instead of checking each one\r\n\t\t$(\"#chainMap [data-icon='user'], #chainMap [data-icon='user'] + .badge\").addClass(\"invisible\");\r\n\r\n\t\t// Loop through passed data and show icons\r\n\t\tfor (var x in data) {\r\n\t\t\t$(\"#chainMap [data-nodeid='\"+data[x].systemID+\"'] [data-icon='user']\").removeClass(\"invisible\")\r\n\t\t\t$(\"#chainMap [data-nodeid='\"+data[x].systemID+\"'] [data-icon='user'] + .badge\").removeClass(\"invisible\").html(data[x].count);\r\n\t\t}\r\n\r\n\t\tOccupiedToolTips.attach($(\"#chainMap [data-icon='user']:not(.invisible)\"));\r\n\r\n\t\treturn data;\r\n\t}\r\n\r\n\tthis.flares = function(data) {\r\n\t\t/*\tfunction for coloring chain map nodes via flares  */\r\n\t\t//var data = typeof(data) !== \"undefined\" ? data : this.data.flares;\r\n\r\n\t\t// Remove all current node coloring instead of checking each one\r\n\t\t$(\"#chainMap td.node\").removeClass(\"redNode yellowNode greenNode\");\r\n\r\n\t\t// Remove all coloring from chain grid\r\n\t\t$(\"#chainGrid tr\").removeClass(\"red yellow green\");\r\n\r\n\t\t// Loop through passed data and add classes by system\r\n\t\tif (data) {\r\n\t\t\tfor (var x in data.flares) {\r\n\t\t\t\tvar systemID = data.flares[x].systemID;\r\n\t\t\t\tvar flare = data.flares[x].flare;\r\n\r\n\t\t\t\tvar row = ($(\"#chainMap [data-nodeid=\"+systemID+\"]\").parent().addClass(flare+\"Node\").parent().index() - 1) / 3 * 2;\r\n\r\n\t\t\t\tif (row > 0) {\r\n\t\t\t\t\t$(\"#chainGrid tr:eq(\"+row+\")\").addClass(flare).next().addClass(flare);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\t}\r\n\r\n\tthis.grid = function() {\r\n\t\t/*  function for showing/hiding grid lines  */\r\n\t\tif (options.chain.gridlines == false) { $(\"#chainGrid tr\").addClass(\"hidden\"); return false; }\r\n\r\n\t\t$(\"#chainGrid tr\").removeClass(\"hidden\");\r\n\t\t//$(\"#chainGrid\").css(\"width\", \"100%\");\r\n\r\n\t\tvar rows = $(\".google-visualization-orgchart-table tr:has(.node)\").length * 2 - 1;\r\n\r\n\t\t$(\"#chainGrid tr:gt(\"+rows+\")\").addClass(\"hidden\");\r\n\t}\r\n\r\n\tthis.lines = function(data) {\r\n\t\t//var data = typeof(data) !== \"undefined\" ? data : this.data.lines;\r\n\r\n\t\tfunction drawNodeLine(system, parent, mode, signatureID) {\r\n\t\t\t/*\tfunction for drawing colored lines  */\r\n\r\n\t\t\t// Find node in chainmap\r\n\t\t\t//var $node = $(\"#chainMap [data-nodeid='\"+system+\"']\").parent();\r\n\t\t\tvar $node = $(\"#chainMap #node\"+system).parent();\r\n\r\n\t\t\tif ($node.length == 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// Get node # in this line\r\n\t\t\tvar nodeIndex = Math.ceil(($node[0].cellIndex + 1) / 2 - 1);\r\n\r\n\t\t\t// applly to my top line\r\n\t\t\tvar $connector = $($node.parent().prev().children(\"td.google-visualization-orgchart-lineleft, td.google-visualization-orgchart-lineright\")[nodeIndex]).addClass(\"left-\"+mode+\" right-\"+mode);\r\n\t\t\t//var $connector = $($node.parent().prev().find(\"td:not([colspan])\")[nodeIndex]).addClass(\"left-\"+mode+\" right-\"+mode).attr(\"data-signatureid\", signatureID);\r\n\r\n\t\t\t// Find parent node\r\n\t\t\t//var $parent = $(\"#chainMap [data-nodeid='\"+parent+\"']\").parent();\r\n\t\t\tvar $parent = $(\"#chainMap #node\"+parent).parent();\r\n\r\n\t\t\tif ($parent.length == 0 || $connector.length == 0)\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t// Find the col of my top line\r\n\t\t\tvar nodeCol = 0, connectorCell = $connector[0].cellIndex;\r\n\t\t\t$node.parent().prev().find(\"td\").each(function(index) {\r\n\t\t\t\tnodeCol += this.colSpan;\r\n\r\n\t\t\t\tif (index == connectorCell) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Get node # in this line\r\n\t\t\tvar parentIndex = Math.ceil(($parent[0].cellIndex + 1) / 2 - 1);\r\n\r\n\t\t\t// Compensate for non-parent nodes (slight performance hit ~10ms)\r\n\t\t\tvar newparentIndex = parentIndex;\r\n\t\t\tfor (var i = 0; i <= parentIndex; i++) {\r\n\t\t\t\tvar checkSystem = 0;//$node.parent().prev().prev().prev().find(\"td:has([data-nodeid]):eq(\"+i+\")\").find(\"[data-nodeid]\").data(\"nodeid\");\r\n\t\t\t\t$node.parent().prev().prev().prev().find(\"td > [data-nodeid]\").each(function(index) {\r\n\t\t\t\t\tif (index == i) {\r\n\t\t\t\t\t\tcheckSystem = $(this).attr(\"id\").replace(\"node\", \"\");//$(this).data(\"nodeid\");\r\n\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif ($.map(data.map.rows, function(node) { return node.c[1].v == checkSystem ? node : null; }).length <= 0) {\r\n\t\t\t\t\tnewparentIndex--;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tparentIndex = newparentIndex;\r\n\r\n\t\t\t// Apply to parent bottom line\r\n\t\t\tvar $connecte = $($node.parent().prev().prev().children(\"td.google-visualization-orgchart-lineleft, td.google-visualization-orgchart-lineright\")[parentIndex]).addClass(\"left-\"+mode+\" right-\"+mode);\r\n\t\t\t//var $connecte = $($node.parent().prev().prev().find(\"td:not([colspan])\")[parentIndex]).addClass(\"left-\"+mode+\" right-\"+mode).attr(\"data-signatureid\", signatureID);\r\n\r\n\t\t\t// the beans\r\n\t\t\tvar col = 0, parent = false, me = false;\r\n\t\t\t$node.parent().prev().prev().find(\"td\").each(function(index, value) {\r\n\t\t\t\tcol += this.colSpan;\r\n\r\n\t\t\t\tif (me && parent) {\r\n\t\t\t\t\t// All done - get outta here\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} else if (typeof($connecte[0]) != \"undefined\" && $connecte[0].cellIndex == index) {\r\n\t\t\t\t\tparent = true;\r\n\r\n\t\t\t\t\t$(this).addClass(\"left-\"+mode);\r\n\r\n\t\t\t\t\t// remove bottom border that points to the right\r\n\t\t\t\t\tif (!me && col != nodeCol) {\r\n\t\t\t\t\t\t$(this).addClass(\"bottom-\"+mode);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// parent and node are same - we are done\r\n\t\t\t\t\tif (nodeCol == col) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (col == nodeCol) {\r\n\t\t\t\t\tme = true;\r\n\r\n\t\t\t\t\t$(this).addClass(\"bottom-\"+mode);\r\n\t\t\t\t} else if (me || parent) {\r\n\t\t\t\t\tvar tempCol = 0, breaker = false, skip = false;\r\n\r\n\t\t\t\t\t$node.parent().prev().find(\"td\").each(function(index) {\r\n\t\t\t\t\t\ttempCol += this.colSpan;\r\n\r\n\t\t\t\t\t\tif (tempCol == col && ($(this).hasClass(\"google-visualization-orgchart-lineleft\") || $(this).hasClass(\"google-visualization-orgchart-lineright\"))) {\r\n\t\t\t\t\t\t\tif (parent == false) {\r\n\t\t\t\t\t\t\t\t// Stop looking cuz there is another node between us and parent\r\n\t\t\t\t\t\t\t\tbreaker = true;\r\n\t\t\t\t\t\t\t\t$connecte.removeClass(\"left-\"+mode+\" right-\"+mode);\r\n\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t} else if (parent == true) {\r\n\t\t\t\t\t\t\t\t// Lets make sure there isnt a node between the parent and me\r\n\t\t\t\t\t\t\t\t$connecte.removeClass(\"left-\"+mode+\" right-\"+mode);\r\n\r\n\t\t\t\t\t\t\t\t$node.parent().prev().prev().find(\"td\").each(function(index) {\r\n\t\t\t\t\t\t\t\t\tif (index >= $connecte[0].cellIndex) {\r\n\t\t\t\t\t\t\t\t\t\t// there is a node after parent but before me\r\n\t\t\t\t\t\t\t\t\t\t$(this).removeClass(\"bottom-\"+mode);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tskip = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (breaker) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!skip) {\r\n\t\t\t\t\t\t$(this).addClass(\"bottom-\"+mode);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfor (var x in data.lines) {\r\n\t\t\tdrawNodeLine(data.lines[x][0], data.lines[x][1], data.lines[x][2], data.lines[x][3]);\r\n\t\t}\r\n\t}\r\n\r\n\tthis.nodes = function(map) {\r\n\t\tvar chain = {cols: [{label: \"System\", type: \"string\"}, {label: \"Parent\", type: \"string\"}], rows: []};\r\n\t\tvar frigTypes = [\"Q003\", \"E004\", \"L005\", \"Z006\", \"M001\", \"C008\", \"G008\", \"A009\"];\r\n\t\tvar connections = [];\r\n\r\n\t\tfunction topLevel(systemID, id) {\r\n\t\t\tif (!systemID || !tripwire.systems[systemID])\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t// System type switch\r\n\t\t\tvar systemType;\r\n\t\t\tif (tripwire.systems[systemID].class)\r\n\t\t\t\tsystemType = \"<span class='wh'>C\" + tripwire.systems[systemID].class + \"</span>\";\r\n\t\t\telse if (tripwire.systems[systemID].security >= 0.45)\r\n\t\t\t\tsystemType = \"<span class='hisec'>HS</span>\";\r\n\t\t\telse if (tripwire.systems[systemID].security > 0.0)\r\n\t\t\t\tsystemType = \"<span class='lowsec'>LS</span>\";\r\n\t\t\telse if (tripwire.systems[systemID].security <= 0.0)\r\n\t\t\t\tsystemType = \"<span class='nullsec'>NS</span>\";\r\n\r\n\t\t\tvar effectClass = null, effect = null;\r\n\t\t\tif (tripwire.systems[systemID].class) {\r\n\t\t\t\tswitch(tripwire.systems[systemID].effect) {\r\n\t\t\t\t\tcase \"Black Hole\":\r\n\t\t\t\t\t\teffectClass = \"blackhole\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Cataclysmic Variable\":\r\n\t\t\t\t\t\teffectClass = \"cataclysmic-variable\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Magnetar\":\r\n\t\t\t\t\t\teffectClass = \"magnetar\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Pulsar\":\r\n\t\t\t\t\t\teffectClass = \"pulsar\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Red Giant\":\r\n\t\t\t\t\t\teffectClass = \"red-giant\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Wolf-Rayet Star\":\r\n\t\t\t\t\t\teffectClass = \"wolf-rayet\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\teffect = tripwire.systems[systemID].effect;\r\n\t\t\t}\r\n\r\n\t\t\tvar system = {v: id};\r\n\t\t\tvar chainNode = \"<div id='node\"+id+\"' data-nodeid='\"+systemID+\"'>\"\r\n\t\t\t\t\t\t\t+\t\"<div class='nodeIcons'>\"\r\n\t\t\t\t\t\t\t+\t\t\"<div style='float: left;'>\"\r\n\t\t\t\t\t\t\t+\t\t\t\"<i class='whEffect' \"+(effectClass ? \"data-icon='\"+effectClass+\"' data-tooltip='\"+effect+\"'\" : null)+\"></i>\"\r\n\t\t\t\t\t\t\t+\t\t\"</div>\"\r\n\t\t\t\t\t\t\t+\t\t\"<div style='float: right;'>\"\r\n\t\t\t\t\t\t\t+\t\t\t\"<i data-icon='user' class='invisible'></i>\"\r\n\t\t\t\t\t\t\t+\t\t\t\"<span class='badge' class='invisible'></span>\"\r\n\t\t\t\t\t\t\t+\t\t\"</div>\"\r\n\t\t\t\t\t\t\t+\t\"</div>\"\r\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeClass'>\"+systemType+\"</h4>\"\r\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeSystem'>\"\r\n\t\t\t\t\t\t\t+\t\t\"<a href='.?system=\"+tripwire.systems[systemID].name+\"'>\"+(options.chain.tabs[options.chain.active] && options.chain.tabs[options.chain.active].systemID != 0 ? options.chain.tabs[options.chain.active].name : tripwire.systems[systemID].name)+\"</a>\"\r\n\t\t\t\t\t\t\t+\t\"</h4>\"\r\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeType'>&nbsp;</h4>\"\r\n\t\t\t\t\t\t\t+\t\"<div class='nodeActivity'>\"\r\n\t\t\t\t\t\t\t+\t\t\"<span class='jumps invisible'>&#9679;</span>&nbsp;<span class='pods invisible'>&#9679;</span>&nbsp;&nbsp;<span class='ships invisible'>&#9679;</span>&nbsp;<span class='npcs invisible'>&#9679;</span>\"\r\n\t\t\t\t\t\t\t+\t\"</div>\"\r\n\t\t\t\t\t\t\t+\"</div>\"\r\n\r\n\t\t\tsystem.f = chainNode;\r\n\r\n\t\t\treturn system;\r\n\t\t}\r\n\r\n\t\tfunction findLinks(system) {\r\n\t\t\tif (system[0] <= 0) return false;\r\n\r\n\t\t\tvar parentID = parseInt(system[1]), childID = chainList.length;\r\n\r\n\t\t\tfor (var x in chainData) {\r\n\t\t\t\tvar link = chainData[x];\r\n\r\n\t\t\t\tif ($.inArray(link.id, usedLinks) == -1) {\r\n\t\t\t\t\tif (link.systemID == system[0]) {\r\n\t\t\t\t\t\tvar node = {};\r\n\t\t\t\t\t\tnode.id = link.id;\r\n\t\t\t\t\t\tnode.life = link.life;\r\n\t\t\t\t\t\tnode.mass = link.mass;\r\n\t\t\t\t\t\tnode.time = link.time;\r\n\r\n\t\t\t\t\t\tnode.parent = {};\r\n\t\t\t\t\t\tnode.parent.id = parentID;\r\n\t\t\t\t\t\tnode.parent.systemID = link.systemID;\r\n\t\t\t\t\t\tnode.parent.name = link.system;\r\n\t\t\t\t\t\tnode.parent.type = link.sig2Type;\r\n\t\t\t\t\t\tnode.parent.typeBM = link.type2BM;\r\n\t\t\t\t\t\tnode.parent.classBM = link.class2BM;\r\n\t\t\t\t\t\tnode.parent.nth = link.nth2;\r\n\t\t\t\t\t\tnode.parent.signatureID = link.sig2ID;\r\n\r\n\t\t\t\t\t\tnode.child = {};\r\n\t\t\t\t\t\tnode.child.id = ++childID;\r\n\t\t\t\t\t\tnode.child.systemID = link.connectionID;\r\n\t\t\t\t\t\tnode.child.name = link.connection;\r\n\t\t\t\t\t\tnode.child.type = link.type;\r\n\t\t\t\t\t\tnode.child.typeBM = link.typeBM;\r\n\t\t\t\t\t\tnode.child.classBM = link.classBM;\r\n\t\t\t\t\t\tnode.child.nth = link.nth;\r\n\t\t\t\t\t\tnode.child.signatureID = link.signatureID;\r\n\r\n\t\t\t\t\t\tchainLinks.push(node);\r\n\t\t\t\t\t\tchainList.push([node.child.systemID, node.child.id, system[2]]);\r\n\t\t\t\t\t\tusedLinks.push(node.id);\r\n\t\t\t\t\t\t//usedLinks[system[2]].push(node.id);\r\n\r\n\t\t\t\t\t\tif ($(\"#show-viewing\").hasClass(\"active\") && tripwire.systems[node.child.systemID] && !tripwire.systems[viewingSystemID].class && !tripwire.systems[node.child.systemID].class) {\r\n\t\t\t\t\t\t\tvar jumps = guidance.findShortestPath(tripwire.map.shortest, [viewingSystemID - 30000000, node.child.systemID - 30000000]).length - 1;\r\n\r\n\t\t\t\t\t\t\tvar calcNode = {};\r\n\t\t\t\t\t\t\tcalcNode.life = \"Gate\";\r\n\t\t\t\t\t\t\tcalcNode.parent = {};\r\n\t\t\t\t\t\t\tcalcNode.parent.id = node.child.id;\r\n\t\t\t\t\t\t\tcalcNode.parent.systemID = node.child.systemID;\r\n\t\t\t\t\t\t\tcalcNode.parent.name = node.child.name;\r\n\t\t\t\t\t\t\tcalcNode.parent.type = node.child.type;\r\n\t\t\t\t\t\t\tcalcNode.parent.nth = node.child.nth;\r\n\r\n\t\t\t\t\t\t\tcalcNode.child = {};\r\n\t\t\t\t\t\t\tcalcNode.child.id = ++childID;\r\n\t\t\t\t\t\t\tcalcNode.child.systemID = viewingSystemID\r\n\t\t\t\t\t\t\tcalcNode.child.name = tripwire.systems[viewingSystemID].name;\r\n\t\t\t\t\t\t\tcalcNode.child.type = jumps;\r\n\t\t\t\t\t\t\tcalcNode.child.nth = null;\r\n\t\t\t\t\t\t\tcalcNode.child.signatureID = jumps;\r\n\r\n\t\t\t\t\t\t\tchainLinks.push(calcNode);\r\n\t\t\t\t\t\t\tchainList.push([0, childID]);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ($(\"#show-favorite\").hasClass(\"active\") && tripwire.systems[node.child.systemID]) {\r\n\t\t\t\t\t\t\tfor (x in options.favorites) {\r\n\t\t\t\t\t\t\t\tif (tripwire.systems[options.favorites[x]].regionID >= 11000000 || tripwire.systems[node.child.systemID].regionID >= 11000000)\r\n\t\t\t\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t\t\t\tvar jumps = guidance.findShortestPath(tripwire.map.shortest, [options.favorites[x] - 30000000, node.child.systemID - 30000000]).length - 1;\r\n\r\n\t\t\t\t\t\t\t\tvar calcNode = {};\r\n\t\t\t\t\t\t\t\tcalcNode.life = \"Gate\";\r\n\t\t\t\t\t\t\t\tcalcNode.parent = {};\r\n\t\t\t\t\t\t\t\tcalcNode.parent.id = node.child.id;\r\n\t\t\t\t\t\t\t\tcalcNode.parent.systemID = node.child.systemID;\r\n\t\t\t\t\t\t\t\tcalcNode.parent.name = node.child.name;\r\n\t\t\t\t\t\t\t\tcalcNode.parent.type = node.child.type;\r\n\t\t\t\t\t\t\t\tcalcNode.parent.nth = node.child.nth;\r\n\r\n\t\t\t\t\t\t\t\tcalcNode.child = {};\r\n\t\t\t\t\t\t\t\tcalcNode.child.id = ++childID;\r\n\t\t\t\t\t\t\t\tcalcNode.child.systemID = options.favorites[x];\r\n\t\t\t\t\t\t\t\tcalcNode.child.name = tripwire.systems[options.favorites[x]].name;\r\n\t\t\t\t\t\t\t\tcalcNode.child.type = jumps;\r\n\t\t\t\t\t\t\t\tcalcNode.child.nth = null;\r\n\t\t\t\t\t\t\t\tcalcNode.child.signatureID = jumps;\r\n\r\n\t\t\t\t\t\t\t\tchainLinks.push(calcNode);\r\n\t\t\t\t\t\t\t\tchainList.push([0, childID]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (link.connectionID == system[0]) {\r\n\t\t\t\t\t\tvar node = {};\r\n\t\t\t\t\t\tnode.id = link.id;\r\n\t\t\t\t\t\tnode.life = link.life;\r\n\t\t\t\t\t\tnode.mass = link.mass;\r\n\t\t\t\t\t\tnode.time = link.time;\r\n\r\n\t\t\t\t\t\tnode.parent = {};\r\n\t\t\t\t\t\tnode.parent.id = parentID;\r\n\t\t\t\t\t\tnode.parent.systemID = link.connectionID;\r\n\t\t\t\t\t\tnode.parent.name = link.connection;\r\n\t\t\t\t\t\tnode.parent.type = link.type;\r\n\t\t\t\t\t\tnode.parent.typeBM = link.typeBM;\r\n\t\t\t\t\t\tnode.parent.classBM = link.classBM;\r\n\t\t\t\t\t\tnode.parent.nth = link.nth;\r\n\t\t\t\t\t\tnode.parent.signatureID = link.signatureID;\r\n\r\n\t\t\t\t\t\tnode.child = {};\r\n\t\t\t\t\t\tnode.child.id = ++childID;\r\n\t\t\t\t\t\tnode.child.systemID = link.systemID;\r\n\t\t\t\t\t\tnode.child.name = link.system;\r\n\t\t\t\t\t\tnode.child.type = link.sig2Type;\r\n\t\t\t\t\t\tnode.child.typeBM = link.type2BM;\r\n\t\t\t\t\t\tnode.child.classBM = link.class2BM;\r\n\t\t\t\t\t\tnode.child.nth = link.nth2;\r\n\t\t\t\t\t\tnode.child.signatureID = link.sig2ID;\r\n\r\n\t\t\t\t\t\tchainLinks.push(node);\r\n\t\t\t\t\t\tchainList.push([node.child.systemID, node.child.id, system[2]]);\r\n\t\t\t\t\t\tusedLinks.push(node.id);\r\n\t\t\t\t\t\t//usedLinks[system[2]].push(node.id);\r\n\r\n\t\t\t\t\t\tif ($(\"#show-viewing\").hasClass(\"active\") && tripwire.systems[node.child.systemID] && !tripwire.systems[viewingSystemID].class && !tripwire.systems[node.child.systemID].class) {\r\n\t\t\t\t\t\t\tvar jumps = guidance.findShortestPath(tripwire.map.shortest, [viewingSystemID - 30000000, node.child.systemID - 30000000]).length - 1;\r\n\r\n\t\t\t\t\t\t\tvar calcNode = {};\r\n\t\t\t\t\t\t\tcalcNode.life = \"Gate\";\r\n\t\t\t\t\t\t\tcalcNode.parent = {};\r\n\t\t\t\t\t\t\tcalcNode.parent.id = node.child.id;\r\n\t\t\t\t\t\t\tcalcNode.parent.systemID = node.child.systemID;\r\n\t\t\t\t\t\t\tcalcNode.parent.name = node.child.name;\r\n\t\t\t\t\t\t\tcalcNode.parent.type = node.child.type;\r\n\t\t\t\t\t\t\tcalcNode.parent.nth = node.child.nth;\r\n\r\n\t\t\t\t\t\t\tcalcNode.child = {};\r\n\t\t\t\t\t\t\tcalcNode.child.id = ++childID;\r\n\t\t\t\t\t\t\tcalcNode.child.systemID = viewingSystemID;\r\n\t\t\t\t\t\t\tcalcNode.child.name = tripwire.systems[viewingSystemID].name;\r\n\t\t\t\t\t\t\tcalcNode.child.type = jumps;\r\n\t\t\t\t\t\t\tcalcNode.child.nth = null;\r\n\t\t\t\t\t\t\tcalcNode.child.signatureID = jumps;\r\n\r\n\t\t\t\t\t\t\tchainLinks.push(calcNode);\r\n\t\t\t\t\t\t\tchainList.push([0, childID]);\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\tif ($(\"#show-favorite\").hasClass(\"active\") && tripwire.systems[node.child.systemID]) {\r\n\t\t\t\t\t\t\tfor (x in options.favorites) {\r\n\t\t\t\t\t\t\t\tif (tripwire.systems[options.favorites[x]].regionID >= 11000000 || tripwire.systems[node.child.systemID].regionID >= 11000000)\r\n\t\t\t\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t\t\t\tvar jumps = guidance.findShortestPath(tripwire.map.shortest, [options.favorites[x] - 30000000, node.child.systemID - 30000000]).length - 1;\r\n\r\n\t\t\t\t\t\t\t\tvar calcNode = {};\r\n\t\t\t\t\t\t\t\tcalcNode.life = \"Gate\";\r\n\t\t\t\t\t\t\t\tcalcNode.parent = {};\r\n\t\t\t\t\t\t\t\tcalcNode.parent.id = node.child.id;\r\n\t\t\t\t\t\t\t\tcalcNode.parent.systemID = node.child.systemID;\r\n\t\t\t\t\t\t\t\tcalcNode.parent.name = node.child.name;\r\n\t\t\t\t\t\t\t\tcalcNode.parent.type = node.child.type;\r\n\t\t\t\t\t\t\t\tcalcNode.parent.nth = node.child.nth;\r\n\r\n\t\t\t\t\t\t\t\tcalcNode.child = {};\r\n\t\t\t\t\t\t\t\tcalcNode.child.id = ++childID;\r\n\t\t\t\t\t\t\t\tcalcNode.child.systemID = options.favorites[x];\r\n\t\t\t\t\t\t\t\tcalcNode.child.name = tripwire.systems[options.favorites[x]].name;\r\n\t\t\t\t\t\t\t\tcalcNode.child.type = jumps;\r\n\t\t\t\t\t\t\t\tcalcNode.child.nth = null;\r\n\t\t\t\t\t\t\t\tcalcNode.child.signatureID = jumps;\r\n\r\n\t\t\t\t\t\t\t\tchainLinks.push(calcNode);\r\n\t\t\t\t\t\t\t\tchainList.push([0, childID]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif (false && $(\"#home\").hasClass(\"active\")) {\r\n\t\t\t$(\"#chainError\").hide();\r\n\r\n\t\t\tvar row = {c: []};\r\n\t\t\tvar systemID = $.map(tripwire.systems, function(system, id) { return system.name == options.chain.home ? id : null; })[0];\r\n\r\n\t\t\trow.c.push(topLevel(systemID, 1), {v: null});\r\n\r\n\t\t\tchain.rows.push(row);\r\n\r\n\t\t\tvar chainList = [[systemID, 1]];\r\n\t\t\tvar chainData = map;\r\n\t\t\tvar chainLinks = [];\r\n\t\t\tvar usedLinks = [];\r\n\r\n\t\t\tfor (var i = 0; i < chainList.length; ++i) {\r\n\t\t\t\tfindLinks(chainList[i]);\r\n\t\t\t}\r\n\t\t} else if (false && $(\"#k-space\").hasClass(\"active\")) {\r\n\t\t\t$(\"#chainError\").hide();\r\n\r\n\t\t\tvar chainList = [];//$.map(tripwire.systems, function(system, id) { return system.class ? null : [id, 1]; });\r\n\t\t\tvar kspace = $.map(tripwire.systems, function(system, id) { return system.class ? null : id; });\r\n\t\t\tvar chainData = map;\r\n\t\t\tvar chainLinks = [];\r\n\t\t\tvar usedLinks = [];\r\n\r\n\t\t\tvar i = 0;\r\n\t\t\tfor (var x in map) {\r\n\t\t\t\tif ($.inArray(map[x].systemID, kspace) != -1) {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tchain.rows.push({c: [topLevel(map[x].systemID, i), {v: null}]});\r\n\t\t\t\t\tchainList.push([map[x].systemID, i]);\r\n\t\t\t\t} else if ($.inArray(map[x].connectionID, kspace) != -1) {\r\n\t\t\t\t\ti++;\r\n\t\t\t\t\tchain.rows.push({c: [topLevel(map[x].connectionID, i), {v: null}]});\r\n\t\t\t\t\tchainList.push([map[x].connectionID, i]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i = 0; i < chainList.length; ++i) {\r\n\t\t\t\tfindLinks(chainList[i]);\r\n\t\t\t}\r\n\t\t} else if (false && $(\"#eve-scout\").hasClass(\"active\")) {\r\n\t\t\t$(\"#chainError\").hide();\r\n\r\n\t\t\tvar row = {c: []};\r\n\t\t\tvar systemID = 31000005;\r\n\r\n\t\t\trow.c.push(topLevel(systemID, 1), {v: null});\r\n\r\n\t\t\tchain.rows.push(row);\r\n\r\n\t\t\tvar chainList = [[systemID, 1]];\r\n\t\t\tvar chainData = map;\r\n\t\t\tvar chainLinks = [];\r\n\t\t\tvar usedLinks = [];\r\n\r\n\t\t\tfor (var i = 0; i < chainList.length; ++i) {\r\n\t\t\t\tfindLinks(chainList[i]);\r\n\t\t\t}\r\n\t\t} else if ($(\"#chainTabs .current\").length > 0) {\r\n\t\t\tvar systems = $(\"#chainTabs .current .name\").data(\"tab\").toString().split(\",\");\r\n\t\t\tvar chainList = [];\r\n\t\t\tvar chainData = map;\r\n\t\t\tvar chainLinks = [];\r\n\t\t\tvar usedLinks = [];\r\n\r\n\t\t\tif (systems == 0) {\r\n\t\t\t\tvar i = 0;\r\n\t\t\t\tfor (var x in map) {\r\n\t\t\t\t\tif (typeof(tripwire.systems[map[x].systemID].class) == \"undefined\") {\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\t//usedLinks[map[x].systemID] = [];\r\n\t\t\t\t\t\tchain.rows.push({c: [topLevel(map[x].systemID, i), {v: null}]});\r\n\t\t\t\t\t\tchainList.push([map[x].systemID, i, map[x].systemID]);\r\n\t\t\t\t\t} else if (tripwire.systems[map[x].connectionID] && typeof(tripwire.systems[map[x].connectionID].class) == \"undefined\") {\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\t//usedLinks[map[x].connectionID] = [];\r\n\t\t\t\t\t\tchain.rows.push({c: [topLevel(map[x].connectionID, i), {v: null}]});\r\n\t\t\t\t\t\tchainList.push([map[x].connectionID, i, map[x].connectionID]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\tfor (var x in systems) {\r\n\t\t\t\t\t//usedLinks[systems[x]] = [];\r\n\t\t\t\t\tchain.rows.push({c: [topLevel(systems[x], parseInt(x) + 1), {v: null}]});\r\n\t\t\t\t\tchainList.push([systems[x], parseInt(x) + 1, systems[x]]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t//var startTime = window.performance.now();\r\n\t\t\tfor (var i = 0; i < chainList.length; i++) {\r\n\t\t\t\tfindLinks(chainList[i]);\r\n\t\t\t}\r\n\t\t\t//console.log(\"stint: \"+ (window.performance.now() - startTime));\r\n\t\t} else {\r\n\t\t\t$(\"#chainError\").hide();\r\n\r\n\t\t\tvar row = {c: []};\r\n\t\t\tvar systemID = viewingSystemID;\r\n\r\n\t\t\trow.c.push(topLevel(systemID, 1), {v: null});\r\n\r\n\t\t\tchain.rows.push(row);\r\n\r\n\t\t\tvar chainList = [[systemID, 1]];\r\n\t\t\tvar chainData = map;\r\n\t\t\tvar chainLinks = [];\r\n\t\t\tvar usedLinks = [];\r\n\r\n\t\t\tfor (var i = 0; i < chainList.length; ++i) {\r\n\t\t\t\tfindLinks(chainList[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tfor (var x in chainLinks) {\r\n\t\t\tvar node = chainLinks[x];\r\n\t\t\tvar row = {c: []};\r\n\r\n\t\t\t// System type switch\r\n\t\t\tvar systemType;\r\n\t\t\tvar nodeClass = tripwire.systems[node.child.systemID] ? tripwire.systems[node.child.systemID].class : null;\r\n\t\t\tvar nodeSecurity = tripwire.systems[node.child.systemID] ? tripwire.systems[node.child.systemID].security : null;\r\n\t\t\tif (nodeClass == 6 || node.child.name == \"Class-6\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"Class 6\"))\r\n\t\t\t\tsystemType = \"<span class='wh'>C6</span>\";\r\n\t\t\telse if (nodeClass == 5 || node.child.name == \"Class-5\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"Class 5\"))\r\n\t\t\t\tsystemType = \"<span class='wh'>C5</span>\";\r\n\t\t\telse if (nodeClass == 4 || node.child.name == \"Class-4\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"Class 4\"))\r\n\t\t\t\tsystemType = \"<span class='wh'>C4</span>\";\r\n\t\t\telse if (nodeClass == 3 || node.child.name == \"Class-3\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"Class 3\"))\r\n\t\t\t\tsystemType = \"<span class='wh'>C3</span>\";\r\n\t\t\telse if (nodeClass == 2 || node.child.name == \"Class-2\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"Class 2\"))\r\n\t\t\t\tsystemType = \"<span class='wh'>C2</span>\";\r\n\t\t\telse if (nodeClass == 1 || node.child.name == \"Class-1\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"Class 1\"))\r\n\t\t\t\tsystemType = \"<span class='wh'>C1</span>\";\r\n\t\t\telse if (nodeClass > 6)\r\n\t\t\t\tsystemType = \"<span class='wh'>C\" + nodeClass + \"</span>\";\r\n\t\t\telse if (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo.split(\" \").length > 1)\r\n\t\t\t\tsystemType = \"<span class='wh'>C\" + tripwire.wormholes[node.child.type].leadsTo.split(\" \")[1] + \"</span>\";\r\n\t\t\telse if (nodeSecurity >= 0.45 || node.child.name == \"High-Sec\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"High-Sec\" && !nodeSecurity))\r\n\t\t\t\tsystemType = \"<span class='hisec'>HS</span>\";\r\n\t\t\telse if (nodeSecurity > 0.0 || node.child.name == \"Low-Sec\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"Low-Sec\" && !nodeSecurity))\r\n\t\t\t\tsystemType = \"<span class='lowsec'>LS</span>\";\r\n\t\t\telse if ((nodeSecurity <= 0.0 && nodeSecurity != null) || node.child.name == \"Null-Sec\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"Null-Sec\"))\r\n\t\t\t\tsystemType = \"<span class='nullsec'>NS</span>\";\r\n\t\t\telse\r\n\t\t\t\tsystemType = \"<span>&nbsp;</span>\";\r\n\r\n\t\t\tvar effectClass = null, effect = null;\r\n\t\t\tif (typeof(tripwire.systems[node.child.systemID]) != \"undefined\") {\r\n\t\t\t\tswitch(tripwire.systems[node.child.systemID].effect) {\r\n\t\t\t\t\tcase \"Black Hole\":\r\n\t\t\t\t\t\teffectClass = \"blackhole\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Cataclysmic Variable\":\r\n\t\t\t\t\t\teffectClass = \"cataclysmic-variable\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Magnetar\":\r\n\t\t\t\t\t\teffectClass = \"magnetar\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Pulsar\":\r\n\t\t\t\t\t\teffectClass = \"pulsar\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Red Giant\":\r\n\t\t\t\t\t\teffectClass = \"red-giant\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tcase \"Wolf-Rayet Star\":\r\n\t\t\t\t\t\teffectClass = \"wolf-rayet\";\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\tdefault:\r\n\t\t\t\t\t\teffectClass = null;\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\r\n\t\t\t\teffect = tripwire.systems[node.child.systemID].effect;\r\n\t\t\t}\r\n\r\n\t\t\tvar child = {v: node.child.id};\r\n\t\t\tvar chainNode = \"<div id='node\"+node.child.id+\"' data-nodeid='\"+node.child.systemID+\"' data-sigid='\"+node.id+\"'>\"\r\n\t\t\t\t\t\t\t+\t\"<div class='nodeIcons'>\"\r\n\t\t\t\t\t\t\t+\t\t\"<div style='float: left;'>\"\r\n\t\t\t\t\t\t\t+\t\t\t\"<i class='whEffect' \"+(effectClass ? \"data-icon='\"+effectClass+\"' data-tooltip='\"+effect+\"'\" : null)+\"></i>\"\r\n\t\t\t\t\t\t\t+\t\t\"</div>\"\r\n\t\t\t\t\t\t\t+\t\t\"<div style='float: right;'>\"\r\n\t\t\t\t\t\t\t+\t\t\t\"<i data-icon='user' class='invisible'></i>\"\r\n\t\t\t\t\t\t\t+\t\t\t\"<span class='badge' class='invisible'></span>\"\r\n\t\t\t\t\t\t\t+\t\t\"</div>\"\r\n\t\t\t\t\t\t\t+\t\"</div>\"\r\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeClass'>\"+(systemType + sigFormat(node.child.classBM, \"class\"))+\"</h4>\"\r\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeSystem'>\"\r\n\t\t\t\t\t\t\t+ \t(tripwire.systems[node.child.systemID] ? \"<a href='.?system=\"+tripwire.systems[node.child.systemID].name+\"'>\"+(node.child.name ? node.child.name : tripwire.systems[node.child.systemID].name)+\"</a>\" : \"<a class='invisible'>system</a>\")\r\n\t\t\t\t\t\t\t+\t\"</h4>\"\r\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeType'>\"+(options.chain[\"node-reference\"] == \"id\" ? node.child.signatureID : node.child.type + sigFormat(node.child.typeBM, \"type\") || \"&nbsp;\")+\"</h4>\"\r\n\t\t\t\t\t\t\t+\t\"<div class='nodeActivity'>\"\r\n\t\t\t\t\t\t\t+\t\t\"<span class='jumps invisible'>&#9679;</span>&nbsp;<span class='pods invisible'>&#9679;</span>&nbsp;&nbsp;<span class='ships invisible'>&#9679;</span>&nbsp;<span class='npcs invisible'>&#9679;</span>\"\r\n\t\t\t\t\t\t\t+\t\"</div>\"\r\n\t\t\t\t\t\t\t+\"</div>\"\r\n\r\n\t\t\tchild.f = chainNode;\r\n\r\n\t\t\tvar parent = {v: node.parent.id};\r\n\r\n\t\t\trow.c.push(child, parent);\r\n\t\t\tchain.rows.push(row);\r\n\r\n\t\t\tif (node.life == \"Critical\" && ($.inArray(node.parent.type, frigTypes) != -1 || $.inArray(node.child.type, frigTypes) != -1))\r\n\t\t\t\tconnections.push(Array(child.v, parent.v, \"eol-frig\", node.id));\r\n\t\t\telse if (node.life == \"Critical\" && node.mass == \"Critical\")\r\n\t\t\t\tconnections.push(Array(child.v, parent.v, \"eol-critical\", node.id));\r\n\t\t\telse if (node.life == \"Critical\" && node.mass == \"Destab\")\r\n\t\t\t\tconnections.push(Array(child.v, parent.v, \"eol-destab\", node.id));\r\n\t\t\telse if ($.inArray(node.parent.type, frigTypes) != -1 || $.inArray(node.child.type, frigTypes) != -1)\r\n\t\t\t\tconnections.push(Array(child.v, parent.v, \"frig\", node.id));\r\n\t\t\telse if (node.life == \"Critical\")\r\n\t\t\t\tconnections.push(Array(child.v, parent.v, \"eol\", node.id));\r\n\t\t\telse if (node.mass == \"Critical\")\r\n\t\t\t\tconnections.push(Array(child.v, parent.v, \"critical\", node.id));\r\n\t\t\telse if (node.mass == \"Destab\")\r\n\t\t\t\tconnections.push(Array(child.v, parent.v, \"destab\", node.id));\r\n\t\t\telse if (node.life == \"Gate\" || node.parent.type == \"GATE\" || node.child.type == \"GATE\")\r\n\t\t\t\tconnections.push(Array(child.v, parent.v, \"gate\", node.id));\r\n\t\t\t//else\r\n\t\t\t//\tconnections.push(Array(child.v, parent.v, \"\", node.id));\r\n\t\t}\r\n\r\n\t\t// Apply critical/destab line colors\r\n\t\tconnections.reverse(); // so we apply to outer systems first\r\n\r\n\t\t//this.data.map = chain;\r\n\t\t//this.data.lines = connections;\r\n\t\treturn {\"map\": chain, \"lines\": connections};\r\n\t}\r\n\r\n\tthis.redraw = function() {\r\n\t\tvar data = $.extend(true, {}, this.data);\r\n\t\tdata.map = $.extend(true, {}, data.rawMap);\r\n\r\n\t\tthis.draw(data);\r\n\t}\r\n\r\n\tthis.draw = function(data) {\r\n\t\tvar data = typeof(data) !== \"undefined\" ? data : {};\r\n\t\t//var startTime = window.performance.now();\r\n\r\n\t\tif (data.map) {\r\n\t\t\tthis.drawing = true;\r\n\r\n\t\t\tthis.data.rawMap = $.extend(true, {}, data.map);\r\n\r\n\t\t\tif (options.chain.active == null || (options.chain.tabs[options.chain.active] && options.chain.tabs[options.chain.active].evescout == false)) {\r\n\t\t\t\tif (options.masks.active != \"273.0\") {\r\n\t\t\t\t\tfor (var i in data.map) {\r\n\t\t\t\t\t\tif (data.map[i].mask == \"273.0\") {\r\n\t\t\t\t\t\t\tdelete data.map[i];\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t// Sort so we keep the chain map order the same\r\n\t\t\tObject.sort(data.map, \"id\");\r\n\r\n\t\t\t$.extend(data, this.nodes(data.map)); // 250ms -> <100ms\r\n\t\t\t$.extend(this.data, data);\r\n\t\t\tthis.map.draw(this.newView(data.map), this.options); // 150ms\r\n\r\n\t\t\tif (options.chain.tabs[options.chain.active]) {\r\n\t\t\t\tfor (var x in options.chain.tabs[options.chain.active].collapsed) {\r\n\t\t\t\t\tvar node = $(\"#chainMap [data-nodeid='\"+options.chain.tabs[options.chain.active].collapsed[x]+\"']\").attr(\"id\");\r\n\r\n\t\t\t\t\tif (node) {\r\n\t\t\t\t\t\tnode = node.split(\"node\")[1];\r\n\t\t\t\t\t\tthis.map.collapse(node - 1, true);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tthis.lines(data); // 300ms\r\n\t\t\tthis.grid(); // 4ms\r\n\r\n\t\t\t// Apply current system style\r\n\t\t\t$(\"#chainMap [data-nodeid='\"+viewingSystemID+\"']\").parent().addClass(\"currentNode\"); // 1ms\r\n\r\n\t\t\tWormholeTypeToolTips.attach($(\"#chainMap .whEffect\")); // 30ms\r\n\t\t\tthis.drawing = false;\r\n\t\t}\r\n\r\n\t\tif (data.activity) // 100ms\r\n\t\t\tthis.data.activity = this.activity(data.activity);\r\n\r\n\t\tif (data.occupied) // 3ms\r\n\t\t\tthis.data.occupied = this.occupied(data.occupied);\r\n\r\n\t\tif (data.flares) // 20ms\r\n\t\t\tthis.data.flares = this.flares(data.flares);\r\n\r\n\t\tif (data.last_modified)\r\n\t\t\tthis.data.last_modified = data.last_modified;\r\n\r\n\t\t//console.log(\"stint: \"+ (window.performance.now() - startTime));\r\n\t}\r\n\r\n\tthis.collapse = function(c) {\r\n\t\tif (chain.drawing) return false;\r\n\r\n\t\tvar collapsed = chain.map.getCollapsedNodes();\r\n\t\toptions.chain.tabs[options.chain.active].collapsed = [];\r\n\t\tfor (x in collapsed) {\r\n\t\t\tvar systemID = $(\"#chainMap #node\"+(collapsed[x] +1)).data(\"nodeid\");\r\n\t\t\toptions.chain.tabs[options.chain.active].collapsed.push(systemID);\r\n\t\t}\r\n\r\n\t\tchain.lines(chain.data);\r\n\r\n\t\t// Apply current system style\r\n\t\t$(\"#chainMap [data-nodeid='\"+viewingSystemID+\"']\").parent().addClass(\"currentNode\");\r\n\r\n\t\tWormholeTypeToolTips.attach($(\"#chainMap .whEffect\"));\r\n\r\n\t\tchain.activity(chain.data.activity);\r\n\r\n\t\tchain.occupied(chain.data.occupied);\r\n\r\n\t\tchain.flares(chain.data.flares);\r\n\r\n\t\tchain.grid();\r\n\r\n\t\toptions.save();\r\n\t}\r\n\r\n\tthis.init = function() {\r\n\t\tthis.map = new google.visualization.OrgChart(document.getElementById(\"chainMap\"));\r\n\t\tthis.options = {allowHtml: true, allowCollapse: true, size: \"medium\", nodeClass: \"node\"};\r\n\r\n\t\tgoogle.visualization.events.addListener(this.map, \"collapse\", this.collapse);\r\n\r\n\t\tthis.map.draw(new google.visualization.DataView(new google.visualization.DataTable({cols:[{label: \"System\", type: \"string\"}, {label: \"Parent\", type: \"string\"}]})), this.options);\r\n\t}\r\n\r\n\t//google.setOnLoadCallback(this.init());\r\n\tthis.init();\r\n}\r\n","var CKConfig = {\r\n\tskin: \"custom\",\r\n\theight: 100,\r\n\tallowedContent: true,\r\n\textraPlugins: \"toolbarswitch,autogrow,autolink\",\r\n\tenterMode: CKEDITOR.ENTER_BR,\r\n\tremoveDialogTabs: 'link:advanced',\r\n\tautoGrow_onStartup: true,\r\n\tautoGrow_minHeight: 100,\r\n\ttoolbar_minToolbar: [\r\n\t\t{name: \"basicstyles\", items: [\"Bold\", \"Italic\", \"Underline\", \"Strike\"]},\r\n\t\t{name: \"paragraph\", items: [\"BulletedList\", \"Outdent\", \"Indent\"]},\r\n\t\t{name: \"links\", items: [\"Link\"]},\r\n\t\t{name: \"colors\", items: [\"TextColor\", \"BGColor\"]},\r\n\t\t{name: \"styles\", items: [\"FontSize\"]},\r\n\t\t{name: \"tools\", items: [\"Toolbarswitch\"]}\r\n\t],\r\n\ttoolbar_maxToolbar: [\r\n\t\t{name: \"basicstyles\", items: [\"Bold\", \"Italic\", \"Underline\", \"Strike\", \"Subscript\", \"Superscript\"]},\r\n\t\t{name: \"paragraph\", items: [\"NumberedList\", \"BulletedList\", \"Outdent\", \"Indent\"]},\r\n\t\t{name: \"links\", items: [\"Link\"]},\r\n\t\t{name: \"colors\", items: [\"TextColor\", \"BGColor\"]},\r\n\t\t{name: \"styles\", items: [\"FontSize\", \"Font\"]},\r\n\t\t{name: \"tools\", items: [\"Source\", \"Toolbarswitch\"]}\r\n\t],\r\n\ttoolbar: \"minToolbar\",\r\n\tsmallToolbar: \"minToolbar\",\r\n\tmaximizedToolbar: \"maxToolbar\",\r\n\tfontSize_style: {\r\n\t    element:        'span',\r\n\t    styles:         { 'font-size': '#(size)' },\r\n\t    overrides:      [ { element :'font', attributes: { 'size': null } } ]\r\n\t}\r\n}\r\n\r\nCKEDITOR.on(\"instanceLoaded\", function(cke) {\r\n\tcke.editor.on(\"contentDom\", function() {\r\n\t\tcke.editor.on(\"key\", function(e) {\r\n\t\t\tif (e.data.keyCode == 27) {\r\n\t\t\t\t// escape key cancels\r\n\t\t\t\t$(cke.editor.element.$).closest(\".comment\").find(\".commentCancel\").click();\r\n\t\t\t\treturn false;\r\n\t\t\t} else if (e.data.domEvent.$.altKey && e.data.domEvent.$.keyCode == 83) {\r\n\t\t\t\t// alt+s saves\r\n\t\t\t\t$(cke.editor.element.$).closest(\".comment\").find(\".commentSave\").click();\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\t\t});\r\n\t});\r\n\r\n\t$(\".cke_combo__font a\")\r\n\t\t.removeClass(\"cke_combo_button\")\r\n\t\t.addClass(\"cke_button cke_button_off\")\r\n\t\t.html('<span class=\"cke_button_icon\">&nbsp;</span>')\r\n\r\n\t$(\".cke_combo__fontsize a\")\r\n\t\t.removeClass(\"cke_combo_button\")\r\n\t\t.addClass(\"cke_button cke_button_off\")\r\n\t\t.html('<span class=\"cke_button_icon\">&nbsp;</span>')\r\n});\r\n\r\nCKEDITOR.on(\"instanceReady\", function(cke) {\r\n\t// ensure focus on init\r\n\tcke.editor.focus();\r\n\r\n\tvar s = cke.editor.getSelection(); // getting selection\r\n\tvar selected_ranges = s.getRanges(); // getting ranges\r\n\tvar node = selected_ranges[0].startContainer; // selecting the starting node\r\n\tvar parents = node.getParents(true);\r\n\r\n\tnode = parents[parents.length - 2].getFirst();\r\n\r\n\tif (!node) return false;\r\n\r\n\twhile (true) {\r\n\t\tvar x = node.getNext();\r\n\t\tif (x == null) {\r\n\t\t\tbreak;\r\n\t\t}\r\n\t\tnode = x;\r\n\t}\r\n\r\n\ts.selectElement(node);\r\n\tselected_ranges = s.getRanges();\r\n\tselected_ranges[0].collapse(false);  //  false collapses the range to the end of the selected node, true before the node.\r\n\ts.selectRanges(selected_ranges);  // putting the current selection there\r\n});\r\n\r\nCKEDITOR.on(\"dialogDefinition\", function(ev) {\r\n\tif (ev.data.name == 'link') {\r\n\t\tev.data.definition.getContents('target').get('linkTargetType')['default'] = '_blank';\r\n\t}\r\n});\r\n","$(\"body\").on(\"dblclick\", \".comment\", function(e) {\r\n\te.preventDefault();\r\n\tdocument.getSelection().removeAllRanges();\r\n\t$(this).find(\".commentEdit\").click();\r\n})\r\n\r\n$(\"body\").on(\"click\", \".commentEdit\", function(e) {\r\n\te.preventDefault();\r\n\r\n\t// Prevent multiple editors\r\n\tif ($(\".cke\").length) return false;\r\n\r\n\tvar $comment = $(this).closest(\".comment\");\r\n\r\n\t$comment.find(\".commentToolbar\").hide();\r\n\r\n\tCKEDITOR.replace($comment.find(\".commentBody\").attr(\"id\"), CKConfig).on(\"instanceReady\", function() {\r\n\t\t$comment.find(\".commentStatus\").html(\"\");\r\n\t\t$comment.find(\".commentFooter\").show();\r\n\t\t$comment.find(\".commentFooter .commentControls\").show();\r\n\t});\r\n\r\n\ttripwire.activity.editComment = $comment.data(\"id\");\r\n\ttripwire.refresh('refresh');\r\n});\r\n\r\n$(\"body\").on(\"click\", \".commentSave, .commentCancel\", function(e) {\r\n\te.preventDefault();\r\n\tvar $this = $(this);\r\n\tif ($this.attr(\"disabled\")) return false;\r\n\r\n\tvar $comment = $this.closest(\".comment\");\r\n\t$this.attr(\"disabled\", \"true\");\r\n\r\n\tif ($this.hasClass(\"commentSave\")) {\r\n\t\tvar data = {\"mode\": \"save\", \"commentID\": $comment.data(\"id\"), \"systemID\": $comment.find(\".commentSticky\").hasClass(\"active\") ? 0 : viewingSystemID, \"comment\": CKEDITOR.instances[$comment.find(\".commentBody\").attr(\"id\")].getData()};\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: \"comments.php\",\r\n\t\t\ttype: \"POST\",\r\n\t\t\tdata: data,\r\n\t\t\tdataType: \"JSON\"\r\n\t\t}).done(function(data) {\r\n\t\t\tif (data && data.result == true) {\r\n\t\t\t\t$comment.find(\".commentModified\").html(\"Edited by \" + data.comment.modifiedBy + \" at \" + data.comment.modifiedDate);\r\n\t\t\t\t$comment.find(\".commentCreated\").html(\"Posted by \" + data.comment.createdBy + \" at \" + data.comment.createdDate);\r\n\t\t\t\tTooltips.attach($comment.find(\"[data-tooltip]\"));\r\n\r\n\t\t\t\tCKEDITOR.instances[$comment.find(\".commentBody\").attr(\"id\")].destroy(false);\r\n\t\t\t\t$comment.attr(\"data-id\", data.comment.id);\r\n\t\t\t\t$comment.find(\".commentToolbar\").show();\r\n\t\t\t\t$comment.find(\".commentFooter\").hide();\r\n\t\t\t\t$this.removeAttr(\"disabled\");\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\tCKEDITOR.instances[$comment.find(\".commentBody\").attr(\"id\")].destroy(true);\r\n\r\n\t\tif (!$comment.attr(\"data-id\")) {\r\n\t\t\t$comment.remove();\r\n\t\t} else {\r\n\t\t\t$comment.find(\".commentToolbar\").show();\r\n\t\t\t$comment.find(\".commentFooter\").hide();\r\n\t\t\t$this.removeAttr(\"disabled\");\r\n\t\t}\r\n\t}\r\n\r\n\t$comment.find(\".commentStatus\").html(\"\");\r\n\r\n\tdelete tripwire.activity.editComment;\r\n\ttripwire.refresh('refresh');\r\n});\r\n\r\n$(\"body\").on(\"click\", \".commentDelete\", function(e) {\r\n\te.preventDefault();\r\n\tvar $comment = $(this).closest(\".comment\");\r\n\r\n\t// check if dialog is open\r\n\tif (!$(\"#dialog-deleteComment\").hasClass(\"ui-dialog-content\")) {\r\n\t\t$(\"#dialog-deleteComment\").data(\"comment\", $comment).dialog({\r\n\t\t\tresizable: false,\r\n\t\t\tminHeight: 0,\r\n\t\t\tposition: {my: \"center\", at: \"center\", of: $(\"#notesWidget\")},\r\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\r\n\t\t\tbuttons: {\r\n\t\t\t\tDelete: function() {\r\n\t\t\t\t\t// Prevent duplicate submitting\r\n\t\t\t\t\t$(\"#dialog-deleteComment\").parent().find(\":button:contains('Delete')\").button(\"disable\");\r\n\r\n\t\t\t\t\tvar $comment = $(this).data(\"comment\");\r\n\t\t\t\t\tvar data = {\"mode\": \"delete\", \"commentID\": $comment.data(\"id\")};\r\n\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: \"comments.php\",\r\n\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\tdata: data,\r\n\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t}).done(function(data) {\r\n\t\t\t\t\t\tif (data && data.result == true) {\r\n\t\t\t\t\t\t\t$(\"#dialog-deleteComment\").dialog(\"close\");\r\n\t\t\t\t\t\t\t$comment.remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).always(function() {\r\n\t\t\t\t\t\t$(\"#dialog-deleteComment\").parent().find(\":button:contains('Delete')\").button(\"enable\");\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tCancel: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t} else if (!$(\"#dialog-deleteComment\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-deleteComment\").data(\"comment\", $comment).dialog(\"open\");\r\n\t}\r\n});\r\n\r\n$(\"body\").on(\"click\", \"#add-comment\", function(e) {\r\n\te.preventDefault();\r\n\r\n\t// Prevent multiple editors\r\n\tif ($(\".cke\").length) return false;\r\n\r\n\tvar $comment = $(\".comment:last\").clone();\r\n\tvar commentID = $(\".comment:visible:last .commentBody\").attr(\"id\") ? $(\".comment:visible:last .commentBody\").attr(\"id\").replace(\"comment\", \"\") + 1 : 0;\r\n\t$(\".comment:last\").before($comment);\r\n\r\n\t$comment.find(\".commentBody\").attr(\"id\", \"comment\" + commentID);\r\n\t$comment.removeClass(\"hidden\").find(\".commentEdit\").click();\r\n});\r\n\r\n$(\"body\").on(\"click\", \".commentSticky\", function(e) {\r\n\te.preventDefault();\r\n\tvar $comment = $(this).closest(\".comment\");\r\n\r\n\tvar data = {\"mode\": \"sticky\", \"commentID\": $comment.data(\"id\"), \"systemID\": $comment.find(\".commentSticky\").hasClass(\"active\") ? viewingSystemID : 0};\r\n\r\n\t$.ajax({\r\n\t\turl: \"comments.php\",\r\n\t\ttype: \"POST\",\r\n\t\tdata: data,\r\n\t\tdataType: \"JSON\"\r\n\t}).done(function(data) {\r\n\t\tif (data && data.result == true) {\r\n\t\t\t$comment.find(\".commentSticky\").hasClass(\"active\") ? $comment.find(\".commentSticky\").removeClass(\"active\") : $comment.find(\".commentSticky\").addClass(\"active\");\r\n\t\t}\r\n\t});\r\n});\r\n","if (window.location.href.indexOf(\"galileo\") != -1) {\r\n\tNotify.trigger(\"This is the test version of Tripwire.<br/>Please use <a href='https://tripwire.cloud-things.com'>Tripwire</a>\")\r\n}\r\n\r\n$(\"body\").on(\"click\", \"a[href^='.?system=']\", function(e) {\r\n\te.preventDefault();\r\n\r\n\tvar system = $(this).attr(\"href\").replace(\".?system=\", \"\");\r\n\tvar systemID = Object.index(tripwire.systems, \"name\", system);\r\n\r\n\ttripwire.systemChange(systemID);\r\n});\r\n\r\n$(\"body\").on(\"submit\", \"#systemSearch\", function(e) {\r\n\te.preventDefault();\r\n\r\n\tvar system = $(this).find(\"[name='system']\").val();\r\n\tvar systemID = Object.index(tripwire.systems, \"name\", system) || false;\r\n\r\n\tif (systemID !== false) {\r\n\t\ttripwire.systemChange(systemID);\r\n\t\t$(this).find(\"[name='system']\").val(\"\");\r\n\t\t$(\"#search\").click();\r\n\t}\r\n});\r\n\r\n$(\"body\").on(\"click\", \"#undo:not(.disabled)\", function() {\r\n\ttripwire.undo();\r\n});\r\n\r\n$(\"body\").on(\"click\", \"#redo:not(.disabled)\", function() {\r\n\ttripwire.redo();\r\n});\r\n\r\n$(document).keydown(function(e)\t{\r\n\tif ((e.metaKey || e.ctrlKey) && (e.keyCode == 89 || e.keyCode == 90)) {\r\n\t\t//Abort - user is in input or textarea\r\n\t\tif ($(document.activeElement).is(\"textarea, input\")) return;\r\n\r\n\t\te.preventDefault();\r\n\r\n\t\tif (e.keyCode == 89 && !$(\"#redo\").hasClass(\"disabled\")) {\r\n\t\t\t$(\"#redo\").click();\r\n\t\t\tNotify.trigger(\"Redoing last undo\");\r\n\t\t} else if (e.keyCode == 90 && !$(\"#undo\").hasClass(\"disabled\")) {\r\n\t\t\t$(\"#undo\").click();\r\n\t\t\tNotify.trigger(\"Undoing last action\");\r\n\t\t}\r\n\t}\r\n});\r\n","$(\"#admin\").click(function(e) {\r\n\te.preventDefault();\r\n\r\n\tif ($(this).hasClass(\"disabled\")) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif (!$(\"#dialog-admin\").hasClass(\"ui-dialog-content\")) {\r\n\t\tvar refreshTimer = null;\r\n\t\tvar $total = null;\r\n\t\tvar $ajax = null;\r\n\r\n\t\tfunction refreshWindow() {\r\n\t\t\tif ($ajax) $ajax.abort();\r\n\t\t\t$total.html(\"Total: \" + $(\"#dialog-admin .window .hasFocus table tr[data-id]\").length);\r\n\r\n\t\t\t$ajax = $.ajax({\r\n\t\t\t\turl: \"admin.php\",\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdata: {mode: $(\"#dialog-admin .menu .active\").attr(\"data-window\")},\r\n\t\t\t\tdataType: \"JSON\"\r\n\t\t\t}).done(function(data) {\r\n\t\t\t\tif (data && data.results) {\r\n\t\t\t\t\tvar rows = data.results;\r\n\t\t\t\t\tvar ids = [];\r\n\r\n\t\t\t\t\tfor (var i = 0, l = rows.length; i < l; i++) {\r\n\t\t\t\t\t\tvar $row = $(\"#dialog-admin .window .hasFocus tbody tr[data-id='\"+ rows[i].id +\"']\");\r\n\t\t\t\t\t\tids.push(rows[i].id);\r\n\r\n\t\t\t\t\t\tif ($row.length) {\r\n\t\t\t\t\t\t\tfor (col in rows[i]) {\r\n\t\t\t\t\t\t\t\tvar $col = $row.find(\"[data-col='\"+col+\"']\");\r\n\t\t\t\t\t\t\t\t$col.html(($col.attr(\"data-format\") == \"number\" ? numFormat(rows[i][col]) : rows[i][col]) || \"&nbsp;\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$row = $(\"#dialog-admin .window .hasFocus table tr.hidden\").clone();\r\n\t\t\t\t\t\t\t$row.attr(\"data-id\", rows[i].id);\r\n\r\n\t\t\t\t\t\t\tfor (col in rows[i]) {\r\n\t\t\t\t\t\t\t\tvar $col = $row.find(\"[data-col='\"+col+\"']\");\r\n\t\t\t\t\t\t\t\t$col.html(($col.attr(\"data-format\") == \"number\" ? numFormat(rows[i][col]) : rows[i][col]) || \"&nbsp;\");\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t$row.removeClass(\"hidden\");\r\n\r\n\t\t\t\t\t\t\t$(\"#dialog-admin .window .hasFocus tbody\").append($row);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$(\"#dialog-admin .window .hasFocus table tr[data-id]\").each(function() {\r\n\t\t\t\t\t\tif ($.inArray($(this).data(\"id\").toString(), ids) == -1) {\r\n\t\t\t\t\t\t\t$(this).remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(\"#dialog-admin .window .hasFocus table\").trigger(\"update\", [true]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(\"#dialog-admin .window .hasFocus table tr[data-id]\").remove();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$total.html(\"Total: \" + $(\"#dialog-admin .window .hasFocus table tr[data-id]\").length);\r\n\t\t\t});\r\n\r\n\t\t\tif ($(\"#dialog-admin\").dialog(\"isOpen\") && $(\"#dialog-admin .menu .active\").attr(\"data-refresh\")) {\r\n\t\t\t\trefreshTimer = setTimeout(refreshWindow, $(\"#dialog-admin .menu .active\").attr(\"data-refresh\"));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t$(\"#dialog-admin\").dialog({\r\n\t\t\tautoOpen: true,\r\n\t\t\tmodal: true,\r\n\t\t\theight: 350,\r\n\t\t\twidth: 800,\r\n\t\t\tbuttons: {\r\n\t\t\t\tClose: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcreate: function() {\r\n\t\t\t\t// menu toggle\r\n\t\t\t\t$(\"#dialog-admin\").on(\"click\", \".menu li\", function(e) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t$menuItem = $(this);\r\n\t\t\t\t\tclearTimeout(refreshTimer);\r\n\r\n\t\t\t\t\t$(\"#dialog-admin .menu .active\").removeClass(\"active\");\r\n\t\t\t\t\t$menuItem.addClass(\"active\");\r\n\t\t\t\t\t$(\"div.ui-dialog[aria-describedby='dialog-admin'] .ui-dialog-traypane\").html(\"\");\r\n\r\n\t\t\t\t\t$(\"#dialog-admin .window [data-window]\").removeClass(\"hasFocus\").hide();\r\n\t\t\t\t\t$(\"#dialog-admin .window [data-window='\"+ $menuItem.data(\"window\") +\"']\").addClass(\"hasFocus\").show();\r\n\r\n\t\t\t\t\trefreshWindow();\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(\"#dialog-admin [data-sortable='true']\").tablesorter({\r\n\t\t\t\t\tsortReset: true,\r\n\t\t\t\t\twidgets: ['saveSort'],\r\n\t\t\t\t\tsortList: [[0,0]]\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// dialog bottom tray\r\n\t\t\t\t$($(this)[0].parentElement).find(\".ui-dialog-buttonpane\").append(\"<div class='ui-dialog-traypane'></div>\");\r\n\t\t\t\t$total = $(\"div.ui-dialog[aria-describedby='dialog-admin'] .ui-dialog-traypane\");\r\n\t\t\t},\r\n\t\t\topen: function() {\r\n\t\t\t\t$menuItem = $(\"#dialog-admin .menu li.active\");\r\n\t\t\t\trefreshWindow();\r\n\t\t\t},\r\n\t\t\tclose: function() {\r\n\t\t\t\tclearTimeout(refreshTimer);\r\n\t\t\t}\r\n\t\t});\r\n\t} else if (!$(\"#dialog-admin\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-admin\").dialog(\"open\");\r\n\t}\r\n});\r\n","$(\".options\").click(function(e) {\r\n\te.preventDefault();\r\n\r\n\tif ($(this).hasClass(\"disabled\"))\r\n\t\treturn false;\r\n\r\n\t$(\"#dialog-options\").dialog({\r\n\t\tautoOpen: false,\r\n\t\twidth: 450,\r\n\t\tminHeight: 400,\r\n\t\tmodal: true,\r\n\t\tbuttons: {\r\n\t\t\tSave: function() {\r\n\t\t\t\t// Options\r\n\t\t\t\tvar data = {mode: \"set\", options: JSON.stringify(options)};\r\n\t\t\t\tvar maskChange = false;\r\n\r\n\t\t\t\t$(\"#dialog-options\").parent().find(\".ui-dialog-buttonpane button:contains('Save')\").attr(\"disabled\", true).addClass(\"ui-state-disabled\");\r\n\r\n\t\t\t\toptions.chain.typeFormat = $(\"#dialog-options #typeFormat\").val();\r\n\t\t\t\toptions.chain.classFormat = $(\"#dialog-options #classFormat\").val();\r\n\r\n\t\t\t\toptions.chain.gridlines = JSON.parse($(\"#dialog-options input[name=gridlines]:checked\").val());\r\n\r\n\t\t\t\toptions.chain[\"node-reference\"] = $(\"#dialog-options input[name=node-reference]:checked\").val();\r\n\r\n\t\t\t\toptions.signatures.pasteLife = $(\"#dialog-options #pasteLife\").val();\r\n\r\n\t\t\t\toptions.background = $(\"#dialog-options #background-image\").val();\r\n\r\n\t\t\t\tif (options.masks.active != $(\"#dialog-options input[name='mask']:checked\").val()) {\r\n\t\t\t\t\tmaskChange = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\toptions.masks.active = $(\"#dialog-options input[name='mask']:checked\").val();\r\n\r\n\t\t\t\toptions.apply();\r\n\t\t\t\toptions.save() // Performs AJAX\r\n\t\t\t\t\t.done(function() {\r\n\t\t\t\t\t\tif (maskChange) {\r\n\t\t\t\t\t\t\t// Reset signatures\r\n\t\t\t\t\t\t\t$(\"#sigTable span[data-age]\").countdown(\"destroy\");\r\n\t\t\t\t\t\t\t$(\"#sigTable tbody\").empty()\r\n\t\t\t\t\t\t\t$(\"#signature-count\").html(0);\r\n\t\t\t\t\t\t\ttripwire.signatures.list = {};\r\n\t\t\t\t\t\t\ttripwire.client.signatures = [];\r\n\r\n\t\t\t\t\t\t\ttripwire.refresh('change');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\r\n\t\t\t\t$(\"#dialog-options\").dialog(\"close\");\r\n\t\t\t\t$(\"#dialog-options\").parent().find(\".ui-dialog-buttonpane button:contains('Save')\").attr(\"disabled\", false).removeClass(\"ui-state-disabled\");\r\n\r\n\t\t\t\t// toggle mask admin icon\r\n\t\t\t\t$(\"#dialog-options input[name='mask']:checked\").data(\"admin\") ? $(\"#admin\").removeClass(\"disabled\") : $(\"#admin\").addClass(\"disabled\");\r\n\t\t\t},\r\n\t\t\tReset: function() {\r\n\t\t\t\t$(\"#dialog-confirm #msg\").html(\"Settings will be reset to defaults temporarily.<br/><br/><p><em>Save settings to make changes permanent.</em></p>\");\r\n\t\t\t\t$(\"#dialog-confirm\").dialog(\"option\", {\r\n\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\tReset: function() {\r\n\t\t\t\t\t\t\toptions.reset();\r\n\t\t\t\t\t\t\toptions.apply();\r\n\r\n\t\t\t\t\t\t\t$(\"#dialog-options\").dialog(\"close\");\r\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}).dialog(\"open\");\r\n\t\t\t},\r\n\t\t\tClose: function() {\r\n\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t}\r\n\t\t},\r\n\t\topen: function() {\r\n\t\t\t// Get user stats data\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: \"user_stats.php\",\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdataType: \"JSON\"\r\n\t\t\t}).done(function(data) {\r\n\t\t\t\tfor (stat in data) {\r\n\t\t\t\t\t$(\"#\"+stat).text(data[stat]);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Get masks\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: \"masks.php\",\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdataType: \"JSON\"\r\n\t\t\t}).done(function(response) {\r\n\t\t\t\tif (response && response.masks) {\r\n\t\t\t\t\t$(\"#dialog-options #masks #default\").html(\"\");\r\n\t\t\t\t\t$(\"#dialog-options #masks #personal\").html(\"\");\r\n\t\t\t\t\t$(\"#dialog-options #masks #corporate\").html(\"\");\r\n\r\n\t\t\t\t\tfor (var x in response.masks) {\r\n\t\t\t\t\t\tvar mask = response.masks[x];\r\n\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t+ '<input type=\"radio\" name=\"mask\" id=\"mask'+x+'\" value=\"'+mask.mask+'\" class=\"selector\" data-owner=\"'+mask.owner+'\" data-admin=\"'+mask.admin+'\" />'\r\n\t\t\t\t\t\t\t+ '<label for=\"mask'+x+'\"><img src=\"'+mask.img+'\" />'\r\n\t\t\t\t\t\t\t+  (mask.optional ? '<i class=\"closeIcon\" onclick=\"return false;\" data-icon=\"red-giant\"><i data-icon=\"times\"></i></i>' : '')\r\n\t\t\t\t\t\t\t+ '<span class=\"selector_label\">'+mask.label+'</span></label>');\r\n\r\n\t\t\t\t\t\t$(\"#dialog-options #masks #\"+mask.type).append(node);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"find\" id=\"findp\" value=\"personal\" class=\"selector\" disabled=\"disabled\" />'\r\n\t\t\t\t\t\t+ '<label for=\"findp\"><i data-icon=\"search\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i></label>');\r\n\t\t\t\t\t$(\"#dialog-options #masks #personal\").append(node);\r\n\r\n\t\t\t\t\tif (init.admin == \"1\") {\r\n\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"find\" id=\"findc\" value=\"corporate\" class=\"selector\" disabled=\"disabled\" />'\r\n\t\t\t\t\t\t\t+ '<label for=\"findc\"><i data-icon=\"search\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i></label>');\r\n\t\t\t\t\t\t$(\"#dialog-options #masks #corporate\").append(node);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$(\"#dialog-options input[name='mask']\").filter(\"[value='\"+response.masks[response.active].mask+\"']\").attr(\"checked\", true).trigger(\"change\");\r\n\r\n\t\t\t\t\t// toggle mask admin icon\r\n\t\t\t\t\tresponse.masks[response.active].admin ? $(\"#admin\").removeClass(\"disabled\") : $(\"#admin\").addClass(\"disabled\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#dialog-options #pasteLife\").val(options.signatures.pasteLife);\r\n\t\t\t$(\"#dialog-options #typeFormat\").val(options.chain.typeFormat);\r\n\t\t\t$(\"#dialog-options #classFormat\").val(options.chain.classFormat);\r\n\t\t\t$(\"#dialog-options input[name='node-reference'][value='\"+options.chain[\"node-reference\"]+\"']\").prop(\"checked\", true);\r\n\t\t\t$(\"#dialog-options input[name='gridlines'][value='\"+options.chain.gridlines+\"']\").prop(\"checked\", true);\r\n\t\t\t$(\"#dialog-options #background-image\").val(options.background);\r\n\t\t},\r\n\t\tcreate: function() {\r\n\t\t\t$(\"#optionsAccordion\").accordion({heightStyle: \"content\", collapsible: true, active: false});\r\n\r\n\t\t\t$(\"#dialog-pwChange\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tminHeight: 0,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tSave: function() {\r\n\t\t\t\t\t\t$(\"#pwForm\").submit();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tclose: function() {\r\n\t\t\t\t\t$(\"#pwForm input[name='password'], #pwForm input[name='confirm']\").val(\"\");\r\n\t\t\t\t\t$(\"#pwError\").text(\"\").hide();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#pwChange\").click(function() {\r\n\t\t\t\t$(\"#dialog-pwChange\").dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#pwForm\").submit(function(e) {\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t$(\"#pwError\").text(\"\").hide();\r\n\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: \"options.php\",\r\n\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\tdata: $(this).serialize(),\r\n\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t$(\"#dialog-msg #msg\").text(\"Password changed\");\r\n\t\t\t\t\t\t$(\"#dialog-msg\").dialog(\"open\");\r\n\r\n\t\t\t\t\t\t$(\"#dialog-pwChange\").dialog(\"close\");\r\n\t\t\t\t\t} else if (response && response.error) {\r\n\t\t\t\t\t\t$(\"#pwError\").text(response.error).show(\"slide\", {direction: \"up\"});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$(\"#pwError\").text(\"Unknown error\").show(\"slide\", {direction: \"up\"});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#dialog-usernameChange\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tminHeight: 0,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tSave: function() {\r\n\t\t\t\t\t\t$(\"#usernameForm\").submit();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\topen: function() {\r\n\t\t\t\t\t$(\"#usernameForm #username\").html($(\"#dialog-options #username\").html());\r\n\t\t\t\t},\r\n\t\t\t\tclose: function() {\r\n\t\t\t\t\t$(\"#usernameForm [name='username']\").val(\"\");\r\n\t\t\t\t\t$(\"#usernameError\").text(\"\").hide();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#usernameChange\").click(function() {\r\n\t\t\t\t$(\"#dialog-usernameChange\").dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#usernameForm\").submit(function(e) {\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t$(\"#usernameError\").text(\"\").hide();\r\n\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: \"options.php\",\r\n\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\tdata: $(this).serialize(),\r\n\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t$(\"#dialog-msg #msg\").text(\"Username changed\");\r\n\t\t\t\t\t\t$(\"#dialog-msg\").dialog(\"open\");\r\n\r\n\t\t\t\t\t\t$(\"#dialog-options #username\").html(response.result);\r\n\r\n\t\t\t\t\t\t$(\"#dialog-usernameChange\").dialog(\"close\");\r\n\t\t\t\t\t} else if (response && response.error) {\r\n\t\t\t\t\t\t$(\"#usernameError\").text(response.error).show(\"slide\", {direction: \"up\"});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$(\"#usernameError\").text(\"Unknown error\").show(\"slide\", {direction: \"up\"});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\t// Mask selections\r\n\t\t\t$(\"#masks\").on(\"change\", \"input.selector:checked\", function() {\r\n\t\t\t\tif ($(this).data(\"owner\")) {\r\n\t\t\t\t\t$(\"#maskControls #edit\").removeAttr(\"disabled\");\r\n\t\t\t\t\t$(\"#maskControls #delete\").removeAttr(\"disabled\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(\"#maskControls #edit\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\t\t$(\"#maskControls #delete\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($(this).val() != 0.0 && $(this).val().split(\".\")[1] == 0) {\r\n\t\t\t\t\t$(\"#dialog-options #leave\").removeAttr(\"disabled\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(\"#dialog-options #leave\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Mask join\r\n\t\t\t$(\"#dialog-joinMask\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tAdd: function() {\r\n\t\t\t\t\t\tvar mask = $(\"#dialog-joinMask #results input:checked\");\r\n\t\t\t\t\t\tvar label = $(\"#dialog-joinMask #results input:checked+label\");\r\n\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\tdata: {mask: mask.val(), mode: \"join\"},\r\n\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t\t\tlabel.css(\"width\", \"\");\r\n\t\t\t\t\t\t\t\tlabel.find(\".info\").remove();\r\n\t\t\t\t\t\t\t\tlabel.append('<i class=\"closeIcon\" onclick=\"return false;\" data-icon=\"red-giant\"><i data-icon=\"times\"></i></i>');\r\n\r\n\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #\"+response.type+\" input.selector:last\").before(mask).before(label);\r\n\t\t\t\t\t\t\t\t$(\"#dialog-joinMask\").dialog(\"close\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcreate: function() {\r\n\t\t\t\t\t$(\"#dialog-joinMask form\").submit(function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t$(\"#dialog-joinMask #results\").html(\"\");\r\n\t\t\t\t\t\t$(\"#dialog-joinMask #loading\").show();\r\n\t\t\t\t\t\t$(\"#dialog-joinMask input[type='submit']\").attr(\"disabled\", \"disabled\");\r\n\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\tdata: $(this).serialize(),\r\n\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\tif (response && response.results) {\r\n\t\t\t\t\t\t\t\tfor (var x in response.results) {\r\n\t\t\t\t\t\t\t\t\tvar mask = response.results[x];\r\n\t\t\t\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t\t\t\t+ '<input type=\"radio\" name=\"mask\" id=\"mask'+mask.mask+'\" value=\"'+mask.mask+'\" class=\"selector\" data-owner=\"false\" data-admin=\"'+mask.admin+'\" />'\r\n\t\t\t\t\t\t\t\t\t\t+ '<label for=\"mask'+mask.mask+'\" style=\"width: 100%; margin-left: -5px;\">'\r\n\t\t\t\t\t\t\t\t\t\t+ '\t<img src=\"'+mask.img+'\" />'\r\n\t\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">'+mask.label+'</span>'\r\n\t\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\r\n\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(mask.characterName ? mask.characterName + '<br/>' : '')\r\n\t\t\t\t\t\t\t\t\t\t+ '\t\t'+mask.corporationName+'<br/>'\r\n\t\t\t\t\t\t\t\t\t\t+ '\t\t'+mask.allianceName\r\n\t\t\t\t\t\t\t\t\t\t+ '\t</div>'\r\n\t\t\t\t\t\t\t\t\t\t+ '</label>');\r\n\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-joinMask #results\").append(node);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else if (response && response.error) {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(response.error);\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unknown error\");\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).always(function() {\r\n\t\t\t\t\t\t\t$(\"#dialog-joinMask #loading\").hide();\r\n\t\t\t\t\t\t\t$(\"#dialog-joinMask input[type='submit']\").removeAttr(\"disabled\");\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\t\t\t\tclose: function() {\r\n\t\t\t\t\t$(\"#dialog-joinMask #results\").html(\"\");\r\n\t\t\t\t\t$(\"#dialog-joinMask input[name='name']\").val(\"\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#dialog-options #masks\").on(\"click\", \"input[name='find']+label\", function() {\r\n\t\t\t\t$(\"#dialog-joinMask input[name='find']\").val($(this).prev().val());\r\n\t\t\t\t$(\"#dialog-joinMask\").dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t// Mask leave\r\n\t\t\t$(\"#dialog-options #masks\").on(\"click\", \".closeIcon\", function() {\r\n\t\t\t\tvar mask = $(this).closest(\"input.selector+label\").prev();\r\n\r\n\t\t\t\t$(\"#dialog-confirm #msg\").text(\"Are you sure you want to remove this mask?\");\r\n\r\n\t\t\t\t$(\"#dialog-confirm\").dialog(\"option\", {\r\n\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\tRemove: function() {\r\n\t\t\t\t\t\t\tvar send = {mode: \"leave\", mask: mask.val()};\r\n\r\n\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\t\tdata: send,\r\n\t\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t\t\t\tmask.next().remove();\r\n\t\t\t\t\t\t\t\t\tmask.remove();\r\n\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\r\n\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unable to delete\");\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}).dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t// Mask delete\r\n\t\t\t$(\"#maskControls #delete\").click(function() {\r\n\t\t\t\tvar mask = $(\"#masks input.selector:checked\");\r\n\r\n\t\t\t\t$(\"#dialog-confirm #msg\").text(\"Are you sure you want to delete this mask?\");\r\n\t\t\t\t$(\"#dialog-confirm\").dialog(\"option\", {\r\n\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\tDelete: function() {\r\n\t\t\t\t\t\t\tvar send = {mode: \"delete\", mask: mask.val()};\r\n\r\n\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\t\tdata: send,\r\n\t\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t\t\t\tmask.next().remove();\r\n\t\t\t\t\t\t\t\t\tmask.remove();\r\n\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\r\n\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unable to delete\");\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}).dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t// User Create mask\r\n\t\t\t$(\"#dialog-createMask\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tCreate: function() {\r\n\t\t\t\t\t\t$(\"#dialog-createMask form\").submit();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcreate: function() {\r\n\t\t\t\t\t$(\"#dialog-createMask #accessList\").on(\"click\", \"#create_add+label\", function() {\r\n\t\t\t\t\t\t$(\"#dialog-EVEsearch\").dialog(\"open\");\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(\"#dialog-createMask form\").submit(function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\tdata: $(this).serialize(),\r\n\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t\t\t// Get masks\r\n\t\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\t\t\tif (response && response.masks) {\r\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #default\").html(\"\");\r\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #personal\").html(\"\");\r\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #corporate\").html(\"\");\r\n\r\n\t\t\t\t\t\t\t\t\t\tfor (var x in response.masks) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar mask = response.masks[x];\r\n\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"radio\" name=\"mask\" id=\"mask'+x+'\" value=\"'+mask.mask+'\" class=\"selector\" data-owner=\"'+mask.owner+'\" data-admin=\"'+mask.admin+'\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"mask'+x+'\"><img src=\"'+mask.img+'\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t+  (mask.optional ? '<i class=\"closeIcon\" onclick=\"return false;\" data-icon=\"red-giant\"><i data-icon=\"times\"></i></i>' : '')\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<span class=\"selector_label\">'+mask.label+'</span></label>');\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #\"+mask.type).append(node);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"find\" id=\"findp\" value=\"personal\" class=\"selector\" disabled=\"disabled\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"findp\"><i data-icon=\"search\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i></label>');\r\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #personal\").append(node);\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (init.admin == \"1\") {\r\n\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"find\" id=\"findc\" value=\"corporate\" class=\"selector\" disabled=\"disabled\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"findc\"><i data-icon=\"search\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i></label>');\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #corporate\").append(node);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options input[name='mask']\").filter(\"[value='\"+response.masks[response.active].mask+\"']\").attr(\"checked\", true).trigger(\"change\");\r\n\r\n\t\t\t\t\t\t\t\t\t\t// toggle mask admin icon\r\n\t\t\t\t\t\t\t\t\t\tresponse.masks[response.active].admin ? $(\"#admin\").removeClass(\"disabled\") : $(\"#admin\").addClass(\"disabled\");\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t$(\"#dialog-createMask\").dialog(\"close\");\r\n\t\t\t\t\t\t\t} else if (response && response.error) {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(response.error);\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unknown error\");\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(\"#dialog-createMask select\").selectmenu({width: 100});\r\n\t\t\t\t},\r\n\t\t\t\topen: function() {\r\n\t\t\t\t\t$(\"#dialog-createMask input[name='name']\").val(\"\");\r\n\t\t\t\t\t$(\"#dialog-createMask #accessList :not(.static)\").remove();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#maskControls #create\").click(function() {\r\n\t\t\t\t$(\"#dialog-createMask\").dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#dialog-createMask #accessList\").on(\"click\", \".maskRemove\", function() {\r\n\t\t\t\t$(this).closest(\"input.selector+label\").prev().remove();\r\n\t\t\t\t$(this).closest(\"label\").remove();\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#dialog-editMask\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tSave: function() {\r\n\t\t\t\t\t\t$(\"#dialog-editMask form\").submit();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcreate: function() {\r\n\t\t\t\t\t$(\"#dialog-editMask #accessList\").on(\"click\", \".maskRemove\", function() {\r\n\t\t\t\t\t\t$(this).closest(\"input.selector+label\").prev().attr(\"name\", \"deletes[]\").hide();\r\n\t\t\t\t\t\t$(this).closest(\"label\").hide();\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(\"#dialog-editMask #accessList\").on(\"click\", \"#edit_add+label\", function() {\r\n\t\t\t\t\t\t$(\"#dialog-EVEsearch\").dialog(\"open\");\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(\"#dialog-editMask form\").submit(function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\tdata: $(this).serialize(),\r\n\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-editMask\").dialog(\"close\");\r\n\t\t\t\t\t\t\t} else if (response && response.error) {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(response.error);\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unknown error\");\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\topen: function() {\r\n\t\t\t\t\tvar mask = $(\"#dialog-options input[name='mask']:checked\").val();\r\n\t\t\t\t\t$(\"#dialog-editMask input[name='mask']\").val(mask);\r\n\t\t\t\t\t$(\"#dialog-editMask #accessList label.static\").hide();\r\n\t\t\t\t\t$(\"#dialog-editMask #loading\").show();\r\n\t\t\t\t\t$(\"#dialog-editMask #name\").text($(\"#dialog-options input[name='mask']:checked+label .selector_label\").text());\r\n\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\tdata: {mode: \"edit\", mask: mask},\r\n\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\tif (response && response.results) {\r\n\t\t\t\t\t\t\tfor (var x in response.results) {\r\n\t\t\t\t\t\t\t\tvar result = response.results[x];\r\n\t\t\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t\t\t+ '<input type=\"checkbox\" checked=\"checked\" onclick=\"return false\" name=\"\" id=\"edit_'+(result.type == 2 ? result.corporationID : result.characterID)+'_'+result.type+'\" value=\"'+(result.type == 2 ? result.corporationID : result.characterID)+'_'+result.type+'\" class=\"selector\" />'\r\n\t\t\t\t\t\t\t\t\t+ '<label for=\"edit_'+(result.type == 2 ? result.corporationID : result.characterID)+'_'+result.type+'\" style=\"width: 100%; margin-left: -5px;\">'\r\n\t\t\t\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/'+(result.type == 2 ? 'Corporation/'+result.corporationID+'_64.png' : 'Character/'+result.characterID+'_64.jpg')+'\" />'\r\n\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">'+(result.type == 2 ? 'Corporation' : 'Character')+'</span>'\r\n\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\r\n\t\t\t\t\t\t\t\t\t+ '\t\t'+(result.type != 2 ? result.characterName + '<br/>' : '')\r\n\t\t\t\t\t\t\t\t\t+ '\t\t'+result.corporationName+'<br/>'\r\n\t\t\t\t\t\t\t\t\t+ '\t\t'+result.allianceName\r\n\t\t\t\t\t\t\t\t\t+ '\t\t<input type=\"button\" class=\"maskRemove\" value=\"Remove\" style=\"position: absolute; bottom: 3px; right: 3px;\" />'\r\n\t\t\t\t\t\t\t\t\t+ '\t</div>'\r\n\t\t\t\t\t\t\t\t\t+ '</label>');\r\n\r\n\t\t\t\t\t\t\t\t$(\"#dialog-editMask #accessList .static:first\").before(node);\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t$(\"#dialog-editMask #accessList label.static\").show();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).always(function() {\r\n\t\t\t\t\t\t$(\"#dialog-editMask #loading\").hide();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tclose: function() {\r\n\t\t\t\t\t$(\"#dialog-editMask #accessList :not(.static)\").remove();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#maskControls #edit\").click(function() {\r\n\t\t\t\t$(\"#dialog-editMask\").dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t// EVE search dialog\r\n\t\t\t$(\"#dialog-EVEsearch\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tAdd: function() {\r\n\t\t\t\t\t\tif ($(\"#accessList input[value='\"+$(\"#EVESearchResults input\").val()+\"']\").length) {\r\n\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Already has access\");\r\n\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$(\"#EVESearchResults .info\").append('<input type=\"button\" class=\"maskRemove\" value=\"Remove\" style=\"position: absolute; bottom: 3px; right: 3px;\" />');\r\n\t\t\t\t\t\tvar node = $(\"#EVESearchResults\").html();\r\n\r\n\t\t\t\t\t\tif ($(\"#dialog-createMask\").dialog(\"isOpen\"))\r\n\t\t\t\t\t\t\t$(\"#dialog-createMask #accessList .static:first\").before(node);\r\n\t\t\t\t\t\telse if ($(\"#dialog-editMask\").dialog(\"isOpen\"))\r\n\t\t\t\t\t\t\t$(\"#dialog-editMask #accessList .static:first\").before(node);\r\n\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t},\r\n\t\t\t\t\tClose: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcreate: function() {\r\n\t\t\t\t\t$(\"#EVEsearch\").submit(function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t$(\"#EVEsearch #searchSpinner\").show();\r\n\t\t\t\t\t\t$(\"#EVEsearch input[type='submit']\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\t\t\t$(\"#dialog-EVEsearch\").parent().find(\".ui-dialog-buttonpane button:contains('Add')\").attr(\"disabled\", true).addClass(\"ui-state-disabled\");\r\n\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\tdata: $(this).serialize(),\r\n\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\tif (response && response.results) {\r\n\t\t\t\t\t\t\t\tvar result = response.results[0];\r\n\t\t\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t\t\t+ '<input type=\"checkbox\" checked=\"checked\" onclick=\"return false\" name=\"adds[]\" id=\"find_'+(result.type == 2 ? result.corporationID : result.characterID)+'_'+result.type+'\" value=\"'+(result.type == 2 ? result.corporationID : result.characterID)+'_'+result.type+'\" class=\"selector\" />'\r\n\t\t\t\t\t\t\t\t\t+ '<label for=\"find_'+(result.type == 2 ? result.corporationID : result.characterID)+'_'+result.type+'\" style=\"width: 100%; margin-left: -5px;\">'\r\n\t\t\t\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/'+(result.type == 2 ? 'Corporation/'+result.corporationID+'_64.png' : 'Character/'+result.characterID+'_64.jpg')+'\" />'\r\n\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">'+(result.type == 2 ? 'Corporation' : 'Character')+'</span>'\r\n\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\r\n\t\t\t\t\t\t\t\t\t+ '\t\t'+(result.type != 2 ? result.characterName + '<br/>' : '')\r\n\t\t\t\t\t\t\t\t\t+ '\t\t'+result.corporationName+'<br/>'\r\n\t\t\t\t\t\t\t\t\t+ '\t\t'+result.allianceName\r\n\t\t\t\t\t\t\t\t\t+ '\t</div>'\r\n\t\t\t\t\t\t\t\t\t+ '</label>');\r\n\r\n\t\t\t\t\t\t\t\t$(\"#EVESearchResults\").html(node);\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"No Results\");\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).always(function() {\r\n\t\t\t\t\t\t\t$(\"#EVEsearch #searchSpinner\").hide();\r\n\t\t\t\t\t\t\t$(\"#EVEsearch input[type='submit']\").removeAttr(\"disabled\");\r\n\t\t\t\t\t\t\t$(\"#dialog-EVEsearch\").parent().find(\".ui-dialog-buttonpane button:contains('Add')\").removeAttr(\"disabled\").removeClass(\"ui-state-disabled\");\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tclose: function() {\r\n\t\t\t\t\t$(\"#EVEsearch input[name='name']\").val(\"\");\r\n\t\t\t\t\t$(\"#EVESearchResults\").html(\"\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n\t$(\"#dialog-options\").dialog(\"open\");\r\n});\r\n","$(\"#add-signature\").click(function(e) {\r\n\te.preventDefault();\r\n\r\n\t$(\"#dialog-sigAdd\").dialog({\r\n\t\tautoOpen: false,\r\n\t\tresizable: false,\r\n\t\tminHeight: 150,\r\n\t\tdialogClass: \"dialog-noeffect\",\r\n\t\tbuttons: {\r\n\t\t\tAdd: function() {\r\n\t\t\t\t$(\"#sigAddForm\").submit();\r\n\t\t\t},\r\n\t\t\tCancel: function() {\r\n\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t}\r\n\t\t},\r\n\t\topen: function() {\r\n\t\t\t$(\"#sigAddForm #sigID\").val('');\r\n\t\t\t$(\"#sigAddForm #sigType\").val(\"Sites\").selectmenu(\"refresh\").trigger(\"selectmenuchange\");\r\n\t\t\t$(\"#sigAddForm #sigLife\").val(72).selectmenu(\"refresh\");\r\n\t\t\t$(\"#sigAddForm #sigName\").val('');\r\n\t\t\t$(\"#sigAddForm #whType\").val('');\r\n\t\t\t$(\"#sigAddForm #connection\").val('');\r\n\t\t\t$(\"#sigAddForm #autoAdd\")[0].checked = false;\r\n\t\t\t$(\"#sigAddForm #autoAdd\").button(\"refresh\");\r\n\t\t\t$(\"#sigAddForm #whLife\").val(\"Stable\").selectmenu(\"refresh\");\r\n\t\t\t$(\"#sigAddForm #whMass\").val(\"Stable\").selectmenu(\"refresh\");\r\n\r\n\t\t\tif (tripwire.client.EVE && tripwire.client.EVE.systemName) {\r\n\t\t\t\t$(\"#autoAdd\").button(\"enable\");\r\n\t\t\t} else {\r\n\t\t\t\t$(\"#autoAdd\").button(\"disable\");\r\n\t\t\t}\r\n\t\t},\r\n\t\tclose: function() {\r\n\t\t\t$(\"th.critical\").removeClass(\"critical\");\r\n\t\t\tValidationTooltips.close();\r\n\t\t},\r\n\t\tcreate: function() {\r\n\t\t\t$(\"#autoAdd\").button().click(function() {\r\n\t\t\t\t$(\"#sigAddForm #connection\").val(tripwire.client.EVE.systemName);\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#sigAddForm #sigType, #sigAddForm #sigLife\").selectmenu({width: 100});\r\n\t\t\t$(\"#sigAddForm #whLife, #sigAddForm #whMass\").selectmenu({width: 80});\r\n\t\t\t$(\"#sigAddForm .sigSystemsAutocomplete\").inlinecomplete({source: tripwire.aSigSystems, maxSize: 10, delay: 0});\r\n\t\t\t$(\"#sigAddForm .typesAutocomplete\").inlinecomplete({source: whList, maxSize: 10, delay: 0});\r\n\r\n\t\t\t$(\"#sigAddForm #whType, #sigAddForm #sigID\").blur(function(e) {\r\n\t\t\t\tif (this.value == \"\") {\r\n\t\t\t\t\tthis.value = \"???\";\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#sigAddForm #whType, #sigAddForm #sigID\").focus(function(e) {\r\n\t\t\t\t$(this).select();\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n\t$(\"#dialog-sigAdd\").dialog(\"open\");\r\n});\r\n\r\n$(\"#sigAddForm\").submit(function(e) {\r\n\te.preventDefault();\r\n\r\n\t// Trim ending whitespace\r\n\t$(\"#sigAddForm #connection\").val($(\"#sigAddForm #connection\").val().trim());\r\n\r\n\t$(\"th.critical\").removeClass(\"critical\");\r\n\tValidationTooltips.close();\r\n\r\n\t// Check for !empty and length == 3\r\n\tif ($(\"#sigAddForm #sigID\").val() == '' || $(\"#sigAddForm #sigID\").val().length !== 3) {\r\n\t\t$(\"#sigAddForm #sigID\").focus().parent().prev(\"th\").addClass(\"critical\");\r\n\t\tValidationTooltips.open({target: $(\"#sigAddForm #sigID\")}).setContent(\"Must be 3 Letters in length!\");\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Check for letters only\r\n\tif ($(\"#sigAddForm #sigID\").val() !== \"???\") {\r\n\t\tvar i = $(\"#sigAddForm #sigID\").val().length;\r\n\t\twhile (i--) {\r\n\t\t\tif ($(\"#sigAddForm #sigID\").val()[i].toLowerCase() === $(\"#sigAddForm #sigID\").val()[i].toUpperCase()) {\r\n\t\t\t\t$(\"#sigAddForm #sigID\").focus().parent().prev(\"th\").addClass(\"critical\");\r\n\t\t\t\tValidationTooltips.open({target: $(\"#sigAddForm #sigID\")}).setContent(\"Must be only letters!\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Check for existing ID\r\n\t\tif ($.map(tripwire.client.signatures, function(sig) {return sig.mask == \"273.0\" && ((options.chain.active != null && !options.chain.tabs[options.chain.active].evescout) || options.chain.active == null) ? null : (viewingSystemID == sig.systemID ? sig.signatureID : sig.sig2ID)}).indexOf($(\"#sigAddForm #sigID\").val().toUpperCase()) !== -1) {\r\n\t\t\t$(\"#sigAddForm #sigID\").focus().parent().prev(\"th\").addClass(\"critical\");\r\n\t\t\tValidationTooltips.open({target: $(\"#sigAddForm #sigID\")}).setContent(\"Signature ID already exists!\");\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\t// Check for !empty WH type\r\n\tif ($(\"#sigAddForm #sigType\").val() == \"Wormhole\" && $(\"#sigAddForm #whType\").val() == '') {\r\n\t\t$(\"#sigAddForm #whType\").focus().parent().prev(\"th\").addClass(\"critical\");\r\n\t\tValidationTooltips.open({target: $(\"#sigAddForm #whType\")}).setContent(\"Must specify a wormhole type!\");\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Check for valid WH type\r\n\tif ($(\"#sigAddForm #sigType\").val() == \"Wormhole\" && whList.indexOf($(\"#sigAddForm #whType\").val()) == -1) {\r\n\t\t$(\"#sigAddForm #whType\").focus().parent().prev(\"th\").addClass(\"critical\");\r\n\t\tValidationTooltips.open({target: $(\"#sigAddForm #whType\")}).setContent(\"Not a valid wormhole type!\");\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Check for valid Leads To\r\n\tif ($(\"#sigAddForm #sigType\").val() == \"Wormhole\" && $(\"#sigAddForm #connection\").val() && tripwire.aSigSystems.indexOf($(\"#sigAddForm #connection\").val()) == -1) {\r\n\t\t$(\"#sigAddForm #connection\").focus().parent().prev(\"th\").addClass(\"critical\");\r\n\t\tValidationTooltips.open({target: $(\"#sigAddForm #connection\")}).setContent(\"Not a valid leads to system!\");\r\n\t\treturn;\r\n\t}\r\n\r\n\tvar form = $(this).serializeObject();\r\n\tform.systemID = viewingSystemID;\r\n\tform.lifeLength = tripwire.wormholes[form.whType] ? tripwire.wormholes[form.whType].life.split(\" \")[0] : 72;\r\n\tform.class = sigClass(viewingSystem, form.whType);\r\n\tif (Object.index(tripwire.systems, \"name\", form.connectionName)) {\r\n\t\tform.connectionID = Object.index(tripwire.systems, \"name\", form.connectionName);\r\n\t\tform.class2 = sigClass(form.connectionName, null);\r\n\t\tform.connectionName = null;\r\n\t}\r\n\r\n\tvar data = {\"request\": {\"signatures\": {\"add\": form}}};\r\n\r\n\t// Prevent duplicate submitting\r\n\t$(\"#sigAddForm input[type=submit]\").attr(\"disabled\", true);\r\n\t$(\"#dialog-sigAdd\").parent().find(\":button:contains('Add')\").button(\"disable\");\r\n\r\n\tvar success = function(data) {\r\n\t\tif (data.result == true) {\r\n\t\t\t$(\"#dialog-sigAdd\").dialog(\"close\");\r\n\r\n\t\t\t$(\"#undo\").removeClass(\"disabled\");\r\n\t\t\tvar undo = $.map(data.resultSet, function(id) { return data.signatures[id] });\r\n\t\t\tif (viewingSystemID in tripwire.signatures.undo) {\r\n\t\t\t\ttripwire.signatures.undo[viewingSystemID].push({action: \"add\", signatures: undo});\r\n\t\t\t} else {\r\n\t\t\t\ttripwire.signatures.undo[viewingSystemID] = [{action: \"add\", signatures: undo}];\r\n\t\t\t}\r\n\r\n\t\t\tsessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\r\n\t\t}\r\n\t}\r\n\r\n\tvar always = function(data) {\r\n\t\t$(\"#sigAddForm input[type=submit]\").removeAttr(\"disabled\");\r\n\t\t$(\"#dialog-sigAdd\").parent().find(\":button:contains('Add')\").button(\"enable\");\r\n\t}\r\n\r\n\ttripwire.refresh('refresh', data, success, always);\r\n});\r\n","$(\"#add-signature2\").click(function(e) {\r\n\te.preventDefault();\r\n\r\n\tif (!$(\"#dialog-signature\").hasClass(\"ui-dialog-content\")) {\r\n\t\t$(\"#dialog-signature\").dialog({\r\n\t\t\tautoOpen: true,\r\n\t\t\tresizable: false,\r\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\r\n\t\t\tposition: {my: \"center\", at: \"center\", of: $(\"#signaturesWidget\")},\r\n\t\t\tbuttons: {\r\n\t\t\t\tAdd: function() {\r\n\t\t\t\t\t$(\"#form-signature\").submit();\r\n\t\t\t\t},\r\n\t\t\t\tCancel: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcreate: function() {\r\n\t\t\t\tvar aSigWormholes = $.map(tripwire.wormholes, function(item, index) { return index;});\r\n\t\t\t\taSigWormholes.splice(26, 0, \"K162\");\r\n\t\t\t\taSigWormholes.push(\"GATE\");\r\n\r\n\t\t\t\t$(\"#dialog-signature [name='signatureType'], #dialog-signature [name='signatureLife']\").selectmenu({width: 100});\r\n\t\t\t\t$(\"#dialog-signature [name='wormholeLife'], #dialog-signature [name='wormholeMass']\").selectmenu({width: 80});\r\n\t\t\t\t$(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete({source: tripwire.aSigSystems, maxSize: 10, delay: 0});\r\n\t\t\t\t$(\"#dialog-signature [data-autocomplete='sigType']\").inlinecomplete({source: aSigWormholes, maxSize: 10, delay: 0});\r\n\r\n\t\t\t\t$(\"#dialog-signature #durationPicker\").durationPicker();\r\n\r\n\t\t\t\t// Ensure first signature ID field only accepts letters\r\n\t\t\t\t$(\"#dialog-signature [name='signatureID_Alpha'], #dialog-signature [name='signatureID2_Alpha']\").on(\"input\", function() {\r\n\t\t\t\t\twhile (!/^[a-zA-Z?]*$/g.test(this.value)) {\r\n\t\t\t\t\t\tthis.value = this.value.substring(0, this.value.length -1);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Ensure second signature ID field only accepts numbers\r\n\t\t\t\t$(\"#dialog-signature [name='signatureID_Numeric'], #dialog-signature [name='signatureID2_Numeric']\").on(\"input\", function() {\r\n\t\t\t\t\twhile (!/^[0-9?]*$/g.test(this.value)) {\r\n\t\t\t\t\t\tthis.value = this.value.substring(0, this.value.length -1);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Select value on click\r\n\t\t\t\t$(\"#dialog-signature .signatureID, #dialog-signature .wormholeType\").on(\"click\", function() {\r\n\t\t\t\t\t$(this).select();\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Auto fill opposite side wormhole w/ K162\r\n\t\t\t\t$(\"#dialog-signature .wormholeType\").on(\"input, change\", function() {\r\n\t\t\t\t\tif ($(this).val().length > 0 && $.inArray($(this).val(), aSigWormholes) != -1 && $(this).val() != \"K162\") {\r\n\t\t\t\t\t\t$(\"#dialog-signature .wormholeType\").not(this).val(\"K162\");\r\n\r\n\t\t\t\t\t\t// Also auto calculate duration\r\n\t\t\t\t\t\t$(\"#dialog-signature #durationPicker\").val(tripwire.wormholes[$(this).val()].life.substring(0, 2) * 60 * 60).change();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Toggle between wormhole and regular signatures\r\n\t\t\t\t$(\"#dialog-signature\").on(\"selectmenuchange\", \"[name='signatureType']\", function() {\r\n\t\t\t\t\tif (this.value == \"wormhole\") {\r\n\t\t\t\t\t\t$(\"#dialog-signature #site\").slideUp(200, function() { $(this).hide(0); });\r\n\t\t\t\t\t\t$(\"#dialog-signature #wormhole\").slideDown(200, function() { $(this).show(200); });\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$(\"#dialog-signature #site\").slideDown(200, function() { $(this).show(200); });\r\n\t\t\t\t\t\t$(\"#dialog-signature #wormhole\").slideUp(200, function() { $(this).hide(0); });\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tValidationTooltips.close();\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(\"#form-signature\").submit(function(e) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tvar form = $(this).serializeObject();\r\n\t\t\t\t\tvar valid = true;\r\n\t\t\t\t\tValidationTooltips.close();\r\n\r\n\t\t\t\t\t// Validate full signature ID fields (blank | 3 characters)\r\n\t\t\t\t\t$.each($(\"#dialog-signature .signatureID:visible\"), function() {\r\n\t\t\t\t\t\tif ($(this).val().length > 0 && $(this).val().length < 3) {\r\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Must be 3 characters in length!\");\r\n\t\t\t\t\t\t\t$(this).select();\r\n\t\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (!valid) return false;\r\n\r\n\t\t\t\t\t// Validate life length (> 5 minutes)\r\n\t\t\t\t\tif (isNaN(parseInt($(\"#dialog-signature #durationPicker\").val())) || !(parseInt($(\"#dialog-signature #durationPicker\").val()) >= 300)) {\r\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-signature #durationPicker + .bdp-input\")}).setContent(\"Must be at least 5 minutes!\");\r\n\t\t\t\t\t\t$(\"#dialog-signature #durationPicker\").select();\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Validate wormhole types (blank | wormhole)\r\n\t\t\t\t\t$.each($(\"#dialog-signature .wormholeType:visible\"), function() {\r\n\t\t\t\t\t\tif ($(this).val().length > 0 && $.inArray($(this).val(), aSigWormholes) == -1) {\r\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Must be a valid wormhole type!\");\r\n\t\t\t\t\t\t\t$(this).select();\r\n\t\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (!valid) return false;\r\n\r\n\t\t\t\t\t// Validate first leads to (system)\r\n\t\t\t\t\tif ($(\"#dialog-signature .leadsTo:visible\")[0] && $.inArray($(\"#dialog-signature .leadsTo:visible:first\").val(), tripwire.aSigSystems) == -1) {\r\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-signature .leadsTo:visible:first\")}).setContent(\"Must be a valid leads to system!\");\r\n\t\t\t\t\t\t$(this).select();\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Validate leads to system (blank | system)\r\n\t\t\t\t\t$.each($(\"#dialog-signature .leadsTo:visible\"), function() {\r\n\t\t\t\t\t\tif ($(this).val().length > 0 && $.inArray($(this).val(), tripwire.aSigSystems) == -1) {\r\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Must be a valid leads to system!\");\r\n\t\t\t\t\t\t\t$(this).select();\r\n\t\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (!valid) return false;\r\n\r\n\t\t\t\t\tconsole.log(form);\r\n\r\n\t\t\t\t\tvar payload = {};\r\n\t\t\t\t\tif (form.signatureType === \"wormhole\") {\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tvar signature = {\r\n\t\t\t\t\t\t\t\"signatureID\": form.signatureID_Alpha + form.signatureID_Numeric,\r\n\t\t\t\t\t\t\t\"systemID\": viewingSystemID,\r\n\t\t\t\t\t\t\t\"type\": form.signatureType,\r\n\t\t\t\t\t\t\t\"name\": form.signatureName\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tpayload = {\"signatures\": {\"add\": [signature]}};\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: \"signatures2.php\",\r\n\t\t\t\t\t\tmethod: \"POST\",\r\n\t\t\t\t\t\tdata: payload,\r\n\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t}).done(function(result) {\r\n\t\t\t\t\t\tconsole.log(result);\r\n\t\t\t\t\t}).always(function(result) {\r\n\t\t\t\t\t\t// console.log(result);\r\n\t\t\t\t\t})\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\topen: function() {\r\n\t\t\t\t$(\"#dialog-signature input\").val(\"\");\r\n\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(\"combat\").selectmenu(\"refresh\");\r\n\r\n\t\t\t\t$(\"#dialog-signature #site\").show();\r\n\t\t\t\t$(\"#dialog-signature #wormhole\").hide();\r\n\r\n\t\t\t\t// Side labels\r\n\t\t\t\t$(\"#dialog-signature .sideLabel:first\").html(viewingSystem + \" Side\");\r\n\t\t\t\t$(\"#dialog-signature .sideLabel:last\").html(\"Other Side\");\r\n\r\n\t\t\t\t// Default signature life\r\n\t\t\t\t$(\"#dialog-signature #durationPicker\").val(options.signatures.pasteLife * 60 * 60).change();\r\n\t\t\t},\r\n\t\t\tclose: function() {\r\n\t\t\t\tValidationTooltips.close();\r\n\t\t\t}\r\n\t\t});\r\n\t} else if (!$(\"#dialog-signature\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-signature\").dialog(\"open\");\r\n\t}\r\n});\r\n","function openSigEdit(e) {\r\n\te.preventDefault();\r\n\r\n\tif ($(this).closest(\"tr\").attr(\"disabled\")) {\r\n\t\treturn false;\r\n\t} else if ($(\"#dialog-deleteSig\").hasClass(\"ui-dialog-content\") && $(\"#dialog-deleteSig\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-deleteSig\").parent().effect(\"shake\", 300);\r\n\t\treturn false;\r\n\t} else if ($(\"#dialog-sigEdit\").hasClass(\"ui-dialog-content\") && $(\"#dialog-sigEdit\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-sigEdit\").parent().effect(\"shake\", 300);\r\n\t\treturn false;\r\n\t}\r\n\r\n\t$(this).closest(\"tr\").addClass(\"selected\");\r\n\r\n\t// check if dialog is open\r\n\tif (!$(\"#dialog-sigEdit\").hasClass(\"ui-dialog-content\")) {\r\n\t\t$(\"#dialog-sigEdit\").dialog({\r\n\t\t\tresizable: false,\r\n\t\t\tminHeight: 150,\r\n\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect\",\r\n\t\t\tbuttons: {\r\n\t\t\t\tSave: function() {\r\n\t\t\t\t\t$(\"#sigEditForm\").submit();\r\n\t\t\t\t},\r\n\t\t\t\tCancel: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\topen: function() {\r\n\t\t\t\tvar id = $(\"#sigTable tr.selected\").data(\"id\");\r\n\t\t\t\t$(\"#sigEditForm\").data(\"id\", id);\r\n\t\t\t\tvar sig = tripwire.client.signatures[id];\r\n\t\t\t\ttripwire.activity.editSig = id;\r\n\t\t\t\ttripwire.refresh('refresh');\r\n\r\n\t\t\t\t$(\"#autoEdit\")[0].checked = false;\r\n\t\t\t\t$(\"#autoEdit\").button(\"refresh\");\r\n\r\n\t\t\t\t// First check if it is a WH\r\n\t\t\t\tif (sig.life || sig.mass) {\r\n\t\t\t\t\t// Check which side we are editing\r\n\t\t\t\t\tif (sig.systemID == viewingSystemID) {\r\n\t\t\t\t\t\t$(\"#dialog-sigEdit #sigID\").val(sig.signatureID);\r\n\t\t\t\t\t\t$(\"#dialog-sigEdit #sigType\").val(\"Wormhole\").selectmenu(\"refresh\").trigger(\"selectmenuchange\");\r\n\t\t\t\t\t\t$(\"#dialog-sigEdit #whType\").val(sig.type);\r\n\t\t\t\t\t\t$(\"#dialog-sigEdit #connection\").val(tripwire.systems[sig.connectionID] ? tripwire.systems[sig.connectionID].name : sig.connection);\r\n\t\t\t\t\t\t$(\"#dialog-sigEdit #whLife\").val(sig.life).selectmenu(\"refresh\");\r\n\t\t\t\t\t\t$(\"#dialog-sigEdit #whMass\").val(sig.mass).selectmenu(\"refresh\");\r\n\r\n\t\t\t\t\t\t$(\"#dialog-sigEdit [name=side]\").val(\"parent\");\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$(\"#dialog-sigEdit #sigID\").val(sig.sig2ID);\r\n\t\t\t\t\t\t$(\"#dialog-sigEdit #sigType\").val(\"Wormhole\").selectmenu(\"refresh\").trigger(\"selectmenuchange\");\r\n\t\t\t\t\t\t$(\"#dialog-sigEdit #whType\").val(sig.sig2Type);\r\n\t\t\t\t\t\t$(\"#dialog-sigEdit #connection\").val(tripwire.systems[sig.systemID] ? tripwire.systems[sig.systemID].name : sig.system);\r\n\t\t\t\t\t\t$(\"#dialog-sigEdit #whLife\").val(sig.life).selectmenu(\"refresh\");\r\n\t\t\t\t\t\t$(\"#dialog-sigEdit #whMass\").val(sig.mass).selectmenu(\"refresh\");\r\n\r\n\t\t\t\t\t\t$(\"#dialog-sigEdit [name=side]\").val(\"child\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$(\"#dialog-sigEdit #sigLife\").val(72).selectmenu(\"refresh\");\r\n\t\t\t\t\t$(\"#dialog-sigEdit #sigName\").val(\"\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Its not a WH\r\n\t\t\t\t\t$(\"#dialog-sigEdit #sigID\").val(sig.signatureID);//.attr(\"name\", \"signatureID\");\r\n\t\t\t\t\t$(\"#dialog-sigEdit #sigType\").val(sig.type == \"???\" ? \"Sites\" : sig.type).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\r\n\t\t\t\t\t$(\"#dialog-sigEdit #sigLife\").val(sig.lifeLength).selectmenu(\"refresh\");\r\n\t\t\t\t\t$(\"#dialog-sigEdit #sigName\").val(sig.name);\r\n\r\n\t\t\t\t\t$(\"#dialog-sigEdit #whType\").val(\"\");\r\n\t\t\t\t\t$(\"#dialog-sigEdit #connection\").val(\"\");\r\n\t\t\t\t\t$(\"#dialog-sigEdit #whLife\").val(\"Stable\").selectmenu(\"refresh\");\r\n\t\t\t\t\t$(\"#dialog-sigEdit #whMass\").val(\"Stable\").selectmenu(\"refresh\");\r\n\r\n\t\t\t\t\t$(\"#dialog-sigEdit [name=side]\").val(\"parent\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif (tripwire.client.EVE && tripwire.client.EVE.systemName) {\r\n\t\t\t\t\t$(\"#autoEdit\").button(\"enable\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(\"#autoEdit\").button(\"disable\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Auto select ID field\r\n\t\t\t\t$(\"#dialog-sigEdit #sigID\").select();\r\n\t\t\t},\r\n\t\t\tclose: function(e, ui) {\r\n\t\t\t\tdelete tripwire.activity.editSig;\r\n\t\t\t\ttripwire.refresh('refresh');\r\n\r\n\t\t\t\t$(this).data(\"id\", \"\");\r\n\r\n\t\t\t\t$(\"th.critical\").removeClass(\"critical\");\r\n\t\t\t\tValidationTooltips.close();\r\n\r\n\t\t\t\t$(\"#sigTable tr.selected\").removeClass(\"selected\");\r\n\t\t\t},\r\n\t\t\tcreate: function() {\r\n\t\t\t\t$(\"#autoEdit\").button().click(function() {\r\n\t\t\t\t\t$(\"#sigEditForm #connection\").val(tripwire.client.EVE.systemName);\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(\"#sigEditForm #sigType, #sigEditForm #sigLife\").selectmenu({width: 100});\r\n\t\t\t\t$(\"#sigEditForm #whLife, #sigEditForm #whMass\").selectmenu({width: 80});\r\n\t\t\t\t$(\"#sigEditForm .sigSystemsAutocomplete\").inlinecomplete({source: tripwire.aSigSystems, maxSize: 10, delay: 0});\r\n\t\t\t\t$(\"#sigEditForm .typesAutocomplete\").inlinecomplete({source: whList, maxSize: 10, delay: 0});\r\n\r\n\t\t\t\t$(\"#sigEditForm #whType, #sigEditForm #sigID\").blur(function(e) {\r\n\t\t\t\t\tif (this.value == \"\") {\r\n\t\t\t\t\t\tthis.value = \"???\";\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(\"#sigEditForm #whType, #sigEditForm #sigID\").focus(function(e) {\r\n\t\t\t\t\t$(this).select();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t} else if (!$(\"#dialog-sigEdit\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-sigEdit\").dialog(\"open\");\r\n\t}\r\n}\r\n\r\n$(\"#sigTable\").on(\"click\", \".sigEdit\", openSigEdit);\r\n$(\"#sigTable tbody\").on(\"dblclick\", \"tr\", openSigEdit);\r\n\r\n$(\"#sigEditForm\").submit(function(e) {\r\n\te.preventDefault();\r\n\r\n\t// Trim ending whitespace\r\n\t$(\"#sigEditForm #connection\").val($(\"#sigEditForm #connection\").val().trim());\r\n\r\n\t$(\"th.critical\").removeClass(\"critical\");\r\n\tValidationTooltips.close();\r\n\r\n\t// Check for !empty and length == 3\r\n\tif ($(\"#sigEditForm #sigID\").val() == '' || $(\"#sigEditForm #sigID\").val().length !== 3) {\r\n\t\t$(\"#sigEditForm #sigID\").focus().parent().prev(\"th\").addClass(\"critical\");\r\n\t\tValidationTooltips.open({target: $(\"#sigEditForm #sigID\")}).setContent(\"Must be 3 letters in length!\");\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Check for letters only\r\n\tif ($(\"#sigEditForm #sigID\").val() !== \"???\") {\r\n\t\tvar i = $(\"#sigEditForm #sigID\").val().length;\r\n\t\twhile (i--) {\r\n\t\t\tif ($(\"#sigEditForm #sigID\").val()[i].toLowerCase() === $(\"#sigEditForm #sigID\").val()[i].toUpperCase()) {\r\n\t\t\t\t$(\"#sigEditForm #sigID\").focus().parent().prev(\"th\").addClass(\"critical\");\r\n\t\t\t\tValidationTooltips.open({target: $(\"#sigEditForm #sigID\")}).setContent(\"Must be only letters!\");\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Check for existing ID\r\n\t\tif ($(\"#sigEditForm #sigID\").val().toUpperCase() !== (viewingSystemID == tripwire.client.signatures[$(this).data(\"id\")].systemID ? tripwire.client.signatures[$(this).data(\"id\")].signatureID : tripwire.client.signatures[$(this).data(\"id\")].sig2ID) && $.map(tripwire.client.signatures, function(sig) {return sig.mask == \"273.0\" && ((options.chain.active != null && !options.chain.tabs[options.chain.active].evescout) || options.chain.active == null) ? null : (viewingSystemID == sig.systemID ? sig.signatureID : sig.sig2ID)}).indexOf($(\"#sigEditForm #sigID\").val().toUpperCase()) !== -1) {\r\n\t\t\t$(\"#sigEditForm #sigID\").focus().parent().prev(\"th\").addClass(\"critical\");\r\n\t\t\tValidationTooltips.open({target: $(\"#sigEditForm #sigID\")}).setContent(\"Signature ID already exists! <input type='button' autofocus='true' id='overwrite' value='Overwrite' style='margin-bottom: -4px; margin-top: -4px; font-size: 0.8em;' data-id='\"+ $(\"#sigTable tr:has(td:first-child:contains(\"+$(\"#sigEditForm #sigID\").val().toUpperCase()+\"))\").data(\"id\") +\"' />\");\r\n\t\t\t$(\"#overwrite\").focus();\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\r\n\t// Check for empty WH type\r\n\tif ($(\"#sigEditForm #sigType\").val() == \"Wormhole\" && $(\"#sigEditForm #whType\").val() == '') {\r\n\t\t$(\"#sigEditForm #whType\").focus().parent().prev(\"th\").addClass(\"critical\");\r\n\t\tValidationTooltips.open({target: $(\"#sigEditForm #whType\")}).setContent(\"Must specify a wormhole type!\");\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Check for valid WH type\r\n\tif ($(\"#sigEditForm #sigType\").val() == \"Wormhole\" && whList.indexOf($(\"#sigEditForm #whType\").val()) == -1) {\r\n\t\t$(\"#sigEditForm #whType\").focus().parent().prev(\"th\").addClass(\"critical\");\r\n\t\tValidationTooltips.open({target: $(\"#sigEditForm #whType\")}).setContent(\"Not a valid wormhole type!\");\r\n\t\treturn;\r\n\t}\r\n\r\n\t// Check for valid Leads To\r\n\tif ($(\"#sigEditForm #sigType\").val() == \"Wormhole\" && $(\"#sigEditForm #connection\").val() && tripwire.aSigSystems.indexOf($(\"#sigEditForm #connection\").val()) == -1) {\r\n\t\t$(\"#sigEditForm #connection\").focus().parent().prev(\"th\").addClass(\"critical\");\r\n\t\tValidationTooltips.open({target: $(\"#sigEditForm #connection\")}).setContent(\"Not a valid leads to system!\");\r\n\t\treturn;\r\n\t}\r\n\r\n\r\n\tvar form = $(this).serializeObject();\r\n\tform.id = $(this).data(\"id\");\r\n\tform.systemID = viewingSystemID; // needed??\r\n\r\n\tif (tripwire.wormholes[form.whType]) {\r\n\t\tform.lifeLength = tripwire.wormholes[form.whType].life.split(\" \")[0];\r\n\t} else if (form.side == \"parent\") {\r\n\t\tform.lifeLength = tripwire.wormholes[tripwire.client.signatures[form.id].sig2Type] ? tripwire.wormholes[tripwire.client.signatures[form.id].sig2Type].life.split(\" \")[0] : form.lifeLength;\r\n\t} else {\r\n\t\tform.lifeLength = tripwire.wormholes[tripwire.client.signatures[form.id].type] ? tripwire.wormholes[tripwire.client.signatures[form.id].type].life.split(\" \")[0] : form.lifeLength;\r\n\t}\r\n\r\n\tform.connectionID = form.connectionName ? Object.index(tripwire.systems, \"name\", form.connectionName) || null : null;\r\n\tform.connectionName = form.connectionID ? (form.side == \"parent\" ? (tripwire.client.signatures[form.id].connectionID > 0 ? tripwire.client.signatures[form.id].connection : null) : (tripwire.client.signatures[form.id].systemID > 0 ? tripwire.client.signatures[form.id].system : null)) : form.connectionName;\r\n\t//form.connectionName = tripwire.systems[form.connectionID] ? (form.side == \"parent\" ? tripwire.client.signatures[form.id].connection : tripwire.client.signatures[form.id].system) || null : form.connectionName;\r\n\tform.whLife = tripwire.client.signatures[form.id].life != form.whLife ? form.whLife : null;\r\n\tform.whLife = !tripwire.client.signatures[form.id].life ? \"New \" + form.whLife : form.whLife;\r\n\tform.sig2ID = form.side == \"parent\" ? tripwire.client.signatures[form.id].sig2ID : tripwire.client.signatures[form.id].signatureID;\r\n\tform.sig2Type = form.side == \"parent\" ? tripwire.client.signatures[form.id].sig2Type : tripwire.client.signatures[form.id].type;\r\n\tform.class = sigClass(viewingSystem, form.sig2Type);\r\n\tform.class2 = sigClass(form.connectionID ? tripwire.systems[form.connectionID].name : null, form.whType);\r\n\tvar data = {\"request\": {\"signatures\": {\"update\": form}}};\r\n\tvar undo = [tripwire.client.signatures[form.id]];\r\n\r\n\t// Prevent duplicate submitting\r\n\t$(\"#sigEditForm input[type=submit]\").attr(\"disabled\", true);\r\n\t$(\"#dialog-sigEdit\").parent().find(\":button:contains('Save')\").button(\"disable\");\r\n\r\n\tvar success = function(data) {\r\n\t\tif (data.result == true) {\r\n\t\t\t$(\"#dialog-sigEdit\").dialog(\"close\");\r\n\r\n\t\t\t$(\"#undo\").removeClass(\"disabled\");\r\n\t\t\tif (viewingSystemID in tripwire.signatures.undo) {\r\n\t\t\t\ttripwire.signatures.undo[viewingSystemID].push({action: \"update\", signatures: undo});\r\n\t\t\t} else {\r\n\t\t\t\ttripwire.signatures.undo[viewingSystemID] = [{action: \"update\", signatures: undo}];\r\n\t\t\t}\r\n\r\n\t\t\tsessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\r\n\t\t}\r\n\t}\r\n\r\n\tvar always = function(data) {\r\n\t\t$(\"#sigEditForm input[type=submit]\").removeAttr(\"disabled\");\r\n\t\t$(\"#dialog-sigEdit\").parent().find(\":button:contains('Save')\").button(\"enable\");\r\n\t}\r\n\r\n\ttripwire.refresh('refresh', data, success, always);\r\n});\r\n"]}