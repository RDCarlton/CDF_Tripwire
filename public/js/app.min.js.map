{"version":3,"sources":["helpers.js","init.js","options.js","layout.js","tripwire.js","global-hooks.js","active.js","addSignature.js","api.js","automapper.js","comments.js","deleteSignature.js","editSignature.js","esi.js","eve.js","parse.js","paste.js","redo.js","serverStatus.js","sync.js","systemChange.js","tutorials.js","undo.js","activity-graph.js","chain-map.js","ckeditor.js","guidance.js","dialogs/admin-dialog.js","dialogs/base-dialog.js","dialogs/options-dialog.js","dialogs/signature-delete-dialog.js","dialogs/signature-dialog.js"],"names":["Object","sort","obj","prop","swapped","prev","i","Number","tmp","index","val","cs","key","toLowerCase","find","maxTime","maxTimeString","Date","size","hasOwnProperty","time","dates","push","length","getTime","$","fn","serializeObject","self","this","json","push_counters","patterns","validate","fixed","named","build","base","value","push_counter","undefined","each","serializeArray","test","name","k","keys","match","merge","reverse_key","pop","replace","RegExp","extend","jQuery","numFormat","num","n","toString","split","join","letterToNumbers","string","toUpperCase","letters","sum","Math","pow","indexOf","substr","sigFormat","input","type","alpha","numeric","format","options","chain","typeFormat","classFormat","x","l","sigClass","id","map","tripwire","systems","system","class","security","systemType","wormholes","leadsTo","isEmpty","getCookie","c_name","c_value","document","cookie","c_start","c_end","unescape","substring","setCookie","exdays","exdate","setDate","getDate","escape","toUTCString","location","protocol","originalAddClassMethod","addClass","originalRemoveClassMethod","removeClass","className","result","apply","arguments","trigger","parseHeaders","headers","arr","trim","headerMap","forEach","line","parts","header","shift","viewingSystem","attr","viewingSystemID","server","app_name","version","html","saveTimer","localOverrides","localOptions","JSON","parse","localStorage","getItem","userID","init","character","characterID","characterName","background","uiscale","favorites","grid","tracking","active","masks","corporationID","gridlines","tabs","node-reference","zoom","routingLimit","signatures","editType","copySeparator","pasteLife","alignment","sigID","sigType","sigAge","sigLife","sigMass","buttons","follow","chainWidget","viewing","signaturesWidget","autoMapper","saveDelay","delay","clearTimeout","setTimeout","save","stringify","window","get","setItem","ajax","url","data","mode","dataType","load","set","local","constructor","reset","defaults","oog","data-col","col","data-row","row","data-sizex","size_x","data-sizey","size_y","css","width","height","favorite","parseInt","home","kspace","evescout","inArray","a","href","hostname","pathname","search","filter","$tab","clone","systemID","append","redraw","gridster","widget_selector","avoid_overlapped_widgets","widget_base_dimensions","widget_margins","autogrow_cols","helper","draggable","start","e","ui","resize","enabled","handle_class","max_size","min_size","stop","$widget","serialize_params","$w","wgd","disable","disable_resize","visibility","click","hasClass","serialize","enable","enable_resize","timer","xhr","client","list","undo","sessionStorage","redo","activity","esi","refreshRate","connected","ageFormat","instance","sync","setAgeFormat","countdown","serverTime","chainMap","draw","pastEOL","since","layout","whTooltip","sig","item","tooltip","sig2Type","whType","life","mass","jump","ageTooltip","date","lifeTime","getMonth","getHours","getMinutes","createdByName","modifiedTime","modifiedByName","refresh","successCallback","alwaysCallback","on","preventDefault","systemChange","parseFloat","originalEvent","wheelDelta","fadeIn","timeout","keydown","activeElement","is","metaKey","ctrlKey","keyCode","getSelection","output","signature","signatureID","wormhole","initialID","secondaryID","otherSignature","aSigSystems","lifeLength","lifeLeft","text","focus","select","Notify","splice","toggle","EVE","systemName","show","hide","characters","removeAttr","remove","isArray","delete","esiDelete","display","stopPropagation","content","color","stick","jBox","offset","y","animation","autoClose","ValidationTooltips","fade","Tooltips","attach","getContent","position","outside","SystemActivityToolTips","appendTo","reposition","repositionOnOpen","createOnInit","onOpen","nodePos","source","closest","parentPos","nodeHeight","targetPos","target","tooltipWidth","container","parent","left","top","WormholeRouteToolTips","WormholeTypeToolTips","adjustDistance","responsiveWidth","OccupiedToolTips","pointer","minWidth","repositionOnContent","parentWidth","setContent","cache","done","occupants","chars","b","shipTypeName","linkSig","sigName","sortable","items","axis","tolerance","containment","update","newTabs","dialog","Remove Tab","Cancel","resizable","minHeight","dialogClass","OK","submit","open","close","create","inlinecomplete","maxSize","thera","checked","eq","contextmenu","delegate","menu","event","my","at","of","children","colName","cmd","beforeOpen","effect","duration","showInfo","setDestination","collapsed","collapse","wormholeID","autoOpen","Close","payload","totalMass","toID","shipType","moogle","prototype","setFlare","flare","flares","removeFlare","widget","autocomplete","_create","element","_selectInit","_super","_value","originalReturn","_superApply","change","_suggest","_initSource","request","response","matcher","escapeRegex","term","results","Array","_close","input_source","addToSelect","select_added_value","select_source","unshift","removeFromSelect","wrapper","toArray","_createShowAllButton","that","wasOpen","button","icons","primary","_search","tablesorter","sortReset","widgets","textExtraction","2","node","toggleClass","shiftKey","nextUntil","addBack","add","Ok","easing","editSigs","editComments","editSig","editComment","animate","backgroundColor","fadeOut","addSig","option","disabled","tr","until","moment","utc","toDate","onExpiry","alwaysExpire","compact","serverSync","wrapInner","slideDown","$set","replaceWith","contents","API","indicator","APIrefresh","expire","periodsToSeconds","onTick","t","from","to","stationID","shortest","initial","secondary","toClass","title","signature2","resultSet","empty","action","comments","modified","$comment","comment","err","message","sticky","commentID","before","created","deleteSig","slideUp","edit","locationTimer","shipTimer","onlineTimer","baseUrl","userAgent","navigator","connection","tokenExpire","subtract","isBefore","expired","param","token","accessToken","user_agent","status","locationDate","getResponseHeader","solar_system_id","stationName","shipID","shipName","shipTypeID","station_id","stationLookup","always","reference","detach","fail","getAllResponseHeaders","warning","console","log","ship","shipDate","ship_item_id","ship_name","ship_type_id","typeLookup","online","characterStatus","typeID","destinationID","clear_waypoints","beginning","destination_id","clear_other_waypoints","add_to_beginning","Authorization","X-User-Agent","targetID","target_id","eveStatus","idLookup","eveIDs","contentType","processData","characterLookup","eveID","async","corporationLookup","allianceLookup","searchString","categories","strict","universeJumps","universeKills","fullLookup","promise","Deferred","category","characterData","corporation_id","corporationData","corporation","alliance_id","allianceData","alliance","resolve","$clone","characterChange","mask","column","editing","sigEditing","signatureCount","pasteSignatures","processing","rowParse","scanner","columns","validScanGroups","validTypes","Gas Site","Data Site","Relic Site","Ore Site","Combat Site","Wormhole","Gasgebiet","Datengebiet","Reliktgebiet","Mineraliengebiet","Kampfgebiet","Wurmloch","Газовый район","Информационный район","Археологический район","Астероидный район","Боевой район","Червоточина","scanGroup","parsePaste","paste","pasteIDs","removes","scan","clipboardData","getData","blur","lastIndex","redoItem","concat","serverStatus","players","times","abort","signatureTime","flareCount","flareTime","last_modified","commentCount","commentTime","appData","aSystems","slice","hasWormhole","hasInitial","hasSecondary","occupied","notify","history","replaceState","effects","bad","whClass","modifier","abs","statics","factionID","factions","regions","regionID","tutorial","introJs","setOptions","showStepNumbers","steps","querySelector","intro","exitOnEsc","exitOnOverlayClick","skipLabel","onchange","_currentStep","previousMask","stepFunc","_options","setOption","exiting","exit","goToStep","off","onexit","undoItem","graph","view","span","label","role","calc","d","r","getValue","sourceColumn","rows","reverse","google","visualization","DataView","DataTable","setColumns","selectHandler","selections","c","AreaChart","getElementById","isStacked","hAxis","textStyle","fontName","fontSize","showTextEvery","vAxis","viewWindowMode","viewWindow","min","maxValue","gridlineColor","pointSize","lineWidth","chartArea","legend","showColorCode","annotations","style","domain","focusTarget","events","addListener","charts","setOnLoadCallback","drawing","newView","elements","querySelectorAll","getAttribute","shipJumps","podKills","shipKills","npcKills","getElementsByClassName","jumps","setAttribute","pods","ships","npcs","attachedElements","count","next","max","lines","drawNodeLine","$node","nodeIndex","ceil","cellIndex","$connector","$parent","nodeCol","connectorCell","colSpan","parentIndex","newparentIndex","checkSystem","v","$connecte","me","tempCol","breaker","skip","nodes","cols","frigTypes","connections","topLevel","effectClass","chainNode","f","makeCalcChildNode","childID","targetSystem","path","guidance","findShortestPath","child","calcNode","nth","findLinks","parentID","chainList","chainData","usedLinks","sig1","sig2","sig1Type","parentType","childType","floor","random","typeBM","classBM","chainLinks","renderPath","systemMarkup","s","nodeClass","nodeSecurity","leadsToPointer","rawMap","expires","system_id","ship_jumps","then","pod_kills","ship_kills","npc_kills","getCollapsedNodes","OrgChart","allowHtml","allowCollapse","CKConfig","skin","allowedContent","extraPlugins","enterMode","CKEDITOR","ENTER_BR","removeDialogTabs","autoGrow_onStartup","autoGrow_minHeight","toolbar_minToolbar","toolbar_maxToolbar","toolbar","smallToolbar","maximizedToolbar","fontSize_style","styles","font-size","overrides","attributes","cke","editor","domEvent","altKey","selected_ranges","getRanges","startContainer","parents","getParents","getFirst","getNext","selectElement","selectRanges","ev","definition","getContents","removeAllRanges","$this","instances","modifiedDate","createdDate","destroy","Delete","extractKeys","call","sorter","findPaths","end","infinity","Infinity","costs","0","predecessors","addToOpen","cost","vertex","bucket","currentCost","adjacentNodes","totalCost","vertexCost","extractShortest","u","predecessor","Guidance","refreshTimer","$total","$ajax","refreshWindow","ids","$row","$col","modal","$menuItem","sortList","parentElement","Save","maskChange","slider","Reset","stats","system_visits","account","logins","lastLogin","username","owner","admin","img","optional","accordion","heightStyle","collapsible","step","slide","error","direction","Add","Remove","send","Create","selectmenu","total","openSignatureDialog","aSigWormholes","durationPicker","not","form","valid","signatureID_Alpha","signatureID_Numeric","existingSignature","findIndex","signatureType","wormholeName","signatureLength","wormholeType","signatureID2_Alpha","signatureID2_Numeric","wormholeName2","wormholeType2","wormholeLife","wormholeMass","signatureName"],"mappings":"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","file":"app.min.js","sourcesContent":["Object.sort = function(obj, prop) {\n\tvar swapped, prev;\n\tdo {\n\t\tswapped = false, prev = null;\n\t\tfor (var i in obj) {\n\t\t\tif (prev && Number(obj[i][prop]) < Number(obj[prev][prop])) {\n\t\t\t\tvar tmp = obj[i];\n\t\t\t\tobj[i] = obj[prev];\n\t\t\t\tobj[prev] = tmp;\n\t\t\t\tswapped = true;\n\t\t\t}\n\t\t\tprev = i;\n\t\t}\n\t} while (swapped);\n}\n\nObject.index = function(obj, prop, val, cs) {\n\tfor (var key in obj) {\n\t\tif (!cs && obj[key][prop] == val) {\n\t\t\treturn key;\n\t\t} else if (obj[key][prop] && obj[key][prop].toLowerCase() == val.toLowerCase()) {\n\t\t\treturn key;\n\t\t}\n\t}\n}\n\nObject.find = function(obj, prop, val, cs) {\n\tfor (var key in obj) {\n\t\tif (!cs && obj[key][prop] == val) {\n\t\t\treturn obj[key];\n\t\t} else if (obj[key][prop] && obj[key][prop].toLowerCase() == val.toLowerCase()) {\n\t\t\treturn obj[key];\n\t\t}\n\t}\n\n\treturn false;\n}\n\nObject.maxTime = function(obj, prop) {\n\tvar maxTimeString = \"\", maxTime;\n\n\tfor (var key in obj) {\n\t\tif (!maxTime || maxTime < new Date(obj[key][prop])) {\n\t\t\tmaxTime = new Date(obj[key][prop]);\n\t\t\tmaxTimeString = obj[key][prop];\n\t\t}\n\t}\n\treturn maxTimeString;\n}\n\nObject.size = function(obj) {\n    var size = 0, key;\n    for (key in obj) {\n        if (obj.hasOwnProperty(key)) size++;\n    }\n\n    return size;\n};\n\nObject.time = function(obj) {\n\tvar dates = [], key;\n\tfor (key in obj) {\n\t\tdates.push(new Date(obj[key].time));\n\t}\n\n\treturn dates.length ? dates.sort()[dates.length -1].getTime() /1000 : 0;\n};\n\n(function($){\n    $.fn.serializeObject = function(){\n\n        var self = this,\n            json = {},\n            push_counters = {},\n            patterns = {\n                \"validate\": /^[a-zA-Z][a-zA-Z0-9_]*(?:\\[(?:\\d*|[a-zA-Z0-9_]+)\\])*$/,\n                \"key\":      /[a-zA-Z0-9_]+|(?=\\[\\])/g,\n                \"push\":     /^$/,\n                \"fixed\":    /^\\d+$/,\n                \"named\":    /^[a-zA-Z0-9_]+$/\n            };\n\n\n        this.build = function(base, key, value){\n            base[key] = value;\n            return base;\n        };\n\n        this.push_counter = function(key){\n            if(push_counters[key] === undefined){\n                push_counters[key] = 0;\n            }\n            return push_counters[key]++;\n        };\n\n        $.each($(this).serializeArray(), function(){\n\n            // skip invalid keys\n            if(!patterns.validate.test(this.name)){\n                return;\n            }\n\n            var k,\n                keys = this.name.match(patterns.key),\n                merge = this.value,\n                reverse_key = this.name;\n\n            while((k = keys.pop()) !== undefined){\n\n                // adjust reverse_key\n                reverse_key = reverse_key.replace(new RegExp(\"\\\\[\" + k + \"\\\\]$\"), '');\n\n                // push\n                if(k.match(patterns.push)){\n                    merge = self.build([], self.push_counter(reverse_key), merge);\n                }\n\n                // fixed\n                else if(k.match(patterns.fixed)){\n                    merge = self.build([], k, merge);\n                }\n\n                // named\n                else if(k.match(patterns.named)){\n                    merge = self.build({}, k, merge);\n                }\n            }\n\n            json = $.extend(true, json, merge);\n        });\n\n        return json;\n    };\n})(jQuery);\n\nvar numFormat = function(num) {\n\t//Seperates the components of the number\n\tvar n = num.toString().split(\".\");\n\t//Comma-fies the first part\n\tn[0] = n[0].replace(/\\B(?=(\\d{3})+(?!\\d))/g, \",\");\n\t//Combines the two sections\n\treturn n.join(\".\");\n};\n\nvar letterToNumbers = function(string) {\n    string = string.toUpperCase();\n    var letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', sum = 0, i;\n    for (i = 0; i < string.length; i++) {\n        sum += Math.pow(letters.length, i) * (letters.indexOf(string.substr(((i + 1) * -1), 1)) + 1);\n    }\n    return sum;\n};\n\nvar sigFormat = function(input, type) {\n\tif (!input) return \"\";\n\n\tvar alpha = /^[a-zA-Z]+$/;\n\tvar numeric = /^[0-9]+$/;\n\tvar format = type == \"type\" ? options.chain.typeFormat || \"\" : options.chain.classFormat || \"\";\n\n\tfor (var x = 0, l = format.length; x < l; x++) {\n\t\tif (format[x].match(alpha)) {\n\t\t\tif (format[x].toUpperCase() == \"B\" && input == \"a\") {\n\t\t\t\treturn \"\";\n\t\t\t} else {\n\t\t\t\tif (format[x] == format[x].toUpperCase()) {\n\t\t\t\t\tformat = format.substr(0, x) + input.toUpperCase() + format.substr(x + 1, l);\n\t\t\t\t} else {\n\t\t\t\t\tformat = format.substr(0, x) + input + format.substr(x + 1, l);\n\t\t\t\t}\n\t\t\t}\n\t\t} else if (format[x].match(numeric)) {\n\t\t\tif (format[x] == 2 && input == \"a\") {\n\t\t\t\treturn \"\";\n\t\t\t} else {\n\t\t\t\tformat = format.substr(0, x) + letterToNumbers(input) + format.substr(x +1, l);\n\t\t\t}\n\t\t}\n\t}\n\n\treturn format;\n};\n\nvar sigClass = function(name, type) {\n\tvar id = $.map(tripwire.systems, function(system, id) { return system.name == name ? id : null })[0];\n\tvar system = {\n\t\t\"name\": name,\n\t\t\"class\": id ? tripwire.systems[id].class : null,\n\t\t\"security\":  id ? tripwire.systems[id].security : null,\n\t\t\"type\": type};\n\tvar systemType = null;\n\n\tif (system.class == 6 || system.name == \"Class-6\" || (typeof(tripwire.wormholes[system.type]) != \"undefined\" && tripwire.wormholes[system.type].leadsTo == \"Class 6\"))\n\t\tsystemType = \"C6\";\n\telse if (system.class == 5 || system.name == \"Class-5\" || (typeof(tripwire.wormholes[system.type]) != \"undefined\" && tripwire.wormholes[system.type].leadsTo == \"Class 5\"))\n\t\tsystemType = \"C5\";\n\telse if (system.class == 4 || system.name == \"Class-4\" || (typeof(tripwire.wormholes[system.type]) != \"undefined\" && tripwire.wormholes[system.type].leadsTo == \"Class 4\"))\n\t\tsystemType = \"C4\";\n\telse if (system.class == 3 || system.name == \"Class-3\" || (typeof(tripwire.wormholes[system.type]) != \"undefined\" && tripwire.wormholes[system.type].leadsTo == \"Class 3\"))\n\t\tsystemType = \"C3\";\n\telse if (system.class == 2 || system.name == \"Class-2\" || (typeof(tripwire.wormholes[system.type]) != \"undefined\" && tripwire.wormholes[system.type].leadsTo == \"Class 2\"))\n\t\tsystemType = \"C2\";\n\telse if (system.class == 1 || system.name == \"Class-1\" || (typeof(tripwire.wormholes[system.type]) != \"undefined\" && tripwire.wormholes[system.type].leadsTo == \"Class 1\"))\n\t\tsystemType = \"C1\";\n\telse if (system.security >= 0.45 || system.name == \"High-Sec\" || (typeof(tripwire.wormholes[system.type]) != \"undefined\" && tripwire.wormholes[system.type].leadsTo == \"High-Sec\" && !system.security))\n\t\tsystemType = \"HS\";\n\telse if (system.security > 0.0 || system.name == \"Low-Sec\" || (typeof(tripwire.wormholes[system.type]) != \"undefined\" && tripwire.wormholes[system.type].leadsTo == \"Low-Sec\" && !system.security))\n\t\tsystemType = \"LS\";\n\telse if ((system.security <= 0.0 && system.security != null) || system.name == \"Null-Sec\" || (typeof(tripwire.wormholes[system.type]) != \"undefined\" && tripwire.wormholes[system.type].leadsTo == \"Null-Sec\"))\n\t\tsystemType = \"NS\";\n\n\treturn systemType;\n};\n\nvar isEmpty = function(obj) {\n    for(var key in obj) {\n        if(obj.hasOwnProperty(key))\n            return false;\n    }\n    return true;\n};\n\nvar getCookie = function(c_name) {\n\tvar c_value = document.cookie;\n\n\tvar c_start = c_value.indexOf(\" \" + c_name + \"=\");\n\tif (c_start == -1) {\n\t\tc_start = c_value.indexOf(c_name + \"=\");\n\t}\n\n\tif (c_start == -1) {\n\t\tc_value = null;\n\t} else {\n\t\tc_start = c_value.indexOf(\"=\", c_start) + 1;\n\t\tvar c_end = c_value.indexOf(\";\", c_start);\n\n\t\tif (c_end == -1) {\n\t\t\tc_end = c_value.length;\n\t\t}\n\n\t\tc_value = unescape(c_value.substring(c_start, c_end));\n\t}\n\n\treturn c_value;\n};\n\nvar setCookie = function(c_name, value, exdays) {\n\tvar exdate = new Date();\n\texdate.setDate(exdate.getDate() + exdays);\n\tvar c_value = escape(value) + ((exdays == null) ? \"\" : \"; expires=\"+exdate.toUTCString());\n\n\tdocument.cookie = c_name + \"=\" + c_value + \";\" + (document.location.protocol == \"https:\" ? \"secure;\" : \"\");\n};\n\n// Global CSS class change event\n(function($) {\n    var originalAddClassMethod = $.fn.addClass;\n\tvar originalRemoveClassMethod = $.fn.removeClass;\n\n    $.fn.addClass = function(className) {\n        // Execute the original method.\n        var result = originalAddClassMethod.apply(this, arguments);\n\n        // trigger a custom event\n        this.trigger('classchange', className);\n\n        // return the original result\n        return result;\n    }\n\n\t$.fn.removeClass = function(className) {\n        // Execute the original method.\n        var result = originalRemoveClassMethod.apply(this, arguments);\n\n        // trigger a custom event\n        this.trigger('classchange', className);\n\n        // return the original result\n        return result;\n    }\n})(jQuery);\n\nvar parseHeaders = function(headers) {\n\t\t// Convert the header string into an array\n\t\t// of individual headers\n\t\tvar arr = headers.trim().split(/[\\r\\n]+/);\n\n\t\t// Create a map of header names to values\n\t\tvar headerMap = {};\n\t\tarr.forEach(function (line) {\n\t\t\t\tvar parts = line.split(': ');\n\t\t\t\tvar header = parts.shift();\n\t\t\t\tvar value = parts.join(': ');\n\t\t\t\theaderMap[header] = value;\n\t\t});\n\t\treturn headerMap;\n}\n","var viewingSystem = $(\"meta[name=system]\").attr(\"content\");\nvar viewingSystemID = $(\"meta[name=systemID]\").attr(\"content\");\nvar server = $(\"meta[name=server]\").attr(\"content\");\nvar app_name = $(\"meta[name=app_name]\").attr(\"content\");\nvar version = $(\"meta[name=version]\").attr(\"content\");\n\n// Page cache indicator\nif (getCookie(\"loadedFromBrowserCache\") == \"true\") {\n\t$(\"#pageTime\").html(\"Page is Cached\");\n}\n\n// setCookie('loadedFromBrowserCache', true);\n\n// Use this to test performance of javascript code lines\n// var startTime = window.performance.now();\n// console.log(\"stint: \"+ (window.performance.now() - startTime));\n","var options = new function() {\n\tvar localOverrides = [\"grid\"];\n\tvar localOptions = JSON.parse(localStorage.getItem(\"tripwire_options\"));\n\tvar saveTimer;\n\n\tthis.userID = init.userID;\n\tthis.character = {id: init.characterID, name: init.characterName};\n\tthis.background = null;\n\tthis.uiscale = 1.0;\n\tthis.favorites = [];\n\tthis.grid = {};\n\tthis.tracking = {active: \"new\"};\n\tthis.masks = {active: init.corporationID + \".2\"};\n\tthis.chain = {typeFormat: null, classFormat: null, gridlines: true, active: 0, tabs: [], \"node-reference\": \"type\", zoom: 1.0, routingLimit: 15};\n\tthis.signatures = {editType: \"unknown\", copySeparator: \",\", pasteLife: 72, alignment: {sigID: \"centerAlign\", sigType: \"centerAlign\", sigAge: \"centerAlign\", leadsTo: \"centerAlign\", sigLife: \"centerAlign\", sigMass: \"centerAlign\"}};\n\tthis.buttons = {follow: false, chainWidget: {viewing: false, favorites: false}, signaturesWidget: {autoMapper: false}};\n\n\tthis.saveDelay = function(delay) {\n\t\tif (saveTimer) clearTimeout(saveTimer);\n\n\t\tsaveTimer = setTimeout(\"options.save()\", delay);\n\t};\n\n\t// Saves options in both cookie and database\n\tthis.save = function() {\n\t\tvar options = JSON.stringify(window.options.get());\n\n\t\tlocalStorage.setItem(\"tripwire_options\", options);\n\n\t\treturn $.ajax({\n\t\t\turl: \"options.php\",\n\t\t\tdata: {mode: \"set\", options: options},\n\t\t\ttype: \"POST\",\n\t\t\tdataType: \"JSON\"\n\t\t});\n\t};\n\n\t// Loads options via passed object else cookie\n\tthis.load = function(data) {\n\t\tif (data && typeof(data) != \"undefined\") {\n\t\t\tthis.set(this, data);\n\t\t} else if (localOptions) {\n\t\t\tthis.set(this, localOptions);\n\t\t}\n\n\t\tthis.apply();\n\t};\n\n\t// Gets options from this by exluding types == function\n\tthis.get = function() {\n\t\tvar data = {};\n\n\t\tfor (var x in this) {\n\t\t\tif (typeof(this[x]) != \"function\") {\n\t\t\t\tdata[x] = this[x];\n\t\t\t}\n\t\t}\n\n\t\treturn data;\n\t};\n\n\t// Sets this from passed object\n\tthis.set = function(local, data) {\n\t\tfor (var prop in data) {\n\t\t\tif (data[prop] && data[prop].constructor && data[prop].constructor === Object) {\n\t\t\t\tif (local) {\n\t\t\t\t\tthis.set(local[prop], data[prop]);\n\t\t\t\t}\n\t\t\t} else if (local && typeof(local[prop]) != \"undefined\") {\n\t\t\t\tlocal[prop] = data[prop];\n\t\t\t}\n\t\t}\n\t};\n\n\tthis.reset = function() {\n\t\tfor (var x in this) {\n\t\t\tif (typeof(this[x]) != \"function\") {\n\t\t\t\tthis[x] = JSON.parse(JSON.stringify(this.reset.defaults[x]));\n\t\t\t}\n\t\t}\n\t};\n\n\t// Applies settings\n\tthis.apply = function() {\n\t\t// Local browser overrides\n\t\tif (localOptions) {\n            for (key in localOverrides) {\n                this[localOverrides[key]] = localOptions[localOverrides[key]];\n\t\t\t}\n\t\t}\n\n\t\t// Grid layout (detect old IGB setting options)\n\t\tif (this.grid.hasOwnProperty(\"oog\") && !isEmpty(this.grid.oog)) {\n\t\t\t$.each(this.grid.oog, function() {\n\t\t\t\t$(\"#\"+this.id).attr({\"data-col\": this.col, \"data-row\": this.row, \"data-sizex\": this.size_x, \"data-sizey\": this.size_y})\n\t\t\t\t\t.css({width: this.width, height: this.height});\n\t\t\t});\n\t\t} else if (!isEmpty(this.grid)) {\n\t\t\t$.each(this.grid, function() {\n\t\t\t\t$(\"#\"+this.id).attr({\"data-col\": this.col, \"data-row\": this.row, \"data-sizex\": this.size_x, \"data-sizey\": this.size_y})\n\t\t\t\t\t.css({width: this.width, height: this.height});\n\t\t\t});\n\t\t}\n\n\t\t// Make sure favorites are all ints and not strings\n\t\tthis.favorites = $.map(this.favorites, function(favorite) {\n\t\t\treturn parseInt(favorite);\n\t\t});\n\n\t\t// Buttons\n\t\tif (this.buttons.follow) $(\"#follow\").addClass(\"active\");\n\t\tif (this.buttons.chainWidget.home) $(\"#home\").addClass(\"active\");\n\t\tif (this.buttons.chainWidget.kspace) $(\"#k-space\").addClass(\"active\");\n\t\tif (this.buttons.chainWidget.viewing) $(\"#show-viewing\").addClass(\"active\");\n\t\tif (this.buttons.chainWidget.favorites) $(\"#show-favorite\").addClass(\"active\");\n\t\tif (this.buttons.chainWidget.evescout) $(\"#eve-scout\").addClass(\"active\");\n\t\tif ($.inArray(parseInt(viewingSystemID), this.favorites) !== -1) $(\"#system-favorite\").attr(\"data-icon\", \"star\").addClass(\"active\");\n\t\tif (this.buttons.signaturesWidget.autoMapper) $(\"#toggle-automapper\").addClass(\"active\");\n\n\t\t// UI Scale\n\t\tif (this.uiscale) {\n\t\t\t$(\"body\").css(\"zoom\", this.uiscale);\n\t\t}\n\n\t\t// Chain zoom\n\t\tif (this.chain.zoom) {\n\t\t\t$(\"#chainParent\").css(\"zoom\", this.chain.zoom);\n\t\t}\n\n\t\t// Background\n\t\tif (this.background) {\n\t\t\tvar a = $('<a>', { href:this.background } )[0];\n\t\t\t$(\"#wrapper\").attr(\"style\", \"background-image: url(https://\" + a.hostname + a.pathname + a.search + \");\");\n\t\t} else {\n\t\t\t$(\"#wrapper\").attr(\"style\", \"\");\n\t\t}\n\n\t\t// Characters in Options\n\t\t$(\"#dialog-options #characters\").html(\"<img src='https://image.eveonline.com/Character/\"+init.characterID+\"_64.jpg' />\");\n\n\t\t// Active mask\n\t\t$(\"#dialog-options input[name='mask']\").filter(\"[value='\"+this.masks.active+\"']\").attr(\"checked\", true);\n\n\t\t// Chain tabs\n\t\t$(\"#chainTabs\").html(\"\");\n\t\tfor (var x in this.chain.tabs) {\n\t\t\tif (this.chain.tabs[x]) {\n\t\t\t\tvar $tab = $(\"#chainTab .tab\").clone();\n\n\t\t\t\t$tab.attr(\"id\", x).find(\".name\").data(\"tab\", this.chain.tabs[x].systemID).html(this.chain.tabs[x].name);\n\t\t\t\tif (x == this.chain.active) { $tab.addClass(\"current\"); }\n\n\t\t\t\t$(\"#chainTabs\").append($tab);\n\t\t\t}\n\t\t}\n\n\t\t// Draw chain if Tripwire is initialized\n\t\tif (typeof(tripwire) !== \"undefined\") {\n\t\t\tchain.redraw();\n\t\t}\n\t};\n\n\tthis.reset.defaults = JSON.parse(JSON.stringify(this.get()));\n\tthis.load(init && init.options ? init.options : null);\n}\n","var grid = $(\".gridster ul\").gridster({\n\twidget_selector: \"li.gridWidget\",\n\tavoid_overlapped_widgets: false,\n\twidget_base_dimensions: [50, 50],\n\twidget_margins: [5, 5],\n\tautogrow_cols: true,\n\thelper: \"clone\",\n\tdraggable: {\n\t\tstart: function(e, ui) {\n\t\t\t$(\"div.gridster\").width($(\"div.gridster ul\").width());\n\t\t}\n\t},\n\tresize: {\n    \tenabled: true,\n    \thandle_class: \"grid-resize\",\n    \tmax_size: [30, 30],\n    \tmin_size: [4, 4],\n    \tstart: function(e) {\n    \t\t$(\"div.gridster\").width($(\"div.gridster ul\").width());\n    \t},\n    \tstop: function(e, ui, $widget) {\n    \t\t//var width = parseInt($(\".gridster\").css(\"margin-left\")) + this.container_width;\n    \t\t//$(\"#wrapper\").css({width: width + \"px\"})\n    \t\tswitch ($widget.attr(\"id\")) {\n    \t\t\tcase \"infoWidget\":\n    \t\t\t\tsetTimeout(\"activity.redraw();\", 300);\n    \t\t\t\tbreak;\n    \t\t}\n    \t}\n\t},\n\tserialize_params: function($w, wgd) {\n\t\treturn {\n\t\t\tid: $w.attr(\"id\"),\n\t\t\tcol: wgd.col,\n\t\t\trow: wgd.row,\n\t\t\tsize_x: wgd.size_x,\n\t\t\tsize_y: wgd.size_y,\n\t\t\twidth: $w.width(),\n\t\t\theight: $w.height()\n\t\t}\n\t}\n}).data(\"gridster\").disable();\n\ngrid.disable_resize();\n$(\".grid-resize\").addClass(\"hidden\").attr(\"data-icon\", \"resize\");\n\n$(\".gridster\").css({visibility: \"visible\"});\n$(\".gridster > *\").addClass(\"gridster-transition\");\n\n$(\"#layout\").click(function() {\n\tif (!$(this).hasClass(\"active\")) {\n\t\tgrid.enable();\n\t\tgrid.enable_resize();\n\t\t$(\".grid-resize\").removeClass(\"hidden\");\n\n\t\t$(this).addClass(\"active\");\n\t} else {\n\t\tgrid.disable();\n\t\tgrid.disable_resize();\n\t\t$(\".grid-resize\").addClass(\"hidden\");\n\n\t\t$(this).removeClass(\"active\");\n\n\t\toptions.grid = grid.serialize();\n\n\t\toptions.save();\n\t}\n});\n","var tripwire = new function() {\n    this.timer, this.xhr;\n\tthis.version = version;\n\tthis.client = {signatures: {}, wormholes: {}};\n\tthis.server = {signatures: {}, wormholes: {}};\n\tthis.signatures = {list: {}, undo: JSON.parse(sessionStorage.getItem(\"tripwire_undo\")) || {}, redo: JSON.parse(sessionStorage.getItem(\"tripwire_redo\")) || {}};\n\tthis.activity = {};\n\tthis.data = {tracking: {}, esi: {}};\n\tthis.refreshRate = 5000;\n\tthis.connected = true;\n\tthis.ageFormat = \"HM\";\n\tthis.instance = window.name ? window.name : (new Date().getTime() / 1000, window.name = new Date().getTime() / 1000);\n\n    // Command to start/stop tripwire updates\n\t// ToDo: Include API and Server timers\n\tthis.stop = function() {\n\t\tclearTimeout(this.timer);\n\t\treturn this.timer;\n\t};\n\n\tthis.start = function() {\n\t\treturn this.sync();\n\t}\n\n    // Command to change Age format\n\t// ToDo: Cookie change to keep\n\tthis.setAgeFormat = function(format) {\n\t\tvar format = typeof(format) !== 'undefined' ? format : this.ageFormat;\n\n\t\t$(\"span[data-age]\").each(function() {\n\t\t\t$(this).countdown(\"option\", {format: format});\n\t\t});\n\n\t\treturn true;\n\t}\n\n    this.serverTime = function() {\n\t\tthis.time;\n\n\t\tthis.serverTime.getTime = function() {\n\t\t\treturn tripwire.serverTime.time;\n\t\t}\n\t}\n    this.serverTime();\n\n    // Handles putting chain together\n\tthis.chainMap = function() {\n\t\tthis.chainMap.parse = function(data) {\n\t\t\tchain.draw(data);\n\t\t}\n\t}\n    this.chainMap();\n\n    this.pastEOL = function() {\n\t\tvar options = {since: $(this).countdown('option', 'until'), format: \"HM\", layout: \"-{hnn}{sep}{mnn}&nbsp;\"};\n\t\t$(this).countdown(\"option\", options);\n\t}\n\n    // Handles WH Type hover-over tooltip\n\t// ToDo: Use native JS\n\tthis.whTooltip = function(sig) {\n\t\tif (viewingSystemID == sig.systemID) {\n\t\t\tif ($.inArray(sig.type, $.map(tripwire.wormholes, function(item, index) { return index;})) >= 0) {\n\t\t\t\tvar type = sig.type;\n\t\t\t\tvar tooltip = '';\n\t\t\t} else {\n\t\t\t\tvar type = sig.sig2Type;\n\t\t\t\tvar tooltip = \"<b>Type:</b> \"+type+\"<br/>\";\n\t\t\t}\n\t\t} else {\n\t\t\tif ($.inArray(sig.sig2Type, $.map(tripwire.wormholes, function(item, index) { return index;})) >= 0) {\n\t\t\t\tvar type = sig.sig2Type;\n\t\t\t\tvar tooltip = '';\n\t\t\t} else {\n\t\t\t\tvar type = sig.type;\n\t\t\t\tvar tooltip = \"<b>Type:</b> \"+type+\"<br/>\";\n\t\t\t}\n\t\t}\n\n\t\tif ($.inArray(type, $.map(tripwire.wormholes, function(item, index) { return index;})) >= 0) {\n\t\t\tvar whType = true;\n\t\t} else {\n\t\t\tvar whType = false;\n\t\t}\n\n\t\ttooltip += \"<b>Life:</b> \"+(whType?tripwire.wormholes[type].life:\"Unknown\")+\"<br/>\";\n\n\t\tif (whType) {\n\t\t\tswitch (tripwire.wormholes[type].leadsTo.split(\" \")[0]) {\n\t\t\t\tcase 'High-Sec':\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span class='hisec'>\"+tripwire.wormholes[type].leadsTo+\"</span><br/>\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Low-Sec':\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span class='lowsec'>\"+tripwire.wormholes[type].leadsTo+\"</span><br/>\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Null-Sec':\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span class='nullsec'>\"+tripwire.wormholes[type].leadsTo+\"</span><br/>\";\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Class':\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span class='wh'>\"+tripwire.wormholes[type].leadsTo+\"</span><br/>\";\n\t\t\t\t\tbreak;\n\t\t\t\tdefault:\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span>\"+tripwire.wormholes[type].leadsTo+\"</span><br/>\";\n\t\t\t}\n\t\t} else {\n\t\t\ttooltip += \"<b>Leads To:</b> <span>Unknown</span><br/>\";\n\t\t}\n\n\t\ttooltip += \"<b>Max Mass</b>: \"+(whType?numFormat(tripwire.wormholes[type].mass):\"Unknown\")+\" Kg<br/>\";\n\n\t\ttooltip += \"<b>Max Jumpable</b>: \"+(whType?numFormat(tripwire.wormholes[type].jump):\"Unknown\")+\" Kg<br/>\";\n\n\t\treturn tooltip;\n\t}\n\n\t// Handles Age hover-over tooltip\n\t// ToDo: Use native JS\n\tthis.ageTooltip = function(sig) {\n\t\t// var date = new Date(sig.lifeTime);\n\t\t// var localOffset = date.getTimezoneOffset() * 60000;\n\t\t// date = new Date(date.getTime() + localOffset);\n        var date = new Date(sig.lifeTime);\n\n\t\tvar tooltip = \"<table class=\\\"age-tooltip-table\\\"><tr>\"\n        + \"<th>Created:</th><td>\"+(date.getMonth()+1)+\"/\"+date.getDate()+\" \"+(date.getHours() < 10?'0':'')+date.getHours()+\":\"+(date.getMinutes() < 10?'0':'')+date.getMinutes()+\"</td>\"\n        + \"<td>\"+sig.createdByName.replace(/'/g, '&#39;').replace(/\"/g, '&#34;')+\"</td>\"\n        + \"</tr>\";\n\n\t\tif (sig.lifeTime != sig.modifiedTime) {\n\t\t\tdate = new Date(sig.modifiedTime);\n\t\t\t// localOffset = date.getTimezoneOffset() * 60000;\n\t\t\t// date = new Date(date.getTime() + localOffset);\n      \n\t\t\ttooltip += \"<tr><th>Last Modified:</th><td>\"+(date.getMonth()+1)+\"/\"+date.getDate()+\" \"+(date.getHours() < 10?'0':'')+date.getHours()+\":\"+(date.getMinutes() < 10?'0':'')+date.getMinutes()+\"</td>\"\n          + \"<td>\"+sig.modifiedByName.replace(/'/g, '&#39;').replace(/\"/g, '&#34;')+\"</td>\"\n          + \"</tr>\";\n\t\t}\n\n\t\ttooltip += \"</table>\";\n\n\t\treturn tooltip;\n\t}\n\n    this.refresh = function(mode, data, successCallback, alwaysCallback) {\n\t\tvar mode = mode || 'refresh';\n\n\t\tthis.sync(mode, data, successCallback, alwaysCallback);\n\t}\n}\n","$(\"body\").on(\"click\", \"a[href^='.?system=']\", function(e) {\n\te.preventDefault();\n\n\tvar system = $(this).attr(\"href\").replace(\".?system=\", \"\");\n\tvar systemID = Object.index(tripwire.systems, \"name\", system);\n\n\ttripwire.systemChange(systemID);\n});\n\n$(\"body\").on(\"submit\", \"#systemSearch\", function(e) {\n\te.preventDefault();\n\n\tvar system = $(this).find(\"[name='system']\").val();\n\tvar systemID = Object.index(tripwire.systems, \"name\", system, true) || false;\n\n\tif (systemID !== false) {\n\t\ttripwire.systemChange(systemID);\n\t\t$(this).find(\"[name='system']\").val(\"\");\n\t\t$(\"#search\").click();\n\t}\n});\n\n$(\"body\").on(\"click\", \"#undo:not(.disabled)\", function() {\n\ttripwire.undo();\n});\n\n$(\"body\").on(\"click\", \"#redo:not(.disabled)\", function() {\n\ttripwire.redo();\n});\n\n// Chain map zooming (Gets funky if you push things too far)\n$(\"#chainParent\").on(\"mousewheel\", function(e) {\n\te.preventDefault();\n\tvar zoom = parseFloat($(\"#chainParent\").css(\"zoom\")) || 1.0;\n\tvar min = 0.6;\n\tvar max = 2.0;\n\n    if (e.originalEvent.wheelDelta / 120 > 0 && zoom < max) {\n\t\t$(\"#chainParent\").css(\"zoom\", zoom + 0.1);\n    } else if (e.originalEvent.wheelDelta / 120 < 0 && zoom > min) {\n\t\t$(\"#chainParent\").css(\"zoom\", zoom - 0.1);\n    }\n\n\t// Show the reset zoom button for awhile\n\t$(\"#chain-zoom-reset\").fadeIn(200);\n\tif (this.timeout) clearTimeout(this.timeout);\n\tthis.timeout = setTimeout('$(\"#chain-zoom-reset\").fadeOut(200);', 3000);\n\n\t// Save options\n\toptions.chain.zoom = parseFloat($(\"#chainParent\").css(\"zoom\"));\n\toptions.saveDelay(2000);\n});\n\n$(\"#chain-zoom-reset\").on(\"click\", function() {\n\t$(\"#chainParent\").css(\"zoom\", 1);\n\toptions.chain.zoom = 1;\n\toptions.saveDelay(2000);\n});\n\n$(document).keydown(function(e)\t{\n\t//Abort - user is in input or textarea\n\tif ($(document.activeElement).is(\"textarea, input\")) return;\n\n\t// Ctrl key hooks\n\tif (e.metaKey || e.ctrlKey) {\n\n\t\tif (e.keyCode === 89 && !$(\"#redo\").hasClass(\"disabled\")) {\n\t\t\t// Ctrl-y redo hook\n\t\t\te.preventDefault();\n\t\t\t$(\"#redo\").click();\n\t\t\tNotify.trigger(\"Redoing last undo\");\n\t\t} else if (e.keyCode === 90 && !$(\"#undo\").hasClass(\"disabled\")) {\n\t\t\t// Ctrl-z undo hook\n\t\t\te.preventDefault();\n\t\t\t$(\"#undo\").click();\n\t\t\tNotify.trigger(\"Undoing last action\");\n\t\t} else if (e.keyCode === 65) {\n\t\t\t// Ctrl-a select all (signatures) hook\n\t\t\te.preventDefault();\n\t\t\t$(\"#sigTable tbody tr\").addClass(\"selected\");\n\t\t\t$(\"#signaturesWidget #delete-signature\").trigger(\"delete:refresh\");\n\t\t} else if (e.keyCode === 67) {\n\t\t\t// Ctrl-c copy selected signatures hook\n\t\t\tif (window.getSelection().toString() === \"\") {\n\t\t\t\tvar output = \"\";\n\t\t\t\t$(\"#sigTable tbody tr.selected\").each(function(row) {\n\t\t\t\t\tvar signature = tripwire.client.signatures[$(this).data(\"id\")];\n\t\t\t\t\tvar row = [];\n\n\t\t\t\t\tif (signature.signatureID) {\n\t\t\t\t\t\trow.push(signature.signatureID.substring(0, 3).toUpperCase() + \"-\" + (signature.signatureID.substring(3, 6) || \"###\"));\n\t\t\t\t\t} else {\n\t\t\t\t\t\trow.push(\"null\");\n\t\t\t\t\t}\n\n\t\t\t\t\trow.push(signature.type);\n\t\t\t\t\tif (signature.type === \"wormhole\") {\n\t\t\t\t\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n\t\t\t\t\t\tvar otherSignature = signature.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\n\t\t\t\t\t\trow.push(wormhole.type || \"null\" );\n\t\t\t\t\t\trow.push(tripwire.systems[signature.systemID] ? tripwire.systems[signature.systemID].name : tripwire.aSigSystems[signature.systemID]);\n\t\t\t\t\t\trow.push(tripwire.systems[otherSignature.systemID] ? tripwire.systems[otherSignature.systemID].name : tripwire.aSigSystems[otherSignature.systemID]);\n\t\t\t\t\t\trow.push(wormhole.life);\n\t\t\t\t\t\trow.push(wormhole.mass);\n\t\t\t\t\t} else {\n\t\t\t\t\t\trow.push(signature.name);\n\t\t\t\t\t}\n\n\t\t\t\t\trow.push(signature.createdByName);\n\t\t\t\t\trow.push(signature.lifeTime);\n\t\t\t\t\trow.push(signature.lifeLength);\n\t\t\t\t\trow.push(signature.lifeLeft);\n\t\t\t\t\trow.push(signature.modifiedByName);\n\t\t\t\t\trow.push(signature.modifiedTime);\n\t\t\t\t\toutput += row.join(options.signatures.copySeparator) + \"\\r\\n\";\n\t\t\t\t});\n\t\t\t\t$(\"#clipboard\").text(output);\n\t\t\t\t$(\"#clipboard\").focus();\n\t\t\t\t$(\"#clipboard\").select();\n\t\t\t}\n\t\t}\n\t} else {\n\t\t// delete key keyhooks\n\t\tif (e.keyCode == 46 && $(\"#sigTable tr.selected\").length > 0) {\n\t\t\t$(\"#delete-signature\").click();\n\t\t}\n\t}\n});\n\n// $(\"#APIclock\").knob({angleArc: 359.9, height: 20, width: 20, max: 60, readOnly: true, displayInput: false, fgColor: \"#CCC\", bgColor: \"#666\"});\n\n$(\"#follow\").click(function(e) {\n\te.preventDefault();\n\n\tif ($(this).hasClass(\"active\"))\n\t\t$(this).removeClass(\"active\");\n\telse\n\t\t$(this).addClass(\"active\");\n\n\toptions.buttons.follow = $(this).hasClass(\"active\");\n\toptions.save();\n})\n\n$(\"#show-viewing\").click(function() {\n\tif ($(this).hasClass(\"active\"))\n\t\t$(this).removeClass(\"active\");\n\telse\n\t\t$(this).addClass(\"active\");\n\n\tchain.redraw();\n\n\toptions.buttons.chainWidget.viewing = $(this).hasClass(\"active\");\n\toptions.save();\n});\n\n$(\"#show-favorite\").click(function() {\n\tif ($(this).hasClass(\"active\"))\n\t\t$(this).removeClass(\"active\");\n\telse\n\t\t$(this).addClass(\"active\");\n\n\tchain.redraw();\n\n\toptions.buttons.chainWidget.favorites = $(this).hasClass(\"active\");\n\toptions.save();\n});\n\n$(\"#system-favorite\").click(function() {\n\tif ($(this).hasClass(\"active\")) {\n\t\t$(this).removeClass(\"active\").attr(\"data-icon\", \"star-empty\");\n\n\t\toptions.favorites.splice(options.favorites.indexOf(parseInt(viewingSystemID)), 1);\n\t} else {\n\t\t$(this).attr(\"data-icon\", \"star\").addClass(\"active\");\n\n\t\toptions.favorites.push(parseInt(viewingSystemID));\n\t}\n\n\tif ($(\"#show-favorite\").hasClass(\"active\"))\n\t\tchain.redraw();\n\n\toptions.save();\n});\n\n$(\"#search\").click(function(e) {\n\t$(\"#searchSpan\").toggle();\n\n\tif ($(this).hasClass(\"active\")) {\n\t\t$(this).removeClass(\"active\");\n\t\tif (tripwire.client.EVE && tripwire.client.EVE.systemName)\n\t\t\t$(\"#currentSpan\").show();\n\t} else {\n\t\t$(this).addClass(\"active\");\n\t\t$(\"#currentSpan\").hide();\n\n\t\t$(\"#searchSpan input[name=system]\").focus().select();\n\t}\n});\n\n$(\"#toggle-automapper\").click(function(e) {\n\te.preventDefault();\n\n\tif ($(this).hasClass(\"active\")) {\n\t\t$(this).removeClass(\"active\");\n\t} else {\n\t\t$(this).addClass(\"active\");\n\t}\n\n\toptions.buttons.signaturesWidget.autoMapper = $(this).hasClass(\"active\");\n\toptions.save();\n});\n\n$(\"#track\").on(\"click\", \".tracking-clone\", function() {\n\tvar characterID =$(this).attr(\"data-characterid\");\n\t$(\"#tracking .tracking-clone\").removeClass(\"active\");\n\n\tif (options.tracking.active == characterID) {\n\t\toptions.tracking.active = null;\n\t\ttripwire.EVE(false, true);\n\t\t$(\"#removeESI\").attr(\"disabled\", \"disabled\");\n\t} else {\n\t\toptions.tracking.active = characterID;\n\n\t\tif (tripwire.esi.characters[options.tracking.active]) {\n\t\t\t$(\"#tracking .tracking-clone[data-characterid='\"+ options.tracking.active +\"']\").addClass(\"active\");\n\t\t\ttripwire.EVE(tripwire.esi.characters[options.tracking.active], true);\n\t\t}\n\n\t\t$(\"#removeESI\").removeAttr(\"disabled\");\n\t}\n\n\toptions.save();\n});\n\n$(\"#login\").on(\"click\", \"#removeESI\", function() {\n\tvar characterID = options.tracking.active;\n\n\toptions.tracking.active = null;\n\ttripwire.EVE(false, true);\n\toptions.save();\n\n\t$(\"#tracking .tracking-clone[data-characterid='\"+ characterID +\"']\").remove();\n\n\t$(\"#removeESI\").attr(\"disabled\", \"disabled\");\n\n\tif ($.isArray(tripwire.data.esi.delete)) {\n\t\ttripwire.data.esiDelete.push(characterID);\n\t} else {\n\t\ttripwire.data.esiDelete = [characterID];\n\t}\n});\n\n$(\"#user\").click(function(e) {\n\te.preventDefault();\n\n\tif ($(this).hasClass(\"active\")) {\n\t\t$(this).removeClass(\"active\");\n\n\t\t$(\"#login > #panel\").css({display: \"none\"});\n\n\t\t//$(\"#wrapper\").unbind(\"click\");\n\t} else {\n\t\t$(this).addClass(\"active\");\n\n\t\t$(\"#login > #panel\").css({display: \"inline\"});\n\t\t$(\"#loginForm input[name=username]\").focus().select();\n\n\t\t// Click outside closes\n\t\t$(\"#wrapper\").click(function(e) {\n\t\t\t$(\"#login > #panel\").css({display: \"none\"});\n\t\t\t$(\"#user\").removeClass(\"active\");\n\t\t});\n\n\t\t$(\"#login\").click(function(e) {\n\t\t\te.stopPropagation();\n\t\t})\n\t}\n});\n\n$(\"#logout\").click(function() {\n\twindow.location = \"logout.php\";\n});\n\nvar Notify = new function() {\n\tthis.trigger = function(content, color, stick, id) {\n\t\tvar color = typeof(color) !== \"undefined\" ? color : \"blue\";\n\t\tvar stick = typeof(stick) !== \"undefined\" ? stick : 10000;\n\t\tvar id = typeof(id) !== \"undefined\" ? id : null;\n\n\t\tnew jBox(\"Notice\", {\n\t\t\tid: id,\n\t\t\tcontent: content,\n\t\t\toffset: {y: 35},\n\t\t\tanimation: \"flip\",\n\t\t\tcolor: color,\n\t\t\tautoClose: stick\n\t\t});\n\t}\n}\n\n// Init valdiation tooltips\nvar ValidationTooltips = new jBox(\"Tooltip\", {\n\ttrigger: null,\n\taddClass: \"validation-tooltip\",\n\tanimation: \"flip\",\n\tfade: 0\n});\n\nvar Tooltips = new jBox(\"Tooltip\", {\n\tattach: $(\"[data-tooltip]\"),\n\tgetContent: \"data-tooltip\",\n\tposition: {x: \"right\", y: \"center\"},\n\toutside: \"x\"\n});\n\nvar SystemActivityToolTips = new jBox(\"Tooltip\", {\n\tgetContent: \"data-tooltip\",\n\tposition: {y: \"bottom\"},\n\tappendTo: $(\"#chainParent\"),\n\treposition: true,\n\trepositionOnOpen: true,\n\tcreateOnInit: true,\n\tonOpen: function() {\n\t\tvar nodePos = this.source.closest(\"[data-nodeid]\").position();\n\t\tvar parentPos = this.source.closest(\".nodeActivity\").position();\n\t\tvar nodeHeight = this.source.closest(\"[data-nodeid]\").height();\n\t\t// var nodeWidth = this.source.closest(\"[data-nodeid]\").width();\n\t\tvar targetPos = this.target.position()\n\t\tvar tooltipWidth = this.container.parent().width();\n\t\t// var tooltipHeight = this.container.parent().height();\n\n\t\tthis.options.position = {x: nodePos.left + parentPos.left + targetPos.left + 3 - tooltipWidth /2 , y: nodePos.top + nodeHeight + 15};\n\t}\n});\n\nvar WormholeRouteToolTips = new jBox(\"Tooltip\", {\n\tgetContent: \"data-tooltip\",\n\tposition: {y: \"bottom\"},\n\tappendTo: $(\"#chainParent\"),\n\treposition: true,\n\trepositionOnOpen: true,\n\tcreateOnInit: true,\n\tonOpen: function() {\n\t\tvar nodePos = this.source.closest(\"[data-nodeid]\").position();\n\t\tvar parentPos = this.source.closest(\".path\").position();\n\t\tvar nodeHeight = this.source.closest(\"[data-nodeid]\").height();\n\t\t// var nodeWidth = this.source.closest(\"[data-nodeid]\").width();\n\t\tvar targetPos = this.target.position()\n\t\tvar tooltipWidth = this.container.parent().width();\n\t\t// var tooltipHeight = this.container.parent().height();\n\n\t\tthis.options.position = {x: nodePos.left + parentPos.left + targetPos.left + 3 - tooltipWidth /2 , y: nodePos.top + nodeHeight + 15};\n\t}\n});\n\nvar WormholeTypeToolTips = new jBox(\"Tooltip\", {\n\tattach: $(\"#chainMap .whEffect[data-icon]\"),\n\tgetContent: \"data-tooltip\",\n\tposition: {x: \"left\", y: \"center\"},\n\tappendTo: $(\"#chainParent\"),\n\toutside: \"x\",\n\tadjustDistance: 100,\n\tresponsiveWidth: false,\n\treposition: true,\n\trepositionOnOpen: true,\n\tcreateOnInit: true,\n\tonOpen: function() {\n\t\tvar parentPos = this.source.closest(\"[data-nodeid]\").position();\n\t\t// var parentHeight = this.source.closest(\"[data-nodeid]\").height();\n\t\t// var parentWidth = this.source.closest(\"[data-nodeid]\").width();\n\t\tvar targetPos = this.target.position()\n\t\tvar tooltipWidth = this.container.parent().width();\n\t\t// var tooltipHeight = this.container.parent().height();\n\n\t\tthis.options.position = {x: parentPos.left - tooltipWidth - 10, y: parentPos.top + targetPos.top - 3};\n\t}\n});\n\nvar OccupiedToolTips = new jBox(\"Tooltip\", {\n\tpointer: \"top:-3\",\n\tposition: {x: \"right\", y: \"center\"},\n\tappendTo: $(\"#chainParent\"),\n\toutside: \"x\",\n\tminWidth: 100,\n\tanimation: \"move\",\n\tadjustDistance: 100,\n\tresponsiveWidth: false,\n\treposition: true,\n\trepositionOnOpen: true,\n\trepositionOnContent: true,\n\tcreateOnInit: true,\n\tonOpen: function() {\n\t\tvar tooltip = this;\n\t\tvar systemID = this.source.closest(\"[data-nodeid]\").data(\"nodeid\");\n\t\tvar parentPos = this.source.closest(\"[data-nodeid]\").position();\n\t\tvar parentWidth = this.source.closest(\"[data-nodeid]\").width();\n\t\tvar targetPos = this.target.position();\n\n\t\tthis.options.position = {x: parentPos.left + parentWidth, y: parentPos.top + targetPos.top - 3};\n\n\t\ttooltip.setContent(\"&nbsp;\");\n\n\t\t$.ajax({\n\t\t\turl: \"occupants.php\",\n\t\t\tdataType: \"JSON\",\n\t\t\tdata: \"systemID=\"+systemID,\n\t\t\tcache: false\n\t\t}).done(function(data) {\n\t\t\tif (data && data.occupants) {\n\t\t\t\tvar chars = \"<table>\";\n\n\t\t\t\t// Sort by characterName\n\t\t\t\tdata.occupants.sort(function(a, b) {\n\t\t\t\t\tif (a.characterName.toLowerCase() < b.characterName.toLowerCase()) return -1;\n\t\t\t\t\tif (a.characterName.toLowerCase() > b.characterName.toLowerCase()) return 1;\n\t\t\t\t\treturn 0;\n\t\t\t\t});\n\n\t\t\t\tfor (var x in data.occupants) {\n\t\t\t\t\tchars += \"<tr><td>\"+data.occupants[x].characterName+\"</td><td style='padding-left: 10px;'>\"+(data.occupants[x].shipTypeName?data.occupants[x].shipTypeName:\"\")+\"</td></tr>\";\n\t\t\t\t}\n\n\t\t\t\tchars += \"</table>\";\n\t\t\t\ttooltip.setContent(chars);\n\t\t\t}\n\t\t});\n\t}\n});\n\n$(\"#chainTabs\").sortable({\n\titems: \"> .tab\",\n\taxis: \"x\",\n\tdelay: 150,\n\ttolerance: \"pointer\",\n\tcontainment: \"parent\",\n\tupdate: function(e, ui) {\n\t\tvar result = $(\"#chainTabs\").sortable(\"toArray\");\n\t\tvar newTabs = [];\n\n\t\tfor (var x in result) {\n\t\t\tnewTabs.push(options.chain.tabs[result[x]]);\n\t\t\t$(\"#chainTabs .tab:eq(\"+x+\")\").attr(\"id\", x);\n\t\t}\n\n\t\toptions.chain.active = $(\".tab.current\").index();\n\t\toptions.chain.tabs = newTabs;\n\t\toptions.save();\n\t}\n});\n\n$(\"#chainTabs\").on(\"click\", \".tab\", function(e) {\n\te.preventDefault();\n\n\tif ($(this).hasClass(\"current\")) {\n\t\t$(\"#chainTabs .tab\").removeClass(\"current\");\n\t\toptions.chain.active = null;\n\t} else {\n\t\t$(\"#chainTabs .tab\").removeClass(\"current\");\n\t\t$(this).addClass(\"current\");\n\t\toptions.chain.active = $(this).index();\n\t}\n\n\toptions.save();\n\tchain.redraw();\n\ttripwire.parse(tripwire.client, \"refresh\");\n});\n\n$(\"#chainTabs\").on(\"click\", \".closeTab\", function(e) {\n\te.stopPropagation();\n\tvar $tab = $(this).closest(\".tab\");\n\n\t$(\"#dialog-confirm #msg\").html(\"This tab will be removed, are you sure?\");\n\t$(\"#dialog-confirm\").dialog(\"option\", {\n\t\tbuttons: {\n\t\t\t\"Remove Tab\": function() {\n\t\t\t\tvar i = $tab.index();\n\n\t\t\t\toptions.chain.active = $(\".tab.current\").index();\n\t\t\t\toptions.chain.tabs.splice(i, 1);\n\t\t\t\toptions.save();\n\n\t\t\t\t$tab.remove();\n\t\t\t\tif ($(\"#chainTabs .tab.current\").length == 0) {\n\t\t\t\t\t$(\"#chainTabs .tab:last\").click();\n\t\t\t\t}\n\n\t\t\t\tfor (var x = 0, l = $(\"#chainTabs .tab\").length; x < l; x++) {\n\t\t\t\t\t$(\"#chainTabs .tab:eq(\"+x+\")\").attr(\"id\", x);\n\t\t\t\t}\n\n\t\t\t\t$(this).dialog(\"close\");\n\t\t\t},\n\t\t\tCancel: function() {\n\t\t\t\t$(this).dialog(\"close\");\n\t\t\t}\n\t\t}\n\t}).dialog(\"open\");\n});\n\n$(\"#newTab\").on(\"click\", function() {\n\t// check if dialog is open\n\tif (!$(\"#dialog-newTab\").hasClass(\"ui-dialog-content\")) {\n\t\t$(\"#dialog-newTab\").dialog({\n\t\t\tresizable: false,\n\t\t\tminHeight: 0,\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\n\t\t\tbuttons: {\n\t\t\t\tOK: function() {\n\t\t\t\t\t$(\"#newTab_form\").submit();\n\t\t\t\t},\n\t\t\t\tCancel: function() {\n\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t}\n\t\t\t},\n\t\t\topen: function() {\n\t\t\t\t$(\"#dialog-newTab .name\").val(viewingSystem).focus();\n\t\t\t\t$(\"#dialog-newTab .sigSystemsAutocomplete\").val(viewingSystem);\n\t\t\t},\n\t\t\tclose: function() {\n\t\t\t\tValidationTooltips.close();\n\t\t\t},\n\t\t\tcreate: function() {\n\t\t\t\t$(\"#dialog-newTab .sigSystemsAutocomplete\").inlinecomplete({source: tripwire.aSigSystems, maxSize: 10, delay: 0});\n\n\t\t\t\t$(\"#newTab_form\").submit(function(e) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvar $tab = $(\"#chainTab .tab\").clone();\n\t\t\t\t\tvar name = $(\"#dialog-newTab .name\").val();\n\t\t\t\t\tvar systemID = Object.index(tripwire.systems, \"name\", $(\"#dialog-newTab .sigSystemsAutocomplete\").val());\n\t\t\t\t\tvar thera = $(\"#tabThera\")[0].checked ? true : false;\n\n\t\t\t\t\tif (!name) {\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-newTab .name\")}).setContent(\"Must have a name!\");\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if (!systemID && $(\"#tabType1\")[0].checked) {\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-newTab .sigSystemsAutocomplete\")}).setContent(\"Must have a valid system!\");\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if ($(\"#tabType2\")[0].checked) {\n\t\t\t\t\t\tsystemID = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\t$tab.attr(\"id\", $(\"#chainTabs .tab\").length).find(\".name\").data(\"tab\", systemID).html(name);\n\t\t\t\t\toptions.chain.tabs.push({systemID: systemID, name: name, evescout: thera});\n\t\t\t\t\toptions.save();\n\n\t\t\t\t\t$(\"#chainTabs\").append($tab);\n\n\t\t\t\t\t$(\"#dialog-newTab\").dialog(\"close\");\n\t\t\t\t});\n\n\t\t\t\t$(\"#dialog-newTab .sigSystemsAutocomplete\").click(function(e) {\n\t\t\t\t\t$(\"#dialog-newTab #tabType1\").click();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t} else if (!$(\"#dialog-newTab\").dialog(\"isOpen\")) {\n\t\t$(\"#dialog-newTab\").dialog(\"open\");\n\t}\n});\n\n$(\"#chainTabs\").on(\"click\", \".editTab\", function(e) {\n\te.stopPropagation();\n\n\t// check if dialog is open\n\tif (!$(\"#dialog-editTab\").hasClass(\"ui-dialog-content\")) {\n\t\t$(\"#dialog-editTab\").dialog({\n\t\t\tresizable: false,\n\t\t\tminHeight: 0,\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\n\t\t\tbuttons: {\n\t\t\t\tOK: function() {\n\t\t\t\t\t$(\"#editTab_form\").submit();\n\t\t\t\t},\n\t\t\t\tCancel: function() {\n\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t}\n\t\t\t},\n\t\t\topen: function() {\n\t\t\t\t$(\"#dialog-editTab .name\").val(options.chain.tabs[options.chain.active].name).focus();\n\t\t\t\t$(\"#dialog-editTab .sigSystemsAutocomplete\").val(options.chain.tabs[options.chain.active].systemID > 0 ? tripwire.systems[options.chain.tabs[options.chain.active].systemID].name : \"\");\n\t\t\t\toptions.chain.tabs[options.chain.active].systemID > 0 ? $(\"#dialog-editTab #editTabType1\")[0].checked = true : $(\"#dialog-editTab #editTabType2\")[0].checked = true;\n\t\t\t\t$(\"#dialog-editTab #editTabThera\")[0].checked = options.chain.tabs[options.chain.active].evescout;\n\t\t\t},\n\t\t\tclose: function() {\n\t\t\t\tValidationTooltips.close();\n\t\t\t},\n\t\t\tcreate: function() {\n\t\t\t\t$(\"#dialog-editTab .sigSystemsAutocomplete\").inlinecomplete({source: tripwire.aSigSystems, maxSize: 10, delay: 0});\n\n\t\t\t\t$(\"#editTab_form\").submit(function(e) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvar $tab = $(\"#chainTabs .tab\").eq([options.chain.active]);\n\t\t\t\t\tvar name = $(\"#dialog-editTab .name\").val();\n\t\t\t\t\tvar systemID = Object.index(tripwire.systems, \"name\", $(\"#dialog-editTab .sigSystemsAutocomplete\").val());\n\t\t\t\t\tvar thera = $(\"#editTabThera\")[0].checked ? true : false;\n\n\t\t\t\t\tif (!name) {\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-editTab .name\")}).setContent(\"Must have a name!\");\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if (!systemID && $(\"#editTabType1\")[0].checked) {\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-editTab .sigSystemsAutocomplete\")}).setContent(\"Must have a valid system!\");\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t} else if ($(\"#editTabType2\")[0].checked) {\n\t\t\t\t\t\tsystemID = 0;\n\t\t\t\t\t}\n\n\t\t\t\t\t$tab.attr(\"id\", $(\"#chainTabs .tab\").length).find(\".name\").data(\"tab\", systemID).html(name);\n\t\t\t\t\toptions.chain.tabs[options.chain.active] = {systemID: systemID, name: name, evescout: thera};\n\t\t\t\t\toptions.save();\n\t\t\t\t\tchain.redraw();\n\n\t\t\t\t\ttripwire.parse(tripwire.client, \"refresh\");\n\n\t\t\t\t\t//$(\"#chainTabs\").append($tab);\n\n\t\t\t\t\t$(\"#dialog-editTab\").dialog(\"close\");\n\t\t\t\t});\n\n\t\t\t\t$(\"#dialog-editTab .sigSystemsAutocomplete\").click(function(e) {\n\t\t\t\t\t$(\"#dialog-editTab #editTabType1\").click();\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\t} else if (!$(\"#dialog-editTab\").dialog(\"isOpen\")) {\n\t\t$(\"#dialog-editTab\").dialog(\"open\");\n\t}\n});\n\n// Signature column context menu\n$(\"#signaturesWidget #sigTable thead\").contextmenu({\n\tdelegate: \"th.sortable\",\n\tmenu: \"#signatureColumnMenu\",\n\tposition: function(event, ui) {\n        return {my: \"left top\", at: \"center\", of: ui.target};\n    },\n\tselect: function(e, ui) {\n\t\tvar col = $(ui.target).parent().parent().children().index($(ui.target).parent()) + 1;\n\n\t\tswitch(col) {\n\t\t\tcase 1:\n\t\t\t\tcolName = \"sigID\";\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tcolName = \"sigType\";\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tcolName = \"sigAge\";\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tcolName = \"leadsTo\";\n\t\t\t\tbreak;\n\t\t\tcase 5:\n\t\t\t\tcolName = \"sigLife\";\n\t\t\t\tbreak;\n\t\t\tcase 6:\n\t\t\t\tcolName = \"sigMass\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\tswitch(ui.cmd) {\n\t\t\tcase \"leftAlign\":\n\t\t\t\t$(\"#signaturesWidget #sigTable tbody td:nth-child(\"+ col +\")\").removeClass(\"centerAlign rightAlign\").addClass(\"leftAlign\");\n\t\t\t\toptions.signatures.alignment[colName] = \"leftAlign\";\n\t\t\t\tbreak;\n\t\t\tcase \"centerAlign\":\n\t\t\t\t$(\"#signaturesWidget #sigTable tbody td:nth-child(\"+ col +\")\").removeClass(\"leftAlign rightAlign\").addClass(\"centerAlign\");\n\t\t\t\toptions.signatures.alignment[colName] = \"centerAlign\";\n\t\t\t\tbreak;\n\t\t\tcase \"rightAlign\":\n\t\t\t\t$(\"#signaturesWidget #sigTable tbody td:nth-child(\"+ col +\")\").removeClass(\"centerAlign leftAlign\").addClass(\"rightAlign\");\n\t\t\t\toptions.signatures.alignment[colName] = \"rightAlign\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\toptions.save();\n\t},\n\tbeforeOpen: function(e, ui) {\n\t\tvar col = $(ui.target).parent().parent().children().index($(ui.target).parent()) + 1;\n\n\t\tswitch(col) {\n\t\t\tcase 1:\n\t\t\t\tcolName = \"sigID\";\n\t\t\t\tbreak;\n\t\t\tcase 2:\n\t\t\t\tcolName = \"sigType\";\n\t\t\t\tbreak;\n\t\t\tcase 3:\n\t\t\t\tcolName = \"sigAge\";\n\t\t\t\tbreak;\n\t\t\tcase 4:\n\t\t\t\tcolName = \"leadsTo\";\n\t\t\t\tbreak;\n\t\t\tcase 5:\n\t\t\t\tcolName = \"sigLife\";\n\t\t\t\tbreak;\n\t\t\tcase 6:\n\t\t\t\tcolName = \"sigMass\";\n\t\t\t\tbreak;\n\t\t}\n\n\t\t$(this).contextmenu(\"enableEntry\", \"leftAlign\", true);\n\t\t$(this).contextmenu(\"enableEntry\", \"centerAlign\", true);\n\t\t$(this).contextmenu(\"enableEntry\", \"rightAlign\", true);\n\n\t\t$(this).contextmenu(\"enableEntry\", options.signatures.alignment[colName], false);\n\t}\n});\n\n// Chain Map Context Menu\n$(\"#chainParent\").contextmenu({\n\tappendTo: \"#chainParent\",\n\tdelegate: \".nodeSystem a\",\n\tposition: function(event, ui) {\n        return {my: \"left top-1\", at: \"right top\", of: ui.target};\n    },\n\tmenu: \"#chainMenu\",\n\tshow: {effect: \"slideDown\", duration: 150},\n\tselect: function(e, ui) {\n\t\tvar id = $(ui.target[0]).closest(\"[data-nodeid]\").data(\"nodeid\");\n\t\tvar row = $(ui.target[0]).closest(\"[data-nodeid]\").attr(\"id\").replace(\"node\", \"\") -1;\n\n\t\tswitch(ui.cmd) {\n\t\t\tcase \"showInfo\":\n\t\t\t\ttripwire.esi.showInfo(id, options.tracking.active);\n\t\t\t\tbreak;\n\t\t\tcase \"setDest\":\n\t\t\t\ttripwire.esi.setDestination(id, options.tracking.active, true);\n\t\t\t\tbreak;\n\t\t\tcase \"addWay\":\n\t\t\t\ttripwire.esi.setDestination(id, options.tracking.active, false);\n\t\t\t\tbreak;\n\t\t\tcase \"showMap\":\n\t\t\t\t// CCPEVE.showMap(id);\n\t\t\t\tbreak;\n\t\t\tcase \"red\":\n\t\t\t\t$(ui.target[0]).closest(\"td\").hasClass(\"redNode\") ? $(this).contextmenu(\"removeFlare\", id, ui) : $(this).contextmenu(\"setFlare\", id, ui.cmd, ui);\n\t\t\t\tbreak;\n\t\t\tcase \"yellow\":\n\t\t\t\t$(ui.target[0]).closest(\"td\").hasClass(\"yellowNode\") ? $(this).contextmenu(\"removeFlare\", id, ui) : $(this).contextmenu(\"setFlare\", id, ui.cmd, ui);\n\t\t\t\tbreak;\n\t\t\tcase \"green\":\n\t\t\t\t$(ui.target[0]).closest(\"td\").hasClass(\"greenNode\") ? $(this).contextmenu(\"removeFlare\", id, ui) : $(this).contextmenu(\"setFlare\", id, ui.cmd, ui);\n\t\t\t\tbreak;\n\t\t\tcase \"mass\":\n\t\t\t\t$(\"#dialog-mass\").data(\"id\", $(ui.target[0]).closest(\"[data-nodeid]\").data(\"sigid\")).data(\"systemID\", $(ui.target[0]).closest(\"[data-nodeid]\").data(\"nodeid\")).dialog(\"open\");\n\t\t\t\tbreak;\n\t\t\tcase \"collapse\":\n\t\t\t\tvar toggle = options.chain.tabs[options.chain.active] ? ($.inArray(id, options.chain.tabs[options.chain.active].collapsed) == -1 ? true : false) : true;\n\t\t\t\tchain.map.collapse(row, toggle);\n\t\t\t\tbreak;\n\t\t}\n\t},\n\tbeforeOpen: function(e, ui) {\n\t\tvar wormholeID = $(ui.target[0]).closest(\"[data-nodeid]\").data(\"sigid\") || null;\n\t\tvar systemID = $(ui.target[0]).closest(\"[data-nodeid]\").data(\"nodeid\");\n\n\t\t// Add check for k-space\n\t\tif (tripwire.systems[systemID].class || !tripwire.esi.characters[options.tracking.active]) {\n\t\t\t$(this).contextmenu(\"enableEntry\", \"setDest\", false);\n\t\t\t$(this).contextmenu(\"enableEntry\", \"addWay\", false);\n\t\t\t$(this).contextmenu(\"enableEntry\", \"showMap\", false);\n\t\t} else {\n\t\t\t$(this).contextmenu(\"enableEntry\", \"setDest\", true);\n\t\t\t$(this).contextmenu(\"enableEntry\", \"addWay\", true);\n\t\t\t$(this).contextmenu(\"enableEntry\", \"showMap\", false);\n\t\t}\n\n\t\tif (wormholeID) {\n\t\t\t$(this).contextmenu(\"enableEntry\", \"mass\", true);\n\t\t} else {\n\t\t\t$(this).contextmenu(\"enableEntry\", \"mass\", false);\n\t\t}\n\t},\n\tcreate: function(e, ui) {\n\t\t// Fix some bad CSS from jQuery Position\n\t\t$(this).find(\".ui-front\").css(\"width\", \"10em\");\n\t\t$(this).find(\".ui-front\").css(\"position\", \"\");\n\n\t\t$(\"#dialog-mass\").dialog({\n\t\t\tautoOpen: false,\n\t\t\twidth: \"auto\",\n\t\t\theight: \"auto\",\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\n\t\t\tbuttons: {\n\t\t\t\tClose: function() {\n\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t}\n\t\t\t},\n\t\t\topen: function() {\n\t\t\t\tvar wormholeID = $(this).data(\"id\");\n\t\t\t\tvar systemID = $(this).data(\"systemID\");\n\t\t\t\tvar wormhole = tripwire.client.wormholes[wormholeID];\n\t\t\t\tvar signature = tripwire.client.signatures[wormhole.initialID];\n\t\t\t\tvar otherSignature = tripwire.client.signatures[wormhole.secondaryID];\n\n\t\t\t\t$(\"#dialog-mass\").dialog(\"option\", \"title\", \"From \"+tripwire.systems[signature.systemID].name+\" to \"+tripwire.systems[otherSignature.systemID].name);\n\n\t\t\t\t$(\"#dialog-mass #massTable tbody tr\").remove();\n\n\t\t\t\tvar payload = {wormholeID: wormhole.id};\n\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: \"mass.php\",\n\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\tdata: payload,\n\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t}).done(function(data) {\n\t\t\t\t\tif (data && data.mass) {\n                        var totalMass = 0;\n\t\t\t\t\t\tfor (x in data.mass) {\n                            totalMass += parseFloat(data.mass[x].mass);\n\t\t\t\t\t\t\t$(\"#dialog-mass #massTable tbody\").append(\"<tr><td>\"+data.mass[x].characterName+\"</td><td>\"+(data.mass[x].toID == systemID ? \"In\" : \"Out\")+\"</td><td>\"+data.mass[x].shipType+\"</td><td>\"+numFormat(data.mass[x].mass)+\"Kg</td><td>\"+data.mass[x].time+\"</td></tr>\");\n\t\t\t\t\t\t}\n                        $(\"#dialog-mass #massTable tbody\").append(\"<tr><td></td><td></td><td></td><th>\"+ numFormat(totalMass) +\"Kg</th><td></td></tr>\");\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t});\n\n\t\t$.moogle.contextmenu.prototype.setFlare = function(systemID, flare, ui) {\n\t\t\tvar data = {\"systemID\": systemID, \"flare\": flare};\n\n\t\t\t$.ajax({\n\t\t\t\turl: \"flares.php\",\n\t\t\t\ttype: \"POST\",\n\t\t\t\tdata: data,\n\t\t\t\tdataType: \"JSON\"\n\t\t\t}).done(function(data) {\n\t\t\t\tif (data && data.result) {\n\t\t\t\t\t// $(ui.target[0]).closest(\"td\").removeClass(\"redNode yellowNode greenNode\").addClass(flare+\"Node\");\n\n\t\t\t\t\tchain.data.flares.flares.push({systemID: systemID, flare: flare, time: null});\n\t\t\t\t\tchain.flares(chain.data.flares);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\t$.moogle.contextmenu.prototype.removeFlare = function(systemID, ui) {\n\t\t\tvar data = {\"systemID\": systemID};\n\n\t\t\t$.ajax({\n\t\t\t\turl: \"flares.php\",\n\t\t\t\ttype: \"POST\",\n\t\t\t\tdata: data,\n\t\t\t\tdataType: \"JSON\"\n\t\t\t}).done(function(data) {\n\t\t\t\tif (data && data.result) {\n\t\t\t\t\t// $(ui.target[0]).closest(\"td\").removeClass(\"redNode yellowNode greenNode\");\n\n\t\t\t\t\tchain.data.flares.flares.splice(Object.index(chain.data.flares.flares, \"systemID\", systemID), 1);\n\t\t\t\t\tchain.flares(chain.data.flares);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n});\n\n// Used to generate eve-survival guide link\nfunction linkSig(sigName) {\n\tvar wormholeSignatures = [\n\t\t// Ore sites\n\t\t\"Average Frontier Deposit\",\n\t\t\"Unexceptional Frontier Deposit\",\n\t\t\"Common Perimeter Deposit\",\n\t\t\"Exceptional Core Deposit\",\n\t\t\"Infrequent Core Deposit\",\n\t\t\"Unusual Core Deposit\",\n\t\t\"Rarified Core Deposit\",\n\t\t\"Isolated Core Deposit\",\n\t\t\"Ordinary Permiter Deposit\",\n\t\t\"Uncommon Core Deposit\",\n\n\t\t// Gas Sites\n\t\t\"Barren Perimeter Reservoir\",\n\t\t\"Minor Perimeter Reservoir\",\n\t\t\"Ordinary Perimeter Reservoir\",\n\t\t\"Sizeable Perimeter Reservoir\",\n\t\t\"Token Perimeter Reservoir\",\n\t\t\"Bountiful Frontier Reservoir\",\n\t\t\"Vast Frontier Reservoir\",\n\t\t\"Instrumental Core Reservoir\",\n\t\t\"Vital Core Reservoir\",\n\n\t\t// Class 1\n\t\t\"Perimeter Ambush Point\",\n\t\t\"Perimeter Camp\",\n\t\t\"Phase Catalyst Node\",\n\t\t\"The Line\",\n\t\t\"Forgotten Perimeter Coronation Platform\",\n\t\t\"Forgotten Perimeter Power Array\",\n\t\t\"Unsecured Perimeter Amplifier\",\n\t\t\"Unsecured Perimeter Information Center\",\n\n\t\t// Class 2\n\t\t\"Perimeter Checkpoint\",\n\t\t\"Perimeter Hangar\",\n\t\t\"The Ruins of Enclave Cohort 27\",\n\t\t\"Sleeper Data Sanctuary\",\n\t\t\"Forgotten Perimeter Gateway\",\n\t\t\"Forgotten Perimeter Habitation Coils\",\n\t\t\"Unsecured Perimeter Comms Relay\",\n\t\t\"Unsecured Perimeter Transponder Farm\",\n\n\t\t// Class 3\n\t\t\"Fortification Frontier Stronghold\",\n\t\t\"Outpost Frontier Stronghold\",\n\t\t\"Solar Cell\",\n\t\t\"The Oruze Construct\",\n\t\t\"Forgotten Frontier Quarantine Outpost\",\n\t\t\"Forgotten Frontier Recursive Depot\",\n\t\t\"Unsecured Frontier Database\",\n\t\t\"Unsecured Frontier Receiver\",\n\n\t\t// Class 4\n\t\t\"Frontier Barracks\",\n\t\t\"Frontier Command Post\",\n\t\t\"Integrated Terminus\",\n\t\t\"Sleeper Information Sanctum\",\n\t\t\"Forgotten Frontier Conversion Module\",\n\t\t\"Forgotten Frontier Evacuation Center\",\n\t\t\"Unsecured Frontier Digital Nexus\",\n\t\t\"Unsecured Frontier Trinary Hub\",\n\n\t\t// Class 5\n\t\t\"Core Garrison\",\n\t\t\"Core Stronghold\",\n\t\t\"Oruze Osobnyk\",\n\t\t\"Quarantine Area\",\n\t\t\"Forgotten Core Data Field\",\n\t\t\"Forgotten Core Information Pen\",\n\t\t\"Unsecured Frontier Enclave Relay\",\n\t\t\"Unsecured Frontier Server Bank\",\n\n\t\t// Class 6\n\t\t\"Core Citadel\",\n\t\t\"Core Bastion\",\n\t\t\"Strange Energy Readings\",\n\t\t\"The Mirror\",\n\t\t\"Forgotten Core Assembly Hall\",\n\t\t\"Forgotten Core Circuitry Disassembler\",\n\t\t\"Unsecured Core Backup Array\",\n\t\t\"Unsecured Core Emergence\"\n\t];\n\n\tif (wormholeSignatures.indexOf(sigName) > -1) {\n\t\treturn '<a href=\"http://eve-survival.org/wikka.php?wakka='+sigName.replace(/ /g, '')+'\" target=\"_blank\" class=\"siteLink\">'+sigName+'</a>';\n\t}\n\n\treturn sigName;\n}\n\n// Custom inlinecomplete + dropdown input\n$.widget(\"custom.inlinecomplete\", $.ui.autocomplete, {\n\t_create: function() {\n\t\tif (!this.element.is(\"input\")) {\n\t\t\tthis._selectInit();\n\t\t}\n\n\t\t// Invoke the parent function\n\t\treturn this._super();\n\t},\n\t_value: function() {\n\t\t// Invoke the parent function\n\t\tvar originalReturn = this._superApply(arguments);\n\n\t\tthis.element.change();\n\n\t\treturn originalReturn;\n\t},\n\t_suggest: function(items) {\n\t\t// if (this.element.val() != items[0].value) {\n\t\t\t// this.element.val(items[0].value.substr(0, this.element.val().length));\n\t\t// }\n\n\t\t// Invoke the parent function\n\t\treturn this._super(items);\n\t},\n\t_initSource: function() {\n\t\tif ($.isArray(this.options.source)) {\n\t\t\tthis.source = function(request, response) {\n\t\t\t\tvar matcher = new RegExp(\"^\" + $.ui.autocomplete.escapeRegex(request.term), \"i\");\n\t\t\t\tvar results = new Array(); // results array\n\t\t\t\tvar data = this.options.source;\n\t\t\t\tvar maxSize = this.options.maxSize || 25; // maximum result size\n\t\t\t\t// simple loop for the options\n\t\t\t\tfor (var i = 0, l = data.length; i < l; i++) {\n\t\t\t\t\tif (matcher.test(data[i])) {\n\t\t\t\t\t\tresults.push(data[i]);\n\n\t\t\t\t\t\tif (maxSize && results.length > maxSize) {\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t // send response\n\t\t\t\t response(results);\n\t\t\t}\n\t\t} else {\n\t\t\t// Invoke the parent function\n\t\t\treturn this._super();\n\t\t}\n\t},\n\t_close: function(event) {\n\t\tthis.options.source = this.options.input_source ? this.options.input_source : this.options.source;\n\n\t\t// Invoke the parent function\n\t\treturn this._super(event);\n\t},\n\taddToSelect: function(value) {\n\t\tthis.options.select_added_value = value;\n\t\tthis.options.select_source.unshift(value);\n\t},\n\tremoveFromSelect: function(value) {\n\t\tif (value) {\n\t\t\tthis.options.select_source.splice(value, 1);\n\t\t} else if (this.options.select_added_value) {\n\t\t\tthis.options.select_source.splice(this.options.select_added_value, 1);\n\t\t}\n\t\tthis.options.select_added_value = null;\n\t},\n\t_selectInit: function() {\n\t\tthis.element.addClass(\"custom-combobox\");\n\t\tthis.wrapper = this.element;\n\t\tthis.element = this.wrapper.find(\"input:first\");\n\t\tthis.select = this.wrapper.find(\"select:first\").remove();\n\n\t\tthis.options.input_source = this.options.source;\n\t\tthis.options.select_source = this.select.children(\"option[value!='']\").map(function() {\n            return $.trim(this.text);\n        }).toArray();\n\n\t\tthis._createShowAllButton();\n\t},\n\t_createShowAllButton: function() {\n        var that = this,\n          wasOpen = false;\n\n        $(\"<a>\")\n\t\t\t.attr(\"tabIndex\", that.element.prop(\"tabindex\"))\n\t\t\t.attr(\"title\", \"\")\n\t\t\t.appendTo(that.wrapper)\n\t\t\t.button({icons: {primary: \"ui-icon-triangle-1-s\"}, text: false})\n\t\t\t.removeClass(\"ui-corner-all\")\n\t\t\t.addClass(\"custom-combobox-toggle ui-corner-right\")\n\t\t\t.on(\"mousedown\", function() {\n\t\t\t\twasOpen = that.widget().is(\":visible\");\n\t\t\t})\n\t\t\t.on(\"click\", function() {\n\t\t\t\tthat.element.trigger(\"focus\");\n\n\t\t\t\t// Close if already visible\n\t\t\t\tif (wasOpen) {\n\t\t\t\t  return;\n\t\t\t\t}\n\n\t\t\t\t// Pass empty string as value to search for, displaying all results\n\t\t\t\tthat.options.source = that.options.select_source;\n\t\t\t\tthat._search(\"\");\n\t\t\t});\n\t},\n});\n\n// Initialize tablesorter plugin on signaturesWidget table\n$(\"#sigTable\").tablesorter({\n\tsortReset: true,\n\twidgets: ['saveSort'],\n\ttextExtraction: {\n\t\t2: function(node) { return $(node).find(\"span\").data(\"age\"); }\n\t}\n});\n\n// Highlight signaturesWidget tr on click\n$(\"#sigTable tbody\").on(\"click\", \"tr\", function(e) {\n\tif (e.metaKey || e.ctrlKey) {\n\t\t// ctrl or cmd key\n\t\t$(this).toggleClass(\"selected\");\n\t} else if (e.shiftKey) {\n\t\t// shift key\n\t\t$(this).addClass(\"selected\");\n\t\t$(\"#sigTable tbody tr.selected:first\").nextUntil(\"#sigTable tbody tr.selected:last\").addBack().add(\"#sigTable tbody tr.selected:last\").addClass(\"selected\");\n\t} else {\n\t\t$(\"#sigTable tbody tr.selected\").removeClass(\"selected\");\n\t\t$(this).addClass(\"selected\");\n\t}\n});\n\n// Un-Highlight signaturesWidget tr on clicking outside\n$(document).click(function(e) {\n    if(!$(e.target).closest('#sigTable tbody').length && !$(e.target).closest('#edit-signature').length && !$(e.target).closest('#delete-signature').length) {\n\t\t$(\"#sigTable tbody tr.selected\").removeClass(\"selected\");\n    }\n});\n\n// Monitor custom 'classchange' event\n$(\"#sigTable tbody\").on(\"classchange\", \"tr\", function(e, className) {\n\t// Trigger signaturesWidget selected row change custom event\n\tif (className === \"selected\") {\n\t\t$(\"#signaturesWidget\").trigger(\"selected:change\");\n\t}\n});\n\n// Update signaturesWidget based on .selected rows change\n$(\"#signaturesWidget\").on(\"selected:change\", function() {\n\t// Enable/Disable delete icon\n\tif ($(\"#sigTable tr.selected\").length === 0) {\n\t\t$(\"#signaturesWidget #delete-signature\").addClass(\"disabled\");\n\t} else {\n\t\t$(\"#signaturesWidget #delete-signature\").removeClass(\"disabled\");\n\t}\n\n\t// Enable/Disable edit icon\n\tif ($(\"#sigTable tr.selected\").length === 1) {\n\t\t$(\"#signaturesWidget #edit-signature\").removeClass(\"disabled\");\n\t} else {\n\t\t$(\"#signaturesWidget #edit-signature\").addClass(\"disabled\");\n\t}\n})\n\n$(\"#dialog-error\").dialog({\n\tautoOpen: false,\n\tresizable: false,\n\tminHeight: 0,\n\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\tbuttons: {\n\t\tOk: function() {\n\t\t\t$(this).dialog(\"close\");\n\t\t}\n\t},\n\tcreate: function() {\n\t\t$(this).dialog(\"option\", \"show\", {effect: \"shake\", duration: 150, easing: \"easeOutElastic\"});\n\t}\n});\n\n$(\"#dialog-msg\").dialog({\n\tautoOpen: false,\n\tresizable: false,\n\tminHeight: 0,\n\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\tbuttons: {\n\t\tOk: function() {\n\t\t\t$(this).dialog(\"close\");\n\t\t}\n\t}\n});\n\n$(\"#dialog-confirm\").dialog({\n\tautoOpen: false,\n\tresizable: false,\n\tminHeight: 0,\n\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\tbuttons: {\n\t\tCancel: function() {\n\t\t\t$(this).dialog(\"close\");\n\t\t}\n\t}\n});\n\nif (window.location.href.indexOf(\"galileo\") != -1) {\n\tNotify.trigger(\"This is the test version of Tripwire.<br/>Please use <a href='https://tripwire.cloud-things.com'>Tripwire</a>\")\n}\n","tripwire.active = function(data) {\n    var editSigs = [];\n    var editComments = [];\n\n    for (var x in data) {\n        var activity = JSON.parse(data[x].activity);\n        editSigs.push(parseInt(activity.editSig));\n        editComments.push(parseInt(activity.editComment));\n\n        if (activity.editSig) {\n            $(\"#sigTable tr[data-id='\"+activity.editSig+\"']\")\n                //.attr('data-tooltip', sig.editing)\n                //.attr(\"title\", sig.editing)\n                .addClass(\"editing\")\n                .find(\"td\")\n                .animate({backgroundColor: \"#001b47\"}, 1000); //35240A - Yellow\n        }\n\n        if (activity.editComment && $(\"#commentWrapper .comment[data-id='\"+activity.editComment+\"'] .cke\").length > 0) {\n            $(\"#commentWrapper .comment[data-id='\"+activity.editComment+\"']\")\n                .addClass(\"editing\")\n                .find(\".commentStatus\").html(data[x].characterName + \" is editing\").fadeIn();\n        }\n    }\n\n    $(\"#sigTable tr.editing\").each(function() {\n        if ($.inArray($(this).data(\"id\"), editSigs) == -1) {\n            $(\"#sigTable tr[data-id='\"+$(this).data(\"id\")+\"']\")\n                //.attr('data-tooltip', '')\n                //.removeAttr(\"title\")\n                .removeClass(\"editing\")\n                .find(\"td\")\n                .animate({backgroundColor: \"#111\"}, 1000, null, function() {$(this).css({backgroundColor: \"\"});});\n        }\n    });\n\n    $(\"#commentWrapper .editing\").each(function() {\n        if ($.inArray($(this).data(\"id\"), editComments) == -1) {\n            $(\"#commentWrapper .editing[data-id='\"+$(this).data(\"id\")+\"']\")\n                .removeClass(\"editing\")\n                .find(\".commentStatus\").fadeOut(function() {$(this).html(\"\")});\n        }\n    });\n}\n","// Hanldes adding to Signatures section\n// ToDo: Use native JS\ntripwire.addSig = function(add, option, disabled) {\n    var option = option || {};\n    var animate = typeof(option.animate) !== 'undefined' ? option.animate : true;\n    var disabled = disabled || false;\n    var wormhole = {};\n\n    if (add.type == \"wormhole\") {\n        var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == add.id || wormhole.secondaryID == add.id) return wormhole; })[0];\n        if (!wormhole) return false;\n        var otherSignature = add.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\n        if (!otherSignature) return false;\n\n        if (add.name) {\n          leadsTo = tripwire.systems[otherSignature.systemID] ? \"<a href='.?system=\"+tripwire.systems[otherSignature.systemID].name+\"'>\"+add.name+\"</a>\" : add.name;\n        } else if (tripwire.aSigSystems[otherSignature.systemID]) {\n            leadsTo = tripwire.aSigSystems[otherSignature.systemID];\n        } else if (tripwire.systems[otherSignature.systemID]) {\n            leadsTo = \"<a href='.?system=\"+tripwire.systems[otherSignature.systemID].name+\"'>\"+tripwire.systems[otherSignature.systemID].name+\"</a>\";\n        } else {\n            leadsTo = \"\";\n        }\n\n        var row = \"<tr data-id='\"+add.id+\"' data-tooltip='' \"+ (disabled ? 'disabled=\"disabled\"' : '') +\">\"\n            + \"<td class='\"+ options.signatures.alignment.sigID +\"'>\"+(add.signatureID ? add.signatureID.substring(0, 3)+\"-\"+(add.signatureID.substring(3, 6) || \"###\") : \"???-###\")+\"</td>\"\n            + \"<td class='type-tooltip \"+ options.signatures.alignment.sigType +\"' data-tooltip=\\\"\"+this.whTooltip(wormhole)+\"\\\">\"+(wormhole[wormhole.parent+\"ID\"] == add.id ? wormhole.type || \"\" : (wormhole.parent ? \"K162\" : \"\"))+\"</td>\"\n            + \"<td class='age-tooltip \"+ options.signatures.alignment.sigAge + (parseInt(add.lifeLength) === 0 ? \" disabled\" : \"\") +\"' data-tooltip='\"+this.ageTooltip(add)+\"'><span data-age='\"+add.lifeTime+\"'></span></td>\"\n            + \"<td class='\"+ options.signatures.alignment.leadsTo +\"'>\"+(leadsTo || \"\")+\"</td>\"\n            + \"<td class='\"+wormhole.life+\" \"+ options.signatures.alignment.sigLife +\"'>\"+wormhole.life+\"</td>\"\n            + \"<td class='\"+wormhole.mass+\" \"+ options.signatures.alignment.sigMass +\"'>\"+wormhole.mass+\"</td>\"\n            + \"</tr>\";\n\n        var tr = $(row);\n    } else {\n        var row = \"<tr data-id='\"+add.id+\"' data-tooltip='' \"+ (disabled ? 'disabled=\"disabled\"' : '') +\">\"\n            + \"<td class='\"+ options.signatures.alignment.sigID +\"'>\"+(add.signatureID ? add.signatureID.substring(0, 3)+\"-\"+(add.signatureID.substring(3, 6) || \"###\") : \"???-###\")+\"</td>\"\n            + \"<td class='\"+ options.signatures.alignment.sigType +\"'>\"+add.type+\"</td>\"\n            + \"<td class='age-tooltip \"+ options.signatures.alignment.sigAge + (parseInt(add.lifeLength) === 0 ? \" disabled\" : \"\") +\"' data-tooltip='\"+this.ageTooltip(add)+\"'><span data-age='\"+add.lifeTime+\"'></span></td>\"\n            + \"<td class='\"+ options.signatures.alignment.leadsTo +\"' colspan='3'>\"+(add.name?linkSig(add.name):'')+\"</td>\"\n            + \"</tr>\";\n\n        var tr = $(row);\n    }\n\n    Tooltips.attach($(tr).find(\"[data-tooltip]\"));\n\n    $(\"#sigTable\").append(tr);\n\n    $(\"#sigTable\").trigger(\"update\");\n\n    // Add counter\n    if (wormhole.life == \"critical\") {\n        $(tr).find('span[data-age]').countdown({until: moment.utc(add.lifeLeft).toDate(), onExpiry: this.pastEOL, alwaysExpire: true, compact: true, format: this.ageFormat, serverSync: this.serverTime.getTime})\n            // .countdown('pause')\n            .addClass('critical')\n            // .countdown('resume');\n    } else {\n        $(tr).find('span[data-age]').countdown({since: moment.utc(add.lifeTime).toDate(), compact: true, format: this.ageFormat, serverSync: this.serverTime.getTime});\n    }\n\n    if (animate) {\n        $(tr)\n            .find('td')\n            .wrapInner('<div class=\"hidden\" />')\n            .parent()\n            .find('td > div')\n            .slideDown(700, function(){\n                $set = $(this);\n                $set.replaceWith($set.contents());\n            });\n\n        $(tr).find(\"td\").animate({backgroundColor: \"#004D16\"}, 1000).delay(1000).animate({backgroundColor: \"#111\"}, 1000, null, function() {$(this).css({backgroundColor: \"\"});});\n    }\n}\n","// Handles API updates\ntripwire.API = function() {\n    this.indicator;\n    this.APIrefresh;\n\n    this.API.expire = function() {\n        var options = {since: tripwire.API.APIrefresh, until: null, format: \"MS\", layout: \"-{mnn}{sep}{snn}\"};\n        $(\"#APItimer\").countdown(\"option\", options);\n    }\n\n    this.API.refresh = function() {\n        $.ajax({\n            url: \"api_update.php\",\n            cache: false,\n            dataType: \"JSON\",\n            data: \"indicator=\"+tripwire.API.indicator\n        }).done(function(data) {\n            if (data && data.APIrefresh) {\n                tripwire.API.indicator = data.indicator;\n                tripwire.API.APIrefresh = new Date(data.APIrefresh);\n                activity.refresh(); //Refresh graph\n\n                var options = {until: tripwire.API.APIrefresh, since: null, layout: \"{mnn}{sep}{snn}\"};\n                $(\"#APItimer\").countdown(\"option\", options);\n                setTimeout(\"tripwire.API.refresh();\", $.countdown.periodsToSeconds($(\"#APItimer\").countdown('getTimes')) - 30);\n            } else if ($(\"#APItimer\").countdown(\"option\", \"layout\") !== \"-{mnn}{sep}{snn}\" && $.countdown.periodsToSeconds($(\"#APItimer\").countdown('getTimes')) > 120) {\n                setTimeout(\"tripwire.API.refresh();\", ($.countdown.periodsToSeconds($(\"#APItimer\").countdown('getTimes')) - 30) * 1000);\n            } else {\n                setTimeout(\"tripwire.API.refresh();\", 15000);\n            }\n        });\n    }\n\n    this.API.init = function() {\n        $.ajax({\n            url: \"api_update.php\",\n            cache: true,\n            dataType: \"JSON\",\n            data: \"init=true\"\n        }).done(function(data) {\n            tripwire.API.indicator = data.indicator;\n            tripwire.API.APIrefresh = new Date(data.APIrefresh);\n\n            $(\"#APItimer\").countdown({until: tripwire.API.APIrefresh, onExpiry: tripwire.API.expire, alwaysExpire: true, compact: true, format: \"MS\", serverSync: tripwire.serverTime.getTime, onTick: function(t) { $(\"#APIclock\").val(t[5] + 1).trigger(\"change\"); }})\n            var timer = $(\"#APItimer\").countdown(\"option\", \"layout\") === \"-{mnn}{sep}{snn}\" ? 15 : $.countdown.periodsToSeconds($(\"#APItimer\").countdown('getTimes')) - 30;\n            setTimeout(\"tripwire.API.refresh();\", timer * 1000);\n        });\n    }\n\n    this.API.init();\n}\n// tripwire.API();\n","tripwire.autoMapper = function(from, to) {\n    var pods = [33328, 670];\n    var undo = [];\n\n    // Convert from & to from system name to system ID for diagnostic testing\n    // from = viewingSystemID;\n    // to = Object.index(tripwire.systems, 'name', to);\n\n    // Make sure the automapper is turned on & not disabled\n    if (!$(\"#toggle-automapper\").hasClass(\"active\") || $(\"#toggle-automapper\").hasClass(\"disabled\"))\n        return false;\n\n    // Make sure from and to are valid systems\n    if (!tripwire.systems[from] || !tripwire.systems[to])\n        return false;\n\n    // Make sure from and to are not the same system\n    if (from == to)\n        return false;\n\n    // Is pilot in a station?\n    if (tripwire.client.EVE && tripwire.client.EVE.stationID)\n        return false;\n\n    // Is pilot in a pod?\n    // if (tripwire.client.EVE && tripwire.client.EVE.shipTypeID && $.inArray(parseInt(tripwire.client.EVE.shipTypeID), pods) >= 0)\n    //     return false;\n\n    // Is this a gate?\n    if (typeof(tripwire.map.shortest[from - 30000000]) != \"undefined\" && typeof(tripwire.map.shortest[from - 30000000][to - 30000000]) != \"undefined\")\n        return false;\n\n     // Is this an existing connection?\n     if ($.map(tripwire.client.wormholes,\n               function(wormhole) {\n                 const initial = tripwire.client.signatures[wormhole.initialID];\n                 const secondary = tripwire.client.signatures[wormhole.secondaryID];\n                 return initial && secondary &&\n                   ((initial.systemID == from && secondary.systemID == to) ||\n                    (initial.systemID == to && secondary.systemID == from))  ? wormhole : null;\n               }).length > 0) {\n       return false;\n     }\n\n    var payload = {\"signatures\": {\"add\": [], \"update\": []}};\n    var sig, toClass;\n\n    if (tripwire.systems[to].class)\n        toClass = \"Class-\" + tripwire.systems[to].class;\n    else if (tripwire.systems[to].security >= 0.45)\n        toClass = \"High-Sec\";\n    else if (tripwire.systems[to].security > 0)\n        toClass = \"Low-Sec\";\n    else\n        toClass = \"Null-Sec\";\n\n    var wormholes = $.map(tripwire.client.wormholes, function(wormhole) {\n        // Find wormholes that have no set Leads To system, and their initial system is from the wormhole we just jumped from\n        if (tripwire.client.signatures[wormhole.initialID].systemID == from && !tripwire.systems[tripwire.client.signatures[wormhole.secondaryID].systemID]) {\n            if (tripwire.aSigSystems[tripwire.client.signatures[wormhole.secondaryID].systemID] == toClass) {\n                // Find wormholes that Leads To is generically set to the class we just jumped into\n                return wormhole;\n            } else if (wormhole.type && tripwire.wormholes[wormhole.type] && tripwire.wormholes[wormhole.type].leadsTo.replace(' ', '-') == toClass) {\n                // Find wormholes that Type is known to lead to the class we just jumped into\n                return wormhole;\n            } else if (tripwire.client.signatures[wormhole.secondaryID].systemID === null && (!wormhole.type || !tripwire.wormholes[wormhole.type])) {\n                // Find wormholes that don't have a Type or any kind of Leads To entered\n                return wormhole;\n            }\n        }\n    });\n\n    if (wormholes.length) {\n        if (wormholes.length > 1) {\n            $(\"#dialog-select-signature\").dialog({\n                autoOpen: true,\n                title: \"Which Signature?\",\n                width: 390,\n                buttons: {\n                    Cancel: function() {\n                        $(this).dialog(\"close\");\n                    },\n                    Ok: function() {\n                        var i = $(\"#dialog-select-signature [name=sig]:checked\").val();\n                        var wormhole = wormholes[i];\n                        var signature = tripwire.client.signatures[wormhole.initialID];\n                        var signature2 = tripwire.client.signatures[wormhole.secondaryID];\n\n                        payload.signatures.update.push({\n                            \"wormhole\": {\n                                \"id\": wormhole.id\n                            },\n                            \"signatures\": [\n                                {\n                                    \"id\": signature.id\n                                },\n                                {\n                                    \"id\": signature2.id,\n                                    \"systemID\": to\n                                }\n                            ]\n                        });\n\n                        var success = function(data) {\n                            if (data.resultSet && data.resultSet[0].result == true) {\n                                undo.push({\"wormhole\": wormhole, \"signatures\": [signature, signature2]});\n                                $(\"#dialog-select-signature\").dialog(\"close\");\n                            }\n                        }\n\n                        tripwire.refresh('refresh', payload, success);\n                    }\n                },\n                open: function() {\n                    $(\"#dialog-select-signature .optionsTable tbody\").empty();\n\n                    $.each(wormholes, function(i) {\n                        var signature = tripwire.client.signatures[wormholes[i].initialID];\n                        var signatureRow = $(\"#sigTable tr[data-id='\"+signature.id+\"']\").html();\n                        var tr = \"<tr>\"\n                          + \"<td><input type='radio' name='sig' value='\"+i+\"' id='sig\"+i+\"' /></td>\"\n                          + signatureRow\n                          + \"</tr>\";\n\n                        $(\"#dialog-select-signature .optionsTable tbody\").append(tr);\n                        $(\"#dialog-select-signature .optionsTable tbody td\").wrapInner(\"<label for='sig\"+i+\"' />\");\n                    });\n                }\n            });\n        } else {\n            var wormhole = wormholes[0];\n            var signature = tripwire.client.signatures[wormhole.initialID];\n            var signature2 = tripwire.client.signatures[wormhole.secondaryID];\n\n            payload.signatures.update.push({\n                \"wormhole\": {\n                    \"id\": wormhole.id\n                },\n                \"signatures\": [\n                    {\n                        \"id\": signature.id\n                    },\n                    {\n                        \"id\": signature2.id,\n                        \"systemID\": to\n                    }\n                ]\n            });\n            undo.push({\"wormhole\": wormhole, \"signatures\": [signature, signature2]});\n        }\n    } else {\n        // Nothing matches, create a new wormhole\n        payload.signatures.add.push({\n            \"wormhole\": {\n                \"type\": null,\n                \"parent\": \"initial\",\n                \"life\": \"stable\",\n                \"mass\": \"stable\"\n            },\n            \"signatures\": [\n                {\n                    \"systemID\": from,\n                    \"type\": \"wormhole\"\n                },\n                {\n                    \"systemID\": to,\n                    \"type\": \"wormhole\"\n                }\n            ]\n        });\n    }\n\n    if (payload.signatures.add.length || payload.signatures.update.length) {\n        var success = function(data) {\n            if (data.resultSet && data.resultSet[0].result == true) {\n                $(\"#undo\").removeClass(\"disabled\");\n\n                if (data.results) {\n                    if (viewingSystemID in tripwire.signatures.undo) {\n                        tripwire.signatures.undo[viewingSystemID].push({action: \"add\", signatures: data.results});\n                    } else {\n                        tripwire.signatures.undo[viewingSystemID] = [{action: \"add\", signatures: data.results}];\n                    }\n                }\n\n                if (undo.length) {\n                    if (viewingSystemID in tripwire.signatures.undo) {\n                        tripwire.signatures.undo[viewingSystemID].push({action: \"update\", signatures: undo});\n                    } else {\n                        tripwire.signatures.undo[viewingSystemID] = [{action: \"update\", signatures: undo}];\n                    }\n                }\n\n                sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n            }\n        }\n\n        tripwire.refresh('refresh', payload, success);\n    }\n}\n","$(\"body\").on(\"dblclick\", \".comment\", function(e) {\n\te.preventDefault();\n\tdocument.getSelection().removeAllRanges();\n\t$(this).find(\".commentEdit\").click();\n})\n\n$(\"body\").on(\"click\", \".commentEdit\", function(e) {\n\te.preventDefault();\n\n\t// Prevent multiple editors\n\tif ($(\".cke\").length) return false;\n\n\tvar $comment = $(this).closest(\".comment\");\n\n\t$comment.find(\".commentToolbar\").hide();\n\n\tCKEDITOR.replace($comment.find(\".commentBody\").attr(\"id\"), CKConfig).on(\"instanceReady\", function() {\n\t\t$comment.find(\".commentStatus\").html(\"\");\n\t\t$comment.find(\".commentFooter\").show();\n\t\t$comment.find(\".commentFooter .commentControls\").show();\n\t});\n\n\ttripwire.activity.editComment = $comment.data(\"id\");\n\ttripwire.refresh('refresh');\n});\n\n$(\"body\").on(\"click\", \".commentSave, .commentCancel\", function(e) {\n\te.preventDefault();\n\tvar $this = $(this);\n\tif ($this.attr(\"disabled\")) return false;\n\n\tvar $comment = $this.closest(\".comment\");\n\t$this.attr(\"disabled\", \"true\");\n\n\tif ($this.hasClass(\"commentSave\")) {\n\t\tvar data = {\"mode\": \"save\", \"commentID\": $comment.data(\"id\"), \"systemID\": $comment.find(\".commentSticky\").hasClass(\"active\") ? 0 : viewingSystemID, \"comment\": CKEDITOR.instances[$comment.find(\".commentBody\").attr(\"id\")].getData()};\n\n\t\t$.ajax({\n\t\t\turl: \"comments.php\",\n\t\t\ttype: \"POST\",\n\t\t\tdata: data,\n\t\t\tdataType: \"JSON\"\n\t\t}).done(function(data) {\n\t\t\tif (data && data.result == true) {\n\t\t\t\t$comment.find(\".commentModified\").html(\"Edited by \" + data.comment.modifiedByName + \" at \" + data.comment.modifiedDate);\n\t\t\t\t$comment.find(\".commentCreated\").html(\"Posted by \" + data.comment.createdByName + \" at \" + data.comment.createdDate);\n\t\t\t\tTooltips.attach($comment.find(\"[data-tooltip]\"));\n\n\t\t\t\tCKEDITOR.instances[$comment.find(\".commentBody\").attr(\"id\")].destroy(false);\n\t\t\t\t$comment.attr(\"data-id\", data.comment.id);\n\t\t\t\t$comment.find(\".commentToolbar\").show();\n\t\t\t\t$comment.find(\".commentFooter\").hide();\n\t\t\t\t$this.removeAttr(\"disabled\");\n\t\t\t}\n\t\t});\n\t} else {\n\t\tCKEDITOR.instances[$comment.find(\".commentBody\").attr(\"id\")].destroy(true);\n\n\t\tif (!$comment.attr(\"data-id\")) {\n\t\t\t$comment.remove();\n\t\t} else {\n\t\t\t$comment.find(\".commentToolbar\").show();\n\t\t\t$comment.find(\".commentFooter\").hide();\n\t\t\t$this.removeAttr(\"disabled\");\n\t\t}\n\t}\n\n\t$comment.find(\".commentStatus\").html(\"\");\n\n\tdelete tripwire.activity.editComment;\n\ttripwire.refresh('refresh');\n});\n\n$(\"body\").on(\"click\", \".commentDelete\", function(e) {\n\te.preventDefault();\n\tvar $comment = $(this).closest(\".comment\");\n\n\t// check if dialog is open\n\tif (!$(\"#dialog-deleteComment\").hasClass(\"ui-dialog-content\")) {\n\t\t$(\"#dialog-deleteComment\").data(\"comment\", $comment).dialog({\n\t\t\tresizable: false,\n\t\t\tminHeight: 0,\n\t\t\tposition: {my: \"center\", at: \"center\", of: $(\"#notesWidget\")},\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\n\t\t\tbuttons: {\n\t\t\t\tDelete: function() {\n\t\t\t\t\t// Prevent duplicate submitting\n\t\t\t\t\t$(\"#dialog-deleteComment\").parent().find(\":button:contains('Delete')\").button(\"disable\");\n\n\t\t\t\t\tvar $comment = $(this).data(\"comment\");\n\t\t\t\t\tvar data = {\"mode\": \"delete\", \"commentID\": $comment.data(\"id\")};\n\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\turl: \"comments.php\",\n\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\tdata: data,\n\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t}).done(function(data) {\n\t\t\t\t\t\tif (data && data.result == true) {\n\t\t\t\t\t\t\t$(\"#dialog-deleteComment\").dialog(\"close\");\n\t\t\t\t\t\t\t$comment.remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t}).always(function() {\n\t\t\t\t\t\t$(\"#dialog-deleteComment\").parent().find(\":button:contains('Delete')\").button(\"enable\");\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tCancel: function() {\n\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t}\n\t\t\t}\n\t\t});\n\t} else if (!$(\"#dialog-deleteComment\").dialog(\"isOpen\")) {\n\t\t$(\"#dialog-deleteComment\").data(\"comment\", $comment).dialog(\"open\");\n\t}\n});\n\n$(\"body\").on(\"click\", \"#add-comment\", function(e) {\n\te.preventDefault();\n\n\t// Prevent multiple editors\n\tif ($(\".cke\").length) return false;\n\n\tvar $comment = $(\".comment:last\").clone();\n\tvar commentID = $(\".comment:visible:last .commentBody\").attr(\"id\") ? $(\".comment:visible:last .commentBody\").attr(\"id\").replace(\"comment\", \"\") + 1 : 0;\n\t$(\".comment:last\").before($comment);\n\n\t$comment.find(\".commentBody\").attr(\"id\", \"comment\" + commentID);\n\t$comment.removeClass(\"hidden\").find(\".commentEdit\").click();\n});\n\n$(\"body\").on(\"click\", \".commentSticky\", function(e) {\n\te.preventDefault();\n\tvar $comment = $(this).closest(\".comment\");\n\n\tvar data = {\"mode\": \"sticky\", \"commentID\": $comment.data(\"id\"), \"systemID\": $comment.find(\".commentSticky\").hasClass(\"active\") ? viewingSystemID : 0};\n\n\t$.ajax({\n\t\turl: \"comments.php\",\n\t\ttype: \"POST\",\n\t\tdata: data,\n\t\tdataType: \"JSON\"\n\t}).done(function(data) {\n\t\tif (data && data.result == true) {\n\t\t\t$comment.find(\".commentSticky\").hasClass(\"active\") ? $comment.find(\".commentSticky\").removeClass(\"active\") : $comment.find(\".commentSticky\").addClass(\"active\");\n\t\t}\n\t});\n});\n","// Handles removing from Signatures section\ntripwire.deleteSig = function(key) {\n    var tr = $(\"#sigTable tr[data-id='\"+key+\"']\");\n\n    //Append empty space to prevent non-coloring\n    $(tr).find('td:empty, a:empty').append(\"&nbsp;\");\n\n    $(tr)\n        .find('td')\n        .wrapInner('<div />')\n        .parent()\n        .find('td > div').animate({backgroundColor: \"#4D0000\"}, 1000).delay(1000).animate({backgroundColor: \"#111\"}, 1000)\n        .slideUp(700, function(){\n            // Remove countdown reference\n            $(tr).find('span[data-age]').countdown(\"destroy\");\n\n            $(this).parent().parent().remove();\n            $(\"#sigTable\").trigger(\"update\");\n        });\n}\n","// Handles changing Signatures section\n// ToDo: Use native JS\ntripwire.editSig = function(edit, disabled) {\n    var disabled = disabled || false;\n    var wormhole = {};\n\n    if (edit.type == \"wormhole\") {\n        var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == edit.id || wormhole.secondaryID == edit.id) return wormhole; })[0];\n        if (!wormhole) return false;\n        var otherSignature = edit.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\n        if (!otherSignature) return false;\n\n        if (edit.name) {\n          leadsTo = tripwire.systems[otherSignature.systemID] ? \"<a href='.?system=\"+tripwire.systems[otherSignature.systemID].name+\"'>\"+edit.name+\"</a>\" : edit.name;\n        } else if (tripwire.aSigSystems[otherSignature.systemID]) {\n            leadsTo = tripwire.aSigSystems[otherSignature.systemID];\n        } else if (tripwire.systems[otherSignature.systemID]) {\n            leadsTo = \"<a href='.?system=\"+tripwire.systems[otherSignature.systemID].name+\"'>\"+tripwire.systems[otherSignature.systemID].name+\"</a>\";\n        } else {\n            leadsTo = \"\";\n        }\n\n        var row = \"<tr data-id='\"+edit.id+\"' data-tooltip='' \"+ (disabled ? 'disabled=\"disabled\"' : '') +\">\"\n            + \"<td class='\"+ options.signatures.alignment.sigID +\"'>\"+(edit.signatureID ? edit.signatureID.substring(0, 3)+\"-\"+(edit.signatureID.substring(3, 6) || \"###\") : \"???-###\")+\"</td>\"\n            + \"<td class='type-tooltip \"+ options.signatures.alignment.sigType +\"' data-tooltip=\\\"\"+this.whTooltip(wormhole)+\"\\\">\"+(wormhole[wormhole.parent+\"ID\"] == edit.id ? wormhole.type || \"\" : (wormhole.parent ? \"K162\" : \"\"))+\"</td>\"\n            + \"<td class='age-tooltip \"+ options.signatures.alignment.sigAge + (parseInt(edit.lifeLength) === 0 ? \" disabled\" : \"\") +\"' data-tooltip='\"+this.ageTooltip(edit)+\"'><span data-age='\"+edit.lifeTime+\"'></span></td>\"\n            + \"<td class='\"+ options.signatures.alignment.leadsTo +\"'>\"+(leadsTo || \"\")+\"</td>\"\n            + \"<td class='\"+wormhole.life+\" \"+ options.signatures.alignment.sigLife +\"'>\"+wormhole.life+\"</td>\"\n            + \"<td class='\"+wormhole.mass+\" \"+ options.signatures.alignment.sigMass +\"'>\"+wormhole.mass+\"</td>\"\n            + \"</tr>\";\n\n        var tr = $(row);\n    } else {\n        var row = \"<tr data-id='\"+edit.id+\"' data-tooltip='' \"+ (disabled ? 'disabled=\"disabled\"' : '') +\">\"\n            + \"<td class='\"+ options.signatures.alignment.sigID +\"'>\"+(edit.signatureID ? edit.signatureID.substring(0, 3)+\"-\"+(edit.signatureID.substring(3, 6) || \"###\") : \"???-###\")+\"</td>\"\n            + \"<td class='\"+ options.signatures.alignment.sigType +\"'>\"+edit.type+\"</td>\"\n            + \"<td class='age-tooltip \"+ options.signatures.alignment.sigAge + (parseInt(edit.lifeLength) === 0 ? \" disabled\" : \"\") +\"' data-tooltip='\"+this.ageTooltip(edit)+\"'><span data-age='\"+edit.lifeTime+\"'></span></td>\"\n            + \"<td class='\"+ options.signatures.alignment.leadsTo +\"' colspan='3'>\"+(edit.name?linkSig(edit.name):'')+\"</td>\"\n            + \"</tr>\";\n\n        var tr = $(row);\n    }\n\n    Tooltips.attach($(tr).find(\"[data-tooltip]\"));\n\n    // Destroy the pervious countdown to prevent errors on a non-existant DOM element\n    $(\"#sigTable tr[data-id='\"+edit.id+\"']\").find('span[data-age]').countdown(\"destroy\");\n    $(\"#sigTable tr[data-id='\"+edit.id+\"']\").replaceWith(tr);\n\n    $(\"#sigTable\").trigger(\"update\");\n    // Update counter\n    if (wormhole.life == \"critical\") {\n        $(tr).find('span[data-age]').countdown({until: moment.utc(edit.lifeLeft).toDate(), onExpiry: this.pastEOL, alwaysExpire: true, compact: true, format: this.ageFormat, serverSync: this.serverTime.getTime})\n            .addClass('critical');\n    } else {\n        $(tr).find('span[data-age]').countdown({since: moment.utc(edit.lifeTime).toDate(), compact: true, format: this.ageFormat, serverSync: this.serverTime.getTime});\n    }\n\n    $(tr).effect(\"pulsate\");\n}\n","tripwire.esi = function() {\n    var baseUrl = \"https://esi.evetech.net\";\n    var userAgent = \"Tripwire Client \" + tripwire.version + \" (\" + window.location.hostname + \") - \" + window.navigator.userAgent;\n    var locationTimer, shipTimer, onlineTimer;\n    this.esi.connection = true;\n    this.esi.characters = {};\n\n    var scopeError = function(characterID) {\n        $(\"#tracking .tracking-clone[data-characterid='\"+ characterID +\"']\").find(\".alert\").show();\n    }\n\n    this.esi.location = function() {\n        clearTimeout(locationTimer);\n\n        for (characterID in tripwire.esi.characters) {\n            var character = tripwire.esi.characters[characterID];\n\n            // Check for expiring token\n            if (moment(character.tokenExpire).subtract(5, \"minutes\").isBefore(moment())) {\n                tripwire.data.esi = {\"expired\": true};\n                continue;\n            }\n\n            $.ajax({\n                url: baseUrl + \"/v1/characters/\"+ characterID +\"/location/?\" + $.param({\"token\": character.accessToken, \"user_agent\": userAgent}),\n                // headers: {\"Authorization\": \"Bearer \"+ character.accessToken, \"X-User-Agent\": userAgent},\n                type: \"GET\",\n                dataType: \"JSON\",\n                characterID: characterID\n            }).done(function(data, status, xhr) {\n                var character = tripwire.esi.characters[this.characterID];\n\n                if (character) {\n                    character.locationDate = moment(xhr.getResponseHeader(\"last-modified\"), \"ddd, DD MMMM YYYY HH:mm:ss\").format();\n\n                    if (character.systemID != data.solar_system_id) {\n                        character.systemID = data.solar_system_id || null;\n                        character.systemName = tripwire.systems[data.solar_system_id] ? tripwire.systems[data.solar_system_id].name : null;\n\n                        $(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"']\").find(\".system\").html(character.systemName || \"&nbsp;\");\n\n                        // Send to Tripwire server on next refresh call\n                        tripwire.data.tracking[this.characterID] = {\n                            characterID: character.characterID,\n                            characterName: character.characterName,\n                            systemID: character.systemID,\n                            systemName: character.systemName,\n                            stationID: character.stationID,\n                            stationName: character.stationName,\n                            shipID: character.shipID,\n                            shipName: character.shipName,\n                            shipTypeID: character.shipTypeID,\n                            shipTypeName: character.shipTypeName};\n                    }\n\n                    if (character.stationID != data.station_id) {\n                        character.stationID = data.station_id || null;\n\n                        if (data.station_id) {\n                            tripwire.esi.stationLookup(data.station_id, this.characterID)\n                                .always(function(data) {\n                                    var character = tripwire.esi.characters[this.reference];\n\n                                    character.stationName = data.name || null;\n                                    $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference +\"']\").find(\".station\").html(data.name.substring(0, 17) + \"...\" || \"&nbsp;\").attr(\"data-tooltip\", data.name);\n                                    Tooltips.attach($(\"#tracking .tracking-clone[data-characterid='\"+ this.reference +\"'] .station[data-tooltip]\"));\n\n                                    // Send to Tripwire server on next refresh call\n                                    tripwire.data.tracking[this.reference] = {\n                                        characterID: character.characterID,\n                                        characterName: character.characterName,\n                                        systemID: character.systemID,\n                                        systemName: character.systemName,\n                                        stationID: character.stationID,\n                                        stationName: character.stationName,\n                                        shipID: character.shipID,\n                                        shipName: character.shipName,\n                                        shipTypeID: character.shipTypeID,\n                                        shipTypeName: character.shipTypeName};\n                                });\n                        } else {\n                            character.stationName = null;\n                            // $(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"']\").find(\".station\").html(\"&nbsp;\").attr(\"data-tooltip\", \"&nbsp;\");\n                            Tooltips.detach($(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"'] .station[data-tooltip]\"));\n\n                            // Send to Tripwire server on next refresh call\n                            tripwire.data.tracking[this.characterID] = {\n                                characterID: character.characterID,\n                                characterName: character.characterName,\n                                systemID: character.systemID,\n                                systemName: character.systemName,\n                                stationID: character.stationID,\n                                stationName: character.stationName,\n                                shipID: character.shipID,\n                                shipName: character.shipName,\n                                shipTypeID: character.shipTypeID,\n                                shipTypeName: character.shipTypeName};\n                        }\n                    }\n\n                    if (options.tracking.active == this.characterID) {\n                        tripwire.EVE(tripwire.esi.characters[options.tracking.active]);\n                    }\n                }\n            }).fail(function(data) {\n                if (data.status == 403) {\n                    tripwire.refresh(\"refresh\", {\"esi\": {\"expired\": true}});\n                }\n            }).always(function(data, status, xhr) {\n                if (status != \"success\" && status != \"abort\" && tripwire.esi.connection == true) {\n                    tripwire.esi.connection = false;\n                    $(\"#esiConnectionSuccess, #esiConnectionError\").click();\n                    Notify.trigger(\"ESI Connection Failed\", \"red\", false, \"esiConnectionError\");\n                } else if (status == \"success\" && tripwire.esi.connection == false) {\n                    tripwire.esi.connection = true;\n                    $(\"#esiConnectionSuccess, #esiConnectionError\").click();\n                    Notify.trigger(\"ESI Connection Resumed\", \"green\", 5000, \"esiConnectionSuccess\");\n                }\n\n                var headers = parseHeaders(xhr.getAllResponseHeaders());\n                if (headers.warning) {\n                  console.log('ESI API Warning: ', headers.warning, this.url);\n                }\n            });\n        }\n\n        locationTimer = setTimeout(\"tripwire.esi.location()\", 5000);\n    }\n\n    this.esi.ship = function() {\n        clearTimeout(shipTimer);\n\n        for (characterID in tripwire.esi.characters) {\n            var character = tripwire.esi.characters[characterID];\n\n            // Check for expiring token\n            if (moment(character.tokenExpire).subtract(5, \"minutes\").isBefore(moment())) {\n                tripwire.data.esi = {\"expired\": true};\n                continue;\n            }\n\n            $.ajax({\n                url: baseUrl + \"/v1/characters/\"+ characterID +\"/ship/?\" + $.param({\"token\": character.accessToken, \"user_agent\": userAgent}),\n                // headers: {\"Authorization\": \"Bearer \"+ character.accessToken, \"X-User-Agent\": userAgent},\n                type: \"GET\",\n                dataType: \"JSON\",\n                characterID: characterID\n            }).done(function(data, status, xhr) {\n                var character = tripwire.esi.characters[this.characterID];\n\n                if (character) {\n                    character.shipDate = moment(xhr.getResponseHeader(\"last-modified\"), \"ddd, DD MMMM YYYY HH:mm:ss\").format();\n\n                    if (character.shipID != data.ship_item_id) {\n                        character.shipID = data.ship_item_id || null;\n\n                        // Send to Tripwire server on next refresh call\n                        tripwire.data.tracking[this.characterID] = {\n                            characterID: character.characterID,\n                            characterName: character.characterName,\n                            systemID: character.systemID,\n                            systemName: character.systemName,\n                            stationID: character.stationID,\n                            stationName: character.stationName,\n                            shipID: character.shipID,\n                            shipName: character.shipName,\n                            shipTypeID: character.shipTypeID,\n                            shipTypeName: character.shipTypeName};\n                    }\n\n                    if (character.shipName != data.ship_name) {\n                        character.shipName = data.ship_name || null;\n                        $(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"']\").find(\".shipname\").html(data.ship_name || \"&nbsp;\");\n\n                        // Send to Tripwire server on next refresh call\n                        tripwire.data.tracking[this.characterID] = {\n                            characterID: character.characterID,\n                            characterName: character.characterName,\n                            systemID: character.systemID,\n                            systemName: character.systemName,\n                            stationID: character.stationID,\n                            stationName: character.stationName,\n                            shipID: character.shipID,\n                            shipName: character.shipName,\n                            shipTypeID: character.shipTypeID,\n                            shipTypeName: character.shipTypeName};\n                    }\n\n                    if (character.shipTypeID != data.ship_type_id) {\n                        character.shipTypeID = data.ship_type_id || null;\n\n                        if (data.ship_type_id) {\n                            tripwire.esi.typeLookup(data.ship_type_id, this.characterID)\n                                .always(function(data) {\n                                    var character = tripwire.esi.characters[this.reference];\n\n                                    character.shipTypeName = data.name || null;\n                                    $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference +\"']\").find(\".ship\").html(data.name || \"&nbsp;\");\n\n                                    // Send to Tripwire server on next refresh call\n                                    tripwire.data.tracking[this.reference] = {\n                                        characterID: character.characterID,\n                                        characterName: character.characterName,\n                                        systemID: character.systemID,\n                                        systemName: character.systemName,\n                                        stationID: character.stationID,\n                                        stationName: character.stationName,\n                                        shipID: character.shipID,\n                                        shipName: character.shipName,\n                                        shipTypeID: character.shipTypeID,\n                                        shipTypeName: character.shipTypeName};\n                                });\n                        } else {\n                            character.shipTypeName = null;\n                            $(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"']\").find(\".ship\").html(\"&nbsp;\");\n\n                            // Send to Tripwire server on next refresh call\n                            tripwire.data.tracking[this.characterID] = {\n                                characterID: character.characterID,\n                                characterName: character.characterName,\n                                systemID: character.systemID,\n                                systemName: character.systemName,\n                                stationID: character.stationID,\n                                stationName: character.stationName,\n                                shipID: character.shipID,\n                                shipName: character.shipName,\n                                shipTypeID: character.shipTypeID,\n                                shipTypeName: character.shipTypeName};\n                        }\n                    }\n                }\n            }).fail(function(data) {\n                if (data.status == 403) {\n                    tripwire.refresh(\"refresh\", {\"esi\": {\"expired\": true}});\n                }\n            }).always(function(data, status, xhr) {\n                if (status != \"success\" && status != \"abort\" && tripwire.esi.connection == true) {\n                    tripwire.esi.connection = false;\n                    $(\"#esiConnectionSuccess, #esiConnectionError\").click();\n                    Notify.trigger(\"ESI Connection Failed\", \"red\", false, \"esiConnectionError\");\n                } else if (status == \"success\" && tripwire.esi.connection == false) {\n                    tripwire.esi.connection = true;\n                    $(\"#esiConnectionSuccess, #esiConnectionError\").click();\n                    Notify.trigger(\"ESI Connection Resumed\", \"green\", 5000, \"esiConnectionSuccess\");\n                }\n\n                var headers = parseHeaders(xhr.getAllResponseHeaders());\n                if (headers.warning) {\n                  console.log('ESI API Warning: ', headers.warning, this.url);\n                }\n            });\n        }\n\n        shipTimer = setTimeout(\"tripwire.esi.ship()\", 5000);\n    }\n\n    this.esi.online = function() {\n        clearTimeout(onlineTimer);\n\n        for (characterID in tripwire.esi.characters) {\n            var character = tripwire.esi.characters[characterID];\n\n            tripwire.esi.characterStatus(character.characterID, character)\n                .done(function(data) {\n                    if (data.online) {\n                        $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference.characterID +\"']\").find(\".online\").removeClass(\"critical\").addClass(\"stable\");\n                    } else {\n                        $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference.characterID +\"']\").find(\".online\").removeClass(\"stable\").addClass(\"critical\");\n                    }\n                }).fail(function(data) {\n                    if (data && data.status == 403) {\n                        scopeError(this.reference.characterID);\n                    }\n                    $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference.characterID +\"']\").find(\".online\").removeClass(\"stable\").addClass(\"critical\");\n                });\n        }\n\n        onlineTimer = setTimeout(\"tripwire.esi.online()\", 60000);\n    }\n\n    this.esi.typeLookup = function(typeID, reference) {\n        return $.ajax({\n            url: baseUrl + \"/v3/universe/types/\"+ typeID +\"/?\" + $.param({\"user_agent\": userAgent}),\n            // headers: {\"X-User-Agent\": userAgent},\n            type: \"GET\",\n            dataType: \"JSON\",\n            reference: reference\n        }).always(function(results, status, xhr) {\n          var headers = parseHeaders(xhr.getAllResponseHeaders());\n          if (headers.warning) {\n            console.log('ESI API Warning: ', headers.warning, this.url);\n          }\n        });\n    }\n\n    this.esi.stationLookup = function(stationID, reference) {\n        return $.ajax({\n            url: baseUrl + \"/v2/universe/stations/\"+ stationID +\"/?\" + $.param({\"user_agent\": userAgent}),\n            // headers: {\"X-User-Agent\": userAgent},\n            type: \"GET\",\n            dataType: \"JSON\",\n            reference: reference\n        }).always(function(results, status, xhr) {\n          var headers = parseHeaders(xhr.getAllResponseHeaders());\n          if (headers.warning) {\n            console.log('ESI API Warning: ', headers.warning, this.url);\n          }\n        });\n    }\n\n    this.esi.setDestination = function(destinationID, characterID, clear_waypoints, beginning) {\n        clear_waypoints = clear_waypoints ? clear_waypoints : false;\n        beginning = beginning ? beginning : false;\n        return $.ajax({\n            url: baseUrl + \"/v2/ui/autopilot/waypoint/?\" + $.param({destination_id: destinationID, clear_other_waypoints: clear_waypoints, add_to_beginning: beginning}),\n            headers: {\"Authorization\": \"Bearer \"+ tripwire.esi.characters[characterID].accessToken, \"X-User-Agent\": userAgent},\n            type: \"POST\",\n            dataType: \"JSON\"\n        }).always(function(results, status, xhr) {\n          var headers = parseHeaders(xhr.getAllResponseHeaders());\n          if (headers.warning) {\n            console.log('ESI API Warning: ', headers.warning, this.url);\n          }\n        });\n    }\n\n    this.esi.showInfo = function(targetID, characterID) {\n        return $.ajax({\n            url: baseUrl + \"/v1/ui/openwindow/information/?\" + $.param({target_id: targetID}),\n            headers: {\"Authorization\": \"Bearer \"+ tripwire.esi.characters[characterID].accessToken, \"X-User-Agent\": userAgent},\n            type: \"POST\",\n            dataType: \"JSON\"\n        }).always(function(results, status, xhr) {\n          var headers = parseHeaders(xhr.getAllResponseHeaders());\n          if (headers.warning) {\n            console.log('ESI API Warning: ', headers.warning, this.url);\n          }\n        });\n    }\n\n    this.esi.characterStatus = function(characterID, reference) {\n        return $.ajax({\n            url: baseUrl + \"/v2/characters/\" + characterID + \"/online/?\" + $.param({\"token\": tripwire.esi.characters[characterID].accessToken, \"user_agent\": userAgent}),\n            // headers: {\"Authorization\": \"Bearer \"+ tripwire.esi.characters[characterID].accessToken, \"X-User-Agent\": userAgent},\n            type: \"GET\",\n            dataType: \"JSON\",\n            reference: reference\n        }).always(function(results, status, xhr) {\n          var headers = parseHeaders(xhr.getAllResponseHeaders());\n          if (headers.warning) {\n            console.log('ESI API Warning: ', headers.warning, this.url);\n          }\n        });\n    }\n\n    this.esi.eveStatus = function() {\n        return $.ajax({\n            url: baseUrl + \"/v1/status/?\" + $.param({\"user_agent\": userAgent}),\n            // headers: {\"X-User-Agent\": userAgent},\n            type: \"GET\",\n            dataType: \"JSON\"\n        }).always(function(results, status, xhr) {\n          var headers = parseHeaders(xhr.getAllResponseHeaders());\n          if (headers.warning) {\n            console.log('ESI API Warning: ', headers.warning, this.url);\n          }\n        });\n    }\n\n    this.esi.idLookup = function(eveIDs) {\n        return $.ajax({\n            url: baseUrl + \"/v2/universe/names/?\" + $.param({\"user_agent\": userAgent}),\n            type: \"POST\",\n            dataType: \"JSON\",\n            contentType: \"application/json\",\n            processData: false,\n            data: JSON.stringify(eveIDs)\n        }).always(function(results, status, xhr) {\n          var headers = parseHeaders(xhr.getAllResponseHeaders());\n          if (headers.warning) {\n            console.log('ESI API Warning: ', headers.warning, this.url);\n          }\n        });\n    }\n\n    this.esi.characterLookup = function(eveID, reference, async) {\n        var async = typeof(async) !== 'undefined' ? async : true;\n        return $.ajax({\n            url: baseUrl + \"/v4/characters/\" + eveID + \"/?\" + $.param({\"user_agent\": userAgent}),\n            type: \"GET\",\n            dataType: \"JSON\",\n            async: async,\n            eveID: eveID,\n            reference: reference\n        }).always(function(results, status, xhr) {\n          var headers = parseHeaders(xhr.getAllResponseHeaders());\n          if (headers.warning) {\n            console.log('ESI API Warning: ', headers.warning, this.url);\n          }\n        });\n    }\n\n    this.esi.corporationLookup = function(eveID, reference, async) {\n        var async = typeof(async) !== 'undefined' ? async : true;\n        return $.ajax({\n            url: baseUrl + \"/v4/corporations/\" + eveID + \"/?\" + $.param({\"user_agent\": userAgent}),\n            type: \"GET\",\n            dataType: \"JSON\",\n            async: async,\n            eveID: eveID,\n            reference: reference\n        }).always(function(results, status, xhr) {\n          var headers = parseHeaders(xhr.getAllResponseHeaders());\n          if (headers.warning) {\n            console.log('ESI API Warning: ', headers.warning, this.url);\n          }\n        });\n    }\n\n    this.esi.allianceLookup = function(eveID, reference, async) {\n        var async = typeof(async) !== 'undefined' ? async : true;\n        return $.ajax({\n            url: baseUrl + \"/v3/alliances/\" + eveID + \"/?\" + $.param({\"user_agent\": userAgent}),\n            type: \"GET\",\n            dataType: \"JSON\",\n            async: async,\n            eveID: eveID,\n            reference: reference\n        }).always(function(results, status, xhr) {\n          var headers = parseHeaders(xhr.getAllResponseHeaders());\n          if (headers.warning) {\n            console.log('ESI API Warning: ', headers.warning, this.url);\n          }\n        });\n    }\n\n    this.esi.search = function(searchString, categories, strict) {\n        return $.ajax({\n            url: baseUrl + \"/v2/search/?\" + $.param({\"user_agent\": userAgent}),\n            type: \"GET\",\n            dataType: \"JSON\",\n            contentType: \"application/json\",\n            data: {\"search\": searchString, \"categories\": categories, \"strict\": strict}\n        }).always(function(results, status, xhr) {\n          var headers = parseHeaders(xhr.getAllResponseHeaders());\n          if (headers.warning) {\n            console.log('ESI API Warning: ', headers.warning, this.url);\n          }\n        });\n    }\n\n    this.esi.universeJumps = function() {\n        return $.ajax({\n            url: baseUrl + \"/v1/universe/system_jumps/?\" + $.param({\"user_agent\": userAgent}),\n            type: \"GET\",\n            dataType: \"JSON\"\n        }).always(function(results, status, xhr) {\n          var headers = parseHeaders(xhr.getAllResponseHeaders());\n          if (headers.warning) {\n            console.log('ESI API Warning: ', headers.warning, this.url);\n          }\n        });\n    }\n\n    this.esi.universeKills = function() {\n        return $.ajax({\n            url: baseUrl + \"/v2/universe/system_kills/?\" + $.param({\"user_agent\": userAgent}),\n            type: \"GET\",\n            dataType: \"JSON\"\n        }).always(function(results, status, xhr) {\n          var headers = parseHeaders(xhr.getAllResponseHeaders());\n          if (headers.warning) {\n            console.log('ESI API Warning: ', headers.warning, this.url);\n          }\n        });\n    }\n\n    // Wrapper to make lookups easier\n    this.esi.fullLookup = function(eveIDs) {\n        var promise = $.Deferred();\n\n        tripwire.esi.idLookup(eveIDs)\n            .done(function(data) {\n                for (item in data) {\n                    if (data[item].category == \"character\") {\n                        tripwire.esi.characterLookup(data[item].id, data[item], false)\n                            .done(function(characterData) {\n                                $.extend(data[item], characterData);\n                                tripwire.esi.corporationLookup(characterData.corporation_id, this.reference, false)\n                                    .done(function(corporationData) {\n                                        data[item].corporation = corporationData;\n                                        if (corporationData.alliance_id) {\n                                            tripwire.esi.allianceLookup(corporationData.alliance_id, this.reference, false)\n                                                .done(function(allianceData) {\n                                                    data[item].alliance = allianceData;\n                                                });\n                                        }\n                                    });\n                            });\n                    } else if (data[item].category == \"corporation\") {\n                        tripwire.esi.corporationLookup(data[item].id, data[item], false)\n                            .done(function(corporationData) {\n                                $.extend(data[item], corporationData);\n                                if (corporationData.alliance_id) {\n                                    tripwire.esi.allianceLookup(corporationData.alliance_id, this.reference, false)\n                                        .done(function(allianceData) {\n                                            data[item].alliance = allianceData;\n                                        });\n                                }\n                            })\n                    }\n                }\n\n                promise.resolve(data);\n            });\n\n        return promise;\n    }\n\n    this.esi.parse = function(characters) {\n        for (characterID in tripwire.esi.characters) {\n            if (!(characterID in characters)) {\n                delete tripwire.esi.characters[characterID];\n                $(\"#tracking .tracking-clone[data-characterid='\"+ characterID +\"']\").remove();\n                if (options.tracking.active == characterID) {\n                    tripwire.EVE(false, true);\n                    $(\"#removeESI\").attr(\"disabled\", \"disabled\");\n                }\n            }\n        }\n\n        for (characterID in characters) {\n            if (options.tracking.active == \"new\") {\n                options.tracking.active = characterID;\n            }\n\n            if (!(characterID in tripwire.esi.characters)) {\n                var $clone = $(\"#tracking-clone\").clone();\n                $clone.attr(\"data-characterid\", characterID);\n                $clone.find(\".avatar img\").attr(\"src\", \"https://image.eveonline.com/Character/\"+ characterID +\"_32.jpg\");\n                $clone.find(\".name\").html(characters[characterID].characterName);\n                $clone.removeAttr(\"id\");\n                $clone.removeClass(\"hidden\");\n                $clone.addClass(\"tracking-clone\");\n\n                if (options.tracking.active == characterID) {\n                    $clone.addClass(\"active\");\n                    $(\"#removeESI\").removeAttr(\"disabled\");\t\t\t\t}\n\n                $(\"#tracking\").append($clone);\n                // Tooltips.attach($clone.find(\"[data-tooltip]\"));\n            }\n\n            tripwire.esi.characters[characterID] = characters[characterID];\n        }\n\n        tripwire.esi.ship();\n        tripwire.esi.location();\n        tripwire.esi.online();\n    }\n}\ntripwire.esi();\n","// Handles data from EVE in-game data\ntripwire.EVE = function(EVE, characterChange) {\n    var systemChange = this.client.EVE && this.client.EVE.systemChange || false;\n\n    if (EVE) {\n        // Automapper\n        if (!characterChange) {\n            // Did the system change or did it previously and we have yet to try an autoMapper call?\n            if ((this.client.EVE && this.client.EVE.systemID != EVE.systemID) || systemChange == true) {\n                systemChange = true;\n\n                // Check if location was updated after the last ship update\n                // if (moment(EVE.locationDate).isAfter(moment(this.client.EVE.shipDate))) {\n                    systemChange = false;\n                    tripwire.autoMapper(this.client.EVE.systemID, EVE.systemID);\n                // }\n            }\n        }\n\n        // System follower\n        if (!characterChange && options.buttons.follow && (this.client.EVE && this.client.EVE.systemID != EVE.systemID) && $(\".ui-dialog:visible\").length == 0) {\n            tripwire.systemChange(EVE.systemID);\n        }\n\n        if (!$(\"#search\").hasClass(\"active\")) {\n            $(\"#currentSpan\").show();\n        }\n\n        // Enable auto-mapper\n        $(\"#toggle-automapper\").removeClass(\"disabled\");\n\n        // Update current system\n        if (EVE.systemID) {\n            // add system to Leads To dropdown\n            if ($(\"#dialog-signature [data-autocomplete='sigSystems']\").hasClass(\"custom-combobox\")) {\n                $(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete(\"removeFromSelect\");\n                $(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete(\"addToSelect\", tripwire.systems[EVE.systemID].name);\n            }\n            $(\"#EVEsystem\").html(tripwire.systems[EVE.systemID].name).attr(\"href\", \".?system=\"+ tripwire.systems[EVE.systemID].name);\n        }\n    } else {\n        // Update current system\n        $(\"#EVEsystem\").html(\"\");\n        $(\"#currentSpan\").hide();\n        // Disable automapper\n        $(\"#toggle-automapper\").addClass(\"disabled\");\n        // remove system from Leads To dropdown\n        if ($(\"#dialog-signature [data-autocomplete='sigSystems']\").hasClass(\"custom-combobox\")) {\n            $(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete(\"removeFromSelect\");\n        }\n    }\n\n    this.client.EVE = {\n        characterID: EVE.characterID,\n        characterName: EVE.characterName,\n        systemID: EVE.systemID,\n        systemName: EVE.systemName,\n        shipTypeID: EVE.shipTypeID,\n        shipTypeName: EVE.shipTypeName,\n        stationID: EVE.stationID,\n        stationName: EVE.stationName,\n        locationDate: EVE.locationDate,\n        shipDate: EVE.shipDate,\n        systemChange: systemChange\n    };\n}\n","tripwire.parse = function(server, mode) {\n    var data = $.extend(true, {}, server);\n\n    if (options.chain.active == null || (options.chain.tabs[options.chain.active] && options.chain.tabs[options.chain.active].evescout != true)) {\n        if (options.masks.active != \"273.0\") {\n            for (var key in data.signatures) {\n                if (data.signatures[key].mask == \"273.0\") {\n                    delete data.signatures[key];\n                }\n            }\n        }\n    }\n\n    if (mode == 'refresh') {\n        // preserve client.EVE across refresh otherwise tracking/automapper will be confused\n        var EVE = this.client.EVE;\n        this.client = server;\n        this.client.EVE = EVE;\n\n        for (var key in data.signatures) {\n            if (data.signatures[key].systemID != viewingSystemID) {\n                continue;\n            }\n            var disabled = data.signatures[key].mask == \"273.0\" && options.masks.active != \"273.0\" ? true : false;\n\n            // Check for differences\n            if (!tripwire.signatures.list[key]) {\n                this.addSig(data.signatures[key], {animate: true}, disabled);\n            } else if (tripwire.signatures.list[key].modifiedTime !== data.signatures[key].modifiedTime) {\n                var edit = false;\n                for (column in data.signatures[key]) {\n                    if (data.signatures[key][column] != tripwire.signatures.list[key][column] && column != \"editing\") {\n                        edit = true;\n                    }\n                }\n\n                if (edit) {\n                    this.editSig(data.signatures[key], disabled);\n                } else {\n                    // this.sigEditing(data.signatures[key]);\n                }\n            }\n        }\n\n        // Sigs needing removal\n        for (var key in tripwire.signatures.list) {\n            if (!data.signatures[key]) {\n                this.deleteSig(key);\n            }\n        }\n    } else if (mode == 'init' || mode == 'change') {\n        this.client = server;\n\n        for (var key in data.signatures) {\n            if (data.signatures[key].systemID != viewingSystemID) {\n                continue;\n            }\n            var disabled = data.signatures[key].mask == \"273.0\" && options.masks.active != \"273.0\" ? true : false;\n\n            this.addSig(data.signatures[key], {animate: false}, disabled);\n\n            if (data.signatures[key].editing) {\n                this.sigEditing(data.signatures[key]);\n            }\n        }\n    }\n\n    tripwire.signatures.list = data.signatures;\n\n    // set the sig count in the UI\n    var signatureCount = 0;\n    $.map(data.signatures, function(signature) {signature.systemID == viewingSystemID ? signatureCount++ : null;});\n    $(\"#signature-count\").html(signatureCount);\n}\n","// Handles pasting sigs from EVE\ntripwire.pasteSignatures = function() {\n    var processing = false;\n\n    var rowParse = function(row) {\n        var scanner = {};\n        var columns = row.split(\"\t\"); // Split by tab\n        var validScanGroups = [\"Cosmic Signature\", \"Cosmic Anomaly\", \"Kosmische Anomalie\", \"Kosmische Signatur\",\n                                \"Скрытый сигнал\", \"Космическая аномалия\"];\n        var validTypes = {\"Gas Site\": \"Gas\", \"Data Site\": \"Data\", \"Relic Site\": \"Relic\", \"Ore Site\": \"Ore\", \"Combat Site\": \"Combat\", \"Wormhole\": \"Wormhole\",\n                            \"Gasgebiet\": \"Gas\", \"Datengebiet\": \"Data\", \"Reliktgebiet\": \"Relic\", \"Mineraliengebiet\": \"Ore\", \"Kampfgebiet\": \"Combat\", \"Wurmloch\": \"Wormhole\",\n                            \"Газовый район\": \"Gas\", \"Информационный район\": \"Data\", \"Археологический район\": \"Relic\", \"Астероидный район\": \"Ore\", \"Боевой район\": \"Combat\", \"Червоточина\": \"Wormhole\"};\n\n        for (var x in columns) {\n            if (columns[x].match(/^([A-Z]{3}[-]\\d{3})$/)) {\n                scanner.id = columns[x].split(\"-\");\n                continue;\n            }\n\n            if (columns[x].match(/(\\d([.|,]\\d)?[ ]?(%))/) || columns[x].match(/(\\d[.|,]?\\d+\\s(AU|AE|km|m|а.е.|км|м))/i)) { // Exclude scan % || AU\n                continue;\n            }\n\n            if ($.inArray(columns[x], validScanGroups) != -1) {\n                scanner.scanGroup = columns[x];\n                continue;\n            }\n\n            if (validTypes[columns[x]]) {\n                scanner.type = validTypes[columns[x]];\n                continue;\n            }\n\n            if (columns[x] != \"\") {\n                scanner.name = columns[x];\n            }\n        }\n\n        if (!scanner.id || scanner.id.length !== 2) {\n            return false;\n        }\n\n        return scanner;\n    }\n\n    this.pasteSignatures.parsePaste = function(paste) {\n        var paste = paste.split(\"\\n\");\n        var payload = {\"signatures\": {\"add\": [], \"update\": []}, \"systemID\": viewingSystemID};\n        var undo = [];\n        processing = true;\n\n        for (var i in paste) {\n            var scanner = rowParse(paste[i]);\n\n            if (scanner.id) {\n                var signature = $.map(tripwire.client.signatures, function(signature) { if (signature.signatureID && signature.signatureID.toUpperCase() == scanner.id[0] + scanner.id[1]) return signature; })[0];\n                if (signature) {\n                    // Update signature (only non-wormholes can be updated to a wormhole)\n                    if (scanner.type == \"Wormhole\" && signature.type != \"wormhole\") {\n                        var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0] || {};\n                        var otherSignature = wormhole.id ? (signature.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID]) : {};\n                        payload.signatures.update.push({\n                            \"wormhole\": {\n                                \"id\": wormhole.id || null,\n                                \"type\": wormhole.type || null,\n                                \"life\": wormhole.life || \"stable\",\n                                \"mass\": wormhole.mass || \"stable\"\n                            },\n                            \"signatures\": [\n                                {\n                                    \"id\": signature.id,\n                                    \"signatureID\": signature.signatureID,\n                                    \"systemID\": viewingSystemID,\n                                    \"type\": \"wormhole\",\n                                    \"name\": signature.name\n                                },\n                                {\n                                    \"id\": otherSignature.id || null,\n                                    \"signatureID\": otherSignature.signatureID || null,\n                                    \"systemID\": otherSignature.systemID || null,\n                                    \"type\": \"wormhole\",\n                                    \"name\": otherSignature.name\n                                }\n                            ]\n                        });\n\n                        if (tripwire.client.wormholes[wormhole.id]) {\n\t\t\t\t\t\t\tundo.push({\"wormhole\": tripwire.client.wormholes[wormhole.id], \"signatures\": [tripwire.client.signatures[signature.id], tripwire.client.signatures[otherSignature.id]]});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// used to be just a regular signature\n\t\t\t\t\t\t\tundo.push(tripwire.client.signatures[signature.id]);\n\t\t\t\t\t\t}\n                    // Make sure we are only updating when we have new info (we never turn wormholes into regular signatures)\n                    } else if (signature.type != \"wormhole\" && ((scanner.type && scanner.type.toLowerCase() != signature.type) || (scanner.name && scanner.name != signature.name))) {\n                        payload.signatures.update.push({\n                            \"id\": signature.id,\n                            \"systemID\": viewingSystemID,\n                            \"type\": scanner.type || 'unknown',\n                            \"name\": scanner.name,\n                            \"lifeLength\": options.signatures.pasteLife * 60 * 60\n                        });\n                        undo.push(tripwire.client.signatures[signature.id]);\n                    }\n                } else {\n                    // Add signature\n                    if (scanner.type == \"Wormhole\") {\n                        payload.signatures.add.push({\n                            \"wormhole\": {\n                                \"type\": null,\n                                \"parent\": \"initial\",\n                                \"life\": \"stable\",\n                                \"mass\": \"stable\"\n                            },\n                            \"signatures\": [\n                                {\n                                    \"signatureID\": scanner.id[0] + scanner.id[1],\n                                    \"systemID\": viewingSystemID,\n                                    \"type\": \"wormhole\",\n                                    \"lifeLength\": options.signatures.pasteLife * 60 * 60\n                                },\n                                {\n                                    \"signatureID\": null,\n                                    \"systemID\": null,\n                                    \"type\": \"wormhole\",\n                                    \"lifeLength\": options.signatures.pasteLife * 60 * 60\n                                }\n                            ]\n                        });\n                    } else {\n                        payload.signatures.add.push({\n                            \"signatureID\": scanner.id[0] + scanner.id[1],\n                            \"systemID\": viewingSystemID,\n                            \"type\": scanner.type || 'unknown',\n                            \"name\": scanner.name,\n                            \"lifeLength\": options.signatures.pasteLife * 60 * 60\n                        });\n                    }\n                }\n            }\n        }\n\n        if (payload.signatures.add.length || payload.signatures.update.length) {\n            var success = function(data) {\n                if (data.resultSet && data.resultSet[0].result == true) {\n                    $(\"#undo\").removeClass(\"disabled\");\n\n                    if (data.results) {\n                        if (viewingSystemID in tripwire.signatures.undo) {\n                            tripwire.signatures.undo[viewingSystemID].push({action: \"add\", signatures: data.results});\n                        } else {\n                            tripwire.signatures.undo[viewingSystemID] = [{action: \"add\", signatures: data.results}];\n                        }\n                    }\n\n                    if (undo.length) {\n                        if (viewingSystemID in tripwire.signatures.undo) {\n                            tripwire.signatures.undo[viewingSystemID].push({action: \"update\", signatures: undo});\n\t\t\t\t\t\t} else {\n                            tripwire.signatures.undo[viewingSystemID] = [{action: \"update\", signatures: undo}];\n\t\t\t\t\t\t}\n                    }\n\n                    sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n                }\n            }\n\n            var always = function(data) {\n                processing = false;\n            }\n\n            tripwire.refresh('refresh', payload, success, always);\n        } else {\n            processing = false;\n        }\n    }\n\n    this.pasteSignatures.init = function() {\n        $(document).keydown(function(e)\t{\n            if ((e.metaKey || e.ctrlKey) && (e.keyCode == 86 || e.keyCode == 91) && !processing) {\n                //Abort - user is in input or textarea\n                if ($(document.activeElement).is(\"textarea, input\")) return;\n\n                $(\"#clipboard\").focus();\n            }\n        });\n\n        $(\"body\").on(\"click\", \"#fullPaste\", function(e) {\n            e.preventDefault();\n\n            var paste = $(this).data(\"paste\").split(\"\\n\");\n            var pasteIDs = [];\n            var removes = [];\n            var undo = [];\n\n            for (var i in paste) {\n                if (scan = rowParse(paste[i])) {\n                    pasteIDs.push((scan.id[0] + scan.id[1]).toLowerCase());\n                }\n            }\n\n            for (var i in tripwire.client.signatures) {\n                var signature = tripwire.client.signatures[i];\n\n                if (signature.systemID == viewingSystemID && signature.signatureID && $.inArray(signature.signatureID.toLowerCase(), pasteIDs) === -1 && signature.signatureID !== \"???\") {\n                    if (signature.type == \"wormhole\") {\n                        var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0] || {};\n                        var otherSignature = wormhole.id ? (signature.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID]) : {};\n                        if (wormhole.type !== \"GATE\") {\n                            removes.push(wormhole);\n                            undo.push({\"wormhole\": wormhole, \"signatures\": [signature, otherSignature]});\n                        }\n                    } else {\n                        removes.push(signature.id);\n                        undo.push(signature);\n                    }\n                }\n            }\n\n            if (removes.length > 0) {\n                var payload = {\"signatures\": {\"remove\": removes}};\n\n                var success = function(data) {\n                    if (data.resultSet && data.resultSet[0].result == true) {\n                        $(\"#undo\").removeClass(\"disabled\");\n                        if (viewingSystemID in tripwire.signatures.undo) {\n                            tripwire.signatures.undo[viewingSystemID].push({action: \"remove\", signatures: undo});\n                        } else {\n                            tripwire.signatures.undo[viewingSystemID] = [{action: \"remove\", signatures: undo}];\n                        }\n\n                        sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n                    }\n                }\n\n                tripwire.refresh('refresh', payload, success);\n            }\n        });\n\n        $(\"#clipboard\").on(\"paste\", function(e) {\n            e.preventDefault();\n            var paste = window.clipboardData ? window.clipboardData.getData(\"Text\") : (e.originalEvent || e).clipboardData.getData('text/plain');\n\n            $(\"#clipboard\").blur();\n            Notify.trigger(\"Paste detected<br/>(<a id='fullPaste' href=''>Click to delete missing sigs</a>)\");\n            $(\"#fullPaste\").data(\"paste\", paste);\n            tripwire.pasteSignatures.parsePaste(paste);\n        });\n    }\n\n    this.pasteSignatures.init();\n}\ntripwire.pasteSignatures();\n","tripwire.redo = function() {\n    if (tripwire.signatures.redo[viewingSystemID].length > 0) {\n        $(\"#redo\").addClass(\"disabled\");\n        var lastIndex = tripwire.signatures.redo[viewingSystemID].length -1;\n        var data = {\"systemID\": viewingSystemID, \"signatures\": {\"add\": [], \"remove\": [], \"update\": []}};\n\n        var redoItem = tripwire.signatures.redo[viewingSystemID][lastIndex];\n        var undo = $.map(redoItem.signatures, function(signature) {\n            // grab the current signature so we can restore the way it is now\n            if (signature.wormhole && tripwire.client.wormholes[signature.wormhole.id]) {\n                // it was a wormhole and still is\n                return {\"wormhole\": tripwire.client.wormholes[signature.wormhole.id], \"signatures\": [tripwire.client.signatures[signature.signatures[0].id], tripwire.client.signatures[signature.signatures[1].id]]};\n            } else if (tripwire.client.signatures[signature.id] && tripwire.client.signatures[signature.id].type == \"wormhole\") {\n                // it was a regular signature but is now a wormhole\n                var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n                return {\"wormhole\": wormhole, \"signatures\": [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]};\n            } else if (signature.wormhole && tripwire.client.signatures[signature.signatures[0].id]) {\n                // it was a wormhole but is now a regular signature\n                return tripwire.client.signatures[signature.signatures[0].id];\n            } else {\n                // it was a regular signature and still is\n                return tripwire.client.signatures[signature.id];\n            }\n        });\n\n        switch(redoItem.action) {\n            case \"add\":\n                data.signatures.add = data.signatures.add.concat(redoItem.signatures);\n                break;\n            case \"remove\":\n                data.signatures.remove = data.signatures.remove.concat($.map(redoItem.signatures, function(signature) { return signature.wormhole ? signature.wormhole : signature.id }));\n                break;\n            case \"update\":\n                data.signatures.update = data.signatures.update.concat(redoItem.signatures);\n                break;\n        }\n\n        var success = function(data) {\n            if (data.resultSet && data.resultSet[0].result == true) {\n                tripwire.signatures.redo[viewingSystemID].pop();\n\n                $(\"#undo\").removeClass(\"disabled\");\n                if (viewingSystemID in tripwire.signatures.undo) {\n                    if (redoItem.action == \"add\") {\n                        // we are adding new signatures we removed so we need the new ids\n                        tripwire.signatures.undo[viewingSystemID].push({\"action\": redoItem.action, \"signatures\": data.results});\n                    } else if (redoItem.action == \"update\") {\n                        tripwire.signatures.undo[viewingSystemID].push({\"action\": redoItem.action, \"signatures\": undo});\n                    } else {\n                        tripwire.signatures.undo[viewingSystemID].push({action: redoItem.action, signatures: redoItem.signatures});\n                    }\n                } else {\n                    if (redoItem.action == \"add\") {\n                        tripwire.signatures.undo[viewingSystemID] = [{\"action\": redoItem.action, \"signatures\": data.results}];\n                    } else if (redoItem.action == \"update\") {\n                        tripwire.signatures.undo[viewingSystemID] = [{\"action\": redoItem.action, \"signatures\": undo}];\n                    } else {\n                        tripwire.signatures.undo[viewingSystemID] = [{action: redoItem.action, signatures: redoItem.signatures}];\n                    }\n                }\n\n                sessionStorage.setItem(\"tripwire_redo\", JSON.stringify(tripwire.signatures.redo));\n                sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n            }\n        }\n\n        var always = function(data) {\n            if (tripwire.signatures.redo[viewingSystemID].length > 0) {\n                $(\"#redo\").removeClass(\"disabled\");\n            }\n        }\n\n        tripwire.refresh('refresh', data, success, always);\n    }\n}\n","// Handles pulling TQ status & player count\ntripwire.serverStatus = function() {\n    this.data;\n    this.timer;\n\n    clearTimeout(tripwire.serverStatus.timer);\n\n    tripwire.esi.eveStatus()\n        .always(function(data) {\n            if (data && data.players && data.players > 0) {\n                if (!tripwire.serverStatus.data || tripwire.serverStatus.data.players !== data.players) {\n                    $('#serverStatus').html(\"<span class='\"+(data.players > 0 ? 'stable' : 'critical')+\"'>TQ</span>: \"+numFormat(data.players));\n\n                    if (tripwire.serverStatus.data) {\n                        $(\"#serverStatus\").effect('pulsate', {times: 5});\n                    }\n                }\n\n                tripwire.serverStatus.data = data;\n            } else {\n                $('#serverStatus').html(\"<span class='critical'>TQ</span>\");\n            }\n\n            tripwire.serverStatus.timer = setTimeout(\"tripwire.serverStatus();\", 15000);\n        });\n}\ntripwire.serverStatus();\n","tripwire.sync = function(mode, data, successCallback, alwaysCallback) {\n    var data = typeof(data) === \"object\" ? $.extend(true, {}, data) : {};\n\n    // Grab any pending changes\n    $.extend(true, data, tripwire.data);\n\n    // Remove old timer to prevent multiple\n    if (this.timer) clearTimeout(this.timer);\n    if (this.xhr) this.xhr.abort();\n\n    if (mode == 'refresh' || mode == 'change') {\n        data.signatureCount = Object.size(this.client.signatures);\n        data.signatureTime = Object.maxTime(this.client.signatures, \"modifiedTime\");\n\n        data.flareCount = chain.data.flares ? chain.data.flares.flares.length : 0;\n        data.flareTime = chain.data.flares ? chain.data.flares.last_modified : 0;\n\n        data.commentCount = Object.size(this.comments.data);\n        data.commentTime = Object.maxTime(this.comments.data, \"modified\");\n\n        data.activity = this.activity;\n    } else {\n        // Expand Tripwire with JSON data from EVE Data Dump and other static data\n        $.extend(this, appData);\n\n        this.aSystems = $.map(this.systems, function(system) { return system.name; });\n        this.aSigSystems = [\"Null-Sec\", \"Low-Sec\", \"High-Sec\", \"Class-1\", \"Class-2\", \"Class-3\", \"Class-4\", \"Class-5\", \"Class-6\"];\n        $.merge(this.aSigSystems, this.aSystems.slice());\n\n        $(\".systemsAutocomplete\").inlinecomplete({source: this.aSystems, maxSize: 10, delay: 0});\n    }\n\n    data.mode = mode != \"init\" ? \"refresh\" : \"init\";\n    data.systemID = viewingSystemID;\n    data.systemName = viewingSystem;\n    data.instance = tripwire.instance;\n    data.version = tripwire.version;\n\n    this.xhr = $.ajax({\n        url: \"refresh.php\",\n        data: data,\n        type: \"POST\",\n        dataType: \"JSON\",\n        cache: false\n    }).done(function(data) {\n        if (data) {\n            tripwire.server = data;\n\n            // Purge bad wormhole signatures\n            for (var i in data.signatures) {\n              if (data.signatures[i].type == \"wormhole\") {\n                var hasWormhole = false;\n                var hasInitial = false;\n                var hasSecondary = false;\n                var wormholeID = null;\n                for (var x in data.wormholes) {\n                  if (data.wormholes[x].initialID == data.signatures[i].id) {\n                    hasInitial = true;\n                    hasWormhole = true;\n                    wormholeID = data.wormholes[x].id;\n                    if (data.signatures[parseInt(data.wormholes[x].secondaryID)]) {\n                      hasSecondary = true;\n                    }\n                  } else if (data.wormholes[x].secondaryID == data.signatures[i].id) {\n                    hasSecondary = true;\n                    hasWormhole = true;\n                    wormholeID = data.wormholes[x].id;\n                    if (data.signatures[parseInt(data.wormholes[x].initialID)]) {\n                      hasInitial = true;\n                    }\n                  }\n                }\n\n                if (!hasWormhole || !hasSecondary || !hasInitial) {\n                  delete data.signatures[i];\n                  if (wormholeID) {\n                    delete data.wormholes[wormholeID];\n                  }\n                }\n              }\n            }\n\n            if (data.esi) {\n                tripwire.esi.parse(data.esi);\n            }\n\n            if (data.sync) {\n                tripwire.serverTime.time = new Date(data.sync);\n            }\n\n            if (data.signatures) {\n                tripwire.parse(data, mode);\n            }\n\n            if (data.comments) {\n                tripwire.comments.parse(data.comments);\n            }\n\n            if (data.wormholes || data.occupied || data.flares) {\n                tripwire.chainMap.parse({\"map\": data.wormholes || null, \"occupied\": data.occupied || null, \"flares\": data.flares || null});\n            } else if (chain.data.occupied && chain.data.occupied.length && !data.occupied) {\n                // send update to remove all occupied system indicators\n                tripwire.chainMap.parse({\"occupied\": []});\n            }\n\n            tripwire.active(data.activity);\n\n            if (data.notify && !$(\"#serverNotification\")[0]) Notify.trigger(data.notify, \"yellow\", false, \"serverNotification\");\n        }\n\n        tripwire.data = {tracking: {}, esi: {}};\n        successCallback ? successCallback(data) : null;\n    }).always(function(data, status) {\n        tripwire.timer = setTimeout(\"tripwire.refresh();\", tripwire.refreshRate);\n\n        alwaysCallback ? alwaysCallback(data) : null;\n\n        if (data.status == 403) {\n            window.location.href = \".\";\n        } else if (status != \"success\" && status != \"abort\" && tripwire.connected == true) {\n            tripwire.connected = false;\n            $(\"#ConnectionSuccess\").click();\n            Notify.trigger(\"Error syncing with server\", \"red\", false, \"connectionError\");\n        } else if (status == \"success\" && tripwire.connected == false) {\n            tripwire.connected = true;\n            $(\"#connectionError\").click();\n            Notify.trigger(\"Successfully reconnected with server\", \"green\", 5000, \"connectionSuccess\");\n        }\n    });\n\n    return true;\n}\ntripwire.sync(\"init\");\n","// Change the currently viewed system\ntripwire.systemChange = function(systemID, mode) {\n    if (mode != \"init\") {\n        $(\"#infoSecurity\").removeClass();\n        $(\"#infoStatics\").empty();\n\n        viewingSystem = tripwire.systems[systemID].name;\n        viewingSystemID = systemID;\n\n        // Reset activity\n        activity.refresh(true);\n\n        // Reset signatures\n        $(\"#sigTable span[data-age]\").countdown(\"destroy\");\n        $(\"#sigTable tbody\").empty();\n        $(\"#signature-count\").html(0);\n        tripwire.signatures.list = {};\n        tripwire.client.signatures = null;\n\n        // Reset chain map\n        chain.redraw();\n\n        // Reset comments\n        $(\"#notesWidget .content .comment:visible\").remove();\n        tripwire.comments.data = null;\n\n        // Change the URL & history\n        history.replaceState(null, null, \"?system=\"+viewingSystem);\n\n        tripwire.refresh(\"change\");\n    }\n\n    // Change the title\n    document.title = tripwire.systems[systemID].name + \" - \" + app_name;\n\n    $(\"#infoSystem\").text(tripwire.systems[systemID].name);\n\n    // Current system favorite\n    $.inArray(parseInt(viewingSystemID), options.favorites) != -1 ? $(\"#system-favorite\").attr(\"data-icon\", \"star\").addClass(\"active\") : $(\"#system-favorite\").attr(\"data-icon\", \"star-empty\").removeClass(\"active\");\n\n    if (tripwire.systems[systemID].class) {\n        // Security\n        $(\"#infoSecurity\").html(\"<span class='wh pointer'>Class \" + tripwire.systems[systemID].class + \"</span>\");\n\n        // Effects\n        if (tripwire.systems[systemID].effect) {\n            var tooltip = \"<table cellpadding=\\\"0\\\" cellspacing=\\\"1\\\">\";\n            for (var x in tripwire.effects[tripwire.systems[systemID].effect]) {\n                var effect = tripwire.effects[tripwire.systems[systemID].effect][x].name;\n                var base = tripwire.effects[tripwire.systems[systemID].effect][x].base;\n                var bad = tripwire.effects[tripwire.systems[systemID].effect][x].bad;\n                var whClass = tripwire.systems[systemID].class > 6 ? 6 : tripwire.systems[systemID].class;\n                var modifier = 0;\n\n                switch (Math.abs(base)) {\n                    case 15:\n                        modifier = base > 0 ? 7 : -7;\n                        break;\n                    case 30:\n                        modifier = base > 0 ? 14 : -14;\n                        break;\n                    case 60:\n                        modifier = base > 0 ? 28 : -28;\n                        break;\n                }\n\n                tooltip += \"<tr><td>\" + effect + \"</td><td style=\\\"padding-left: 25px; text-align: right;\\\" class=\\\"\" + (bad ? \"critical\" : \"stable\") + \"\\\">\";\n                tooltip += base + (modifier * (whClass -1)) + \"%</td></tr>\";\n            }\n            tooltip += \"</table>\";\n            $(\"#infoSecurity\").append(\"&nbsp;<span class='pointer' data-tooltip='\" + tooltip + \"'>\" + tripwire.systems[systemID].effect + \"</span>\");\n            Tooltips.attach($(\"#infoSecurity [data-tooltip]\"));\n        }\n\n        // Statics\n        for (var x in tripwire.systems[systemID].statics) {\n            var type = tripwire.systems[systemID].statics[x];\n            var wormhole = tripwire.wormholes[type];\n            var color = \"wh\";\n\n            switch (wormhole.leadsTo) {\n                case \"High-Sec\":\n                    color = \"hisec\";\n                    break;\n                case \"Low-Sec\":\n                    color = \"lowsec\";\n                    break;\n                case \"Null-Sec\":\n                    color = \"nullsec\";\n                    break;\n            }\n\n            $(\"#infoStatics\").append(\"<div><span class='\"+ color +\"'>&#9679;</span> <b>\"+ wormhole.leadsTo +\"</b> via <span class='\"+ color +\"'>\"+ type +\"</span></div>\");\n        }\n\n        // Faction\n        $(\"#infoFaction\").html(\"&nbsp;\");\n    } else {\n        // Security\n        if (tripwire.systems[systemID].security >= 0.45) {\n            $(\"#infoSecurity\").addClass(\"hisec\").text(\"High-Sec \" + tripwire.systems[systemID].security);\n        } else if (tripwire.systems[systemID].security > 0.0) {\n            $(\"#infoSecurity\").addClass(\"lowsec\").text(\"Low-Sec \" + tripwire.systems[systemID].security);\n        } else {\n            $(\"#infoSecurity\").addClass(\"nullsec\").text(\"Null-Sec \" + tripwire.systems[systemID].security);\n        }\n\n        // Faction\n        $(\"#infoFaction\").html(tripwire.systems[systemID].factionID ? tripwire.factions[tripwire.systems[systemID].factionID].name : \"&nbsp;\");\n    }\n\n    // Region\n    $(\"#infoRegion\").text(tripwire.regions[tripwire.systems[systemID].regionID].name);\n\n    // Info Links\n    $(\"#infoWidget .infoLink\").each(function() {\n        this.href = $(this).data(\"href\").replace(/\\$systemName/gi, tripwire.systems[systemID].name).replace(/\\$systemID/gi, systemID);\n    });\n\n    // Reset undo/redo\n    tripwire.signatures.undo[systemID] && tripwire.signatures.undo[systemID].length > 0 ? $(\"#undo\").removeClass(\"disabled\") : $(\"#undo\").addClass(\"disabled\");\n    tripwire.signatures.redo[systemID] && tripwire.signatures.redo[systemID].length > 0 ? $(\"#redo\").removeClass(\"disabled\") : $(\"#redo\").addClass(\"disabled\");\n\n    // Reset delete signature icon\n    $(\"#sigTable tr.selected\").length == 0 ? $(\"#signaturesWidget #delete-signature\").addClass(\"disabled\") : $(\"#signaturesWidget #delete-signature\").removeClass(\"disabled\");\n}\ntripwire.systemChange(viewingSystemID, \"init\");\n","var tutorial;\n\n// infoWidget\n$(\"#infoWidget .tutorial\").click(function() {\n    tutorial = introJs().setOptions({\n        showStepNumbers: false,\n        steps: [\n            {\n                element: document.querySelector(\"#infoWidget\"),\n                intro: \"<h4>System information widget</h4><br/><p>Displays information on the currently <b>selected</b> Tripwire system.</p>\"\n            },\n            {\n                element: document.querySelector(\"#infoGeneral\"),\n                intro: \"<p>This section includes:<br/>System Name<br/>Security Rating<br/>Region<br/>Owning Faction Name</p><br/><p>If the selected system is a wormhole with a system effect, that will also be shown - hover over it to view the effect breakdown.</p>\"\n            },\n            {\n                element: document.querySelector(\"#activityGraph\"),\n                intro: \"<p>This is the graph containing historical ship jump and kill information from the EVE API.</p><br/><p>This data is only available for K-Space systems and not wormhole systems.</p><br/><p>The EVE API updates this data each hour, so this graph will update itself at the top of every hour.</p>\"\n            },\n            {\n                element: $(\"#activityGraph svg > g > g:nth-child(5)\")[0],\n                intro: \"<p>Each category can be toggled by clicking these keys to drill down the graph into finer detail.</p>\"\n            },\n            {\n                element: document.querySelector(\"#activityGraphControls\"),\n                intro: \"<p>Select different lengths of historical data to adjust the graph to display more or less information.</p>\"\n            },\n            {\n                element: document.querySelector(\"#infoStatics\"),\n                intro: \"<p>If a wormhole system is selected, the publicaly known static wormholes will appear here.</p>\"\n            },\n            {\n                element: document.querySelector(\"#infoLinks\"),\n                intro: \"<p>These are some quick links to various sites for this specific system.</p>\"\n            },\n            {\n                element: document.querySelector(\"#system-favorite\"),\n                intro: \"<p>This toggles wether this is a 'favorite' system, orange is active.</p><br/><p>'Favorite' systems can be rendered in the chain map to be able to see how far away trade hub systems are from your wormhole chain K-Space exits.</p>\"\n            }\n        ]\n    }).start();\n});\n\n// signaturesWidget\n$(\"#signaturesWidget .tutorial\").click(function() {\n    tutorial = introJs().setOptions({\n        showStepNumbers: false,\n        steps: [\n            {\n                element: document.querySelector(\"#signaturesWidget\"),\n                intro: \"<h4>System signatures widget</h4><br/><p>Displays all signatures and wormholes in the currently <b>selected</b> Tripwire system.</p>\"\n            },\n            {\n                element: document.querySelector(\"#add-signature\"),\n                intro: \"<p>Add new signatures and wormholes manually by clicking the + icon.</p><br/><p>Copy & Paste EVE scanner results anywhere once Tripwire has focus to add or update signatures, repeated pastes will only update with new information.</p>\"\n            },\n            {\n                element: document.querySelector(\"#delete-signature\"),\n                intro: \"<p>Click here or use the keyboard shortcut <b>DELETE</b> to delete <b>selected</b> signatures from this system.</p><br/><p>Click on a row to select it, click multiple rows to delete multiple signatures at once, click a selected row again to unselect it.</p>\"\n            },\n            {\n                element: document.querySelector(\"#signature-count\"),\n                intro: \"<p>This shows the current count of signatures, including wormholes, in the selected system.</p>\"\n            },\n            {\n                element: document.querySelector(\"#undo\"),\n                intro: \"<p>Click here or use the keyboard shortcut <b>CTRL-Z</b> to undo the last changes you made in this sytem (this includes clipboard pasted changes).</p><br/><p>You can undo multiple times as history is kept in the browser.</p>\"\n            },\n            {\n                element: document.querySelector(\"#redo\"),\n                intro: \"<p>Click here or use the keyboard shortcut <b>CTRL-Y</b> to redo the last changes you made in this system (this includes clipboard pasted changes).</p><br/><p>You can redo multiple times as history is kept in the browser.</p>\"\n            },\n            {\n                element: document.querySelector(\"#toggle-automapper\"),\n                intro: \"<p>Click here to toggle the Auto-mapper feature on (orange) or off.</p><br/><p>This feature only works when an in-game character is being actively tracked, otherwise this icon appears disabled.</p><br/><p>The automapper will watch for a change in your in-game system not via a star gate and try to automatically add or update wormholes.</p><br/><p>First it tries to seach for wormholes already added but missing a leads to system, this includes via wormhole type (B274) or with a leads to of 'High-Sec' for example.</p><br/><p>Next it searches for wormholes without any type or leads to at all.</p><br/><p>Finally if there are no wormholes or they all have a leads to system already, it will add a new wormhole.</p><br/><p>If at any time if finds multiple wormholes it can update, a dialog window will appear asking which wormhole you want to update.</p>\"\n            },\n            {\n                element: document.querySelector(\"#sigTable\"),\n                intro: \"<p>Each column can be sorted by clicking the column label, sort by multiple columns by holding the shift key.</p><br/><p>Right-click a column to change the text-alignment.</p>\"\n            }\n        ]\n    }).start();\n});\n\n// notesWidget\n$(\"#notesWidget .tutorial\").click(function(e) {\n    e.preventDefault();\n\n    tutorial = introJs().setOptions({\n        showStepNumbers: false,\n        exitOnEsc: false,\n        exitOnOverlayClick: false,\n        skipLabel: \"Abort\",\n        steps: [\n            {\n                element: document.querySelector(\"#notesWidget\"),\n                intro: \"<h4>System notes widget</h4><br/><p>Displays comments based on the currently <b>selected</b> Tripwire system.</p><br/><p>The rest of this tutorial will guide you through actually adding a comment, but don't worry we will switch you to your private Tripwire mask so we don't disturb anyone else.</p><br/><p>When you finish or leave this tutorial we will switch you back to your previous Tripwire mask.</p>\"\n            },\n            {\n                element: document.querySelector(\"#add-comment\"),\n                intro: \"<p>Now click the + icon to begin adding a new comment in this system (\" + viewingSystem + \").</p>\"\n            },\n            {\n                element: document.querySelector(\"#notesWidget\"),\n                intro: \"<p>Type some basic text now and click save.</p>\"\n            },\n            {\n                element: document.querySelector(\"#notesWidget\"),\n                intro: \"<p>This is our newly created comment. Hover over the comment with your mouse to see additional information and controls.</p>\"\n            },\n            {\n                element: document.querySelector(\"#notesWidget\"),\n                intro: \"<p>You can click the 'pin' or 'sticky' button to toggle showing this comment for every system, not just this system.</p>\"\n            },\n            {\n                element: document.querySelector(\"#notesWidget\"),\n                intro: \"<p>Use the <b>Edit</b> to modify a comment and <b>Delete</b> to remove a comment.</p><br/><p>You can also quickly edit any comment by simply doubling clicking anywhere on it.</p>\"\n            },\n            {\n                element: document.querySelector(\"#notesWidget\"),\n                intro: \"<p>Click on the <b>Edit</b> now on our comment.</p>\"\n            },\n            {\n                element: document.querySelector(\"#notesWidget\"),\n                intro: \"<p>The toolbar at the top allows you to customize your notes.</p><br/><p>You can also click on the <b>Maximize/Minimize</b> button (the far right toolbar icon) to edit this comment in full screen mode.</p><br/><p>In full screen mode you will see 1 new button added to the toolbar to view the source code of the comment where you can write HTML, CSS, and even Javascript in your notes!</p>\"\n            },\n            {\n                element: document.querySelector(\"#notesWidget\"),\n                intro: \"<p>This concludes the tutorial, we will now switch you back to your previous Tripwire mask and delete the comment we created.</p>\"\n            }\n        ]\n    }).start();\n\n    tutorial.onchange(function(element) {\n        switch(tutorial._currentStep) {\n            case 1:\n                $(\".introjs-prevbutton, .introjs-nextbutton\").hide();\n\n                console.log(\"switch mask to private\");\n                tutorial.previousMask = options.masks.active;\n                options.masks.active = options.character.id + \".1\";\n                options.save();\n\n                tutorial.stepFunc = function() {\n                    setTimeout(function() {\n                        tutorial._options.steps[2].element = $(\"#notesWidget\").find(\".comment:has(.cke_toolbar)\")[0];\n                        tutorial.setOption(\"steps\", tutorial._options.steps);\n\n                        tutorial.exiting = false;\n                        tutorial.exit().start().goToStep(3);\n                        tutorial.exiting = true;\n                    }, 200);\n                }\n\n                $(\"#notesWidget #add-comment\").on(\"click\", tutorial.stepFunc);\n                break;\n            case 2:\n                $(\".introjs-prevbutton, .introjs-nextbutton\").hide();\n                $(\"#notesWidget #add-comment\").off(\"click\", tutorial.stepFunc);\n\n                tutorial.stepFunc = function() {\n                    tutorial.comment = $(this).closest(\".comment\");\n                    setTimeout(function() {\n                        tutorial._options.steps[3].element = tutorial.comment[0];\n                        tutorial._options.steps[4].element = tutorial.comment.find(\".commentSticky\")[0];\n                        tutorial._options.steps[5].element = tutorial.comment.find(\".commentControls\")[0];\n                        tutorial._options.steps[6].element = tutorial.comment.find(\".commentControls\")[0];\n                        tutorial.setOption(\"steps\", tutorial._options.steps);\n\n                        tutorial.exiting = false;\n                        tutorial.exit().start().goToStep(4);\n                        tutorial.exiting = true;\n                    }, 200);\n                }\n\n                $(\"#notesWidget\").on(\"click\", \".commentSave\", tutorial.stepFunc);\n                break;\n            case 6:\n                $(\".introjs-prevbutton, .introjs-nextbutton\").hide();\n                $(\"#notesWidget\").off(\"click\", \".commentSave\", tutorial.stepFunc);\n\n                tutorial.stepFunc = function() {\n                    setTimeout(function() {\n                        tutorial._options.steps[7].element = $(\"#notesWidget\").find(\".comment:has(.cke_toolbar)\")[0];\n                        tutorial._options.steps[8].element = $(\"#notesWidget\").find(\".comment:has(.cke_toolbar)\")[0];\n                        tutorial.setOption(\"steps\", tutorial._options.steps);\n\n                        tutorial.exiting = false;\n                        tutorial.exit().start().goToStep(8);\n                        tutorial.exiting = true;\n                    }, 200);\n                }\n\n                $(\"#notesWidget\").on(\"click\", \".commentEdit\", tutorial.stepFunc);\n                break;\n        }\n    });\n\n    tutorial.onexit(function() {\n        if (tutorial.exiting) {\n            $(\".commentCancel:visible\").click();\n            // delete the tutorial comment that was created\n            if (tutorial.comment) {\n                var data = {\"mode\": \"delete\", \"commentID\": tutorial.comment.data(\"id\")};\n\n                $.ajax({\n                    url: \"comments.php\",\n                    type: \"POST\",\n                    data: data,\n                    dataType: \"JSON\"\n                }).done(function(data) {\n                    if (data && data.result == true) {\n                        tutorial.comment.remove();\n                    }\n                });\n            }\n\n            if (tutorial.previousMask) {\n                setTimeout(function() {\n                    console.log(\"change mask back, delete comment\", tutorial.previousMask);\n                    options.masks.active = tutorial.previousMask;\n                    options.save();\n                }, 200);\n            }\n\n            // remove event listeners\n            $(\"#notesWidget #add-comment\").off(\"click\", tutorial.stepFunc);\n            $(\"#notesWidget\").off(\"click\", \".commentSave\", tutorial.stepFunc);\n            $(\"#notesWidget\").off(\"click\", \".commentEdit\", tutorial.stepFunc);\n            $(\"#notesWidget\").off(\"click\", \".cke_toolgroup:has(.cke_button__toolbarswitch)\", tutorial.stepFunc);\n        }\n    });\n\n    tutorial.previousMask;\n    tutorial.comment;\n    tutorial.stepFunc;\n    tutorial.exiting = true;\n});\n","tripwire.undo = function() {\n    if (tripwire.signatures.undo[viewingSystemID].length > 0) {\n        $(\"#undo\").addClass(\"disabled\");\n        var lastIndex = tripwire.signatures.undo[viewingSystemID].length -1;\n        var data = {\"systemID\": viewingSystemID, \"signatures\": {\"add\": [], \"remove\": [], \"update\": []}};\n\n        var undoItem = tripwire.signatures.undo[viewingSystemID][lastIndex];\n        var redo = $.map(undoItem.signatures, function(signature) {\n            // grab the current signature so we can restore the way it is now\n            if (signature.wormhole && tripwire.client.wormholes[signature.wormhole.id]) {\n                // it was a wormhole and still is\n                return {\"wormhole\": tripwire.client.wormholes[signature.wormhole.id], \"signatures\": [tripwire.client.signatures[signature.signatures[0].id], tripwire.client.signatures[signature.signatures[1].id]]};\n            } else if (tripwire.client.signatures[signature.id] && tripwire.client.signatures[signature.id].type == \"wormhole\") {\n                // it was a regular signature but is now a wormhole\n                var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n                return {\"wormhole\": wormhole, \"signatures\": [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]};\n            } else if (signature.wormhole && tripwire.client.signatures[signature.signatures[0].id]) {\n                // it was a wormhole but is now a regular signature\n                return tripwire.client.signatures[signature.signatures[0].id];\n            } else {\n                // it was a regular signature and still is\n                return tripwire.client.signatures[signature.id];\n            }\n        });\n\n        switch(undoItem.action) {\n            case \"add\":\n                data.signatures.remove = data.signatures.remove.concat($.map(undoItem.signatures, function(signature) { return signature.wormhole ? signature.wormhole : signature.id }));\n                break;\n            case \"remove\":\n                data.signatures.add = data.signatures.add.concat(undoItem.signatures);\n                break;\n            case \"update\":\n                data.signatures.update = data.signatures.update.concat(undoItem.signatures);\n                break;\n        }\n\n        var success = function(data) {\n            if (data.resultSet && data.resultSet[0].result == true) {\n                tripwire.signatures.undo[viewingSystemID].pop();\n\n                $(\"#redo\").removeClass(\"disabled\");\n                if (viewingSystemID in tripwire.signatures.redo) {\n                    if (undoItem.action == \"remove\") {\n                        // we are adding new signatures we removed so we need the new ids\n                        tripwire.signatures.redo[viewingSystemID].push({\"action\": undoItem.action, \"signatures\": data.results});\n                    } else if (undoItem.action == \"update\") {\n                        tripwire.signatures.redo[viewingSystemID].push({\"action\": undoItem.action, \"signatures\": redo});\n                    } else {\n                        tripwire.signatures.redo[viewingSystemID].push({\"action\": undoItem.action, \"signatures\": undoItem.signatures});\n                    }\n                } else {\n                    if (undoItem.action == \"remove\") {\n                        tripwire.signatures.redo[viewingSystemID] = [{\"action\": undoItem.action, \"signatures\": data.results}];\n                    } else if (undoItem.action == \"update\") {\n                        tripwire.signatures.redo[viewingSystemID] = [{\"action\": undoItem.action, \"signatures\": redo}];\n                    } else {\n                        tripwire.signatures.redo[viewingSystemID] = [{\"action\": undoItem.action, \"signatures\": undoItem.signatures}];\n                    }\n                }\n\n                sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n                sessionStorage.setItem(\"tripwire_redo\", JSON.stringify(tripwire.signatures.redo));\n            }\n        }\n\n        var always = function(data) {\n            if (tripwire.signatures.undo[viewingSystemID].length > 0) {\n                $(\"#undo\").removeClass(\"disabled\");\n            }\n        }\n\n        tripwire.refresh('refresh', data, success, always);\n    }\n}\n","var activity = new function() {\n\tthis.graph;\n\tthis.options;\n\tthis.view;\n\tthis.span = 24;\n\tthis.columns = [\n\t\t{id: \"time\", label: \"Time\", role: \"domain\", type: \"string\", calc: function(d, r) { return d.getValue(r, 0) + \"h\"; }},\n\t\t{id: \"jumps\", label: \"Jumps\", role: \"data\", type: \"number\", sourceColumn: 1, column: 1, title: \"Jumps\"},\n\t\t{id: \"podkills\", label: \"Pod Kills\", role: \"data\", type: \"number\", sourceColumn: 2, column: 2, title: \"Pod Kills\"},\n\t\t{id: \"shipkills\", label: \"Ship Kills\", role: \"data\", type: \"number\", sourceColumn: 3, column: 3, title: \"Ship Kills\"},\n\t\t{id: \"npckills\", label: \"NPC Kills\", role: \"data\", type: \"number\", sourceColumn: 4, column: 4, title: \"NPC Kills\"},\n\t\t//{id: \"annotationLabel\", label: \"Test\", role: \"annotation\", type: \"string\", sourceColumn: 5, title: \"Test\"},\n\t\t//{id: \"annotationText\", label: \"Test\", role: \"annotationText\", type: \"string\", sourceColumn: 6, title: \"Test\"}\n\t];\n\n\tthis.getData = function(span, cache) {\n\t\tvar span = typeof(span) !== \"undefined\" ? span : this.span;\n\t\tvar cache = typeof(cache) !== \"undefined\" ? cache : true;\n\n\t\t// Google hasn't finished loading yet\n\t\tif (!activity.graph) {\n\t\t\t\tsetTimeout(function() {activity.getData(span, cache)}, 500);\n\t\t\t\treturn false;\n\t\t}\n\n\t\treturn $.ajax({\n\t\t\turl: \"activity_graph.php\",\n\t\t\tdata: {systemID: viewingSystemID, time: span},\n\t\t\ttype: \"GET\",\n\t\t\tdataType: \"JSON\",\n\t\t\tcache: cache\n\t\t}).done(function(json) {\n\t\t\tif (json) {\n\t\t\t\tjson.rows.reverse();\n\t\t\t\tactivity.view = new google.visualization.DataView(new google.visualization.DataTable(json));\n\t\t\t\tactivity.view.setColumns(activity.columns);\n\t\t\t\tactivity.graph.draw(activity.view, activity.options);\n\t\t\t}\n\t\t});\n\t};\n\n\tthis.selectHandler = function() {\n\t\tvar selections = activity.graph.getSelection();\n\n\t\tif (selections[0] && selections[0].row == null) {\n\t\t\tvar c = selections[0].column;\n\n\t\t\tif (activity.columns[c].sourceColumn) {\n\t\t\t\t//activity.columns[c].calc = function() { return null };\n\t\t\t\tactivity.columns[c].label = activity.columns[c].title + \" (off)\";\n\t\t\t\tdelete activity.columns[c].sourceColumn;\n\t\t\t} else {\n\t\t\t\tactivity.columns[c].sourceColumn = activity.columns[c].column;\n\t\t\t\tactivity.columns[c].label = activity.columns[c].title;\n\t\t\t\t//delete activity.columns[c].calc;\n\t\t\t}\n\n\t\t\tactivity.view.setColumns(activity.columns);\n\t\t\tactivity.options.animation.duration = 0;\n\t\t\tactivity.graph.draw(activity.view, activity.options);\n\t\t\tactivity.options.animation.duration = 500;\n\t\t}\n\t}\n\n\tthis.init = function() {\n\t\tactivity.graph = new google.visualization.AreaChart(document.getElementById(\"activityGraph\"));\n\t\tactivity.options = {\n\t\t\tisStacked: false,\n\t\t\tbackgroundColor: \"transparent\",\n\t\t\thAxis: {textStyle: {color: \"#999\", fontName: \"Verdana\", fontSize: 10}, showTextEvery: 3},\n\t\t\tvAxis: {textStyle: {color: \"#666\", fontName: \"Verdana\", fontSize: 10}, viewWindowMode: \"maximized\", viewWindow: {min: 0}, maxValue: 5},\n\t\t\tgridlineColor: \"#454545\",\n\t\t\tpointSize: 2,\n\t\t\tlineWidth: 1,\n\t\t\tchartArea: {left: \"10%\", top: \"5%\", width: \"88%\", height: \"85%\"},\n\t\t\tlegend: {position: \"in\", textStyle: {color: \"#CCC\", fontName: \"Verdana\", fontSize: 8.5}},\n\t\t\tanimation: {duration: 500, easing: \"inAndout\"},\n\t\t\ttooltip: {showColorCode: true},\n\t\t\tannotations: {style: \"line\", textStyle: {fontSize: 12, color: \"#ccc\"}, domain: 0},\n\t\t\tfocusTarget: \"category\"\n\t\t}\n\n\t\tgoogle.visualization.events.addListener(activity.graph, \"select\", activity.selectHandler);\n\n\t\tactivity.getData(activity.span);\n\t}\n\n\tthis.time = function(span) {\n\t\tswitch(span) {\n\t\t\tcase 24:\n\t\t\t\tthis.options.hAxis.showTextEvery = 3;\n\t\t\t\tbreak;\n\t\t\tcase 48:\n\t\t\t\tthis.options.hAxis.showTextEvery = 6;\n\t\t\t\tbreak;\n\t\t\tcase 168:\n\t\t\t\tthis.options.hAxis.showTextEvery = 24;\n\t\t\t\tbreak;\n\t\t}\n\n\t\tthis.span = span;\n\t\tthis.getData(span);\n\t}\n\n\tthis.redraw = function() {\n\t\tthis.graph.draw(this.view, this.options);\n\t}\n\n\tthis.refresh = function(cache) {\n\t\tthis.getData(this.span, cache);\n\t}\n\n\tgoogle.charts.setOnLoadCallback(this.init);\n}\n","var chain = new function() {\n\tthis.map, this.view, this.options, this.drawing, this.data = {};\n\n\tthis.newView = function(json) {\n\t\tthis.view = new google.visualization.DataView(new google.visualization.DataTable(json));\n\t\treturn this.view;\n\t};\n\n\tthis.activity = function(data) {\n\t\t/*\tfunction for adding recent activity to chain map nodes\t*/\n\t\t//var data = typeof(data) !== \"undefined\" ? data : this.data.activity;\n\n\t\t// Hide all activity colored dots instead of checking each one\n\t\tvar elements = document.querySelectorAll(\"#chainMap .nodeActivity span\");\n\t\tfor (var i = 0, l = elements.length; i < l; ++i) {\n\t\t   elements[i].className = elements[i].className + \" invisible\";\n\t\t}\n\n\t\t// Loop through passed data and show dots by system\n\t\tvar elements = document.querySelectorAll(\"#chainMap [data-nodeid]\");\n\t\tfor (var i = 0, l = elements.length; i < l; ++i) {\n\t\t   var systemID = elements[i].getAttribute(\"data-nodeid\");\n\t\t   if (data[systemID]) {\n\t\t\t   var shipJumps = data[systemID].shipJumps;\n\t\t\t   var podKills = data[systemID].podKills;\n\t\t\t   var shipKills = data[systemID].shipKills;\n\t\t\t   var npcKills = data[systemID].npcKills;\n\t\t\t   var node = elements[i].getElementsByClassName(\"nodeActivity\")[0];\n\n\t\t\t   if (shipJumps > 0) {\n\t\t\t\t   var jumps = node.getElementsByClassName(\"jumps\")[0];\n\t\t\t\t   jumps.className = jumps.className.replace(/invisible/g, \"\");\n\t\t\t\t   jumps.setAttribute(\"data-tooltip\", shipJumps + \" Jumps\");\n\t\t\t   }\n\n\t\t\t   if (podKills > 0) {\n\t\t\t\t   var pods = node.getElementsByClassName(\"pods\")[0];\n\t\t\t\t   pods.className = pods.className.replace(/invisible/g, \"\");\n\t\t\t\t   pods.setAttribute(\"data-tooltip\", podKills + \" Pod Kills\");\n\t\t\t   }\n\n\t\t\t   if (shipKills > 0) {\n\t\t\t\t   var ships = node.getElementsByClassName(\"ships\")[0];\n\t\t\t\t   ships.className = ships.className.replace(/invisible/g, \"\");\n\t\t\t\t   ships.setAttribute(\"data-tooltip\", shipKills + \" Ship Kills\");\n\t\t\t   }\n\n\t\t\t   if (npcKills > 0) {\n\t\t\t\t   var npcs = node.getElementsByClassName(\"npcs\")[0];\n\t\t\t\t   npcs.className = npcs.className.replace(/invisible/g, \"\");\n\t\t\t\t   npcs.setAttribute(\"data-tooltip\", npcKills + \" NPC Kills\");\n\t\t\t   }\n\t\t   }\n\t\t}\n\n\t\tif (SystemActivityToolTips.attachedElements && SystemActivityToolTips.attachedElements.length > 0) {\n\t\t\tSystemActivityToolTips.detach($(\"#chainMap .whEffect\"));\n\t\t}\n\t\tSystemActivityToolTips.attach($(\"#chainMap .nodeActivity > span[data-tooltip]:not(.invisible)\"));\n\n\t\treturn data;\n\t}\n\n\tthis.occupied = function(data) {\n\t\t/*\tfunction for showing occupied icon  */\n\n\t\t// Hide all icons instead of checking each one\n\t\t$(\"#chainMap [data-icon='user'], #chainMap [data-icon='user'] + .badge\").addClass(\"invisible\");\n\n\t\t// Loop through passed data and show icons\n\t\tfor (var x in data) {\n\t\t\t$(\"#chainMap [data-nodeid='\"+data[x].systemID+\"'] [data-icon='user']\").removeClass(\"invisible\");\n\t\t\t$(\"#chainMap [data-nodeid='\"+data[x].systemID+\"'] [data-icon='user'] + .badge\").removeClass(\"invisible\").html(data[x].count);\n\t\t}\n\n\t\tOccupiedToolTips.attach($(\"#chainMap [data-icon='user']:not(.invisible)\"));\n\n\t\treturn data;\n\t}\n\n\tthis.flares = function(data) {\n\t\t/*\tfunction for coloring chain map nodes via flares  */\n\t\t//var data = typeof(data) !== \"undefined\" ? data : this.data.flares;\n\n\t\t// Remove all current node coloring instead of checking each one\n\t\t$(\"#chainMap td.node\").removeClass(\"redNode yellowNode greenNode\");\n\n\t\t// Remove all coloring from chain grid\n\t\t$(\"#chainGrid tr\").removeClass(\"red yellow green\");\n\n\t\t// Loop through passed data and add classes by system\n\t\tif (data) {\n\t\t\tfor (var x in data.flares) {\n\t\t\t\tvar systemID = data.flares[x].systemID;\n\t\t\t\tvar flare = data.flares[x].flare;\n\n\t\t\t\tvar row = ($(\"#chainMap [data-nodeid=\"+systemID+\"]\").parent().addClass(flare+\"Node\").parent().index() - 1) / 3 * 2;\n\n\t\t\t\tif (row > 0) {\n\t\t\t\t\t$(\"#chainGrid tr:eq(\"+row+\")\").addClass(flare).next().addClass(flare);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn data;\n\t}\n\n\tthis.grid = function() {\n\t\t/*  function for showing/hiding grid lines  */\n\t\t// This is an optional feature\n\t\tif (options.chain.gridlines == false) {\n\t\t\t$(\"#chainGrid tr\").addClass(\"hidden\");\n\t\t\treturn false;\n\t\t}\n\n\t\t$(\"#chainGrid tr\").removeClass(\"hidden\");\n\t\t//$(\"#chainGrid\").css(\"width\", \"100%\");\n\n\t\t// Calculate how many rows have systems, max 0 hack to prevent negative numbers, and rows above this number get hidden\n\t\tvar rows = Math.max(0, $(\".google-visualization-orgchart-table tr:has(.node)\").length * 2 - 1);\n\t\t$(\"#chainGrid tr:gt(\"+rows+\")\").addClass(\"hidden\");\n\t}\n\n\tthis.lines = function(data) {\n\t\t//var data = typeof(data) !== \"undefined\" ? data : this.data.lines;\n\n\t\tfunction drawNodeLine(system, parent, mode, signatureID) {\n\t\t\t/*\tfunction for drawing colored lines  */\n\n\t\t\t// Find node in chainmap\n\t\t\t//var $node = $(\"#chainMap [data-nodeid='\"+system+\"']\").parent();\n\t\t\tvar $node = $(\"#chainMap #node\"+system).parent();\n\n\t\t\tif ($node.length == 0) {\n\t\t\t\treturn false;\n\t\t\t}\n\n\t\t\t// Get node # in this line\n\t\t\tvar nodeIndex = Math.ceil(($node[0].cellIndex + 1) / 2 - 1);\n\n\t\t\t// applly to my top line\n\t\t\tvar $connector = $($node.parent().prev().children(\"td.google-visualization-orgchart-lineleft, td.google-visualization-orgchart-lineright\")[nodeIndex]).addClass(\"left-\"+mode+\" right-\"+mode);\n\t\t\t//var $connector = $($node.parent().prev().find(\"td:not([colspan])\")[nodeIndex]).addClass(\"left-\"+mode+\" right-\"+mode).attr(\"data-signatureid\", signatureID);\n\n\t\t\t// Find parent node\n\t\t\t//var $parent = $(\"#chainMap [data-nodeid='\"+parent+\"']\").parent();\n\t\t\tvar $parent = $(\"#chainMap #node\"+parent).parent();\n\n\t\t\tif ($parent.length == 0 || $connector.length == 0)\n\t\t\t\treturn false;\n\n\t\t\t// Find the col of my top line\n\t\t\tvar nodeCol = 0, connectorCell = $connector[0].cellIndex;\n\t\t\t$node.parent().prev().find(\"td\").each(function(index) {\n\t\t\t\tnodeCol += this.colSpan;\n\n\t\t\t\tif (index == connectorCell) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Get node # in this line\n\t\t\tvar parentIndex = Math.ceil(($parent[0].cellIndex + 1) / 2 - 1);\n\n\t\t\t// Compensate for non-parent nodes (slight performance hit ~10ms)\n\t\t\tvar newparentIndex = parentIndex;\n\t\t\tfor (var i = 0; i <= parentIndex; i++) {\n\t\t\t\tvar checkSystem = 0;//$node.parent().prev().prev().prev().find(\"td:has([data-nodeid]):eq(\"+i+\")\").find(\"[data-nodeid]\").data(\"nodeid\");\n\t\t\t\t$node.parent().prev().prev().prev().find(\"td > [data-nodeid]\").each(function(index) {\n\t\t\t\t\tif (index == i) {\n\t\t\t\t\t\tcheckSystem = $(this).attr(\"id\").replace(\"node\", \"\");//$(this).data(\"nodeid\");\n\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\tif ($.map(data.map.rows, function(node) { return node.c[1].v == checkSystem ? node : null; }).length <= 0) {\n\t\t\t\t\tnewparentIndex--;\n\t\t\t\t}\n\t\t\t}\n\t\t\tparentIndex = newparentIndex;\n\n\t\t\t// Apply to parent bottom line\n\t\t\tvar $connecte = $($node.parent().prev().prev().children(\"td.google-visualization-orgchart-lineleft, td.google-visualization-orgchart-lineright\")[parentIndex]).addClass(\"left-\"+mode+\" right-\"+mode);\n\t\t\t//var $connecte = $($node.parent().prev().prev().find(\"td:not([colspan])\")[parentIndex]).addClass(\"left-\"+mode+\" right-\"+mode).attr(\"data-signatureid\", signatureID);\n\n\t\t\t// the beans\n\t\t\tvar col = 0, parent = false, me = false;\n\t\t\t$node.parent().prev().prev().find(\"td\").each(function(index, value) {\n\t\t\t\tcol += this.colSpan;\n\n\t\t\t\tif (me && parent) {\n\t\t\t\t\t// All done - get outta here\n\t\t\t\t\treturn false;\n\t\t\t\t} else if (typeof($connecte[0]) != \"undefined\" && $connecte[0].cellIndex == index) {\n\t\t\t\t\tparent = true;\n\n\t\t\t\t\t$(this).addClass(\"left-\"+mode);\n\n\t\t\t\t\t// remove bottom border that points to the right\n\t\t\t\t\tif (!me && col != nodeCol) {\n\t\t\t\t\t\t$(this).addClass(\"bottom-\"+mode);\n\t\t\t\t\t}\n\n\t\t\t\t\t// parent and node are same - we are done\n\t\t\t\t\tif (nodeCol == col) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t} else if (col == nodeCol) {\n\t\t\t\t\tme = true;\n\n\t\t\t\t\t$(this).addClass(\"bottom-\"+mode);\n\t\t\t\t} else if (me || parent) {\n\t\t\t\t\tvar tempCol = 0, breaker = false, skip = false;\n\n\t\t\t\t\t$node.parent().prev().find(\"td\").each(function(index) {\n\t\t\t\t\t\ttempCol += this.colSpan;\n\n\t\t\t\t\t\tif (tempCol == col && ($(this).hasClass(\"google-visualization-orgchart-lineleft\") || $(this).hasClass(\"google-visualization-orgchart-lineright\"))) {\n\t\t\t\t\t\t\tif (parent == false) {\n\t\t\t\t\t\t\t\t// Stop looking cuz there is another node between us and parent\n\t\t\t\t\t\t\t\tbreaker = true;\n\t\t\t\t\t\t\t\t$connecte.removeClass(\"left-\"+mode+\" right-\"+mode);\n\n\t\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t\t} else if (parent == true) {\n\t\t\t\t\t\t\t\t// Lets make sure there isnt a node between the parent and me\n\t\t\t\t\t\t\t\t$connecte.removeClass(\"left-\"+mode+\" right-\"+mode);\n\n\t\t\t\t\t\t\t\t$node.parent().prev().prev().find(\"td\").each(function(index) {\n\t\t\t\t\t\t\t\t\tif (index >= $connecte[0].cellIndex) {\n\t\t\t\t\t\t\t\t\t\t// there is a node after parent but before me\n\t\t\t\t\t\t\t\t\t\t$(this).removeClass(\"bottom-\"+mode);\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tskip = true;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\tif (breaker) {\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\n\t\t\t\t\tif (!skip) {\n\t\t\t\t\t\t$(this).addClass(\"bottom-\"+mode);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\tfor (var x in data.lines) {\n\t\t\tdrawNodeLine(data.lines[x][0], data.lines[x][1], data.lines[x][2], data.lines[x][3]);\n\t\t}\n\t}\n\n\tthis.nodes = function(map) {\n\t\tvar chain = {cols: [{label: \"System\", type: \"string\"}, {label: \"Parent\", type: \"string\"}], rows: []};\n\t\tvar frigTypes = [\"Q003\", \"E004\", \"L005\", \"Z006\", \"M001\", \"C008\", \"G008\", \"A009\", \"SML\", \"MED\", \"LRG\", \"XLG\"];\n\t\tvar connections = [];\n\n\t\tfunction topLevel(systemID, id) {\n\t\t\tif (!systemID || !tripwire.systems[systemID])\n\t\t\t\treturn false;\n\n\t\t\t// System type switch\n\t\t\tvar systemType;\n\t\t\tif (tripwire.systems[systemID].class)\n\t\t\t\tsystemType = \"<span class='wh'>C\" + tripwire.systems[systemID].class + \"</span>\";\n\t\t\telse if (tripwire.systems[systemID].security >= 0.45)\n\t\t\t\tsystemType = \"<span class='hisec'>HS</span>\";\n\t\t\telse if (tripwire.systems[systemID].security > 0.0)\n\t\t\t\tsystemType = \"<span class='lowsec'>LS</span>\";\n\t\t\telse if (tripwire.systems[systemID].security <= 0.0)\n\t\t\t\tsystemType = \"<span class='nullsec'>NS</span>\";\n\n\t\t\tvar effectClass = null, effect = null;\n\t\t\tif (tripwire.systems[systemID].class) {\n\t\t\t\tswitch(tripwire.systems[systemID].effect) {\n\t\t\t\t\tcase \"Black Hole\":\n\t\t\t\t\t\teffectClass = \"blackhole\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Cataclysmic Variable\":\n\t\t\t\t\t\teffectClass = \"cataclysmic-variable\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Magnetar\":\n\t\t\t\t\t\teffectClass = \"magnetar\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Pulsar\":\n\t\t\t\t\t\teffectClass = \"pulsar\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Red Giant\":\n\t\t\t\t\t\teffectClass = \"red-giant\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Wolf-Rayet Star\":\n\t\t\t\t\t\teffectClass = \"wolf-rayet\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\teffect = tripwire.systems[systemID].effect;\n\t\t\t}\n\n\t\t\tvar system = {v: id};\n\t\t\tvar chainNode = \"<div id='node\"+id+\"' data-nodeid='\"+systemID+\"'>\"\n\t\t\t\t\t\t\t+\t\"<div class='nodeIcons'>\"\n\t\t\t\t\t\t\t+\t\t\"<div style='float: left;'>\"\n\t\t\t\t\t\t\t+\t\t\t\"<i class='whEffect' \"+(effectClass ? \"data-icon='\"+effectClass+\"' data-tooltip='\"+effect+\"'\" : null)+\"></i>\"\n\t\t\t\t\t\t\t+\t\t\"</div>\"\n\t\t\t\t\t\t\t+\t\t\"<div style='float: right;'>\"\n\t\t\t\t\t\t\t+\t\t\t\"<i data-icon='user' class='invisible'></i>\"\n\t\t\t\t\t\t\t+\t\t\t\"<span class='badge invisible'></span>\"\n\t\t\t\t\t\t\t+\t\t\"</div>\"\n\t\t\t\t\t\t\t+\t\"</div>\"\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeClass'>\"+systemType+\"</h4>\"\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeSystem'>\"\n\t\t\t\t\t\t\t+\t\t\"<a href='.?system=\"+tripwire.systems[systemID].name+\"'>\"+(options.chain.tabs[options.chain.active] && options.chain.tabs[options.chain.active].systemID != 0 ? options.chain.tabs[options.chain.active].name : tripwire.systems[systemID].name)+\"</a>\"\n\t\t\t\t\t\t\t+\t\"</h4>\"\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeType'>&nbsp;</h4>\"\n\t\t\t\t\t\t\t+\t\"<div class='nodeActivity'>\"\n\t\t\t\t\t\t\t+\t\t\"<span class='jumps invisible'>&#9679;</span>&nbsp;<span class='pods invisible'>&#9679;</span>&nbsp;&nbsp;<span class='ships invisible'>&#9679;</span>&nbsp;<span class='npcs invisible'>&#9679;</span>\"\n\t\t\t\t\t\t\t+\t\"</div>\"\n\t\t\t\t\t\t\t+\"</div>\"\n\n\t\t\tsystem.f = chainNode;\n\n\t\t\treturn system;\n\t\t}\n\t\t\n\t\tfunction makeCalcChildNode(childID, node, targetSystem) {\n\t\t\tvar path = guidance.findShortestPath(tripwire.map.shortest, [targetSystem - 30000000, node.child.systemID - 30000000]);\n\t\t\t\n\t\t\tvar calcNode = {};\n\t\t\tcalcNode.life = \"Gate\";\n\t\t\tcalcNode.parent = {};\n\t\t\tcalcNode.parent.id = node.child.id;\n\t\t\tcalcNode.parent.systemID = node.child.systemID;\n\t\t\tcalcNode.parent.name = node.child.name;\n\t\t\tcalcNode.parent.type = node.child.type;\n\t\t\tcalcNode.parent.nth = node.child.nth;\n\n\t\t\tcalcNode.child = {};\n\t\t\tcalcNode.child.id = ++childID;\n\t\t\tcalcNode.child.systemID = targetSystem;\n\t\t\tcalcNode.child.name = tripwire.systems[targetSystem].name;\n\t\t\tcalcNode.child.path = path;\n\t\t\tcalcNode.child.jumps = path.length - 1;\n\t\t\tcalcNode.child.nth = null;\t\t\t\n\t\t\t\n\t\t\treturn { childID, calcNode };\n\t\t}\n\n\t\tfunction findLinks(system) {\n\t\t\tif (system[0] <= 0) return false;\n\n\t\t\tvar parentID = parseInt(system[1]), childID = chainList.length;\n\n\t\t\tfor (var x in chainData) {\n\t\t\t\tvar wormhole = chainData[x];\t\t\t\t\n\t\t\t\tif ($.inArray(wormhole.id, usedLinks) == -1) {\n\t\t\t\t\tvar sig1, sig2, sig1Type, sig2Type,\n\t\t\t\t\t\tparent, child, parentType, childType;\n\t\t\t\t\tif (wormhole.parent == \"secondary\") {\n\t\t\t\t\t\tsig1 = tripwire.client.signatures[wormhole.secondaryID];\n\t\t\t\t\t\tsig2 = tripwire.client.signatures[wormhole.initialID];\n\t\t\t\t\t} else {\n\t\t\t\t\t\tsig1 = tripwire.client.signatures[wormhole.initialID];\n\t\t\t\t\t\tsig2 = tripwire.client.signatures[wormhole.secondaryID];\n\t\t\t\t\t}\n\t\t\t\t\tsig1Type = wormhole.type; sig2Type = 'K162';\n\t\t\t\t\t\n\t\t\t\t\tif (sig1 && sig1.systemID == system[0]) {\n\t\t\t\t\t\tparent = sig1; child = sig2;\n\t\t\t\t\t\tparentType = sig2Type; childType = sig1Type;\n\t\t\t\t\t} else if(sig2 && sig2.systemID == system[0]) {\n\t\t\t\t\t\tparent = sig2; child = sig1;\n\t\t\t\t\t\tchildType = sig2Type; parentType = sig1Type;\n\t\t\t\t\t} else { continue; }\n\t\t\t\t\t\n\t\t\t\t\tvar node = {};\n\t\t\t\t\tnode.id = wormhole.id;\n\t\t\t\t\tnode.life = wormhole.life;\n\t\t\t\t\tnode.mass = wormhole.mass;\n\t\t\t\t\tnode.time = parent.modifiedTime;\n\n\t\t\t\t\tnode.parent = {};\n\t\t\t\t\tnode.parent.id = parentID;\n\t\t\t\t\tnode.parent.systemID = tripwire.systems[parent.systemID] ? parent.systemID : parent.systemID + \"|\" + Math.floor(Math.random() * Math.floor(10000));\n\t\t\t\t\tnode.parent.name = parent.name;\n\t\t\t\t\tnode.parent.type = parentType;\n\t\t\t\t\tnode.parent.typeBM = null;\n\t\t\t\t\tnode.parent.classBM = null;\n\t\t\t\t\tnode.parent.nth = null;\n\t\t\t\t\tnode.parent.signatureID = child.signatureID;\n\n\t\t\t\t\tnode.child = {};\n\t\t\t\t\tnode.child.id = ++childID;\n\t\t\t\t\tnode.child.systemID = tripwire.systems[child.systemID] ? child.systemID : child.systemID + \"|\" + Math.floor(Math.random() * Math.floor(10000));\n\t\t\t\t\tnode.child.name = child.name;\n\t\t\t\t\tnode.child.type = childType;\n\t\t\t\t\tnode.child.typeBM = null;\n\t\t\t\t\tnode.child.classBM = null;\n\t\t\t\t\tnode.child.nth = null;\n\t\t\t\t\tnode.child.signatureID = parent.signatureID;\n\n\t\t\t\t\tchainLinks.push(node);\n\t\t\t\t\tchainList.push([node.child.systemID, node.child.id, system[2]]);\n\t\t\t\t\tusedLinks.push(node.id);\n\t\t\t\t\t// usedLinks[system[2]].push(node.id);\n\n\t\t\t\t\tif ($(\"#show-viewing\").hasClass(\"active\") && tripwire.systems[node.child.systemID] && !tripwire.systems[viewingSystemID].class && !tripwire.systems[node.child.systemID].class) {\n\t\t\t\t\t\tvar calcNode = makeCalcChildNode(childID, node, viewingSystemID);\n\t\t\t\t\t\tchildID = calcNode.childID;\n\n\t\t\t\t\t\tchainLinks.push(calcNode.calcNode);\n\t\t\t\t\t\tchainList.push([0, childID]);\n\t\t\t\t\t}\n\n\t\t\t\t\tif ($(\"#show-favorite\").hasClass(\"active\") && tripwire.systems[node.child.systemID]) {\n\t\t\t\t\t\tfor (x in options.favorites) {\n\t\t\t\t\t\t\tif (tripwire.systems[options.favorites[x]].regionID >= 11000000 || tripwire.systems[node.child.systemID].regionID >= 11000000)\n\t\t\t\t\t\t\t\tcontinue;\n\n\t\t\t\t\t\t\tvar calcNode = makeCalcChildNode(childID, node, options.favorites[x]);\n\t\t\t\t\t\t\tchildID = calcNode.childID;\n\n\t\t\t\t\t\t\tchainLinks.push(calcNode.calcNode);\n\t\t\t\t\t\t\tchainList.push([0, childID]);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t\n\t\tfunction renderPath(path) {\n\t\t\tif(path.length <= 1 || path.length > options.chain.routingLimit) { return '' + path.length - 1; }\n\t\t\telse {\n\t\t\t\tvar systemMarkup = path\n\t\t\t\t.slice(0, path.length - 1).reverse()\n\t\t\t\t.map(s => {\n\t\t\t\t\tvar system = appData.systems[30000000 + 1 * s];\n\t\t\t\t\tvar securityClass = system.security >= 0.45 ? 'hisec' :\n\t\t\t\t\t\tsystem.security >= 0.0 ? 'lowsec' :\n\t\t\t\t\t\t'nullsec';\n\t\t\t\t\treturn '<span class=\"' + securityClass + '\" data-tooltip=\"' + system.name + ' (' + system.security + ')\">&#x25a0</span>';\n\t\t\t\t});\n\t\t\t\tvar r = '<span class=\"path\">';\n\t\t\t\tfor(var i = 0; i < systemMarkup.length; i++) {\n\t\t\t\t\tif(i > 0 && 0 == i % 5) { r += '|'; }\n\t\t\t\t\t\n\t\t\t\t\tr += systemMarkup[i];\t\t\t\t \n\t\t\t\t}\n\t\t\t\treturn r + '</span>';\n\t\t\t}\n\t\t}\n\n\t\tif ($(\"#chainTabs .current\").length > 0) {\n\t\t\tvar systems = $(\"#chainTabs .current .name\").data(\"tab\").toString().split(\",\");\n\t\t\tvar chainList = [];\n\t\t\tvar chainData = map;\n\t\t\tvar chainLinks = [];\n\t\t\tvar usedLinks = [];\n\n\t\t\tif (systems == 0) {\n                                let i = 0;\n                                Object.keys(map).slice()/*.reverse()*/.forEach(x => {\n\t\t\t\t        const parent = tripwire.client.signatures[map[x].initialID];\n\t\t\t\t        const child = tripwire.client.signatures[map[x].secondaryID];\n                                        if (parent && tripwire.systems[parent.systemID] && typeof(tripwire.systems[parent.systemID].class) == \"undefined\") {\n\t\t\t\t\t\ti++;\n\t\t\t\t\t\t// usedLinks[parent.systemID] = [];\n\t\t\t\t\t\tchain.rows.push({c: [topLevel(parent.systemID, i), {v: null}]});\n\t\t\t\t\t\tchainList.push([parent.systemID, i, parent.systemID]);\n                                        } else if (child && tripwire.systems[child.systemID] && typeof(tripwire.systems[child.systemID].class) == \"undefined\") {\n\t\t\t\t  \t        i++;\n\t\t\t\t  \t\t// usedLinks[child.systemID] = [];\n\t\t\t\t\t\tchain.rows.push({c: [topLevel(child.systemID, i), {v: null}]});\n\t\t\t\t\t\tchainList.push([child.systemID, i, child.systemID]);\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tfor (var x in systems) {\n\t\t\t\t\t// usedLinks[systems[x]] = [];\n\t\t\t\t\tchain.rows.push({c: [topLevel(systems[x], parseInt(x) + 1), {v: null}]});\n\t\t\t\t\tchainList.push([systems[x], parseInt(x) + 1, systems[x]]);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfor (var i = 0; i < chainList.length; i++) {\n\t\t\t\tfindLinks(chainList[i]);\n\t\t\t}\n\t\t} else {\n\t\t\t$(\"#chainError\").hide();\n\n\t\t\tvar row = {c: []};\n\t\t\tvar systemID = viewingSystemID;\n\n\t\t\trow.c.push(topLevel(systemID, 1), {v: null});\n\n\t\t\tchain.rows.push(row);\n\n\t\t\tvar chainList = [[systemID, 1]];\n\t\t\tvar chainData = map;\n\t\t\tvar chainLinks = [];\n\t\t\tvar usedLinks = [];\n\n\t\t\tfor (var i = 0; i < chainList.length; ++i) {\n\t\t\t\tfindLinks(chainList[i]);\n\t\t\t}\n\t\t}\n\n\t\tfor (var x in chainLinks) {\n\t\t\tvar node = chainLinks[x];\n\t\t\tvar row = {c: []};\n\n\t\t\t// System type switch\n\t\t\tvar systemType;\n\t\t\tvar nodeClass = tripwire.systems[node.child.systemID] ? tripwire.systems[node.child.systemID].class : null;\n\t\t\tvar nodeSecurity = tripwire.systems[node.child.systemID] ? tripwire.systems[node.child.systemID].security : null;\n\t\t\tvar leadsToPointer = typeof(node.child.systemID) === \"string\" && node.child.systemID.indexOf(\"|\") >= 0 ? tripwire.aSigSystems[node.child.systemID.substring(0, node.child.systemID.indexOf(\"|\"))] : null;\n\t\t\tif (nodeClass == 6 || leadsToPointer == \"Class-6\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"Class 6\"))\n\t\t\t\tsystemType = \"<span class='wh'>C6</span>\";\n\t\t\telse if (nodeClass == 5 || leadsToPointer == \"Class-5\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"Class 5\"))\n\t\t\t\tsystemType = \"<span class='wh'>C5</span>\";\n\t\t\telse if (nodeClass == 4 || leadsToPointer == \"Class-4\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"Class 4\"))\n\t\t\t\tsystemType = \"<span class='wh'>C4</span>\";\n\t\t\telse if (nodeClass == 3 || leadsToPointer == \"Class-3\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"Class 3\"))\n\t\t\t\tsystemType = \"<span class='wh'>C3</span>\";\n\t\t\telse if (nodeClass == 2 || leadsToPointer == \"Class-2\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"Class 2\"))\n\t\t\t\tsystemType = \"<span class='wh'>C2</span>\";\n\t\t\telse if (nodeClass == 1 || leadsToPointer == \"Class-1\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"Class 1\"))\n\t\t\t\tsystemType = \"<span class='wh'>C1</span>\";\n\t\t\telse if (nodeClass > 6)\n\t\t\t\tsystemType = \"<span class='wh'>C\" + nodeClass + \"</span>\";\n\t\t\telse if (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo.split(\" \").length > 1)\n\t\t\t\tsystemType = \"<span class='wh'>C\" + tripwire.wormholes[node.child.type].leadsTo.split(\" \")[1] + \"</span>\";\n\t\t\telse if (nodeSecurity >= 0.45 || leadsToPointer == \"High-Sec\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"High-Sec\" && !nodeSecurity))\n\t\t\t\tsystemType = \"<span class='hisec'>HS</span>\";\n\t\t\telse if (nodeSecurity > 0.0 || leadsToPointer == \"Low-Sec\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"Low-Sec\" && !nodeSecurity))\n\t\t\t\tsystemType = \"<span class='lowsec'>LS</span>\";\n\t\t\telse if ((nodeSecurity <= 0.0 && nodeSecurity != null) || leadsToPointer == \"Null-Sec\" || (typeof(tripwire.wormholes[node.child.type]) != \"undefined\" && tripwire.wormholes[node.child.type].leadsTo == \"Null-Sec\"))\n\t\t\t\tsystemType = \"<span class='nullsec'>NS</span>\";\n\t\t\telse\n\t\t\t\tsystemType = \"<span>&nbsp;</span>\";\n\n\t\t\tvar effectClass = null, effect = null;\n\t\t\tif (typeof(tripwire.systems[node.child.systemID]) != \"undefined\") {\n\t\t\t\tswitch(tripwire.systems[node.child.systemID].effect) {\n\t\t\t\t\tcase \"Black Hole\":\n\t\t\t\t\t\teffectClass = \"blackhole\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Cataclysmic Variable\":\n\t\t\t\t\t\teffectClass = \"cataclysmic-variable\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Magnetar\":\n\t\t\t\t\t\teffectClass = \"magnetar\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Pulsar\":\n\t\t\t\t\t\teffectClass = \"pulsar\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Red Giant\":\n\t\t\t\t\t\teffectClass = \"red-giant\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"Wolf-Rayet Star\":\n\t\t\t\t\t\teffectClass = \"wolf-rayet\";\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\teffectClass = null;\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\n\t\t\t\teffect = tripwire.systems[node.child.systemID].effect;\n\t\t\t}\n\n\t\t\tvar child = {v: node.child.id};\n\t\t\tvar chainNode = \"<div id='node\"+node.child.id+\"' data-nodeid='\"+node.child.systemID+\"' data-sigid='\"+node.id+\"'>\"\n\t\t\t\t\t\t\t+\t\"<div class='nodeIcons'>\"\n\t\t\t\t\t\t\t+\t\t\"<div style='float: left;'>\"\n\t\t\t\t\t\t\t+\t\t\t\"<i class='whEffect' \"+(effectClass ? \"data-icon='\"+effectClass+\"' data-tooltip='\"+effect+\"'\" : null)+\"></i>\"\n\t\t\t\t\t\t\t+\t\t\"</div>\"\n\t\t\t\t\t\t\t+\t\t\"<div style='float: right;'>\"\n\t\t\t\t\t\t\t+\t\t\t\"<i data-icon='user' class='invisible'></i>\"\n\t\t\t\t\t\t\t+\t\t\t\"<span class='badge invisible'></span>\"\n\t\t\t\t\t\t\t+\t\t\"</div>\"\n\t\t\t\t\t\t\t+\t\"</div>\"\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeClass'>\"+(systemType + sigFormat(node.child.classBM, \"class\"))+\"</h4>\"\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeSystem'>\"\n\t\t\t\t\t\t\t+ \t(tripwire.systems[node.child.systemID] ? \"<a href='.?system=\"+tripwire.systems[node.child.systemID].name+\"'>\"+(node.parent.name ? node.parent.name : tripwire.systems[node.child.systemID].name)+\"</a>\" : (node.parent.name ? node.parent.name : \"<a class='invisible'>system</a>\"))\n\t\t\t\t\t\t\t+\t\"</h4>\"\n\t\t\t\t\t\t\t+\t(node.child.path ? \"<h4 class='nodeType'>\" + renderPath(node.child.path) + \"</h4>\" : (\"<h4 class='nodeType'>\"+(options.chain[\"node-reference\"] == \"id\" ? (node.child.signatureID ? node.child.signatureID.substring(0, 3) : \"&nbsp;\") : (node.child.type || \"&nbsp;\") + sigFormat(node.child.typeBM, \"type\") || \"&nbsp;\")+\"</h4>\"))\n\t\t\t\t\t\t\t+\t\"<div class='nodeActivity'>\"\n\t\t\t\t\t\t\t+\t\t\"<span class='jumps invisible'>&#9679;</span>&nbsp;<span class='pods invisible'>&#9679;</span>&nbsp;&nbsp;<span class='ships invisible'>&#9679;</span>&nbsp;<span class='npcs invisible'>&#9679;</span>\"\n\t\t\t\t\t\t\t+\t\"</div>\"\n\t\t\t\t\t\t\t+\"</div>\"\n\n\t\t\tchild.f = chainNode;\n\n\t\t\tvar parent = {v: node.parent.id};\n\n\t\t\trow.c.push(child, parent);\n\t\t\tchain.rows.push(row);\n\n\t\t\tif (node.life == \"critical\" && ($.inArray(node.parent.type, frigTypes) != -1 || $.inArray(node.child.type, frigTypes) != -1))\n\t\t\t\tconnections.push(Array(child.v, parent.v, \"eol-frig\", node.id));\n\t\t\telse if (node.life == \"critical\" && node.mass == \"critical\")\n\t\t\t\tconnections.push(Array(child.v, parent.v, \"eol-critical\", node.id));\n\t\t\telse if (node.life == \"critical\" && node.mass == \"destab\")\n\t\t\t\tconnections.push(Array(child.v, parent.v, \"eol-destab\", node.id));\n\t\t\telse if ($.inArray(node.parent.type, frigTypes) != -1 || $.inArray(node.child.type, frigTypes) != -1)\n\t\t\t\tconnections.push(Array(child.v, parent.v, \"frig\", node.id));\n\t\t\telse if (node.life == \"critical\")\n\t\t\t\tconnections.push(Array(child.v, parent.v, \"eol\", node.id));\n\t\t\telse if (node.mass == \"critical\")\n\t\t\t\tconnections.push(Array(child.v, parent.v, \"critical\", node.id));\n\t\t\telse if (node.mass == \"destab\")\n\t\t\t\tconnections.push(Array(child.v, parent.v, \"destab\", node.id));\n\t\t\telse if (node.life == \"Gate\" || node.parent.type == \"GATE\" || node.child.type == \"GATE\")\n\t\t\t\tconnections.push(Array(child.v, parent.v, \"gate\", node.id));\n\t\t\t//else\n\t\t\t//\tconnections.push(Array(child.v, parent.v, \"\", node.id));\n\t\t}\n\n\t\t// Apply critical/destab line colors\n\t\tconnections.reverse(); // so we apply to outer systems first\n\n\t\t//this.data.map = chain;\n\t\t//this.data.lines = connections;\n\t\treturn {\"map\": chain, \"lines\": connections};\n\t}\n\n\tthis.redraw = function() {\n\t\tvar data = $.extend(true, {}, this.data);\n\t\tdata.map = $.extend(true, {}, data.rawMap);\n\n\t\tthis.draw(data);\n\t}\n\n\tthis.draw = function(data) {\n\t\tvar data = typeof(data) !== \"undefined\" ? data : {};\n\n\t\t// We need to make sure Google chart is ready and we have signature data for this system before we begin, otherwise delay\n\t\tif (!this.map || (Object.size(data.map) && !tripwire.client.signatures)) {\n\t\t\tsetTimeout(() => chain.draw(data), 100);\n\t\t\treturn;\n\t\t}\n\n\t\tif (data.map) {\n\t\t\tthis.drawing = true;\n\n\t\t\tthis.data.rawMap = $.extend(true, {}, data.map);\n\n\t\t\t// if (options.chain.active == null || (options.chain.tabs[options.chain.active] && options.chain.tabs[options.chain.active].evescout == false)) {\n\t\t\t// \tif (options.masks.active != \"273.0\") {\n\t\t\t// \t\tfor (var i in data.map) {\n\t\t\t// \t\t\tif (data.map[i].mask == \"273.0\") {\n\t\t\t// \t\t\t\tdelete data.map[i];\n\t\t\t// \t\t\t}\n\t\t\t// \t\t}\n\t\t\t// \t}\n\t\t\t// }\n\n\t\t\t// Sort so we keep the chain map order the same\n\t\t\tObject.sort(data.map, \"id\");\n\n\t\t\t$.extend(data, this.nodes(data.map)); // 250ms -> <100ms\n\t\t\t$.extend(this.data, data);\n\t\t\tthis.map.draw(this.newView(data.map), this.options); // 150ms\n\n\t\t\tif (options.chain.tabs[options.chain.active]) {\n\t\t\t\tfor (var x in options.chain.tabs[options.chain.active].collapsed) {\n\t\t\t\t\tvar node = $(\"#chainMap [data-nodeid='\"+options.chain.tabs[options.chain.active].collapsed[x]+\"']\").attr(\"id\");\n\n\t\t\t\t\tif (node) {\n\t\t\t\t\t\tnode = node.split(\"node\")[1];\n\t\t\t\t\t\tthis.map.collapse(node - 1, true);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tthis.lines(data); // 300ms\n\t\t\tthis.grid(); // 4ms\n\n\t\t\t// Apply current system style\n\t\t\t$(\"#chainMap [data-nodeid='\"+viewingSystemID+\"']\").parent().addClass(\"currentNode\"); // 0.1ms\n\n\t\t\t// Remove old system effect tooltips and add current ones\n\t\t\tif (WormholeTypeToolTips.attachedElements && WormholeTypeToolTips.attachedElements.length > 0) {\n\t\t\t\tWormholeTypeToolTips.detach($(\"#chainMap .whEffect\"));\n\t\t\t}\n\t\t\tWormholeTypeToolTips.attach($(\"#chainMap .whEffect[data-icon]\")); // 0.30ms\n\t\t\tWormholeRouteToolTips.attach($(\".path span[data-tooltip]\"));\n\n\t\t\tthis.drawing = false;\n\t\t}\n\n\t\t// Gather latest system activity\n\t\tif (!this.data.activity || new Date() > this.data.activity.expires) {\n\t\t\tdata.activity = {};\n\t\t\ttripwire.esi.universeJumps()\n\t\t\t\t.done(function(results, status, request) {\n\t\t\t\t\tdata.activity.expires = new Date(request.getResponseHeader(\"expires\"));\n\t\t\t\t\t$.each(results, function(x) {\n\t\t\t\t\t\tdata.activity[results[x].system_id] = {\n\t\t\t\t\t\t\tsystemID: results[x].system_id,\n\t\t\t\t\t\t\tshipJumps: results[x].ship_jumps\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.then(function() {\n\t\t\t\t\t return tripwire.esi.universeKills()\n\t\t\t\t\t\t.done(function(results) {\n\t\t\t\t\t\t\t$.each(results, function(x) {\n\t\t\t\t\t\t\t\tif (data.activity[results[x].system_id]) {\n\t\t\t\t\t\t\t\t\tdata.activity[results[x].system_id].podKills = results[x].pod_kills;\n\t\t\t\t\t\t\t\t\tdata.activity[results[x].system_id].shipKills = results[x].ship_kills;\n\t\t\t\t\t\t\t\t\tdata.activity[results[x].system_id].npcKills = results[x].npc_kills;\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tdata.activity[results[x].system_id] = {\n\t\t\t\t\t\t\t\t\t\tsystemID: results[x].system_id,\n\t\t\t\t\t\t\t\t\t\tpodKills: results[x].pod_kills,\n\t\t\t\t\t\t\t\t\t\tshipKills: results[x].ship_kills,\n\t\t\t\t\t\t\t\t\t\tnpcKills: results[x].npc_kills,\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.then(function() {\n\t\t\t\t\tchain.data.activity = chain.activity(data.activity);\n\t\t\t\t});\n\t\t} else if (data.map) {\n\t\t\tchain.activity(this.data.activity);\n\t\t}\n\n\t\tif (data.occupied) { // 3ms\n\t\t\tthis.data.occupied = this.occupied(data.occupied);\n\t\t}\n\n\t\tif (data.flares) { // 20ms\n\t\t\tthis.data.flares = this.flares(data.flares);\n\t\t}\n\t}\n\n\tthis.collapse = function(c) {\n\t\tif (chain.drawing) return false;\n\n\t\tif (options.chain.tabs[options.chain.active]) {\n\t\t\tvar collapsed = chain.map.getCollapsedNodes();\n\t\t\toptions.chain.tabs[options.chain.active].collapsed = [];\n\t\t\tfor (x in collapsed) {\n\t\t\t\tvar systemID = $(\"#chainMap #node\"+(collapsed[x] +1)).data(\"nodeid\");\n\t\t\t\toptions.chain.tabs[options.chain.active].collapsed.push(systemID);\n\t\t\t}\n\t\t}\n\n\t\tchain.lines(chain.data);\n\n\t\t// Apply current system style\n\t\t$(\"#chainMap [data-nodeid='\"+viewingSystemID+\"']\").parent().addClass(\"currentNode\");\n\n\t\tif (WormholeTypeToolTips.attachedElements && WormholeTypeToolTips.attachedElements.length > 0) {\n\t\t\tWormholeTypeToolTips.detach($(\"#chainMap .whEffect\"));\n\t\t}\n\t\tWormholeTypeToolTips.attach($(\"#chainMap .whEffect[data-icon]\"));\n\n\t\tchain.activity(chain.data.activity);\n\n\t\tchain.occupied(chain.data.occupied);\n\n\t\tchain.flares(chain.data.flares);\n\n\t\tchain.grid();\n\n\t\toptions.save();\n\t}\n\n\tthis.init = function() {\n\t\tchain.map = new google.visualization.OrgChart(document.getElementById(\"chainMap\"));\n\t\tchain.options = {allowHtml: true, allowCollapse: true, size: \"medium\", nodeClass: \"node\"};\n\n\t\tgoogle.visualization.events.addListener(chain.map, \"collapse\", chain.collapse);\n\n\t\tchain.map.draw(new google.visualization.DataView(new google.visualization.DataTable({cols:[{label: \"System\", type: \"string\"}, {label: \"Parent\", type: \"string\"}]})), this.options);\n\t}\n\n\tgoogle.charts.setOnLoadCallback(this.init);\n}\n","var CKConfig = {\n\tskin: \"custom\",\n\theight: 100,\n\tallowedContent: true,\n\textraPlugins: \"toolbarswitch,autogrow,autolink\",\n\tenterMode: CKEDITOR.ENTER_BR,\n\tremoveDialogTabs: 'link:advanced',\n\tautoGrow_onStartup: true,\n\tautoGrow_minHeight: 100,\n\ttoolbar_minToolbar: [\n\t\t{name: \"basicstyles\", items: [\"Bold\", \"Italic\", \"Underline\", \"Strike\"]},\n\t\t{name: \"paragraph\", items: [\"BulletedList\", \"Outdent\", \"Indent\"]},\n\t\t{name: \"links\", items: [\"Link\"]},\n\t\t{name: \"colors\", items: [\"TextColor\", \"BGColor\"]},\n\t\t{name: \"styles\", items: [\"FontSize\"]},\n\t\t{name: \"tools\", items: [\"Toolbarswitch\"]}\n\t],\n\ttoolbar_maxToolbar: [\n\t\t{name: \"basicstyles\", items: [\"Bold\", \"Italic\", \"Underline\", \"Strike\", \"Subscript\", \"Superscript\"]},\n\t\t{name: \"paragraph\", items: [\"NumberedList\", \"BulletedList\", \"Outdent\", \"Indent\"]},\n\t\t{name: \"links\", items: [\"Link\"]},\n\t\t{name: \"colors\", items: [\"TextColor\", \"BGColor\"]},\n\t\t{name: \"styles\", items: [\"FontSize\", \"Font\"]},\n\t\t{name: \"tools\", items: [\"Source\", \"Toolbarswitch\"]}\n\t],\n\ttoolbar: \"minToolbar\",\n\tsmallToolbar: \"minToolbar\",\n\tmaximizedToolbar: \"maxToolbar\",\n\tfontSize_style: {\n\t    element:        'span',\n\t    styles:         { 'font-size': '#(size)' },\n\t    overrides:      [ { element :'font', attributes: { 'size': null } } ]\n\t}\n}\n\nCKEDITOR.on(\"instanceLoaded\", function(cke) {\n\tcke.editor.on(\"contentDom\", function() {\n\t\tcke.editor.on(\"key\", function(e) {\n\t\t\tif (e.data.keyCode == 27) {\n\t\t\t\t// escape key cancels\n\t\t\t\t$(cke.editor.element.$).closest(\".comment\").find(\".commentCancel\").click();\n\t\t\t\treturn false;\n\t\t\t} else if (e.data.domEvent.$.altKey && e.data.domEvent.$.keyCode == 83) {\n\t\t\t\t// alt+s saves\n\t\t\t\t$(cke.editor.element.$).closest(\".comment\").find(\".commentSave\").click();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t});\n\n\t$(\".cke_combo__font a\")\n\t\t.removeClass(\"cke_combo_button\")\n\t\t.addClass(\"cke_button cke_button_off\")\n\t\t.html('<span class=\"cke_button_icon\">&nbsp;</span>')\n\n\t$(\".cke_combo__fontsize a\")\n\t\t.removeClass(\"cke_combo_button\")\n\t\t.addClass(\"cke_button cke_button_off\")\n\t\t.html('<span class=\"cke_button_icon\">&nbsp;</span>')\n});\n\nCKEDITOR.on(\"instanceReady\", function(cke) {\n\t// ensure focus on init\n\tcke.editor.focus();\n\n\tvar s = cke.editor.getSelection(); // getting selection\n\tvar selected_ranges = s.getRanges(); // getting ranges\n\tvar node = selected_ranges[0].startContainer; // selecting the starting node\n\tvar parents = node.getParents(true);\n\n\tnode = parents[parents.length - 2].getFirst();\n\n\tif (!node) return false;\n\n\twhile (true) {\n\t\tvar x = node.getNext();\n\t\tif (x == null) {\n\t\t\tbreak;\n\t\t}\n\t\tnode = x;\n\t}\n\n\ts.selectElement(node);\n\tselected_ranges = s.getRanges();\n\tselected_ranges[0].collapse(false);  //  false collapses the range to the end of the selected node, true before the node.\n\ts.selectRanges(selected_ranges);  // putting the current selection there\n});\n\nCKEDITOR.on(\"dialogDefinition\", function(ev) {\n\tif (ev.data.name == 'link') {\n\t\tev.data.definition.getContents('target').get('linkTargetType')['default'] = '_blank';\n\t}\n});\n","var guidance = (function (undefined) {\n\n\tvar extractKeys = function (obj) {\n\t\tvar keys = [];\n\n\t\tfor (var key in obj) {\n\t\t    Object.prototype.hasOwnProperty.call(obj,key) && keys.push(key);\n\t\t}\n\n\t\treturn keys;\n\t}\n\n\tvar sorter = function (a, b) {\n\t\treturn parseFloat (a) - parseFloat (b);\n\t}\n\n\tvar findPaths = function (map, start, end, infinity) {\n\t\tinfinity = infinity || Infinity;\n\n\t\tvar costs = {},\n\t\t    open = {'0': [start]},\n\t\t    predecessors = {},\n\t\t    keys;\n\n\t\tvar addToOpen = function (cost, vertex) {\n\t\t\tvar key = \"\" + cost;\n\t\t\tif (!open[key]) open[key] = [];\n\t\t\topen[key].push(vertex);\n\t\t}\n\n\t\tcosts[start] = 0;\n\n\t\twhile (open && !costs[end]) {\n\t\t\tif(!(keys = extractKeys(open)).length) break;\n\n\t\t\tkeys.sort(sorter);\n\n\t\t\tvar key = keys[0],\n\t\t\t    bucket = open[key],\n\t\t\t    node = bucket.shift(),\n\t\t\t    currentCost = parseFloat(key),\n\t\t\t    adjacentNodes = map[node] || {};\n\n\t\t\tif (!bucket.length) delete open[key];\n\n\t\t\tfor (var vertex in adjacentNodes) {\n\t\t\t    if (Object.prototype.hasOwnProperty.call(adjacentNodes, vertex)) {\n\t\t\t\t\tvar cost = adjacentNodes[vertex],\n\t\t\t\t\t    totalCost = cost + currentCost,\n\t\t\t\t\t    vertexCost = costs[vertex];\n\n\t\t\t\t\tif ((vertexCost === undefined) || (vertexCost > totalCost)) {\n\t\t\t\t\t\tcosts[vertex] = totalCost;\n\t\t\t\t\t\taddToOpen(totalCost, vertex);\n\t\t\t\t\t\tpredecessors[vertex] = node;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tif (costs[end] === undefined) {\n\t\t\treturn null;\n\t\t} else {\n\t\t\treturn predecessors;\n\t\t}\n\n\t}\n\n\tvar extractShortest = function (predecessors, end) {\n\t\tvar nodes = [],\n\t\t    u = end;\n\n\t\twhile (u) {\n\t\t\tnodes.push(u);\n\t\t\tpredecessor = predecessors[u];\n\t\t\tu = predecessors[u];\n\t\t}\n\n\t\tnodes.reverse();\n\t\treturn nodes;\n\t}\n\n\tvar findShortestPath = function (map, nodes) {\n\t\tvar start = nodes.shift(),\n\t\t    end,\n\t\t    predecessors,\n\t\t    path = [],\n\t\t    shortest;\n\n\t\twhile (nodes.length) {\n\t\t\tend = nodes.shift();\n\t\t\tpredecessors = findPaths(map, start, end);\n\n\t\t\tif (predecessors) {\n\t\t\t\tshortest = extractShortest(predecessors, end);\n\t\t\t\tif (nodes.length) {\n\t\t\t\t\tpath.push.apply(path, shortest.slice(0, -1));\n\t\t\t\t} else {\n\t\t\t\t\treturn path.concat(shortest);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\treturn null;\n\t\t\t}\n\n\t\t\tstart = end;\n\t\t}\n\t}\n\n\tvar toArray = function (list, offset) {\n\t\ttry {\n\t\t\treturn Array.prototype.slice.call(list, offset);\n\t\t} catch (e) {\n\t\t\tvar a = [];\n\t\t\tfor (var i = offset || 0, l = list.length; i < l; ++i) {\n\t\t\t\ta.push(list[i]);\n\t\t\t}\n\t\t\treturn a;\n\t\t}\n\t}\n\n\tvar Guidance = function (map) {\n\t\tthis.map = map;\n\t}\n\n\tGuidance.prototype.findShortestPath = function (start, end) {\n\t\tvar result;\n\n\t\tif (Object.prototype.toString.call(start) === '[object Array]') {\n\t\t\tresult = findShortestPath(this.map, start);\n\t\t} else if (arguments.length === 2) {\n\t\t\tresult = findShortestPath(this.map, [start, end]);\n\t\t} else {\n\t\t\tresult = findShortestPath(this.map, toArray(arguments));\n\t\t}\n\n\t\treturn result;\n\t}\n\n\tGuidance.findShortestPath = function (map, start, end) {\n\t\tif (Object.prototype.toString.call(start) === '[object Array]') {\n\t\t\treturn findShortestPath(map, start);\n\t\t} else if (arguments.length === 3) {\n\t\t\treturn findShortestPath(map, [start, end]);\n\t\t} else {\n\t\t\treturn findShortestPath(map, toArray(arguments, 1));\n\t\t}\n\t}\n\n\treturn Guidance;\n})();\n","$(\"#admin\").click(function(e) {\n\te.preventDefault();\n\n\tif ($(this).hasClass(\"disabled\")) {\n\t\treturn false;\n\t}\n\n\tif (!$(\"#dialog-admin\").hasClass(\"ui-dialog-content\")) {\n\t\tvar refreshTimer = null;\n\t\tvar $total = null;\n\t\tvar $ajax = null;\n\n\t\tfunction refreshWindow() {\n\t\t\tif ($ajax) $ajax.abort();\n\t\t\t$total.html(\"Total: \" + $(\"#dialog-admin .window .hasFocus table tr[data-id]\").length);\n\n\t\t\t$ajax = $.ajax({\n\t\t\t\turl: \"admin.php\",\n\t\t\t\ttype: \"POST\",\n\t\t\t\tdata: {mode: $(\"#dialog-admin .menu .active\").attr(\"data-window\")},\n\t\t\t\tdataType: \"JSON\"\n\t\t\t}).done(function(data) {\n\t\t\t\tif (data && data.results) {\n\t\t\t\t\tvar rows = data.results;\n\t\t\t\t\tvar ids = [];\n\n\t\t\t\t\tfor (var i = 0, l = rows.length; i < l; i++) {\n\t\t\t\t\t\tvar $row = $(\"#dialog-admin .window .hasFocus tbody tr[data-id='\"+ rows[i].id +\"']\");\n\t\t\t\t\t\tids.push(rows[i].id);\n\n\t\t\t\t\t\tif ($row.length) {\n\t\t\t\t\t\t\tfor (col in rows[i]) {\n\t\t\t\t\t\t\t\tvar $col = $row.find(\"[data-col='\"+col+\"']\");\n\t\t\t\t\t\t\t\t$col.html(($col.attr(\"data-format\") == \"number\" ? numFormat(rows[i][col]) : rows[i][col]) || \"&nbsp;\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t$row = $(\"#dialog-admin .window .hasFocus table tr.hidden\").clone();\n\t\t\t\t\t\t\t$row.attr(\"data-id\", rows[i].id);\n\n\t\t\t\t\t\t\tfor (col in rows[i]) {\n\t\t\t\t\t\t\t\tvar $col = $row.find(\"[data-col='\"+col+\"']\");\n\t\t\t\t\t\t\t\t$col.html(($col.attr(\"data-format\") == \"number\" ? numFormat(rows[i][col]) : rows[i][col]) || \"&nbsp;\");\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t$row.removeClass(\"hidden\");\n\n\t\t\t\t\t\t\t$(\"#dialog-admin .window .hasFocus tbody\").append($row);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t$(\"#dialog-admin .window .hasFocus table tr[data-id]\").each(function() {\n\t\t\t\t\t\tif ($.inArray($(this).data(\"id\").toString(), ids) == -1) {\n\t\t\t\t\t\t\t$(this).remove();\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\t\t\t\t\t$(\"#dialog-admin .window .hasFocus table\").trigger(\"update\", [true]);\n\t\t\t\t} else {\n\t\t\t\t\t$(\"#dialog-admin .window .hasFocus table tr[data-id]\").remove();\n\t\t\t\t}\n\n\t\t\t\t$total.html(\"Total: \" + $(\"#dialog-admin .window .hasFocus table tr[data-id]\").length);\n\t\t\t});\n\n\t\t\tif ($(\"#dialog-admin\").dialog(\"isOpen\") && $(\"#dialog-admin .menu .active\").attr(\"data-refresh\")) {\n\t\t\t\trefreshTimer = setTimeout(refreshWindow, $(\"#dialog-admin .menu .active\").attr(\"data-refresh\"));\n\t\t\t}\n\t\t}\n\n\t\t$(\"#dialog-admin\").dialog({\n\t\t\tautoOpen: true,\n\t\t\tmodal: true,\n\t\t\theight: 350,\n\t\t\twidth: 800,\n\t\t\tbuttons: {\n\t\t\t\tClose: function() {\n\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t}\n\t\t\t},\n\t\t\tcreate: function() {\n\t\t\t\t// menu toggle\n\t\t\t\t$(\"#dialog-admin\").on(\"click\", \".menu li\", function(e) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\t$menuItem = $(this);\n\t\t\t\t\tclearTimeout(refreshTimer);\n\n\t\t\t\t\t$(\"#dialog-admin .menu .active\").removeClass(\"active\");\n\t\t\t\t\t$menuItem.addClass(\"active\");\n\t\t\t\t\t$(\"div.ui-dialog[aria-describedby='dialog-admin'] .ui-dialog-traypane\").html(\"\");\n\n\t\t\t\t\t$(\"#dialog-admin .window [data-window]\").removeClass(\"hasFocus\").hide();\n\t\t\t\t\t$(\"#dialog-admin .window [data-window='\"+ $menuItem.data(\"window\") +\"']\").addClass(\"hasFocus\").show();\n\n\t\t\t\t\trefreshWindow();\n\t\t\t\t});\n\n\t\t\t\t$(\"#dialog-admin [data-sortable='true']\").tablesorter({\n\t\t\t\t\tsortReset: true,\n\t\t\t\t\twidgets: ['saveSort'],\n\t\t\t\t\tsortList: [[0,0]]\n\t\t\t\t});\n\n\t\t\t\t// dialog bottom tray\n\t\t\t\t$($(this)[0].parentElement).find(\".ui-dialog-buttonpane\").append(\"<div class='ui-dialog-traypane'></div>\");\n\t\t\t\t$total = $(\"div.ui-dialog[aria-describedby='dialog-admin'] .ui-dialog-traypane\");\n\t\t\t},\n\t\t\topen: function() {\n\t\t\t\t$menuItem = $(\"#dialog-admin .menu li.active\");\n\t\t\t\trefreshWindow();\n\t\t\t},\n\t\t\tclose: function() {\n\t\t\t\tclearTimeout(refreshTimer);\n\t\t\t}\n\t\t});\n\t} else if (!$(\"#dialog-admin\").dialog(\"isOpen\")) {\n\t\t$(\"#dialog-admin\").dialog(\"open\");\n\t}\n});\n","// Dialog effects\n$(\"#wrapper\").addClass(\"transition\");\n\n$(document).on(\"dialogopen\", \".ui-dialog\", function (event, ui) {\n\t// Add additional full screen overlay for 2nd level dialog\n\tif ($(\".ui-dialog:visible\").length == 2 && $(this).hasClass(\"dialog-modal\"))\n\t\t$(\"body\").append($(\"<div id='overlay' class='overlay' />\").css(\"z-index\", $(this).css(\"z-index\") - 1));\n\telse if ($(\"#overlay\"))\n\t\t$(\"#overlay\").css(\"z-index\", $(this).css(\"z-index\") - 1);\n\n\tif (!$(this).hasClass(\"dialog-noeffect\"))\n\t\t$(\"#wrapper\").addClass(\"blur\");\n});\n\n$(document).on(\"dialogclose\", \".ui-dialog\", function (event, ui) {\n\tif (!$(\".ui-dialog\").is(\":visible\"))\n\t\t$(\"#wrapper\").removeClass(\"blur\");\n\n\tif ($(\".ui-dialog:visible\").length == 1)\n\t\t$(\"#overlay\").remove();\n\telse if ($(\"#overlay\"))\n\t\t$(\"#overlay\").css(\"z-index\", $(this).css(\"z-index\") - 2);\n\n\t//if ($(\".ui-dialog:visible\").length == 0 && options.buttons.follow && viewingSystemID != tripwire.client.EVE.systemID)\n\t//\twindow.location = \"?system=\"+tripwire.client.EVE.systemName;\n});\n\n// Signature overwrite\n$(document).on(\"click\", \"#overwrite\", function() {\n\tvar payload = {\"signatures\": {\"remove\": []}, \"systemID\": viewingSystemID};\n\tvar undo = [];\n\n\tvar signature = tripwire.client.signatures[$(this).data(\"id\")];\n\tif (signature.type != \"wormhole\") {\n\t\tundo.push(signature);\n\t\tpayload.signatures.remove.push(signature.id);\n\t} else {\n\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n\t\tundo.push({\"wormhole\": wormhole, \"signatures\": [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]});\n\t\tpayload.signatures.remove.push(wormhole);\n\t}\n\n\t$(\"#overwrite\").attr(\"disable\", true);\n\n\tvar success = function(data) {\n\t\tif (data.resultSet && data.resultSet[0].result == true) {\n\t\t\tValidationTooltips.close();\n\n\t\t\t$(\"#undo\").removeClass(\"disabled\");\n\t\t\tif (viewingSystemID in tripwire.signatures.undo) {\n\t\t\t\ttripwire.signatures.undo[viewingSystemID].push({action: \"remove\", signatures: undo});\n\t\t\t} else {\n\t\t\t\ttripwire.signatures.undo[viewingSystemID] = [{action: \"remove\", signatures: undo}];\n\t\t\t}\n\n\t\t\tsessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n\n\t\t\tif ($(\"#dialog-signature\").parent().find(\":button:contains('Save')\")) {\n\t\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Save')\").click();\n\t\t\t} else {\n\t\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Add')\").click();\n\t\t\t}\n\t\t}\n\t}\n\n\tvar always = function() {\n\t\t$(\"#overwrite\").removeAttr(\"disable\");\n\t}\n\n\ttripwire.refresh('refresh', payload, success, always);\n});\n","$(\".options\").click(function(e) {\n\te.preventDefault();\n\n\tif ($(this).hasClass(\"disabled\"))\n\t\treturn false;\n\n\t$(\"#dialog-options\").dialog({\n\t\tautoOpen: false,\n\t\twidth: 450,\n\t\tminHeight: 400,\n\t\tmodal: true,\n\t\tbuttons: {\n\t\t\tSave: function() {\n\t\t\t\t// Options\n\t\t\t\tvar data = {mode: \"set\", options: JSON.stringify(options)};\n\t\t\t\tvar maskChange = false;\n\n\t\t\t\t$(\"#dialog-options\").parent().find(\".ui-dialog-buttonpane button:contains('Save')\").attr(\"disabled\", true).addClass(\"ui-state-disabled\");\n\n\t\t\t\toptions.chain.typeFormat = $(\"#dialog-options #typeFormat\").val();\n\t\t\t\toptions.chain.classFormat = $(\"#dialog-options #classFormat\").val();\n\t\t\t\toptions.chain.routingLimit = 1 * $(\"#dialog-options #chainRoutingLimit\").val();\n\n\t\t\t\toptions.chain.gridlines = JSON.parse($(\"#dialog-options input[name=gridlines]:checked\").val());\n\n\t\t\t\toptions.chain[\"node-reference\"] = $(\"#dialog-options input[name=node-reference]:checked\").val();\n\n\t\t\t\toptions.signatures.editType = $(\"#dialog-options #editType\").val();\n\n\t\t\t\toptions.signatures.pasteLife = $(\"#dialog-options #pasteLife\").val();\n\n\t\t\t\toptions.signatures.copySeparator = $(\"#dialog-options #copySeparator\").val();\n\n\t\t\t\toptions.background = $(\"#dialog-options #background-image\").val();\n\n\t\t\t\toptions.uiscale = $(\"#dialog-options #uiscale-slider\").slider(\"value\");\n\n\t\t\t\tif (options.masks.active != $(\"#dialog-options input[name='mask']:checked\").val()) {\n\t\t\t\t\tmaskChange = true;\n\t\t\t\t}\n\n\t\t\t\toptions.masks.active = $(\"#dialog-options input[name='mask']:checked\").val();\n\n\t\t\t\toptions.apply();\n\t\t\t\toptions.save() // Performs AJAX\n\t\t\t\t\t.done(function() {\n\t\t\t\t\t\tif (maskChange) {\n\t\t\t\t\t\t\t// Reset signatures\n\t\t\t\t\t\t\t$(\"#sigTable span[data-age]\").countdown(\"destroy\");\n\t\t\t\t\t\t\t$(\"#sigTable tbody\").empty()\n\t\t\t\t\t\t\t$(\"#signature-count\").html(0);\n\t\t\t\t\t\t\ttripwire.signatures.list = {};\n\t\t\t\t\t\t\ttripwire.client.signatures = [];\n\n\t\t\t\t\t\t\ttripwire.refresh('change');\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\n\n\t\t\t\t$(\"#dialog-options\").dialog(\"close\");\n\t\t\t\t$(\"#dialog-options\").parent().find(\".ui-dialog-buttonpane button:contains('Save')\").attr(\"disabled\", false).removeClass(\"ui-state-disabled\");\n\n\t\t\t\t// toggle mask admin icon\n\t\t\t\t$(\"#dialog-options input[name='mask']:checked\").data(\"admin\") ? $(\"#admin\").removeClass(\"disabled\") : $(\"#admin\").addClass(\"disabled\");\n\t\t\t},\n\t\t\tReset: function() {\n\t\t\t\t$(\"#dialog-confirm #msg\").html(\"Settings will be reset to defaults temporarily.<br/><br/><p><em>Save settings to make changes permanent.</em></p>\");\n\t\t\t\t$(\"#dialog-confirm\").dialog(\"option\", {\n\t\t\t\t\tbuttons: {\n\t\t\t\t\t\tReset: function() {\n\t\t\t\t\t\t\toptions.reset();\n\t\t\t\t\t\t\toptions.apply();\n\n\t\t\t\t\t\t\t$(\"#dialog-options\").dialog(\"close\");\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t\t},\n\t\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).dialog(\"open\");\n\t\t\t},\n\t\t\tClose: function() {\n\t\t\t\t$(this).dialog(\"close\");\n\t\t\t}\n\t\t},\n\t\topen: function() {\n\t\t\t// Get user stats data\n\t\t\t$.ajax({\n\t\t\t\turl: \"user_stats.php\",\n\t\t\t\ttype: \"POST\",\n\t\t\t\tdataType: \"JSON\"\n\t\t\t}).done(function(data) {\n\t\t\t\tfor (i in data.stats) {\n\t\t\t\t\tfor (x in data.stats[i]) {\n\t\t\t\t\t\t$(\"#optionsAccordion #\"+ x).text(data.stats[i][x]);\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t$(\"#optionsAccordion #systems_visited\").text(data.system_visits);\n\t\t\t\t$(\"#optionsAccordion #logins\").text(data.account.logins);\n\t\t\t\t$(\"#optionsAccordion #lastLogin\").text(data.account.lastLogin);\n\t\t\t\t$(\"#optionsAccordion #username\").text(data.username);\n\t\t\t});\n\n\t\t\t// Get masks\n\t\t\t$.ajax({\n\t\t\t\turl: \"masks.php\",\n\t\t\t\ttype: \"POST\",\n\t\t\t\tdataType: \"JSON\"\n\t\t\t}).done(function(response) {\n\t\t\t\tif (response && response.masks) {\n\t\t\t\t\t$(\"#dialog-options #masks #default\").html(\"\");\n\t\t\t\t\t$(\"#dialog-options #masks #personal\").html(\"\");\n\t\t\t\t\t$(\"#dialog-options #masks #corporate\").html(\"\");\n\n\t\t\t\t\tfor (var x in response.masks) {\n\t\t\t\t\t\tvar mask = response.masks[x];\n\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t+ '<input type=\"radio\" name=\"mask\" id=\"mask'+x+'\" value=\"'+mask.mask+'\" class=\"selector\" data-owner=\"'+mask.owner+'\" data-admin=\"'+mask.admin+'\" />'\n\t\t\t\t\t\t\t+ '<label for=\"mask'+x+'\"><img src=\"'+mask.img+'\" />'\n\t\t\t\t\t\t\t+  (mask.optional ? '<i class=\"closeIcon\" onclick=\"return false;\" data-icon=\"red-giant\"><i data-icon=\"times\"></i></i>' : '')\n\t\t\t\t\t\t\t+ '<span class=\"selector_label\">'+mask.label+'</span></label>');\n\n\t\t\t\t\t\t$(\"#dialog-options #masks #\"+mask.type).append(node);\n\t\t\t\t\t}\n\n\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"find\" id=\"findp\" value=\"personal\" class=\"selector\" disabled=\"disabled\" />'\n\t\t\t\t\t\t+ '<label for=\"findp\"><i data-icon=\"search\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i></label>');\n\t\t\t\t\t$(\"#dialog-options #masks #personal\").append(node);\n\n\t\t\t\t\tif (init.admin == \"1\") {\n\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"find\" id=\"findc\" value=\"corporate\" class=\"selector\" disabled=\"disabled\" />'\n\t\t\t\t\t\t\t+ '<label for=\"findc\"><i data-icon=\"search\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i></label>');\n\t\t\t\t\t\t$(\"#dialog-options #masks #corporate\").append(node);\n\t\t\t\t\t}\n\n\t\t\t\t\t$(\"#dialog-options input[name='mask']\").filter(\"[value='\"+response.masks[response.active].mask+\"']\").attr(\"checked\", true).trigger(\"change\");\n\n\t\t\t\t\t// toggle mask admin icon\n\t\t\t\t\tresponse.masks[response.active].admin ? $(\"#admin\").removeClass(\"disabled\") : $(\"#admin\").addClass(\"disabled\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(\"#dialog-options #editType\").val(options.signatures.editType);\n\t\t\t$(\"#dialog-options #pasteLife\").val(options.signatures.pasteLife);\n\t\t\t$(\"#dialog-options #copySeparator\").val(options.signatures.copySeparator);\n\t\t\t$(\"#dialog-options #typeFormat\").val(options.chain.typeFormat);\n\t\t\t$(\"#dialog-options #chainRoutingLimit\").val(options.chain.routingLimit);\n\t\t\t$(\"#dialog-options #classFormat\").val(options.chain.classFormat);\n\t\t\t$(\"#dialog-options input[name='node-reference'][value='\"+options.chain[\"node-reference\"]+\"']\").prop(\"checked\", true);\n\t\t\t$(\"#dialog-options input[name='gridlines'][value='\"+options.chain.gridlines+\"']\").prop(\"checked\", true);\n\t\t\t$(\"#dialog-options #background-image\").val(options.background);\n\t\t},\n\t\tcreate: function() {\n\t\t\t$(\"#optionsAccordion\").accordion({heightStyle: \"content\", collapsible: true, active: false});\n\n\t\t\t$(\"#uiscale-slider\").slider({\n\t\t\t\tmin: 0.7,\n\t\t\t\tmax: 1.4,\n\t\t\t\tstep: 0.05,\n\t\t\t\tvalue: options.uiscale || 1.0,\n\t\t\t\tchange: function(e, ui) {\n\t\t\t\t\t$(\"body\").css(\"zoom\", ui.value);\n\t\t\t\t},\n\t\t\t\tslide: function(e, ui) {\n\t\t\t\t\t$(\"label[for='uiscale-slider']\").html(ui.value);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(\"label[for='uiscale-slider']\").html($(\"#uiscale-slider\").slider(\"value\"));\n\n\t\t\t$(\"#dialog-pwChange\").dialog({\n\t\t\t\tautoOpen: false,\n\t\t\t\tresizable: false,\n\t\t\t\tminHeight: 0,\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\t\t\t\tbuttons: {\n\t\t\t\t\tSave: function() {\n\t\t\t\t\t\t$(\"#pwForm\").submit();\n\t\t\t\t\t},\n\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tclose: function() {\n\t\t\t\t\t$(\"#pwForm input[name='password'], #pwForm input[name='confirm']\").val(\"\");\n\t\t\t\t\t$(\"#pwError\").text(\"\").hide();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(\"#pwChange\").click(function() {\n\t\t\t\t$(\"#dialog-pwChange\").dialog(\"open\");\n\t\t\t});\n\n\t\t\t$(\"#pwForm\").submit(function(e) {\n\t\t\t\te.preventDefault();\n\n\t\t\t\t$(\"#pwError\").text(\"\").hide();\n\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: \"options.php\",\n\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\tdata: $(this).serialize(),\n\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t}).done(function(response) {\n\t\t\t\t\tif (response && response.result) {\n\t\t\t\t\t\t$(\"#dialog-msg #msg\").text(\"Password changed\");\n\t\t\t\t\t\t$(\"#dialog-msg\").dialog(\"open\");\n\n\t\t\t\t\t\t$(\"#dialog-pwChange\").dialog(\"close\");\n\t\t\t\t\t} else if (response && response.error) {\n\t\t\t\t\t\t$(\"#pwError\").text(response.error).show(\"slide\", {direction: \"up\"});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(\"#pwError\").text(\"Unknown error\").show(\"slide\", {direction: \"up\"});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t$(\"#dialog-usernameChange\").dialog({\n\t\t\t\tautoOpen: false,\n\t\t\t\tresizable: false,\n\t\t\t\tminHeight: 0,\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\t\t\t\tbuttons: {\n\t\t\t\t\tSave: function() {\n\t\t\t\t\t\t$(\"#usernameForm\").submit();\n\t\t\t\t\t},\n\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\topen: function() {\n\t\t\t\t\t$(\"#usernameForm #username\").html($(\"#dialog-options #username\").html());\n\t\t\t\t},\n\t\t\t\tclose: function() {\n\t\t\t\t\t$(\"#usernameForm [name='username']\").val(\"\");\n\t\t\t\t\t$(\"#usernameError\").text(\"\").hide();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(\"#usernameChange\").click(function() {\n\t\t\t\t$(\"#dialog-usernameChange\").dialog(\"open\");\n\t\t\t});\n\n\t\t\t$(\"#usernameForm\").submit(function(e) {\n\t\t\t\te.preventDefault();\n\n\t\t\t\t$(\"#usernameError\").text(\"\").hide();\n\n\t\t\t\t$.ajax({\n\t\t\t\t\turl: \"options.php\",\n\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\tdata: $(this).serialize(),\n\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t}).done(function(response) {\n\t\t\t\t\tif (response && response.result) {\n\t\t\t\t\t\t$(\"#dialog-msg #msg\").text(\"Username changed\");\n\t\t\t\t\t\t$(\"#dialog-msg\").dialog(\"open\");\n\n\t\t\t\t\t\t$(\"#dialog-options #username\").html(response.result);\n\n\t\t\t\t\t\t$(\"#dialog-usernameChange\").dialog(\"close\");\n\t\t\t\t\t} else if (response && response.error) {\n\t\t\t\t\t\t$(\"#usernameError\").text(response.error).show(\"slide\", {direction: \"up\"});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(\"#usernameError\").text(\"Unknown error\").show(\"slide\", {direction: \"up\"});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\n\t\t\t// Mask selections\n\t\t\t$(\"#masks\").on(\"change\", \"input.selector:checked\", function() {\n\t\t\t\tif ($(this).data(\"owner\")) {\n\t\t\t\t\t$(\"#maskControls #edit\").removeAttr(\"disabled\");\n\t\t\t\t\t$(\"#maskControls #delete\").removeAttr(\"disabled\");\n\t\t\t\t} else {\n\t\t\t\t\t$(\"#maskControls #edit\").attr(\"disabled\", \"disabled\");\n\t\t\t\t\t$(\"#maskControls #delete\").attr(\"disabled\", \"disabled\");\n\t\t\t\t}\n\n\t\t\t\tif ($(this).val() != 0.0 && $(this).val().split(\".\")[1] == 0) {\n\t\t\t\t\t$(\"#dialog-options #leave\").removeAttr(\"disabled\");\n\t\t\t\t} else {\n\t\t\t\t\t$(\"#dialog-options #leave\").attr(\"disabled\", \"disabled\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Mask join\n\t\t\t$(\"#dialog-joinMask\").dialog({\n\t\t\t\tautoOpen: false,\n\t\t\t\tresizable: false,\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\t\t\t\tbuttons: {\n\t\t\t\t\tAdd: function() {\n\t\t\t\t\t\tvar mask = $(\"#dialog-joinMask #results input:checked\");\n\t\t\t\t\t\tvar label = $(\"#dialog-joinMask #results input:checked+label\");\n\n\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\turl: \"masks.php\",\n\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\tdata: {mask: mask.val(), mode: \"join\"},\n\t\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t\t}).done(function(response) {\n\t\t\t\t\t\t\tif (response && response.result) {\n\t\t\t\t\t\t\t\tlabel.css(\"width\", \"\");\n\t\t\t\t\t\t\t\tlabel.find(\".info\").remove();\n\t\t\t\t\t\t\t\tlabel.append('<i class=\"closeIcon\" onclick=\"return false;\" data-icon=\"red-giant\"><i data-icon=\"times\"></i></i>');\n\n\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #\"+response.type+\" input.selector:last\").before(mask).before(label);\n\t\t\t\t\t\t\t\t$(\"#dialog-joinMask\").dialog(\"close\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t},\n\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcreate: function() {\n\t\t\t\t\t$(\"#dialog-joinMask form\").submit(function(e) {\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t$(\"#dialog-joinMask #results\").html(\"\");\n\t\t\t\t\t\t$(\"#dialog-joinMask #loading\").show();\n\t\t\t\t\t\t$(\"#dialog-joinMask input[type='submit']\").attr(\"disabled\", \"disabled\");\n\n\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\turl: \"masks.php\",\n\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\tdata: $(this).serialize(),\n\t\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t\t}).then(function(response) {\n\t\t\t\t\t\t\tif (response && response.results && response.results.length) {\n\t\t\t\t\t\t\t\treturn tripwire.esi.fullLookup(response.eveIDs)\n\t\t\t\t\t\t\t\t\t.done(function(results) {\n\t\t\t\t\t\t\t\t\t\tif (results) {\n\t\t\t\t\t\t\t\t\t\t\tfor (var x in results) {\n\t\t\t\t\t\t\t\t\t\t\t\tvar mask = response.results[x];\n\t\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"radio\" name=\"mask\" id=\"mask'+mask.mask+'\" value=\"'+mask.mask+'\" class=\"selector\" data-owner=\"false\" data-admin=\"'+mask.admin+'\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"mask'+mask.mask+'\" style=\"width: 100%; margin-left: -5px;\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<img src=\"'+mask.img+'\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">'+mask.label+'</span>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].name + '<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].category == \"character\" ? results[x].corporation.name +'<br/>' : null)\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].alliance ? results[x].alliance.name : '')+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t</div>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '</label>');\n\n\t\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-joinMask #results\").append(node);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t} else if (response && response.error) {\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(response.error);\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unknown error\");\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}).then(function() {\n\t\t\t\t\t\t\t$(\"#dialog-joinMask #loading\").hide();\n\t\t\t\t\t\t\t$(\"#dialog-joinMask input[type='submit']\").removeAttr(\"disabled\");\n\t\t\t\t\t\t});\n\t\t\t\t\t})\n\t\t\t\t},\n\t\t\t\tclose: function() {\n\t\t\t\t\t$(\"#dialog-joinMask #results\").html(\"\");\n\t\t\t\t\t$(\"#dialog-joinMask input[name='name']\").val(\"\");\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(\"#dialog-options #masks\").on(\"click\", \"input[name='find']+label\", function() {\n\t\t\t\t$(\"#dialog-joinMask input[name='find']\").val($(this).prev().val());\n\t\t\t\t$(\"#dialog-joinMask\").dialog(\"open\");\n\t\t\t});\n\n\t\t\t// Mask leave\n\t\t\t$(\"#dialog-options #masks\").on(\"click\", \".closeIcon\", function() {\n\t\t\t\tvar mask = $(this).closest(\"input.selector+label\").prev();\n\n\t\t\t\t$(\"#dialog-confirm #msg\").text(\"Are you sure you want to remove this mask?\");\n\n\t\t\t\t$(\"#dialog-confirm\").dialog(\"option\", {\n\t\t\t\t\tbuttons: {\n\t\t\t\t\t\tRemove: function() {\n\t\t\t\t\t\t\tvar send = {mode: \"leave\", mask: mask.val()};\n\n\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\turl: \"masks.php\",\n\t\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\t\tdata: send,\n\t\t\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t\t\t}).done(function(response) {\n\t\t\t\t\t\t\t\tif (response && response.result) {\n\t\t\t\t\t\t\t\t\tmask.next().remove();\n\t\t\t\t\t\t\t\t\tmask.remove();\n\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\n\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unable to delete\");\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).dialog(\"open\");\n\t\t\t});\n\n\t\t\t// Mask delete\n\t\t\t$(\"#maskControls #delete\").click(function() {\n\t\t\t\tvar mask = $(\"#masks input.selector:checked\");\n\n\t\t\t\t$(\"#dialog-confirm #msg\").text(\"Are you sure you want to delete this mask?\");\n\t\t\t\t$(\"#dialog-confirm\").dialog(\"option\", {\n\t\t\t\t\tbuttons: {\n\t\t\t\t\t\tDelete: function() {\n\t\t\t\t\t\t\tvar send = {mode: \"delete\", mask: mask.val()};\n\n\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\turl: \"masks.php\",\n\t\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\t\tdata: send,\n\t\t\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t\t\t}).done(function(response) {\n\t\t\t\t\t\t\t\tif (response && response.result) {\n\t\t\t\t\t\t\t\t\tmask.next().remove();\n\t\t\t\t\t\t\t\t\tmask.remove();\n\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\n\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unable to delete\");\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t},\n\t\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}).dialog(\"open\");\n\t\t\t});\n\n\t\t\t// User Create mask\n\t\t\t$(\"#dialog-createMask\").dialog({\n\t\t\t\tautoOpen: false,\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\t\t\t\tbuttons: {\n\t\t\t\t\tCreate: function() {\n\t\t\t\t\t\t$(\"#dialog-createMask form\").submit();\n\t\t\t\t\t},\n\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcreate: function() {\n\t\t\t\t\t$(\"#dialog-createMask #accessList\").on(\"click\", \"#create_add+label\", function() {\n\t\t\t\t\t\t$(\"#dialog-EVEsearch\").dialog(\"open\");\n\t\t\t\t\t});\n\n\t\t\t\t\t$(\"#dialog-createMask form\").submit(function(e) {\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\turl: \"masks.php\",\n\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\tdata: $(this).serialize(),\n\t\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t\t}).done(function(response) {\n\t\t\t\t\t\t\tif (response && response.result) {\n\t\t\t\t\t\t\t\t// Get masks\n\t\t\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\t\t\turl: \"masks.php\",\n\t\t\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t\t\t\t}).done(function(response) {\n\t\t\t\t\t\t\t\t\tif (response && response.masks) {\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #default\").html(\"\");\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #personal\").html(\"\");\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #corporate\").html(\"\");\n\n\t\t\t\t\t\t\t\t\t\tfor (var x in response.masks) {\n\t\t\t\t\t\t\t\t\t\t\tvar mask = response.masks[x];\n\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"radio\" name=\"mask\" id=\"mask'+x+'\" value=\"'+mask.mask+'\" class=\"selector\" data-owner=\"'+mask.owner+'\" data-admin=\"'+mask.admin+'\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"mask'+x+'\"><img src=\"'+mask.img+'\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t+  (mask.optional ? '<i class=\"closeIcon\" onclick=\"return false;\" data-icon=\"red-giant\"><i data-icon=\"times\"></i></i>' : '')\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<span class=\"selector_label\">'+mask.label+'</span></label>');\n\n\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #\"+mask.type).append(node);\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"find\" id=\"findp\" value=\"personal\" class=\"selector\" disabled=\"disabled\" />'\n\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"findp\"><i data-icon=\"search\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i></label>');\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #personal\").append(node);\n\n\t\t\t\t\t\t\t\t\t\tif (init.admin == \"1\") {\n\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"find\" id=\"findc\" value=\"corporate\" class=\"selector\" disabled=\"disabled\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"findc\"><i data-icon=\"search\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i></label>');\n\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #corporate\").append(node);\n\t\t\t\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options input[name='mask']\").filter(\"[value='\"+response.masks[response.active].mask+\"']\").attr(\"checked\", true).trigger(\"change\");\n\n\t\t\t\t\t\t\t\t\t\t// toggle mask admin icon\n\t\t\t\t\t\t\t\t\t\tresponse.masks[response.active].admin ? $(\"#admin\").removeClass(\"disabled\") : $(\"#admin\").addClass(\"disabled\");\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\n\t\t\t\t\t\t\t\t$(\"#dialog-createMask\").dialog(\"close\");\n\t\t\t\t\t\t\t} else if (response && response.error) {\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(response.error);\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unknown error\");\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\n\t\t\t\t\t$(\"#dialog-createMask select\").selectmenu({width: 100});\n\t\t\t\t},\n\t\t\t\topen: function() {\n\t\t\t\t\t$(\"#dialog-createMask input[name='name']\").val(\"\");\n\t\t\t\t\t$(\"#dialog-createMask #accessList :not(.static)\").remove();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(\"#maskControls #create\").click(function() {\n\t\t\t\t$(\"#dialog-createMask\").dialog(\"open\");\n\t\t\t});\n\n\t\t\t$(\"#dialog-createMask #accessList\").on(\"click\", \".maskRemove\", function() {\n\t\t\t\t$(this).closest(\"input.selector+label\").prev().remove();\n\t\t\t\t$(this).closest(\"label\").remove();\n\t\t\t});\n\n\t\t\t$(\"#dialog-editMask\").dialog({\n\t\t\t\tautoOpen: false,\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\t\t\t\tbuttons: {\n\t\t\t\t\tSave: function() {\n\t\t\t\t\t\t$(\"#dialog-editMask form\").submit();\n\t\t\t\t\t},\n\t\t\t\t\tCancel: function() {\n\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcreate: function() {\n\t\t\t\t\t$(\"#dialog-editMask #accessList\").on(\"click\", \".maskRemove\", function() {\n\t\t\t\t\t\t$(this).closest(\"input.selector+label\").prev().attr(\"name\", \"deletes[]\").hide();\n\t\t\t\t\t\t$(this).closest(\"label\").hide();\n\t\t\t\t\t});\n\n\t\t\t\t\t$(\"#dialog-editMask #accessList\").on(\"click\", \"#edit_add+label\", function() {\n\t\t\t\t\t\t$(\"#dialog-EVEsearch\").dialog(\"open\");\n\t\t\t\t\t});\n\n\t\t\t\t\t$(\"#dialog-editMask form\").submit(function(e) {\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\t$.ajax({\n\t\t\t\t\t\t\turl: \"masks.php\",\n\t\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\t\tdata: $(this).serialize(),\n\t\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t\t}).done(function(response) {\n\t\t\t\t\t\t\tif (response && response.result) {\n\t\t\t\t\t\t\t\t$(\"#dialog-editMask\").dialog(\"close\");\n\t\t\t\t\t\t\t} else if (response && response.error) {\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(response.error);\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unknown error\");\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\topen: function() {\n\t\t\t\t\tvar mask = $(\"#dialog-options input[name='mask']:checked\").val();\n\t\t\t\t\t$(\"#dialog-editMask input[name='mask']\").val(mask);\n\t\t\t\t\t$(\"#dialog-editMask #accessList label.static\").hide();\n\t\t\t\t\t$(\"#dialog-editMask #loading\").show();\n\t\t\t\t\t$(\"#dialog-editMask #name\").text($(\"#dialog-options input[name='mask']:checked+label .selector_label\").text());\n\n\t\t\t\t\t$.ajax({\n\t\t\t\t\t\turl: \"masks.php\",\n\t\t\t\t\t\ttype: \"POST\",\n\t\t\t\t\t\tdata: {mode: \"edit\", mask: mask},\n\t\t\t\t\t\tdataType: \"JSON\"\n\t\t\t\t\t}).then(function(response) {\n\t\t\t\t\t\tif (response && response.results && response.results.length) {\n\t\t\t\t\t\t\treturn tripwire.esi.fullLookup(response.results)\n\t\t\t\t\t\t\t\t.done(function(results) {\n\t\t\t\t\t\t\t\t\tif (results) {\n\t\t\t\t\t\t\t\t\t\tfor (var x in results) {\n\t\t\t\t\t\t\t\t\t\t\tif (results[x].category == \"character\") {\n\t\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"checkbox\" checked=\"checked\" onclick=\"return false\" name=\"\" id=\"edit_'+results[x].id+'_1373\" value=\"'+results[x].id+'_1373\" class=\"selector\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"edit_'+results[x].id+'_1373\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/Character/'+results[x].id+'_64.jpg\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">Character</span>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].name + '<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].corporation.name+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].alliance ? results[x].alliance.name : '')+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t<input type=\"button\" class=\"maskRemove\" value=\"Remove\" style=\"position: absolute; bottom: 3px; right: 3px;\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t</div>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '</label>');\n\n\t\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-editMask #accessList .static:first\").before(node);\n\t\t\t\t\t\t\t\t\t\t\t} else if (results[x].category == \"corporation\") {\n\t\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"checkbox\" checked=\"checked\" onclick=\"return false\" name=\"\" id=\"edit_'+results[x].id+'_2\" value=\"'+results[x].id+'_2\" class=\"selector\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"edit_'+results[x].id+'_2\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/Corporation/'+results[x].id+'_64.png\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">Corporation</span>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].name+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].alliance ? results[x].alliance.name : '')+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t<input type=\"button\" class=\"maskRemove\" value=\"Remove\" style=\"position: absolute; bottom: 3px; right: 3px;\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t</div>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '</label>');\n\n\t\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-editMask #accessList .static:first\").before(node);\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t}).then(function(response) {\n\t\t\t\t\t\t$(\"#dialog-editMask #accessList label.static\").show();\n\t\t\t\t\t\t$(\"#dialog-editMask #loading\").hide();\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tclose: function() {\n\t\t\t\t\t$(\"#dialog-editMask #accessList :not(.static)\").remove();\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t$(\"#maskControls #edit\").click(function() {\n\t\t\t\t$(\"#dialog-editMask\").dialog(\"open\");\n\t\t\t});\n\n\t\t\t// EVE search dialog\n\t\t\t$(\"#dialog-EVEsearch\").dialog({\n\t\t\t\tautoOpen: false,\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\n\t\t\t\tbuttons: {\n\t\t\t\t\tAdd: function() {\n\t\t\t\t\t\tif ($(\"#accessList input[value='\"+$(\"#EVESearchResults input\").val()+\"']\").length) {\n\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Already has access\");\n\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$(\"#EVESearchResults .info\").append('<input type=\"button\" class=\"maskRemove\" value=\"Remove\" style=\"position: absolute; bottom: 3px; right: 3px;\" />');\n\t\t\t\t\t\t$(\"#EVESearchResults input:checked\").attr(\"checked\", \"checked\");\n\t\t\t\t\t\t$(\"#EVESearchResults input:checked\").attr(\"onclick\", \"return false\");\n\n\t\t\t\t\t\tvar nodes = $(\"#EVESearchResults .maskNode:has(input:checked)\");\n\n\t\t\t\t\t\tif ($(\"#dialog-createMask\").dialog(\"isOpen\"))\n\t\t\t\t\t\t\t$(\"#dialog-createMask #accessList .static:first\").before(nodes);\n\t\t\t\t\t\telse if ($(\"#dialog-editMask\").dialog(\"isOpen\"))\n\t\t\t\t\t\t\t$(\"#dialog-editMask #accessList .static:first\").before(nodes);\n\n\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t},\n\t\t\t\t\tClose: function() {\n\t\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\tcreate: function() {\n\t\t\t\t\t$(\"#EVEsearch\").submit(function(e) {\n\t\t\t\t\t\te.preventDefault();\n\n\t\t\t\t\t\tif ($(\"#EVEsearch input[name='name']\").val() == \"\") {\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\t$(\"#EVESearchResults, #searchCount\").html(\"\");\n\t\t\t\t\t\t$(\"#EVEsearch #searchSpinner\").show();\n\t\t\t\t\t\t$(\"#EVEsearch input[type='submit']\").attr(\"disabled\", \"disabled\");\n\t\t\t\t\t\t$(\"#dialog-EVEsearch\").parent().find(\".ui-dialog-buttonpane button:contains('Add')\").attr(\"disabled\", true).addClass(\"ui-state-disabled\");\n\n\t\t\t\t\t\ttripwire.esi.search($(\"#EVEsearch input[name='name']\").val(), $(\"#EVEsearch input[name='category']:checked\").val(), $(\"#EVEsearch input[name='exact']\")[0].checked)\n\t\t\t\t\t\t\t.done(function(results) {\n\t\t\t\t\t\t\t\tif (results && (results.character || results.corporation)) {\n\t\t\t\t\t\t\t\t\t// limit results\n\t\t\t\t\t\t\t\t\tresults = $.merge(results.character || [], results.corporation || []);\n\t\t\t\t\t\t\t\t\ttotal = results.length;\n\t\t\t\t\t\t\t\t\tresults = results.slice(0, 10);\n\t\t\t\t\t\t\t\t\treturn tripwire.esi.fullLookup(results)\n\t\t\t\t\t\t\t\t\t\t.done(function(results) {\n\t\t\t\t\t\t\t\t\t\t\t$(\"#EVEsearch #searchCount\").html(\"Found: \"+total+\"<br/>Showing: \"+(total<10?total:10));\n\t\t\t\t\t\t\t\t\t\t\tif (results) {\n\t\t\t\t\t\t\t\t\t\t\t\tfor (var x in results) {\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (results[x].category == \"character\") {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<div class=\"maskNode\"><input type=\"checkbox\" name=\"adds[]\" id=\"find_'+results[x].id+'_1373\" value=\"'+results[x].id+'_1373\" class=\"selector\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"find_'+results[x].id+'_1373\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/Character/'+results[x].id+'_64.jpg\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">Character</span>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].name + '<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].corporation.name+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].alliance ? results[x].alliance.name : '')+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t</div>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '</label></div>');\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#EVESearchResults\").append(node);\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else if (results[x].category == \"corporation\") {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<div class=\"maskNode\"><input type=\"checkbox\" name=\"adds[]\" id=\"find_'+results[x].id+'_2\" value=\"'+results[x].id+'_2\" class=\"selector\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"find_'+results[x].id+'_2\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/Corporation/'+results[x].id+'_64.png\" />'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">Corporation</span>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].name+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].alliance ? results[x].alliance.name : '')+'<br/>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t</div>'\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '</label></div>');\n\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#EVESearchResults\").append(node);\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}).always(function() {\n\t\t\t\t\t\t\t\t\t\t\t$(\"#EVEsearch #searchSpinner\").hide();\n\t\t\t\t\t\t\t\t\t\t\t$(\"#EVEsearch input[type='submit']\").removeAttr(\"disabled\");\n\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-EVEsearch\").parent().find(\".ui-dialog-buttonpane button:contains('Add')\").removeAttr(\"disabled\").removeClass(\"ui-state-disabled\");\n\t\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"No Results\");\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\n\n\t\t\t\t\t\t\t\t\t$(\"#EVEsearch #searchSpinner\").hide();\n\t\t\t\t\t\t\t\t\t$(\"#EVEsearch input[type='submit']\").removeAttr(\"disabled\");\n\t\t\t\t\t\t\t\t\t$(\"#dialog-EVEsearch\").parent().find(\".ui-dialog-buttonpane button:contains('Add')\").removeAttr(\"disabled\").removeClass(\"ui-state-disabled\");\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t});\n\t\t\t\t},\n\t\t\t\tclose: function() {\n\t\t\t\t\t$(\"#EVEsearch input[name='name']\").val(\"\");\n\t\t\t\t\t$(\"#EVESearchResults, #searchCount\").html(\"\");\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t});\n\n\t$(\"#dialog-options\").dialog(\"open\");\n});\n","$(\"#signaturesWidget\").on(\"click\", \"#delete-signature\", function(e) {\n\te.preventDefault();\n\n\tif ($(this).closest(\"tr\").attr(\"disabled\")) {\n\t\treturn false;\n\t} else if ($(\"#sigTable tr.selected\").length == 0) {\n\t\treturn false;\n\t} else if ($(\"#dialog-sigEdit\").hasClass(\"ui-dialog-content\") && $(\"#dialog-sigEdit\").dialog(\"isOpen\")) {\n\t\t$(\"#dialog-sigEdit\").parent().effect(\"shake\", 300);\n\t\treturn false;\n\t}\n\n\t// check if dialog is open\n\tif (!$(\"#dialog-deleteSig\").hasClass(\"ui-dialog-content\")) {\n\t\t$(\"#dialog-deleteSig\").dialog({\n\t\t\tresizable: false,\n\t\t\tminHeight: 0,\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\n\t\t\tbuttons: {\n\t\t\t\tDelete: function() {\n\t\t\t\t\t// Prevent duplicate submitting\n\t\t\t\t\t$(\"#dialog-deleteSig\").parent().find(\":button:contains('Delete')\").button(\"disable\");\n\t\t\t\t\tvar payload = {\"signatures\": {\"remove\": []}, \"systemID\": viewingSystemID};\n\t\t\t\t\tvar undo = [];\n\n\t\t\t\t\tvar signatures = $.map($(\"#sigTable tr.selected\"), function(n) {\n\t\t\t\t\t\tvar signature = tripwire.client.signatures[$(n).data(\"id\")];\n\t\t\t\t\t\tif (signature.type != \"wormhole\") {\n\t\t\t\t\t\t\tundo.push(signature);\n\t\t\t\t\t\t\treturn signature.id;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n\t\t\t\t\t\t\tundo.push({\"wormhole\": wormhole, \"signatures\": [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]});\n\t\t\t\t\t\t\treturn wormhole;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tpayload.signatures.remove = signatures;\n\n\t\t\t\t\tvar success = function(data) {\n\t\t\t\t\t\tif (data.resultSet && data.resultSet[0].result == true) {\n\t\t\t\t\t\t\t$(\"#dialog-deleteSig\").dialog(\"close\");\n\n\t\t\t\t\t\t\t$(\"#undo\").removeClass(\"disabled\");\n\t\t\t\t\t\t\tif (viewingSystemID in tripwire.signatures.undo) {\n\t\t\t\t\t\t\t\ttripwire.signatures.undo[viewingSystemID].push({action: \"remove\", signatures: undo});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttripwire.signatures.undo[viewingSystemID] = [{action: \"remove\", signatures: undo}];\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tsessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar always = function(data) {\n\t\t\t\t\t\t$(\"#dialog-deleteSig\").parent().find(\":button:contains('Delete')\").button(\"enable\");\n\t\t\t\t\t}\n\n\t\t\t\t\ttripwire.refresh('refresh', payload, success, always);\n\t\t\t\t},\n\t\t\t\tCancel: function() {\n\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t}\n\t\t\t},\n\t\t\tclose: function() {\n\t\t\t\t$(\"#sigTable tr.selected\").removeClass(\"selected\");\n\t\t\t\t//$(\"#sigTable .sigDelete\").removeClass(\"invisible\");\n\t\t\t}\n\t\t});\n\t} else if (!$(\"#dialog-deleteSig\").dialog(\"isOpen\")) {\n\t\t$(\"#dialog-deleteSig\").dialog(\"open\");\n\t}\n});\n","$(\"#sigTable tbody\").on(\"dblclick\", \"tr\", {mode: \"dblclick-update\"}, openSignatureDialog);\n$(\"#edit-signature\").on(\"click\", {mode: \"update\"}, openSignatureDialog);\n$(\"#add-signature\").click({mode: \"add\"}, openSignatureDialog);\n\nfunction openSignatureDialog(e) {\n\te.preventDefault();\n\tmode = e.data.mode;\n\telement = this;\n\n\tif (mode == \"dblclick-update\") {\n\t\t$(\"#sigTable tr.selected\").removeClass(\"selected\");\n\t\t$(this).closest(\"tr\").addClass(\"selected\");\n\t\tmode = \"update\";\n\t} else if (mode == \"update\") {\n\t\tvar elements = $(\"#sigTable tbody tr.selected\");\n\t\tif (elements.length !== 1) {\n\t\t\treturn false;\n\t\t} else {\n\t\t\telement = elements[0];\n\t\t}\n\t}\n\n\tif (!$(\"#dialog-signature\").hasClass(\"ui-dialog-content\")) {\n\t\t$(\"#dialog-signature\").dialog({\n\t\t\tautoOpen: true,\n\t\t\tresizable: false,\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\n\t\t\tposition: {my: \"center\", at: \"center\", of: $(\"#signaturesWidget\")},\n\t\t\tbuttons: {\n\t\t\t\tSave: function() {\n\t\t\t\t\t$(\"#form-signature\").submit();\n\t\t\t\t},\n\t\t\t\tAdd: function() {\n\t\t\t\t\t$(\"#form-signature\").submit();\n\t\t\t\t},\n\t\t\t\tCancel: function() {\n\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t}\n\t\t\t},\n\t\t\tcreate: function() {\n\t\t\t\tvar aSigWormholes = $.map(tripwire.wormholes, function(item, index) { return index;});\n\t\t\t\taSigWormholes.splice(26, 0, \"K162\");\n\t\t\t\taSigWormholes.push(\"GATE\");\n\t\t\t\taSigWormholes.push(\"SML\");\n\t\t\t\taSigWormholes.push(\"MED\");\n\t\t\t\taSigWormholes.push(\"LRG\");\n\t\t\t\taSigWormholes.push(\"XLG\");\n\n\t\t\t\t$(\"#dialog-signature [name='signatureType'], #dialog-signature [name='signatureLife']\").selectmenu({width: 100});\n\t\t\t\t$(\"#dialog-signature [name='wormholeLife'], #dialog-signature [name='wormholeMass']\").selectmenu({width: 80});\n\t\t\t\t$(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete({source: tripwire.aSigSystems, maxSize: 10, delay: 0});\n\t\t\t\t$(\"#dialog-signature [data-autocomplete='sigType']\").inlinecomplete({source: aSigWormholes, maxSize: 10, delay: 0});\n\n\t\t\t\t$(\"#dialog-signature #durationPicker\").durationPicker();\n\t\t\t\t$(\"#dialog-signature #durationPicker\").on(\"change\", function() {\n\t\t\t\t\t// prevent negative values\n\t\t\t\t\tif (this.value < 0) {\n\t\t\t\t\t\tthis.value = 0;\n\t\t\t\t\t\t$(this).change();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Ensure first signature ID field only accepts letters\n\t\t\t\t$(\"#dialog-signature [name='signatureID_Alpha'], #dialog-signature [name='signatureID2_Alpha']\").on(\"input\", function() {\n\t\t\t\t\twhile (!/^[a-zA-Z?]*$/g.test(this.value)) {\n\t\t\t\t\t\tthis.value = this.value.substring(0, this.value.length -1);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Move to the numeric ID after filling out alpha ID\n\t\t\t\t$(\"#dialog-signature [name='signatureID_Alpha']\").on(\"input\", function() {\n\t\t\t\t\tif (this.value.length === 3) {\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureID_Numeric']\").select();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t$(\"#dialog-signature [name='signatureID2_Alpha']\").on(\"input\", function() {\n\t\t\t\t\tif (this.value.length === 3) {\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureID2_Numeric']\").select();\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Ensure second signature ID field only accepts numbers\n\t\t\t\t$(\"#dialog-signature [name='signatureID_Numeric'], #dialog-signature [name='signatureID2_Numeric']\").on(\"input\", function() {\n\t\t\t\t\twhile (!/^[0-9?]*$/g.test(this.value)) {\n\t\t\t\t\t\tthis.value = this.value.substring(0, this.value.length -1);\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Select value on click\n\t\t\t\t$(\"#dialog-signature .signatureID, #dialog-signature .wormholeType\").on(\"click\", function() {\n\t\t\t\t\t$(this).select();\n\t\t\t\t});\n\n\t\t\t\t// Auto fill opposite side wormhole w/ K162\n\t\t\t\t$(\"#dialog-signature .wormholeType\").on(\"input, change\", function() {\n\t\t\t\t\tif (this.value.length > 0 && $.inArray(this.value.toUpperCase(), aSigWormholes) != -1 && this.value.toUpperCase() != \"K162\") {\n\t\t\t\t\t\t$(\"#dialog-signature .wormholeType\").not(this).val(\"K162\");\n\n\t\t\t\t\t\t// Also auto calculate duration\n\t\t\t\t\t\tif (tripwire.wormholes[this.value.toUpperCase()]) {\n\t\t\t\t\t\t\t$(\"#dialog-signature #durationPicker\").val(tripwire.wormholes[this.value.toUpperCase()].life.substring(0, 2) * 60 * 60).change();\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (this.value.toUpperCase() === \"K162\") {\n\t\t\t\t\t\tif ($.inArray($(\"#dialog-signature .wormholeType\").not(this).val().toUpperCase(), aSigWormholes) === -1 || $(\"#dialog-signature .wormholeType\").not(this).val().toUpperCase() === \"K162\") {\n\t\t\t\t\t\t\t$(\"#dialog-signature .wormholeType\").not(this).val(\"????\");\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if (this.value == \"????\") {\n\t\t\t\t\t\t$(\"#dialog-signature .wormholeType\").not(this).val(\"K162\");\n\t\t\t\t\t}\n\t\t\t\t});\n\n\t\t\t\t// Toggle between wormhole and regular signatures\n\t\t\t\t$(\"#dialog-signature\").on(\"selectmenuchange\", \"[name='signatureType']\", function() {\n\t\t\t\t\tif (this.value == \"wormhole\") {\n\t\t\t\t\t\t$(\"#dialog-signature #site\").slideUp(200, function() { $(this).hide(0); });\n\t\t\t\t\t\t$(\"#dialog-signature #wormhole\").slideDown(200, function() { $(this).show(200); });\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(\"#dialog-signature #site\").slideDown(200, function() { $(this).show(200); });\n\t\t\t\t\t\t$(\"#dialog-signature #wormhole\").slideUp(200, function() { $(this).hide(0); });\n\t\t\t\t\t}\n\n\t\t\t\t\tValidationTooltips.close();\n\t\t\t\t});\n\n\t\t\t\t$(\"#form-signature\").submit(function(e) {\n\t\t\t\t\te.preventDefault();\n\t\t\t\t\tvar form = $(this).serializeObject();\n\t\t\t\t\tvar valid = true;\n\t\t\t\t\tValidationTooltips.close();\n\n\t\t\t\t\t// Validate full signature ID fields (blank | 3 characters)\n\t\t\t\t\t$.each($(\"#dialog-signature .signatureID:visible\"), function() {\n\t\t\t\t\t\tif (this.value.length > 0 && this.value.length < 3) {\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Must be 3 characters in length!\");\n\t\t\t\t\t\t\t$(this).select();\n\t\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!valid) return false;\n\n\t\t\t\t\t// Validate full signature ID doesn't already exist in current system\n\t\t\t\t\tif (form.signatureID_Alpha.length === 3 && form.signatureID_Numeric.length === 3 && Object.find(tripwire.client.signatures, \"signatureID\", form.signatureID_Alpha + form.signatureID_Numeric, true) != false && Object.find(tripwire.client.signatures, \"signatureID\", form.signatureID_Alpha + form.signatureID_Numeric, true).id != $(\"#dialog-signature\").data(\"signatureid\")) {\n\t\t\t\t\t\tvar existingSignature = Object.find(tripwire.client.signatures, \"signatureID\", form.signatureID_Alpha + form.signatureID_Numeric);\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-signature .signatureID:first\")}).setContent(\"Signature ID already exists! <input type='button' autofocus='true' id='overwrite' value='Overwrite' style='margin-bottom: -4px; margin-top: -4px; font-size: 0.8em;' data-id='\"+ existingSignature.id +\"' />\");\n\t\t\t\t\t\t$(\"#overwrite\").focus();\n\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\treturn false;\n\t\t\t\t\t}\n\t\t\t\t\tif (!valid) return false;\n\n\t\t\t\t\t// Validate wormhole types (blank | wormhole)\n\t\t\t\t\t$.each($(\"#dialog-signature .wormholeType:visible\"), function() {\n\t\t\t\t\t\tif (this.value.length > 0 && $.inArray(this.value.toUpperCase(), aSigWormholes) == -1 && this.value != \"????\") {\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Must be a valid wormhole type!\");\n\t\t\t\t\t\t\t$(this).select();\n\t\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!valid) return false;\n\n\t\t\t\t\t// Validate leads to system (blank | system)\n\t\t\t\t\t$.each($(\"#dialog-signature .leadsTo:visible\"), function() {\n\t\t\t\t\t\tif (this.value.length > 0 && tripwire.aSigSystems.findIndex((item) => this.value.toLowerCase() === item.toLowerCase()) == -1) {\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Must be a valid leads to system!\");\n\t\t\t\t\t\t\t$(this).select();\n\t\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!valid) return false;\n\n\t\t\t\t\t// Validate leads to isn't the viewing system which causes a inner loop\n\t\t\t\t\t$.each($(\"#dialog-signature .leadsTo:visible\"), function() {\n\t\t\t\t\t\tif (this.value.length > 0 && this.value.toLowerCase() === viewingSystem.toLowerCase()) {\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Wormhole cannot lead to the same system it comes from!\");\n\t\t\t\t\t\t\t$(this).select();\n\t\t\t\t\t\t\tvalid = false;\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tif (!valid) return false;\n\n\t\t\t\t\tvar payload = {};\n\t\t\t\t\tvar undo = [];\n\t\t\t\t\tif (form.signatureType === \"wormhole\") {\n\t\t\t\t\t\tvar signature = {\n\t\t\t\t\t\t\t\"signatureID\": form.signatureID_Alpha + form.signatureID_Numeric,\n\t\t\t\t\t\t\t\"systemID\": viewingSystemID,\n\t\t\t\t\t\t\t\"type\": \"wormhole\",\n\t\t\t\t\t\t\t\"name\": form.wormholeName,\n\t\t\t\t\t\t\t\"lifeLength\": form.signatureLength\n\t\t\t\t\t\t};\n\t\t\t\t\t\tvar leadsTo = null;\n\t\t\t\t\t\tif (Object.index(tripwire.systems, \"name\", form.leadsTo, true)) {\n\t\t\t\t\t\t\t// Leads To is a normal EVE system, so use the sytem ID\n\t\t\t\t\t\t\tleadsTo = Object.index(tripwire.systems, \"name\", form.leadsTo, true)\n\t\t\t\t\t\t} else if (tripwire.wormholes[form.wormholeType.toUpperCase()]) {\n\t\t\t\t\t\t\t// Leads To can be determined by the wormhole type, so lets use what we know it leads to\n\t\t\t\t\t\t\tif (tripwire.aSigSystems.findIndex((item) => tripwire.wormholes[form.wormholeType.toUpperCase()].leadsTo.replace(' ', '-').toLowerCase() === item.toLowerCase()) > -1) {\n\t\t\t\t\t\t\t\tleadsTo = tripwire.aSigSystems.findIndex((item) => tripwire.wormholes[form.wormholeType.toUpperCase()].leadsTo.replace(' ', '-').toLowerCase() === item.toLowerCase());\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else if (tripwire.aSigSystems.findIndex((item) => form.leadsTo.toLowerCase() === item.toLowerCase()) !== -1) {\n\t\t\t\t\t\t\t// Leads To is one of the valid types we allow, so use of of those indexes as reference\n\t\t\t\t\t\t\tleadsTo = tripwire.aSigSystems.findIndex((item) => form.leadsTo.toLowerCase() === item.toLowerCase());\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar signature2 = {\n\t\t\t\t\t\t\t\"signatureID\": form.signatureID2_Alpha + form.signatureID2_Numeric,\n\t\t\t\t\t\t\t\"systemID\": leadsTo,\n\t\t\t\t\t\t\t\"type\": \"wormhole\",\n\t\t\t\t\t\t\t\"name\": form.wormholeName2,\n\t\t\t\t\t\t\t\"lifeLength\": form.signatureLength\n\t\t\t\t\t\t};\n\t\t\t\t\t\tvar type = null;\n\t\t\t\t\t\tvar parent = null;\n\t\t\t\t\t\tif (form.wormholeType.length > 0 && $.inArray(form.wormholeType.toUpperCase(), aSigWormholes) != -1 && form.wormholeType.toUpperCase() != \"K162\") {\n\t\t\t\t\t\t\tparent = \"initial\";\n\t\t\t\t\t\t\ttype = form.wormholeType.toUpperCase();\n\t\t\t\t\t\t} else if (form.wormholeType2.length > 0 && $.inArray(form.wormholeType2.toUpperCase(), aSigWormholes) != -1 && form.wormholeType2.toUpperCase() != \"K162\") {\n\t\t\t\t\t\t\tparent = \"secondary\";\n\t\t\t\t\t\t\ttype = form.wormholeType2.toUpperCase();\n\t\t\t\t\t\t} else if (form.wormholeType.toUpperCase() == \"K162\") {\n\t\t\t\t\t\t\tparent = \"secondary\";\n\t\t\t\t\t\t\ttype = \"????\";\n\t\t\t\t\t\t} else if (form.wormholeType2.toUpperCase() == \"K162\") {\n\t\t\t\t\t\t\tparent = \"initial\";\n\t\t\t\t\t\t\ttype = \"????\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tvar wormhole = {\n\t\t\t\t\t\t\t\"type\": type,\n\t\t\t\t\t\t\t\"parent\": parent,\n\t\t\t\t\t\t\t\"life\": form.wormholeLife,\n\t\t\t\t\t\t\t\"mass\": form.wormholeMass\n\t\t\t\t\t\t};\n\t\t\t\t\t\tif (mode == \"update\") {\n\t\t\t\t\t\t\tsignature.id = $(\"#dialog-signature\").data(\"signatureid\");\n\t\t\t\t\t\t\tsignature2.id = $(\"#dialog-signature\").data(\"signature2id\");\n\t\t\t\t\t\t\twormhole.id = $(\"#dialog-signature\").data(\"wormholeid\");\n\n\t\t\t\t\t\t\t// Update the initial and type based on which side of the wormhole we are editing\n\t\t\t\t\t\t\tif (tripwire.client.wormholes[wormhole.id]) {\n\t\t\t\t\t\t\t\tif (form.wormholeType.length > 0 && $.inArray(form.wormholeType.toUpperCase(), aSigWormholes) != -1 && form.wormholeType.toUpperCase() != \"K162\") {\n\t\t\t\t\t\t\t\t\twormhole.parent = tripwire.client.wormholes[wormhole.id].initialID == signature.id ? \"initial\" : \"secondary\";\n\t\t\t\t\t\t\t\t\twormhole.type = form.wormholeType.toUpperCase();\n\t\t\t\t\t\t\t\t} else if (form.wormholeType2.length > 0 && $.inArray(form.wormholeType2.toUpperCase(), aSigWormholes) != -1 && form.wormholeType2.toUpperCase() != \"K162\") {\n\t\t\t\t\t\t\t\t\twormhole.parent = tripwire.client.wormholes[wormhole.id].initialID == signature.id ? \"secondary\" : \"initial\";\n\t\t\t\t\t\t\t\t\twormhole.type = form.wormholeType2.toUpperCase();\n\t\t\t\t\t\t\t\t} else if (form.wormholeType.toUpperCase() == \"K162\") {\n\t\t\t\t\t\t\t\t\twormhole.parent = tripwire.client.wormholes[wormhole.id].initialID == signature.id ? \"secondary\" : \"initial\";\n\t\t\t\t\t\t\t\t\twormhole.type = \"????\";\n\t\t\t\t\t\t\t\t} else if (form.wormholeType2.toUpperCase() == \"K162\") {\n\t\t\t\t\t\t\t\t\twormhole.parent = tripwire.client.wormholes[wormhole.id].initialID == signature.id ? \"initial\" : \"secondary\";\n\t\t\t\t\t\t\t\t\twormhole.type = \"????\";\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tpayload = {\"signatures\": {\"update\": [{\"wormhole\": wormhole, \"signatures\": [signature, signature2]}]}};\n\n\t\t\t\t\t\t\tif (tripwire.client.wormholes[wormhole.id]) {\n\t\t\t\t\t\t\t\t\t//used to be a wormhole\n\t\t\t\t\t\t\t\t\tundo.push({\"wormhole\": tripwire.client.wormholes[wormhole.id], \"signatures\": [tripwire.client.signatures[signature.id], tripwire.client.signatures[signature2.id]]});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t// used to be just a regular signature\n\t\t\t\t\t\t\t\t\tundo.push(tripwire.client.signatures[signature.id]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tpayload = {\"signatures\": {\"add\": [{\"wormhole\": wormhole, \"signatures\": [signature, signature2]}]}};\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\tif (mode == \"update\") {\n\t\t\t\t\t\t\tvar signature = {\n\t\t\t\t\t\t\t\t\"id\": $(\"#dialog-signature\").data(\"signatureid\"),\n\t\t\t\t\t\t\t\t\"signatureID\": form.signatureID_Alpha + form.signatureID_Numeric,\n\t\t\t\t\t\t\t\t\"systemID\": viewingSystemID,\n\t\t\t\t\t\t\t\t\"type\": form.signatureType,\n\t\t\t\t\t\t\t\t\"name\": form.signatureName,\n\t\t\t\t\t\t\t\t\"lifeLength\": form.signatureLength\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tpayload = {\"signatures\": {\"update\": [signature]}};\n\n\t\t\t\t\t\t\tif (tripwire.client.signatures[signature.id].type == \"wormhole\") {\n\t\t\t\t\t\t\t\t//used to be a wormhole\n\t\t\t\t\t\t\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n\t\t\t\t\t\t\t\tvar signature2 = signature.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\n\t\t\t\t\t\t\t\tundo.push({\"wormhole\": tripwire.client.wormholes[wormhole.id], \"signatures\": [tripwire.client.signatures[signature.id], tripwire.client.signatures[signature2.id]]});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// used to be just a regular signature\n\t\t\t\t\t\t\t\tundo.push(tripwire.client.signatures[signature.id]);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar signature = {\n\t\t\t\t\t\t\t\t\"signatureID\": form.signatureID_Alpha + form.signatureID_Numeric,\n\t\t\t\t\t\t\t\t\"systemID\": viewingSystemID,\n\t\t\t\t\t\t\t\t\"type\": form.signatureType,\n\t\t\t\t\t\t\t\t\"name\": form.signatureName,\n\t\t\t\t\t\t\t\t\"lifeLength\": form.signatureLength\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tpayload = {\"signatures\": {\"add\": [signature]}};\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Save')\").button(\"disable\");\n\n\t\t\t\t\tvar success = function(data) {\n\t\t\t\t\t\tif (data.resultSet && data.resultSet[0].result == true) {\n\t\t\t\t\t\t\t$(\"#dialog-signature\").dialog(\"close\");\n\n\t\t\t\t\t\t\t$(\"#undo\").removeClass(\"disabled\");\n\n\t\t\t\t\t\t\tif (mode == \"add\") {\n\t\t\t\t\t\t\t\tundo = data.results;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tif (viewingSystemID in tripwire.signatures.undo) {\n\t\t\t\t\t\t\t\ttripwire.signatures.undo[viewingSystemID].push({action: mode, signatures: undo});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttripwire.signatures.undo[viewingSystemID] = [{action: mode, signatures: undo}];\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tsessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar always = function() {\n\t\t\t\t\t\t$(\"#sigEditForm input[type=submit]\").removeAttr(\"disabled\");\n\t\t\t\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Save')\").button(\"enable\");\n\t\t\t\t\t}\n\n\t\t\t\t\ttripwire.refresh('refresh', payload, success, always);\n\t\t\t\t});\n\t\t\t},\n\t\t\topen: function() {\n\t\t\t\t$(\"#dialog-signature\").data(\"signatureid\", \"\");\n\t\t\t\t$(\"#dialog-signature\").data(\"signature2id\", \"\");\n\t\t\t\t$(\"#dialog-signature\").data(\"wormholeid\", \"\");\n\n\t\t\t\t$(\"#dialog-signature input\").val(\"\");\n\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(\"unknown\").selectmenu(\"refresh\");\n\n\t\t\t\t$(\"#dialog-signature [name='wormholeLife']\").val(\"stable\").selectmenu(\"refresh\");\n\t\t\t\t$(\"#dialog-signature [name='wormholeMass']\").val(\"stable\").selectmenu(\"refresh\");\n\n\t\t\t\t$(\"#dialog-signature #site\").show();\n\t\t\t\t$(\"#dialog-signature #wormhole\").hide();\n\n\t\t\t\t// Side labels\n\t\t\t\t$(\"#dialog-signature .sideLabel:first\").html(viewingSystem + \" Side\");\n\t\t\t\t$(\"#dialog-signature .sideLabel:last\").html(\"Other Side\");\n\n\t\t\t\t// Default signature life\n\t\t\t\t$(\"#dialog-signature #durationPicker\").val(options.signatures.pasteLife * 60 * 60).change();\n\n\t\t\t\tif (mode == \"update\" && $(element).data(\"id\") && tripwire.client.signatures[$(element).data(\"id\")]) {\n\t\t\t\t\tvar id = $(element).data(\"id\");\n\t\t\t\t\tvar signature = tripwire.client.signatures[id];\n\t\t\t\t\t$(\"#dialog-signature\").data(\"signatureid\", id);\n\n\t\t\t\t\t// Change the dialog buttons\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Add')\").hide();\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Save')\").show();\n\n\t\t\t\t\t// Change the dialog title\n\t\t\t\t\t$(\"#dialog-signature\").dialog(\"option\", \"title\", \"Edit Signature\");\n\n\t\t\t\t\tif (signature.type == \"wormhole\") {\n\t\t\t\t\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == id || wormhole.secondaryID == id) return wormhole; })[0];\n\t\t\t\t\t\tvar otherSignature = id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\n\t\t\t\t\t\t$(\"#dialog-signature\").data(\"signature2id\", otherSignature.id);\n\t\t\t\t\t\t$(\"#dialog-signature\").data(\"wormholeid\", wormhole.id);\n\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Alpha']\").val(signature.signatureID ? signature.signatureID.substr(0, 3) : \"???\");\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Numeric']\").val(signature.signatureID ? signature.signatureID.substr(3, 5) : \"\");\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(signature.type).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\n\t\t\t\t\t\t$(\"#dialog-signature [name='wormholeName']\").val(signature.name);\n\t\t\t\t\t\t$(\"#dialog-signature [name='leadsTo']\").val(tripwire.systems[otherSignature.systemID] ? tripwire.systems[otherSignature.systemID].name : (tripwire.aSigSystems[otherSignature.systemID] ? tripwire.aSigSystems[otherSignature.systemID] : \"\"));\n\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID2_Alpha']\").val(otherSignature.signatureID ? otherSignature.signatureID.substr(0, 3) : \"???\");\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID2_Numeric']\").val(otherSignature.signatureID ? otherSignature.signatureID.substr(3, 5) : \"\");\n\t\t\t\t\t\t$(\"#dialog-signature [name='wormholeName2']\").val(otherSignature.name);\n\t\t\t\t\t\t$(\"#dialog-signature [name='wormholeLife']\").val(wormhole.life).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\n\t\t\t\t\t\t$(\"#dialog-signature [name='wormholeMass']\").val(wormhole.mass).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\n\n\t\t\t\t\t\tif (wormhole[wormhole.parent+\"ID\"] == signature.id) {\n\t\t\t\t\t\t\t$(\"#dialog-signature input[name='wormholeType']\").val(wormhole.type).change();\n\t\t\t\t\t\t} else if (wormhole[wormhole.parent+\"ID\"] == otherSignature.id) {\n\t\t\t\t\t\t\t$(\"#dialog-signature input[name='wormholeType2']\").val(wormhole.type).change();\n\t\t\t\t\t\t}\n\t\t\t\t\t\t$(\"#dialog-signature #durationPicker\").val(signature.lifeLength).change();\n\t\t\t\t\t} else {\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Alpha']\").val(signature.signatureID ? signature.signatureID.substr(0, 3) : \"???\");\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Numeric']\").val(signature.signatureID ? signature.signatureID.substr(3, 5) : \"\");\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(signature.type).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureName']\").val(signature.name);\n\t\t\t\t\t\t$(\"#dialog-signature #durationPicker\").val(signature.lifeLength).change();\n\t\t\t\t\t}\n\n\t\t\t\t\t// Heightlight first ID section\n\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Alpha']\").select();\n\t\t\t\t} else {\n\t\t\t\t\t// Change the dialog buttons\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Add')\").show();\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Save')\").hide();\n\n\t\t\t\t\t// Change the dialog title\n\t\t\t\t\t$(\"#dialog-signature\").dialog(\"option\", \"title\", \"Add Signature\");\n\n\t\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(options.signatures.editType || \"unknown\").selectmenu(\"refresh\")\n\t\t\t\t\tif ($(\"#dialog-signature [name='signatureType']\").val() === \"wormhole\") {\n\t\t\t\t\t\t$(\"#dialog-signature #site\").hide();\n\t\t\t\t\t\t$(\"#dialog-signature #wormhole\").show();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t\tclose: function() {\n\t\t\t\tValidationTooltips.close();\n\t\t\t\t$(\"#sigTable tr.selected\").removeClass(\"selected\");\n\t\t\t\t$(\"#dialog-signature\").data(\"signatureid\", \"\");\n\t\t\t\t$(\"#dialog-signature\").data(\"signature2id\", \"\");\n\t\t\t\t$(\"#dialog-signature\").data(\"wormholeid\", \"\");\n\t\t\t}\n\t\t});\n\t} else if (!$(\"#dialog-signature\").dialog(\"isOpen\")) {\n\t\t$(\"#dialog-signature\").dialog(\"open\");\n\t}\n};\n"]}