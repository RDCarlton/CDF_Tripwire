{"version":3,"sources":["helpers.js","zarzakh.js","init.js","options.js","layout.js","tripwire.js","global-hooks.js","wormholeRendering.js","widget-inlinecomplete.js","systemAnalysis.js","favourite.js","invasions.js","guidance.js","systemRendering.js","chain-map-renderer-orgchart.js","chain-map-renderer-radial.js","chain-map.js","guidance_profiles.js","systemPanel.js","active.js","addSignature.js","api.js","automapper.js","comments.js","deleteSignature.js","editSignature.js","esi.js","eve.js","genericSystemTypes.js","parse.js","paste.js","redo.js","serverStatus.js","sync.js","systemChange.js","tutorials.js","undo.js","activity-graph.js","ckeditor.js","fw.js","wormholeAnalysis.js","dialogs/admin-dialog.js","dialogs/base-dialog.js","dialogs/options-dialog.js","dialogs/ping-dialog.js","dialogs/signature-delete-dialog.js","dialogs/signature-dialog.js"],"names":["Object","sort","obj","prop","swapped","prev","i","Number","tmp","index","val","cs","key","toLowerCase","find","maxTime","maxTimeString","Date","time","dates","push","length","getTime","$","fn","serializeObject","self","this","json","push_counters","patterns","validate","fixed","named","build","base","value","push_counter","undefined","each","serializeArray","test","name","k","keys","match","merge","reverse_key","pop","replace","RegExp","extend","jQuery","letterToNumbers","string","toUpperCase","letters","sum","Math","pow","indexOf","substr","sigFormat","input","type","alpha","numeric","format","options","chain","typeFormat","classFormat","x","l","positionRelativeTo","elem","ancestor","elemPos","getBoundingClientRect","ancestorPos","left","scrollLeft","top","scrollTop","lookupMultiple","map","propertyName","lookupString","suppress","values","split","results","v","r","join","getCookie","c_name","c_value","document","cookie","c_start","c_end","unescape","substring","setCookie","exdays","exdate","setDate","getDate","escape","toUTCString","location","protocol","originalAddClassMethod","addClass","originalRemoveClassMethod","removeClass","className","result","apply","arguments","trigger","appData","regions","factions","systems","regionID","constellationID","factionID","security","shortest","forEach","findSystemID","systemName","viewingSystem","attr","viewingSystemID","server","app_name","version","html","window","stop","saveTimer","localOverrides","localOptions","JSON","parse","localStorage","getItem","userID","init","character","id","characterID","characterName","background","uiscale","favorites","grid","tracking","active","masks","corporationID","gridlines","aura","tabs","node-reference","zoom","sigNameLocation","routingLimit","routeSecurity","routeIgnore","enabled","renderer","nodeSpacing","y","signatures","editType","copySeparator","pasteLife","alignment","sigID","sigType","sigAge","leadsTo","sigLife","sigMass","buttons","follow","chainWidget","viewing","signaturesWidget","autoMapper","saveDelay","delay","clearTimeout","setTimeout","save","stringify","get","setItem","ajax","url","data","mode","dataType","load","set","tripwire","set_tracking_text","local","constructor","reset","defaults","hasOwnProperty","oog","data-col","col","data-row","row","data-sizex","size_x","data-sizey","size_y","css","width","height","favorite","parseInt","home","kspace","evescout","inArray","a","href","hostname","pathname","search","filter","$tab","clone","systemID","append","guidance","clearCache","redraw","gridster","widget_selector","avoid_overlapped_widgets","widget_base_dimensions","widget_margins","autogrow_cols","helper","draggable","start","e","ui","resize","handle_class","min_size","$widget","serialize_params","$w","wgd","disable","disable_resize","visibility","click","hasClass","serialize","enable","enable_resize","timer","xhr","client","wormholes","list","undo","sessionStorage","redo","serverSignatureCount","activity","esi","refreshRate","connected","ageFormat","instance","_this","sync","setAgeFormat","countdown","serverTime","chainMap","draw","pastEOL","since","layout","whTooltip","sig","item","tooltip","sig2Type","whType","life","Intl","NumberFormat","mass","jump","ageTooltip","date","lifeTime","getMonth","getHours","getMinutes","createdByName","modifiedTime","modifiedByName","refresh","successCallback","alwaysCallback","getSystemIDsByNames","systemNames","characters","getElementById","textContent","style","display","on","preventDefault","system","systemChange","ctrlKey","parseFloat","originalEvent","wheelDelta","fadeIn","timeout","keydown","activeElement","is","metaKey","keyCode","getSelection","toString","output","signature","signatureID","wormhole","initialID","secondaryID","otherSignature","genericSystemTypes","lifeLength","lifeLeft","text","focus","select","Notify","splice","target","innerHTML","f","systemInfo","systemAnalysis","analyse","systemRendering","renderSystem","toggle","EVE","show","hide","removeAttr","remove","isArray","delete","esiDelete","isInPanel","content","color","stick","jBox","offset","animation","autoClose","ValidationTooltips","fade","Tooltips","attach","getContent","position","outside","SystemActivityToolTips","appendTo","reposition","repositionOnOpen","createOnInit","onOpen","targetPos","tooltipWidth","source","closest","container","parent","offsetHeight","WormholeRouteToolTips","WormholeTypeToolTips","adjustDistance","responsiveWidth","OccupiedToolTips","pointer","minWidth","repositionOnContent","offsetWidth","setContent","cache","done","occupants","chars","b","shipTypeName","formatSignatureID","linkSig","sigName","sortable","items","axis","tolerance","containment","update","newTabs","setActiveTab","stopPropagation","dialog","Remove Tab","Cancel","resizable","minHeight","dialogClass","OK","submit","open","close","create","inlinecomplete","aSigSystems","maxSize","thera","checked","eq","contextmenu","delegate","menu","event","my","at","of","children","colName","cmd","beforeOpen","effect","duration","nodeElem","showInfo","setDestination","collapsed","collapse","existingTabIndex","newTab","wormholeID","class","existingTab","autoOpen","Close","payload","jumps","totalMass","jumpMass","shipTypeID","toID","typeName","moogle","prototype","setFlare","flare","flares","removeFlare","tablesorter","sortReset","widgets","textExtraction","2","node","toggleClass","shiftKey","nextUntil","addBack","add","Ok","easing","wormholeRendering","formatEndTypes","types","override","Array","overrideSystem","eligibleTypes","genericSystemType","systemTypeClass","systemTypeName","renderWormholeType","from","renderMass","widget","autocomplete","_create","_coerceSource","element","_selectInit","_super","_value","originalReturn","_superApply","change","_suggest","assign","bind","_initSource","request","response","matcher","escapeRegex","term","dataSource","label","_renderItem","ul","renderResult","renderers","_close","input_source","addToSelect","select_added_value","select_source","unshift","removeFromSelect","wrapper","trim","toArray","_createShowAllButton","that","wasOpen","button","icons","primary","customDropdown","_search","wormholeType","mutators","addMutator","m","leadsToPointer","nodeClass","nodeSecurity","nodeFaction","getDummySystem","baseSecurity","pathSymbol","systemTypeModifiers","mutate","effectClass","mutator_favourite","_FavouriteMutator","invasions","_Invasions","pathSymbolMap","stellar_reconnaissance","triglavian_minor_victory","escalating_liminality","final_liminality","edencom_minor_victory","redoubt","bulwark","fortress","textMap","_","keyBy","system_id","status","derived_security_status","updated_at","system_name","system_security","system_sovereignty","systemInvasion","tip","sorter","adjustCostForOptions","mapCost","toSystem","adjustJumpCost","to","cost","Guidance","jumpCostModifiers","reduce","modifier","findPaths","end","limit","endsInStart","costs","0","predecessors","addToOpen","vertex","bucket","shift","currentCost","adjacentNodes","vertexText","totalCost","vertexCost","extractShortest","nodes","u","predecessor","reverse","kSpaceCache","findShortestPath","cacheKey","cachedPath","connections","closed","renderPath","path","systemMarkup","slice","s","renderEffect","tag","ChainMapRendererOrgchart","owner","google","visualization","OrgChart","allowHtml","allowCollapse","size","events","addListener","collapseHandler","DataView","DataTable","cols","ready","drawing","switchTo","charts","setOnLoadCallback","switchFrom","lines","newView","nodeId","nodeVal","updateLines","drawNodeLine","addModes","jquerySelector","prefixes","doModeClasses","c","removeModes","classFunc","prefix","$node","nodeIndex","ceil","cellIndex","$connector","$parent","nodeCol","connectorCell","colSpan","parentIndex","newparentIndex","checkSystem","rows","$connecte","me","tempCol","breaker","skip","lastLineData","concat","getCollapsedNodes","collapsedSystems","updateCollapsed","ChainMapRendererRadial","newDiv","createElement","appendChild","div","parentNode","removeChild","mapData","drawInner","CIRCLE_SIZE","first_ring_delta","ringX","ci","ringY","maps","nodesById","ri","inNode","mapNode","minArc","newMap","circles","arc","circle","connection","styles","markup","mi","ni","mapDiv","innerContainer","firstChild","bounds","makeDivsForRing","PI","domNode","finalPositions","w","h","cx","cy","parentWidth","parentHeight","outerContainer","canvas","getElementsByTagName","ctx","getContext","scale","translate","maxCi","beginPath","ellipse","lineWidth","setLineDash","strokeStyle","propertyFromCssClass","stroke","moveTo","cp1","radToCartesian","radPosition","theta","cp2","bezierCurveTo","lineTo","auraColor","shadowBlur","shadowColor","ai","restore","dashed","minRad","maxRad","parentCollapsed","skipped","rads_per_arc","acc","rad_offset","alignment_delta","frag","createRange","createContextualFragment","dblclick","dr","rad_centre","excess","nextBounds","rad","sin","cos","property","cssText","body","getComputedStyle","getPropertyValue","view","thirdPartySuppliers","orgChart","radial","useRenderer","elements","querySelectorAll","getAttribute","shipJumps","podKills","shipKills","npcKills","getElementsByClassName","setAttribute","pods","ships","npcs","attachedElements","detach","occupied","count","next","max","topLevel","tab","makeSystemNode","whId","inSigId","nodeTypeMarkup","additionalClasses","systemType","systemNameText","chainNode","statics","shortCodeMap","High-Sec","Low-Sec","Null-Sec","Triglavian","Class-1","Class-2","Class-3","Class-4","Class-5","Class-6","classMap","H","L","N","▼","formatStatics","makeCalcChildNode","childID","targetSystem","child","calcNode","calculated","nth","findLinks","parentID","chainList","connectedTo","addCalcChildNodes","chainLinks","chainData","usedLinks","sig1","sig2","sig1Type","parentType","childType","floor","random","typeBM","classBM","sigIndex","supplier","ids","nextChildID","supplierNodes","ti","supplierNode","thirdParty","nodeNameSuffix","systemsInChainMap","sigText","modifiers","connectionWormhole","wormholeAnalysis","wormholeFromTypePair","likelyWormhole","parentModifiers","chainModifiers","p","cm","parentPathHome","pathHome","exits","newIndex","rawMap","drawRetryTimer","systemPanel","expires","universeJumps","getResponseHeader","ship_jumps","then","universeKills","pod_kills","ship_kills","npc_kills","guidance_profiles","blueLootSystems","chainExits","renderRoute","targets","addPathHome","cssClass","categoryText","inChain","exitSystem","n","editSigs","editComments","editSig","editComment","animate","backgroundColor","fadeOut","makeSigInfo","wh","wormholeTypeText","formattedType","lifeText","critical","stable","addSig","option","disabled","returnLinkText","sigInfo","leadsToText","tr","until","moment","utc","toDate","onExpiry","alwaysExpire","compact","serverSync","wrapInner","slideDown","$set","replaceWith","contents","setReturnSig","sigToRemoveId","sigToUpdate","returnSig","sigToRemove","sigDialog","overwriteSignature","API","indicator","APIrefresh","expire","periodsToSeconds","onTick","t","automapState","pendingDecision","console","info","noMapSystems","stationID","initial","secondary","toClass","title","signature2","resultSet","formatSystem","empty","trElem","action","comments","modified","$comment","comment","err","message","sticky","commentID","before","created","deleteSig","slideUp","edit","locationTimer","shipTimer","onlineTimer","baseUrl","userAgent","navigator","oauth","subject","accessToken","isExpired","tokenExpire","subtract","isBefore","expired","param","token","user_agent","jqXHR","locationDate","solar_system_id","stationName","shipID","shipName","station_id","stationLookup","always","reference","fail","warn","ship","shipDate","ship_item_id","ship_name","ship_type_id","typeLookup","online","characterStatus","typeID","destinationID","clear_waypoints","beginning","destination_id","clear_other_waypoints","add_to_beginning","headers","Authorization","X-User-Agent","targetID","target_id","eveStatus","idLookup","eveIDs","contentType","processData","characterLookup","eveID","async","corporationLookup","allianceLookup","searchString","categories","strict","fullLookup","promise","Deferred","category","characterData","corporation_id","corporationData","corporation","alliance_id","allianceData","alliance","resolve","parseOauth","_data","$clone","characterChange","updateSignatureTable","newSigsInSystem","mask","column","editing","sigEditing","currentSystem","signatureCount","updateReturnStatus","wormholeId","returnSigId","needReturn","pasteSignatures","processing","rowParse","scanner","columns","validScanGroups","validTypes","Combat Site","Data Site","Gas Site","Ore Site","Relic Site","Wormhole","Site de combat","Site de données","Site de collecte de gaz","Site de minerai","Site de reliques","Trou de ver","Kampfgebiet","Datengebiet","Gasgebiet","Mineraliengebiet","Reliktgebiet","Wurmloch","戦闘サイト","データサイト","ガスサイト","鉱石サイト","遺物サイト","ワームホール","전투 사이트","데이터 사이트","가스 사이트","채광 사이트","유물 사이트","웜홀","Боевой район","Информационный район","Газовый район","Астероидный район","Археологический район","Червоточина","scanGroup","parsePaste","paste","pasteIDs","removes","scan","clipboardData","getData","blur","lastIndex","redoItem","serverStatus","players","times","updateServerTime","innerText","setInterval","log","signatureTime","flareCount","flareTime","last_modified","commentCount","commentTime","o","wormholeInitialIDs","wormholeSecondaryIDs","notify","discord_integration","history","replaceState","effects","bad","whClass","abs","securityText","HS","LS","NS","Trig","toFixed","fw","factionMarkup","fi","tutorial","introJs","setOptions","showStepNumbers","steps","querySelector","intro","exitOnEsc","exitOnOverlayClick","skipLabel","onchange","_currentStep","previousMask","stepFunc","_options","setOption","exiting","exit","goToStep","off","onexit","undoItem","graph","span","role","calc","d","getValue","sourceColumn","setColumns","selectHandler","selections","AreaChart","isStacked","hAxis","textStyle","fontName","fontSize","showTextEvery","vAxis","viewWindowMode","viewWindow","min","maxValue","gridlineColor","pointSize","chartArea","legend","showColorCode","annotations","domain","focusTarget","CKConfig","skin","allowedContent","extraPlugins","enterMode","CKEDITOR","ENTER_BR","removeDialogTabs","autoGrow_onStartup","autoGrow_minHeight","toolbar_minToolbar","toolbar_maxToolbar","toolbar","smallToolbar","maximizedToolbar","fontSize_style","font-size","overrides","attributes","cke","editor","domEvent","altKey","selected_ranges","getRanges","startContainer","parents","getParents","getFirst","getNext","selectElement","selectRanges","ev","definition","getContents","commentSortHandler","sortOrder","sortElem","containerElem","nextSort","flexDirection","removeAllRanges","$this","instances","modifiedDate","createdDate","destroy","Delete","_FactionWarfare","listeners","SamanuniAthounonGateOpen","isEqual","error","occupier_faction_id","contested","victory_points","victory_points_threshold","objAndKey","targetSystemID","systemText","lookupText","findIndex","eligibleWormholeTypes","sourceDef","targetDef","coerce","def","matches","possibleSystems","exclusions","entries","wt","notFrom","notLeadsTo","dummyWormholes","GATE","SML","MED","LRG","XLG","type1","type2","system1","system2","class1","class2","refreshTimer","$total","$ajax","refreshWindow","abort","$row","$col","modal","$menuItem","sortList","parentElement","Save","maskChange","slider","Reset","stats","system_visits","account","logins","lastLogin","username","admin","img","optional","setUpSlider","step","slide","accordion","heightStyle","collapsible","direction","Add","Remove","send","Create","selectmenu","total","Send","fromSignature","sigDialogVM","openSignatureDialog","sigId","aSigWormholes","K162","getTargetName","sigTypeDropdownFiller","extractor","eligible","durationPicker","not","form","valid","signatureID_Alpha","signatureID_Numeric","sigKey","existing","signatureType","wormholeName","signatureLength","signatureID2_Alpha","signatureID2_Numeric","wormholeName2","wormholeType2","wormholeLife","wormholeMass","signatureName","sigAlpha","completeFunction","delegateSave"],"mappings":"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","file":"app.min.js","sourcesContent":["Object.sort = function(obj, prop) {\r\n\tvar swapped, prev;\r\n\tdo {\r\n\t\tswapped = false, prev = null;\r\n\t\tfor (var i in obj) {\r\n\t\t\tif (prev && Number(obj[i][prop]) < Number(obj[prev][prop])) {\r\n\t\t\t\tvar tmp = obj[i];\r\n\t\t\t\tobj[i] = obj[prev];\r\n\t\t\t\tobj[prev] = tmp;\r\n\t\t\t\tswapped = true;\r\n\t\t\t}\r\n\t\t\tprev = i;\r\n\t\t}\r\n\t} while (swapped);\r\n}\r\n\r\nObject.index = function(obj, prop, val, cs) {\r\n\tfor (var key in obj) {\r\n\t\tif (!cs && obj[key][prop] == val) {\r\n\t\t\treturn key;\r\n\t\t} else if (obj[key][prop] && obj[key][prop].toLowerCase() == val.toLowerCase()) {\r\n\t\t\treturn key;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nObject.find = function(obj, prop, val, cs) {\r\n\tfor (var key in obj) {\r\n\t\tif (!cs && obj[key][prop] == val) {\r\n\t\t\treturn obj[key];\r\n\t\t} else if (obj[key][prop] && obj[key][prop].toLowerCase() == val.toLowerCase()) {\r\n\t\t\treturn obj[key];\r\n\t\t}\r\n\t}\r\n\r\n\treturn false;\r\n}\r\n\r\nObject.maxTime = function(obj, prop) {\r\n\tvar maxTimeString = \"\", maxTime;\r\n\r\n\tfor (var key in obj) {\r\n\t\tif (!maxTime || maxTime < new Date(obj[key][prop])) {\r\n\t\t\tmaxTime = new Date(obj[key][prop]);\r\n\t\t\tmaxTimeString = obj[key][prop];\r\n\t\t}\r\n\t}\r\n\treturn maxTimeString;\r\n}\r\n\r\nObject.time = function(obj) {\r\n\tvar dates = [], key;\r\n\tfor (key in obj) {\r\n\t\tdates.push(new Date(obj[key].time));\r\n\t}\r\n\r\n\treturn dates.length ? dates.sort()[dates.length -1].getTime() /1000 : 0;\r\n};\r\n\r\n(function($){\r\n    $.fn.serializeObject = function(){\r\n\r\n        var self = this,\r\n            json = {},\r\n            push_counters = {},\r\n            patterns = {\r\n                \"validate\": /^[a-zA-Z][a-zA-Z0-9_]*(?:\\[(?:\\d*|[a-zA-Z0-9_]+)\\])*$/,\r\n                \"key\":      /[a-zA-Z0-9_]+|(?=\\[\\])/g,\r\n                \"push\":     /^$/,\r\n                \"fixed\":    /^\\d+$/,\r\n                \"named\":    /^[a-zA-Z0-9_]+$/\r\n            };\r\n\r\n\r\n        this.build = function(base, key, value){\r\n            base[key] = value;\r\n            return base;\r\n        };\r\n\r\n        this.push_counter = function(key){\r\n            if(push_counters[key] === undefined){\r\n                push_counters[key] = 0;\r\n            }\r\n            return push_counters[key]++;\r\n        };\r\n\r\n        $.each($(this).serializeArray(), function(){\r\n\r\n            // skip invalid keys\r\n            if(!patterns.validate.test(this.name)){\r\n                return;\r\n            }\r\n\r\n            var k,\r\n                keys = this.name.match(patterns.key),\r\n                merge = this.value,\r\n                reverse_key = this.name;\r\n\r\n            while((k = keys.pop()) !== undefined){\r\n\r\n                // adjust reverse_key\r\n                reverse_key = reverse_key.replace(new RegExp(\"\\\\[\" + k + \"\\\\]$\"), '');\r\n\r\n                // push\r\n                if(k.match(patterns.push)){\r\n                    merge = self.build([], self.push_counter(reverse_key), merge);\r\n                }\r\n\r\n                // fixed\r\n                else if(k.match(patterns.fixed)){\r\n                    merge = self.build([], k, merge);\r\n                }\r\n\r\n                // named\r\n                else if(k.match(patterns.named)){\r\n                    merge = self.build({}, k, merge);\r\n                }\r\n            }\r\n\r\n            json = $.extend(true, json, merge);\r\n        });\r\n\r\n        return json;\r\n    };\r\n})(jQuery);\r\n\r\nvar letterToNumbers = function(string) {\r\n    string = string.toUpperCase();\r\n    var letters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ', sum = 0, i;\r\n    for (i = 0; i < string.length; i++) {\r\n        sum += Math.pow(letters.length, i) * (letters.indexOf(string.substr(((i + 1) * -1), 1)) + 1);\r\n    }\r\n    return sum;\r\n};\r\n\r\nvar sigFormat = function(input, type) {\r\n\tif (!input) return \"\";\r\n\r\n\tvar alpha = /^[a-zA-Z]+$/;\r\n\tvar numeric = /^[0-9]+$/;\r\n\tvar format = type == \"type\" ? options.chain.typeFormat || \"\" : options.chain.classFormat || \"\";\r\n\r\n\tfor (var x = 0, l = format.length; x < l; x++) {\r\n\t\tif (format[x].match(alpha)) {\r\n\t\t\tif (format[x].toUpperCase() == \"B\" && input == \"a\") {\r\n\t\t\t\treturn \"\";\r\n\t\t\t} else {\r\n\t\t\t\tif (format[x] == format[x].toUpperCase()) {\r\n\t\t\t\t\tformat = format.substr(0, x) + input.toUpperCase() + format.substr(x + 1, l);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tformat = format.substr(0, x) + input + format.substr(x + 1, l);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t} else if (format[x].match(numeric)) {\r\n\t\t\tif (format[x] == 2 && input == \"a\") {\r\n\t\t\t\treturn \"\";\r\n\t\t\t} else {\r\n\t\t\t\tformat = format.substr(0, x) + letterToNumbers(input) + format.substr(x +1, l);\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn format;\r\n};\r\n\r\n/** Find the relative position of one element within the hierarchy tree of another */\r\nfunction positionRelativeTo(elem, ancestor) {\r\n\tconst elemPos = elem.getBoundingClientRect(),\r\n\t\tancestorPos = ancestor.getBoundingClientRect();\r\n\treturn { \r\n\t\tleft: elemPos.left - ancestorPos.left + ancestor.scrollLeft,\r\n\t\ttop: elemPos.top - ancestorPos.top + ancestor.scrollTop\r\n\t};\r\n}\r\n\r\n/** Look up one or more values in a comma separated string as keys in a data map, and return a property from the results in a new comma separated string.\r\nConvenience function for UI mapping.\r\nWill throw a failure message, unless suppress=true in which case it will return undefined, if \r\nany of the lookups fail to resolve. */\r\nfunction lookupMultiple(map, propertyName, lookupString, suppress) {\r\n\tconst values = lookupString.split(',');\r\n\tconst results = [];\r\n\tfor(var i = 0; i < values.length; i++) {\r\n\t\tconst v = values[i];\r\n\t\tconst r = map[v];\r\n\t\tif(!r) { \r\n\t\t\tif(suppress) { return undefined;}\r\n\t\t\telse { throw 'Value ' + v + ' did not match anything in ' + map; }\r\n\t\t}\r\n\t\tresults.push(r[propertyName]);\r\n\t}\r\n\treturn results.join(',');\r\n}\r\n\r\nvar getCookie = function(c_name) {\r\n\tvar c_value = document.cookie;\r\n\r\n\tvar c_start = c_value.indexOf(\" \" + c_name + \"=\");\r\n\tif (c_start == -1) {\r\n\t\tc_start = c_value.indexOf(c_name + \"=\");\r\n\t}\r\n\r\n\tif (c_start == -1) {\r\n\t\tc_value = null;\r\n\t} else {\r\n\t\tc_start = c_value.indexOf(\"=\", c_start) + 1;\r\n\t\tvar c_end = c_value.indexOf(\";\", c_start);\r\n\r\n\t\tif (c_end == -1) {\r\n\t\t\tc_end = c_value.length;\r\n\t\t}\r\n\r\n\t\tc_value = unescape(c_value.substring(c_start, c_end));\r\n\t}\r\n\r\n\treturn c_value;\r\n};\r\n\r\nvar setCookie = function(c_name, value, exdays) {\r\n\tvar exdate = new Date();\r\n\texdate.setDate(exdate.getDate() + exdays);\r\n\tvar c_value = escape(value) + ((exdays == null) ? \"\" : \"; expires=\"+exdate.toUTCString());\r\n\r\n\tdocument.cookie = c_name + \"=\" + c_value + \";\" + (document.location.protocol == \"https:\" ? \"secure;\" : \"\");\r\n};\r\n\r\n// Global CSS class change event\r\n(function($) {\r\n    var originalAddClassMethod = $.fn.addClass;\r\n\tvar originalRemoveClassMethod = $.fn.removeClass;\r\n\r\n    $.fn.addClass = function(className) {\r\n        // Execute the original method.\r\n        var result = originalAddClassMethod.apply(this, arguments);\r\n\r\n        // trigger a custom event\r\n        this.trigger('classchange', className);\r\n\r\n        // return the original result\r\n        return result;\r\n    }\r\n\r\n\t$.fn.removeClass = function(className) {\r\n        // Execute the original method.\r\n        var result = originalRemoveClassMethod.apply(this, arguments);\r\n\r\n        // trigger a custom event\r\n        this.trigger('classchange', className);\r\n\r\n        // return the original result\r\n        return result;\r\n    }\r\n})(jQuery);\r\n\r\n","appData.regions[10001000] = { name: 'Yasna Zakh' };\r\nappData.factions[500029] = { name: 'Deathless Custodians' };\r\nappData.systems[30100000] = {\r\n\tname: 'Zarzakh',\r\n\tregionID: 10001000,\r\n\tconstellationID: 20010000,\r\n\tfactionID: 500029,\r\n\tsecurity: -1.0\r\n};\r\nappData.map.shortest[100000] = {};\r\n[1041, 1269, 2086, 3841].forEach(function(x) { \r\n\tappData.map.shortest[100000][x] = 0;\r\n\tappData.map.shortest[x][100000] = 0;\r\n});","function findSystemID(systemName) {\r\n\tfor(let k in appData.systems) {\r\n\t\tif(appData.systems[k].name.toUpperCase() === systemName.toUpperCase()) return k; \r\n\t}\r\n\treturn undefined;\r\n}\r\n\r\nvar viewingSystem = $(\"meta[name=system]\").attr(\"content\");\r\nvar viewingSystemID = findSystemID(viewingSystem);\r\nvar server = $(\"meta[name=server]\").attr(\"content\");\r\nvar app_name = $(\"meta[name=app_name]\").attr(\"content\");\r\nvar version = $(\"meta[name=version]\").attr(\"content\");\r\n\r\n// Page cache indicator\r\nif (getCookie(\"loadedFromBrowserCache\") == \"true\") {\r\n\t$(\"#pageTime\").html(\"Page is Cached\");\r\n}\r\n\r\n// Reload with default system if it was invalid\r\nif(!viewingSystemID) { window.stop(); window.location = '?system=Jita'; }\r\n\r\n\r\n// setCookie('loadedFromBrowserCache', true);\r\n\r\n// Use this to test performance of javascript code lines\r\n// var startTime = window.performance.now();\r\n// console.log(\"stint: \"+ (window.performance.now() - startTime));\r\n","var options = new function() {\r\n\tvar localOverrides = [\"grid\"];\r\n\tvar localOptions = JSON.parse(localStorage.getItem(\"tripwire_options\"));\r\n\tvar saveTimer;\r\n\r\n\tthis.userID = init.userID;\r\n\tthis.character = {id: init.characterID, name: init.characterName};\r\n\tthis.background = null;\r\n\tthis.uiscale = 1.0;\r\n\tthis.favorites = [];\r\n\tthis.grid = {};\r\n\tthis.tracking = {active: \"new\"};\r\n\tthis.masks = {active: init.corporationID + \".2\"};\r\n\tthis.chain = {typeFormat: null, classFormat: null, gridlines: true, aura: true, active: 0, tabs: [], \"node-reference\": \"type\", zoom: 1.0, sigNameLocation: 'name', routingLimit: 15, routeSecurity: 'shortest', routeIgnore: { enabled: false, systems: [ 'Tama', 'Rancer' ] }, renderer: 'radial', nodeSpacing: { x: 1.0, y: 1.0 } };\r\n\tthis.signatures = {editType: \"unknown\", copySeparator: \",\", pasteLife: 72, alignment: {sigID: \"centerAlign\", sigType: \"centerAlign\", sigAge: \"centerAlign\", leadsTo: \"centerAlign\", sigLife: \"centerAlign\", sigMass: \"centerAlign\"}};\r\n\tthis.buttons = {follow: false, chainWidget: {viewing: false, favorites: false}, signaturesWidget: {autoMapper: false}};\r\n\r\n\tthis.saveDelay = function(delay) {\r\n\t\tif (saveTimer) clearTimeout(saveTimer);\r\n\r\n\t\tsaveTimer = setTimeout(\"options.save()\", delay);\r\n\t};\r\n\r\n\t// Saves options in both cookie and database\r\n\tthis.save = function() {\r\n\t\tvar options = JSON.stringify(window.options.get());\r\n\r\n\t\tlocalStorage.setItem(\"tripwire_options\", options);\r\n\r\n\t\treturn $.ajax({\r\n\t\t\turl: \"options.php\",\r\n\t\t\tdata: {mode: \"set\", options: options},\r\n\t\t\ttype: \"POST\",\r\n\t\t\tdataType: \"JSON\"\r\n\t\t});\r\n\t};\r\n\r\n\t// Loads options via passed object else cookie\r\n\tthis.load = function(data) {\r\n\t\tif (data && typeof(data) != \"undefined\") {\r\n\t\t\tthis.set(this, data);\r\n\t\t} else if (localOptions) {\r\n\t\t\tthis.set(this, localOptions);\r\n\t\t}\r\n\r\n\t\tthis.apply();\r\n\t\tif(tripwire) { set_tracking_text(); }\r\n\t};\r\n\r\n\t// Gets options from this by exluding types == function\r\n\tthis.get = function() {\r\n\t\tvar data = {};\r\n\r\n\t\tfor (var x in this) {\r\n\t\t\tif (typeof(this[x]) != \"function\") {\r\n\t\t\t\tdata[x] = this[x];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\t};\r\n\r\n\t// Sets this from passed object\r\n\tthis.set = function(local, data) {\r\n\t\tfor (var prop in data) {\r\n\t\t\tif (data[prop] && data[prop].constructor && data[prop].constructor === Object) {\r\n\t\t\t\tif (local) {\r\n\t\t\t\t\tthis.set(local[prop], data[prop]);\r\n\t\t\t\t}\r\n\t\t\t} else if (local && typeof(local[prop]) != \"undefined\") {\r\n\t\t\t\tlocal[prop] = data[prop];\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\tthis.reset = function() {\r\n\t\tfor (var x in this) {\r\n\t\t\tif (typeof(this[x]) != \"function\") {\r\n\t\t\t\tthis[x] = JSON.parse(JSON.stringify(this.reset.defaults[x]));\r\n\t\t\t}\r\n\t\t}\r\n\t};\r\n\r\n\t// Applies settings\r\n\tthis.apply = function() {\r\n\t\t// Local browser overrides\r\n\t\tif (localOptions) {\r\n            for (key in localOverrides) {\r\n                this[localOverrides[key]] = localOptions[localOverrides[key]];\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Grid layout (detect old IGB setting options)\r\n\t\tif (this.grid.hasOwnProperty(\"oog\") && Object.keys(this.grid.oog||{}).length) {\r\n\t\t\t$.each(this.grid.oog, function() {\r\n\t\t\t\t$(\"#\"+this.id).attr({\"data-col\": this.col, \"data-row\": this.row, \"data-sizex\": this.size_x, \"data-sizey\": this.size_y})\r\n\t\t\t\t\t.css({width: this.width, height: this.height});\r\n\t\t\t});\r\n\t\t} else if (Object.keys(this.grid||{}).length) {\r\n\t\t\t$.each(this.grid, function() {\r\n\t\t\t\t$(\"#\"+this.id).attr({\"data-col\": this.col, \"data-row\": this.row, \"data-sizex\": this.size_x, \"data-sizey\": this.size_y})\r\n\t\t\t\t\t.css({width: this.width, height: this.height});\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t// Make sure favorites are all ints and not strings\r\n\t\tthis.favorites = $.map(this.favorites, function(favorite) {\r\n\t\t\treturn parseInt(favorite);\r\n\t\t});\r\n\r\n\t\t// Buttons\r\n\t\tif (this.buttons.follow) $(\"#follow\").addClass(\"active\");\r\n\t\tif (this.buttons.chainWidget.home) $(\"#home\").addClass(\"active\");\r\n\t\tif (this.buttons.chainWidget.kspace) $(\"#k-space\").addClass(\"active\");\r\n\t\tif (this.buttons.chainWidget.viewing) $(\"#show-viewing\").addClass(\"active\");\r\n\t\tif (this.buttons.chainWidget.favorites) $(\"#show-favorite\").addClass(\"active\");\r\n\t\tif (this.buttons.chainWidget.evescout) $(\"#eve-scout\").addClass(\"active\");\r\n\t\tif ($.inArray(parseInt(viewingSystemID), this.favorites) !== -1) $(\"#system-favorite\").attr(\"data-icon\", \"star\").addClass(\"active\");\r\n\t\tif (this.buttons.signaturesWidget.autoMapper) $(\"#toggle-automapper\").addClass(\"active\");\r\n\r\n\t\t// UI Scale\r\n\t\tif (this.uiscale) {\r\n\t\t\t$(\"body\").css(\"zoom\", this.uiscale);\r\n\t\t}\r\n\r\n\t\t// Chain zoom\r\n\t\tif (this.chain.zoom) {\r\n\t\t\t$(\"#chainParent\").css(\"zoom\", this.chain.zoom);\r\n\t\t}\r\n\r\n\t\t// Background\r\n\t\tif (this.background) {\r\n\t\t\tvar a = $('<a>', { href:this.background } )[0];\r\n\t\t\t$(\"#wrapper\").attr(\"style\", \"background-image: url(https://\" + a.hostname + a.pathname + a.search + \");\");\r\n\t\t} else {\r\n\t\t\t$(\"#wrapper\").attr(\"style\", \"\");\r\n\t\t}\r\n\r\n\t\t// Characters in Options\r\n\t\t$(\"#dialog-options #characters\").html(\"<img src='https://image.eveonline.com/Character/\"+init.characterID+\"_64.jpg' />\");\r\n\r\n\t\t// Active mask\r\n\t\t$(\"#dialog-options input[name='mask']\").filter(\"[value='\"+this.masks.active+\"']\").attr(\"checked\", true);\r\n\r\n\t\t// Chain tabs\r\n\t\t$(\"#chainTabs\").html(\"\");\r\n\t\tfor (var x in this.chain.tabs) {\r\n\t\t\tif (this.chain.tabs[x]) {\r\n\t\t\t\tvar $tab = $(\"#chainTab .tab\").clone();\r\n\r\n\t\t\t\t$tab.attr(\"id\", x).find(\".name\").data(\"tab\", this.chain.tabs[x].systemID).html(this.chain.tabs[x].name);\r\n\t\t\t\tif (x == this.chain.active) { $tab.addClass(\"current\"); }\r\n\r\n\t\t\t\t$(\"#chainTabs\").append($tab);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\t// Reset routing cache in case routing options changed\r\n\t\tif(guidance) { guidance.clearCache(); }\r\n\r\n\t\t// Draw chain if Tripwire is initialized\r\n\t\tif (typeof(tripwire) !== \"undefined\") {\r\n\t\t\tchain.redraw();\r\n\t\t}\r\n\t};\r\n\r\n\tthis.reset.defaults = JSON.parse(JSON.stringify(this.get()));\r\n\tthis.load(init && init.options ? init.options : null);\r\n}\r\n","var grid = $(\".gridster ul\").gridster({\r\n\twidget_selector: \"li.gridWidget\",\r\n\tavoid_overlapped_widgets: false,\r\n\twidget_base_dimensions: [50, 50],\r\n\twidget_margins: [5, 5],\r\n\tautogrow_cols: true,\r\n\thelper: \"clone\",\r\n\tdraggable: {\r\n\t\tstart: function(e, ui) {\r\n\t\t\t$(\"div.gridster\").width($(\"div.gridster ul\").width());\r\n\t\t}\r\n\t},\r\n\tresize: {\r\n    \tenabled: true,\r\n    \thandle_class: \"grid-resize\",\r\n    \tmin_size: [4, 4],\r\n    \tstart: function(e) {\r\n    \t\t$(\"div.gridster\").width($(\"div.gridster ul\").width());\r\n    \t},\r\n    \tstop: function(e, ui, $widget) {\r\n    \t\t//var width = parseInt($(\".gridster\").css(\"margin-left\")) + this.container_width;\r\n    \t\t//$(\"#wrapper\").css({width: width + \"px\"})\r\n    \t\tswitch ($widget.attr(\"id\")) {\r\n    \t\t\tcase \"infoWidget\":\r\n    \t\t\t\tsetTimeout(\"activity.redraw();\", 300);\r\n    \t\t\t\tbreak;\r\n    \t\t}\r\n    \t}\r\n\t},\r\n\tserialize_params: function($w, wgd) {\r\n\t\treturn {\r\n\t\t\tid: $w.attr(\"id\"),\r\n\t\t\tcol: wgd.col,\r\n\t\t\trow: wgd.row,\r\n\t\t\tsize_x: wgd.size_x,\r\n\t\t\tsize_y: wgd.size_y,\r\n\t\t\twidth: $w.width(),\r\n\t\t\theight: $w.height()\r\n\t\t}\r\n\t}\r\n}).data(\"gridster\").disable();\r\n\r\ngrid.disable_resize();\r\n$(\".grid-resize\").addClass(\"hidden\").attr(\"data-icon\", \"resize\");\r\n\r\n$(\".gridster\").css({visibility: \"visible\"});\r\n$(\".gridster > *\").addClass(\"gridster-transition\");\r\n\r\n$(\"#layout\").click(function() {\r\n\tif (!$(this).hasClass(\"active\")) {\r\n\t\tgrid.enable();\r\n\t\tgrid.enable_resize();\r\n\t\t$(\".grid-resize\").removeClass(\"hidden\");\r\n\r\n\t\t$(this).addClass(\"active\");\r\n\t} else {\r\n\t\tgrid.disable();\r\n\t\tgrid.disable_resize();\r\n\t\t$(\".grid-resize\").addClass(\"hidden\");\r\n\r\n\t\t$(this).removeClass(\"active\");\r\n\r\n\t\toptions.grid = grid.serialize();\r\n\r\n\t\toptions.save();\r\n\t}\r\n});\r\n","var tripwire = new function() {\r\n    this.timer, this.xhr;\r\n\tthis.version = version;\r\n\tthis.client = {signatures: {}, wormholes: {}};\r\n\tthis.server = {signatures: {}, wormholes: {}};\r\n\tthis.signatures = {list: {}, undo: JSON.parse(sessionStorage.getItem(\"tripwire_undo\")) || {}, redo: JSON.parse(sessionStorage.getItem(\"tripwire_redo\")) || {}};\r\n\tthis.serverSignatureCount = 0;\r\n\tthis.activity = {};\r\n\tthis.data = {tracking: {}, esi: {}};\r\n\tthis.refreshRate = 5000;\r\n\tthis.connected = true;\r\n\tthis.ageFormat = \"HM\";\r\n\tthis.instance = window.name ? window.name : (new Date().getTime() / 1000, window.name = new Date().getTime() / 1000);\r\n\r\n\t// Reference to `this` that can be used inside of functions\r\n\tvar _this = this\r\n\r\n    // Command to start/stop tripwire updates\r\n\t// ToDo: Include API and Server timers\r\n\tthis.stop = function() {\r\n\t\tclearTimeout(this.timer);\r\n\t\treturn this.timer;\r\n\t};\r\n\r\n\tthis.start = function() {\r\n\t\treturn this.sync();\r\n\t}\r\n\r\n    // Command to change Age format\r\n\t// ToDo: Cookie change to keep\r\n\tthis.setAgeFormat = function(format) {\r\n\t\tvar format = typeof(format) !== 'undefined' ? format : this.ageFormat;\r\n\r\n\t\t$(\"span[data-age]\").each(function() {\r\n\t\t\t$(this).countdown(\"option\", {format: format});\r\n\t\t});\r\n\r\n\t\treturn true;\r\n\t}\r\n\r\n    this.serverTime = function() {\r\n\t\tthis.time;\r\n\r\n\t\tthis.serverTime.getTime = function() {\r\n\t\t\treturn tripwire.serverTime.time;\r\n\t\t}\r\n\t}\r\n    this.serverTime();\r\n\r\n    // Handles putting chain together\r\n\tthis.chainMap = function() {\r\n\t\tthis.chainMap.parse = function(data) {\r\n\t\t\tchain.draw(data);\r\n\t\t}\r\n\t}\r\n    this.chainMap();\r\n\r\n    this.pastEOL = function() {\r\n\t\tvar options = {since: $(this).countdown('option', 'until'), format: \"HM\", layout: \"-{hnn}{sep}{mnn}&nbsp;\"};\r\n\t\t$(this).countdown(\"option\", options);\r\n\t}\r\n\r\n    // Handles WH Type hover-over tooltip\r\n\t// ToDo: Use native JS\r\n\tthis.whTooltip = function(sig) {\r\n\t\tif (viewingSystemID == sig.systemID) {\r\n\t\t\tif ($.inArray(sig.type, $.map(appData.wormholes, function(item, index) { return index;})) >= 0) {\r\n\t\t\t\tvar type = sig.type;\r\n\t\t\t\tvar tooltip = '';\r\n\t\t\t} else {\r\n\t\t\t\tvar type = sig.sig2Type;\r\n\t\t\t\tvar tooltip = \"<b>Type:</b> \"+(type || 'Unknown')+\"<br/>\";\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\tif ($.inArray(sig.sig2Type, $.map(appData.wormholes, function(item, index) { return index;})) >= 0) {\r\n\t\t\t\tvar type = sig.sig2Type;\r\n\t\t\t\tvar tooltip = '';\r\n\t\t\t} else {\r\n\t\t\t\tvar type = sig.type;\r\n\t\t\t\tvar tooltip = \"<b>Type:</b> \"+(type || 'Unknown')+\"<br/>\";\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tif ($.inArray(type, $.map(appData.wormholes, function(item, index) { return index;})) >= 0) {\r\n\t\t\tvar whType = true;\r\n\t\t} else {\r\n\t\t\tvar whType = false;\r\n\t\t}\r\n\r\n\t\ttooltip += \"<b>Life:</b> \"+(whType?appData.wormholes[type].life:\"Unknown\")+\"<br/>\";\r\n\r\n\t\tif (whType) {\r\n\t\t\tswitch (appData.wormholes[type].leadsTo.split(\"-\")[0]) {\r\n\t\t\t\tcase 'High':\r\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span class='hisec'>\"+appData.wormholes[type].leadsTo+\"</span><br/>\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'Low':\r\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span class='lowsec'>\"+appData.wormholes[type].leadsTo+\"</span><br/>\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'Null':\r\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span class='nullsec'>\"+appData.wormholes[type].leadsTo+\"</span><br/>\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tcase 'Class':\r\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span class='wh'>\"+appData.wormholes[type].leadsTo+\"</span><br/>\";\r\n\t\t\t\t\tbreak;\r\n\t\t\t\tdefault:\r\n\t\t\t\t\ttooltip += \"<b>Leads To:</b> <span>\"+appData.wormholes[type].leadsTo+\"</span><br/>\";\r\n\t\t\t}\r\n\r\n\t\t\ttooltip += \"<b>Max Mass</b>: \"+(Intl.NumberFormat().format(tripwire.wormholes[type].mass))+\" Kg<br/>\";\r\n\r\n\t\t\ttooltip += \"<b>Max Jumpable</b>: \"+(Intl.NumberFormat().format(tripwire.wormholes[type].jump))+\" Kg<br/>\";\r\n\t\t}\r\n\r\n\t\treturn tooltip;\r\n\t}\r\n\r\n\t// Handles Age hover-over tooltip\r\n\t// ToDo: Use native JS\r\n\tthis.ageTooltip = function(sig) {\r\n\t\t// var date = new Date(sig.lifeTime);\r\n\t\t// var localOffset = date.getTimezoneOffset() * 60000;\r\n\t\t// date = new Date(date.getTime() + localOffset);\r\n        var date = new Date(sig.lifeTime);\r\n\r\n\t\tvar tooltip = \"<table class=\\\"age-tooltip-table\\\"><tr>\"\r\n        + \"<th>Created:</th><td>\"+(date.getMonth()+1)+\"/\"+date.getDate()+\" \"+(date.getHours() < 10?'0':'')+date.getHours()+\":\"+(date.getMinutes() < 10?'0':'')+date.getMinutes()+\"</td>\"\r\n        + \"<td>\"+sig.createdByName.replace(/'/g, '&#39;').replace(/\"/g, '&#34;')+\"</td>\"\r\n        + \"</tr>\";\r\n\r\n\t\tif (sig.lifeTime != sig.modifiedTime) {\r\n\t\t\tdate = new Date(sig.modifiedTime);\r\n\t\t\t// localOffset = date.getTimezoneOffset() * 60000;\r\n\t\t\t// date = new Date(date.getTime() + localOffset);\r\n      \r\n\t\t\ttooltip += \"<tr><th>Last Modified:</th><td>\"+(date.getMonth()+1)+\"/\"+date.getDate()+\" \"+(date.getHours() < 10?'0':'')+date.getHours()+\":\"+(date.getMinutes() < 10?'0':'')+date.getMinutes()+\"</td>\"\r\n          + \"<td>\"+sig.modifiedByName.replace(/'/g, '&#39;').replace(/\"/g, '&#34;')+\"</td>\"\r\n          + \"</tr>\";\r\n\t\t}\r\n\r\n\t\ttooltip += \"</table>\";\r\n\r\n\t\treturn tooltip;\r\n\t}\r\n\r\n    this.refresh = function(mode, data, successCallback, alwaysCallback) {\r\n\t\tvar mode = mode || 'refresh';\r\n\r\n\t\tthis.sync(mode, data, successCallback, alwaysCallback);\r\n\t}\r\n\r\n\t// getSystemIDsByNames performs a case-insensitive search of the internal\r\n\t// list of systems looking for matches on each system name in the given\r\n\t// comma-separated list of names. A comma-separated list of system IDs is\r\n\t// returned if all systems are found, otherwise the empty string is returned.\r\n\tthis.getSystemIDsByNames = function(systemNames) {\r\n\t\tif (!_this.systems) {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t\tconst values = systemNames.split(\",\");\r\n\t\tconst systems = [];\r\n\t\tfor(var i = 0; i < values.length; i++) {\r\n\t\t\tfor (systemID in _this.systems) {\r\n\t\t\t\tconst system = _this.systems[systemID];\r\n\t\t\t\tif (system.name.toLowerCase() == values[i].toLowerCase()) {\r\n\t\t\t\t\tsystems.push(systemID);\r\n\t\t\t\t\tbreak;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tif (values.length != systems.length) {\r\n\t\t\treturn \"\";\r\n\t\t}\r\n\t\treturn systems.join(\",\");\r\n\t}\r\n}\r\n","$(\"body\").on(\"click\", \"a[href^='.?system=']\", function(e) {\r\n\te.preventDefault();\r\n\r\n\tvar system = $(this).attr(\"href\").replace(\".?system=\", \"\");\r\n\tvar systemID = Object.index(tripwire.systems, \"name\", system);\r\n\r\n\ttripwire.systemChange(systemID);\r\n});\r\n\r\n$(\"body\").on(\"submit\", \"#systemSearch\", function(e) {\r\n\te.preventDefault();\r\n\r\n\tvar system = $(this).find(\"[name='system']\").val();\r\n\tvar systemID = Object.index(tripwire.systems, \"name\", system, true) || false;\r\n\r\n\tif (systemID !== false) {\r\n\t\ttripwire.systemChange(systemID);\r\n\t\t$(this).find(\"[name='system']\").val(\"\");\r\n\t\t$(\"#search\").click();\r\n\t}\r\n});\r\n\r\n$(\"body\").on(\"click\", \"#undo:not(.disabled)\", function() {\r\n\ttripwire.undo();\r\n});\r\n\r\n$(\"body\").on(\"click\", \"#redo:not(.disabled)\", function() {\r\n\ttripwire.redo();\r\n});\r\n\r\n// Chain map zooming (Gets funky if you push things too far)\r\n$(\"#chainParent\").on(\"mousewheel\", function(e) {\r\n\tif(!e.ctrlKey) { return; }\r\n\te.preventDefault();\r\n\tvar zoom = parseFloat($(\"#chainParent\").css(\"zoom\")) || 1.0;\r\n\tvar min = 0.6;\r\n\tvar max = 2.0;\r\n\r\n    if (e.originalEvent.wheelDelta / 120 > 0 && zoom < max) {\r\n\t\t$(\"#chainParent\").css(\"zoom\", zoom + 0.1);\r\n    } else if (e.originalEvent.wheelDelta / 120 < 0 && zoom > min) {\r\n\t\t$(\"#chainParent\").css(\"zoom\", zoom - 0.1);\r\n    }\r\n\r\n\t// Show the reset zoom button for awhile\r\n\t$(\"#chain-zoom-reset\").fadeIn(200);\r\n\tif (this.timeout) clearTimeout(this.timeout);\r\n\tthis.timeout = setTimeout('$(\"#chain-zoom-reset\").fadeOut(200);', 3000);\r\n\r\n\t// Save options\r\n\toptions.chain.zoom = parseFloat($(\"#chainParent\").css(\"zoom\"));\r\n\toptions.saveDelay(2000);\r\n});\r\n\r\n$(\"#chain-zoom-reset\").on(\"click\", function() {\r\n\t$(\"#chainParent\").css(\"zoom\", 1);\r\n\toptions.chain.zoom = 1;\r\n\toptions.saveDelay(2000);\r\n});\r\n\r\n$(document).keydown(function(e)\t{\r\n\t//Abort - user is in input or textarea\r\n\tif ($(document.activeElement).is(\"textarea, input\")) return;\r\n\r\n\t// Ctrl key hooks\r\n\tif (e.metaKey || e.ctrlKey) {\r\n\r\n\t\tif (e.keyCode === 89 && !$(\"#redo\").hasClass(\"disabled\")) {\r\n\t\t\t// Ctrl-y redo hook\r\n\t\t\te.preventDefault();\r\n\t\t\t$(\"#redo\").click();\r\n\t\t\tNotify.trigger(\"Redoing last undo\");\r\n\t\t} else if (e.keyCode === 90 && !$(\"#undo\").hasClass(\"disabled\")) {\r\n\t\t\t// Ctrl-z undo hook\r\n\t\t\te.preventDefault();\r\n\t\t\t$(\"#undo\").click();\r\n\t\t\tNotify.trigger(\"Undoing last action\");\r\n\t\t} else if (e.keyCode === 65) {\r\n\t\t\t// Ctrl-a select all (signatures) hook\r\n\t\t\te.preventDefault();\r\n\t\t\t$(\"#sigTable tbody tr\").addClass(\"selected\");\r\n\t\t\t$(\"#signaturesWidget #delete-signature\").trigger(\"delete:refresh\");\r\n\t\t} else if (e.keyCode === 67) {\r\n\t\t\t// Ctrl-c copy selected signatures hook\r\n\t\t\tif (window.getSelection().toString() === \"\") {\r\n\t\t\t\tvar output = \"\";\r\n\t\t\t\t$(\"#sigTable tbody tr.selected\").each(function(row) {\r\n\t\t\t\t\tvar signature = tripwire.client.signatures[$(this).data(\"id\")];\r\n\t\t\t\t\tvar row = [];\r\n\r\n\t\t\t\t\tif (signature.signatureID) {\r\n\t\t\t\t\t\trow.push(signature.signatureID.substring(0, 3).toUpperCase() + \"-\" + (signature.signatureID.substring(3, 6) || \"###\"));\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trow.push(\"null\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trow.push(signature.type);\r\n\t\t\t\t\tif (signature.type === \"wormhole\") {\r\n\t\t\t\t\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\r\n\t\t\t\t\t\tvar otherSignature = signature.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\r\n\t\t\t\t\t\trow.push(wormhole.type || \"null\" );\r\n\t\t\t\t\t\trow.push(tripwire.systems[signature.systemID] ? tripwire.systems[signature.systemID].name : appData.genericSystemTypes[signature.systemID]);\r\n\t\t\t\t\t\trow.push(tripwire.systems[otherSignature.systemID] ? tripwire.systems[otherSignature.systemID].name : appData.genericSystemTypes[otherSignature.systemID]);\r\n\t\t\t\t\t\trow.push(wormhole.life);\r\n\t\t\t\t\t\trow.push(wormhole.mass);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\trow.push(signature.name);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\trow.push(signature.createdByName);\r\n\t\t\t\t\trow.push(signature.lifeTime);\r\n\t\t\t\t\trow.push(signature.lifeLength);\r\n\t\t\t\t\trow.push(signature.lifeLeft);\r\n\t\t\t\t\trow.push(signature.modifiedByName);\r\n\t\t\t\t\trow.push(signature.modifiedTime);\r\n\t\t\t\t\toutput += row.join(options.signatures.copySeparator) + \"\\r\\n\";\r\n\t\t\t\t});\r\n\t\t\t\t$(\"#clipboard\").text(output);\r\n\t\t\t\t$(\"#clipboard\").focus();\r\n\t\t\t\t$(\"#clipboard\").select();\r\n\t\t\t}\r\n\t\t}\r\n\t} else {\r\n\t\t// delete key keyhooks\r\n\t\tif (e.keyCode == 46 && $(\"#sigTable tr.selected\").length > 0) {\r\n\t\t\t$(\"#delete-signature\").click();\r\n\t\t}\r\n\t}\r\n});\r\n\r\n// $(\"#APIclock\").knob({angleArc: 359.9, height: 20, width: 20, max: 60, readOnly: true, displayInput: false, fgColor: \"#CCC\", bgColor: \"#666\"});\r\n\r\n$(\"#follow\").click(function(e) {\r\n\te.preventDefault();\r\n\r\n\tif ($(this).hasClass(\"active\"))\r\n\t\t$(this).removeClass(\"active\");\r\n\telse\r\n\t\t$(this).addClass(\"active\");\r\n\r\n\toptions.buttons.follow = $(this).hasClass(\"active\");\r\n\toptions.save();\r\n})\r\n\r\n$(\"#show-viewing\").click(function() {\r\n\tif ($(this).hasClass(\"active\"))\r\n\t\t$(this).removeClass(\"active\");\r\n\telse\r\n\t\t$(this).addClass(\"active\");\r\n\r\n\tchain.redraw();\r\n\r\n\toptions.buttons.chainWidget.viewing = $(this).hasClass(\"active\");\r\n\toptions.save();\r\n});\r\n\r\n$(\"#show-favorite\").click(function() {\r\n\tif ($(this).hasClass(\"active\"))\r\n\t\t$(this).removeClass(\"active\");\r\n\telse\r\n\t\t$(this).addClass(\"active\");\r\n\r\n\tchain.redraw();\r\n\r\n\toptions.buttons.chainWidget.favorites = $(this).hasClass(\"active\");\r\n\toptions.save();\r\n});\r\n\r\n$(\"#system-favorite\").click(function() {\r\n\tif ($(this).hasClass(\"active\")) {\r\n\t\t$(this).removeClass(\"active\").attr(\"data-icon\", \"star-empty\");\r\n\r\n\t\toptions.favorites.splice(options.favorites.indexOf(parseInt(viewingSystemID)), 1);\r\n\t} else {\r\n\t\t$(this).attr(\"data-icon\", \"star\").addClass(\"active\");\r\n\r\n\t\toptions.favorites.push(parseInt(viewingSystemID));\r\n\t}\r\n\r\n\tif ($(\"#show-favorite\").hasClass(\"active\"))\r\n\t\tchain.redraw();\r\n\r\n\toptions.save();\r\n});\r\n\r\n$('#favorite-dropdown-toggle').click(function() {\r\n\tconst target = document.getElementById('favorite-panel');\r\n\tif(target.style.display === 'none') {\r\n\t\tconst listWrapper = document.getElementById('favorite-panel-wrapper');\r\n\t\tlistWrapper.innerHTML = options.favorites.length == 0 ? '<p>You have no favourites. Use the star to add a system.</p>'\r\n\t\t\t: options.favorites.map(function(f) {\r\n\t\t\t\tconst systemInfo = systemAnalysis.analyse(f);\r\n\t\t\t\treturn '<p>' + systemRendering.renderSystem(systemInfo) + '</p>';\r\n\t\t\t}).join('\\n');\r\n\t\ttarget.style.display = '';\r\n\t} else { target.style.display = 'none'; }\r\n});\r\n\r\n$(\"#search\").click(function(e) {\r\n\t$(\"#searchSpan\").toggle();\r\n\r\n\tif ($(this).hasClass(\"active\")) {\r\n\t\t$(this).removeClass(\"active\");\r\n\t\tif (tripwire.client.EVE && tripwire.client.EVE.systemName)\r\n\t\t\t$(\"#currentSpan\").show();\r\n\t} else {\r\n\t\t$(this).addClass(\"active\");\r\n\t\t$(\"#currentSpan\").hide();\r\n\r\n\t\t$(\"#searchSpan input[name=system]\").focus().select();\r\n\t}\r\n});\r\n\r\n$(\"#toggle-automapper\").click(function(e) {\r\n\te.preventDefault();\r\n\r\n\tif ($(this).hasClass(\"active\")) {\r\n\t\t$(this).removeClass(\"active\");\r\n\t} else {\r\n\t\t$(this).addClass(\"active\");\r\n\t}\r\n\r\n\toptions.buttons.signaturesWidget.autoMapper = $(this).hasClass(\"active\");\r\n\toptions.save();\r\n});\r\n\r\n$(\"#track\").on(\"click\", \".tracking-clone\", function() {\r\n\tvar characterID =$(this).attr(\"data-characterid\");\r\n\t$(\"#tracking .tracking-clone\").removeClass(\"active\");\r\n\r\n\tif (options.tracking.active == characterID) {\r\n\t\toptions.tracking.active = null;\r\n\t\ttripwire.EVE(false, true);\r\n\t\t$(\"#removeESI\").attr(\"disabled\", \"disabled\");\r\n\t} else {\r\n\t\toptions.tracking.active = characterID;\r\n\r\n\t\tif (tripwire.esi.characters[options.tracking.active]) {\r\n\t\t\t$(\"#tracking .tracking-clone[data-characterid='\"+ options.tracking.active +\"']\").addClass(\"active\");\r\n\t\t\ttripwire.EVE(tripwire.esi.characters[options.tracking.active], true);\r\n\t\t}\r\n\r\n\t\t$(\"#removeESI\").removeAttr(\"disabled\");\r\n\t}\r\n\tset_tracking_text();\r\n\toptions.save();\r\n});\r\n\r\n/** Set UI text based on the current tracked character */\r\nfunction set_tracking_text() {\r\n\tif(tripwire.esi.characters[options.tracking.active]) {\r\n\t\tdocument.getElementById('user-track-name').textContent = tripwire.esi.characters[options.tracking.active].characterName;\r\n\t\tdocument.getElementById('user-track').style.display = '';\r\n\t\tdocument.getElementById('user-no-track').style.display = 'none';\r\n\t} else {\r\n\t\tdocument.getElementById('user-track').style.display = 'none';\r\n\t\tdocument.getElementById('user-no-track').style.display = '';\t\r\n\t}\r\n}\r\n\r\n$(\"#login\").on(\"click\", \"#removeESI\", function() {\r\n\tvar characterID = options.tracking.active;\r\n\r\n\toptions.tracking.active = null;\r\n\ttripwire.EVE(false, true);\r\n\toptions.save();\r\n\r\n\t$(\"#tracking .tracking-clone[data-characterid='\"+ characterID +\"']\").remove();\r\n\r\n\t$(\"#removeESI\").attr(\"disabled\", \"disabled\");\r\n\r\n\tif ($.isArray(tripwire.data.esi.delete)) {\r\n\t\ttripwire.data.esiDelete.push(characterID);\r\n\t} else {\r\n\t\ttripwire.data.esiDelete = [characterID];\r\n\t}\r\n});\r\n\r\n$(\"#user\").click(function(e) {\r\n\te.preventDefault();\r\n\r\n\tif ($(this).hasClass(\"active\")) {\r\n\t\t$(this).removeClass(\"active\");\r\n\r\n\t\t$(\"#login > #panel\").css({display: \"none\"});\r\n\r\n\t\t//$(\"#wrapper\").unbind(\"click\");\r\n\t} else {\r\n\t\t$(this).addClass(\"active\");\r\n\r\n\t\t$(\"#login > #panel\").css({display: \"inline\"});\r\n\t\t$(\"#loginForm input[name=username]\").focus().select();\r\n\t}\r\n});\r\n$(\"#wrapper\").click(function(e) { // Click outside closes\r\n\tif(!(e.originalEvent && e.originalEvent.isInPanel)) {\r\n\t\t$(\"#login > #panel\").css({display: \"none\"});\r\n\t\t$(\"#user\").removeClass(\"active\");\r\n\t}\r\n});\r\n$(\"#login\").click(function(e) { // click inside doesn't\r\n\te.originalEvent.isInPanel = true;\r\n})\r\n\r\n\r\n$(\"#logout\").click(function() {\r\n\twindow.location = \"logout.php\";\r\n});\r\n\r\nvar Notify = new function() {\r\n\tthis.trigger = function(content, color, stick, id) {\r\n\t\tvar color = typeof(color) !== \"undefined\" ? color : \"blue\";\r\n\t\tvar stick = typeof(stick) !== \"undefined\" ? stick : 10000;\r\n\t\tvar id = typeof(id) !== \"undefined\" ? id : null;\r\n\r\n\t\tnew jBox(\"Notice\", {\r\n\t\t\tid: id,\r\n\t\t\tcontent: content,\r\n\t\t\toffset: {y: 35},\r\n\t\t\tanimation: \"flip\",\r\n\t\t\tcolor: color,\r\n\t\t\tautoClose: stick\r\n\t\t});\r\n\t}\r\n}\r\n\r\n// Init valdiation tooltips\r\nvar ValidationTooltips = new jBox(\"Tooltip\", {\r\n\ttrigger: null,\r\n\taddClass: \"validation-tooltip\",\r\n\tanimation: \"flip\",\r\n\tfade: 0\r\n});\r\n\r\nvar Tooltips = new jBox(\"Tooltip\", {\r\n\tattach: $(\"[data-tooltip]\"),\r\n\tgetContent: \"data-tooltip\",\r\n\tposition: {x: \"right\", y: \"center\"},\r\n\toutside: \"x\"\r\n});\r\n\r\nvar SystemActivityToolTips = new jBox(\"Tooltip\", {\r\n\tgetContent: \"data-tooltip\",\r\n\tposition: {y: \"bottom\"},\r\n\tappendTo: $(\"#chainParent\"),\r\n\treposition: true,\r\n\trepositionOnOpen: true,\r\n\tcreateOnInit: true,\r\n\tonOpen: function() {\r\n\t\tvar targetPos = positionRelativeTo(this.target[0], document.getElementById('chainParent'));\r\n\t\tvar nodePos = this.source.closest(\"[data-nodeid]\").position();\r\n\t\tvar parentPos = this.source.closest(\".nodeActivity\").position();\r\n\t\tvar nodeHeight = this.source.closest(\"[data-nodeid]\").height();\r\n\t\t// var nodeWidth = this.source.closest(\"[data-nodeid]\").width();\r\n\t\tvar tooltipWidth = this.container.parent().width();\r\n\t\t// var tooltipHeight = this.container.parent().height();\r\n\r\n\t\tthis.options.position = {x: targetPos.left + 3 - tooltipWidth /2 , y: targetPos.top + this.target[0].offsetHeight};\r\n\t}\r\n});\r\n\r\nvar WormholeRouteToolTips = new jBox(\"Tooltip\", {\r\n\tgetContent: \"data-tooltip\",\r\n\tposition: {y: \"bottom\"},\r\n\tappendTo: $(\"#chainParent\"),\r\n\treposition: true,\r\n\trepositionOnOpen: true,\r\n\tcreateOnInit: true,\r\n\tonOpen: function() {\r\n\t\tvar targetPos = positionRelativeTo(this.target[0], document.getElementById('chainParent'));\r\n\t\tvar nodeHeight = this.source.closest(\"[data-nodeid]\").height();\r\n\t\t// var nodeWidth = this.source.closest(\"[data-nodeid]\").width();\r\n\t\tvar tooltipWidth = this.container.parent().width();\r\n\t\t// var tooltipHeight = this.container.parent().height();\r\n\t\t\r\n\t\tthis.options.position = {x: targetPos.left + 3 - tooltipWidth /2 , y: targetPos.top + this.target[0].offsetHeight};\r\n\t}\r\n});\r\n\r\nvar WormholeTypeToolTips = new jBox(\"Tooltip\", {\r\n\tattach: $(\"#chainMap .whEffect[data-icon]\"),\r\n\tgetContent: \"data-tooltip\",\r\n\tposition: {x: \"left\", y: \"center\"},\r\n\tappendTo: $(\"#chainParent\"),\r\n\toutside: \"x\",\r\n\tadjustDistance: 100,\r\n\tresponsiveWidth: false,\r\n\treposition: true,\r\n\trepositionOnOpen: true,\r\n\tcreateOnInit: true,\r\n\tonOpen: function() {\r\n\t\tvar targetPos = positionRelativeTo(this.target[0], document.getElementById('chainParent'));\r\n\t\tvar tooltipWidth = this.container.parent().width();\r\n\r\n\t\tthis.options.position = {x: targetPos.left - tooltipWidth - 10, y: targetPos.top - 3};\r\n\t}\r\n});\r\n\r\nvar OccupiedToolTips = new jBox(\"Tooltip\", {\r\n\tpointer: \"top:-3\",\r\n\tposition: {x: \"right\", y: \"center\"},\r\n\tappendTo: $(\"#chainParent\"),\r\n\toutside: \"x\",\r\n\tminWidth: 100,\r\n\tanimation: \"move\",\r\n\tadjustDistance: 100,\r\n\tresponsiveWidth: false,\r\n\treposition: true,\r\n\trepositionOnOpen: true,\r\n\trepositionOnContent: true,\r\n\tcreateOnInit: true,\r\n\tonOpen: function() {\r\n\t\tvar tooltip = this;\r\n\t\tconst nodeElemJ = this.source.closest(\"[data-nodeid]\");\r\n\t\tvar systemID = nodeElemJ.data(\"nodeid\");\r\n\t\tvar targetPos = positionRelativeTo(this.target[0], document.getElementById('chainParent'));\r\n\r\n\t\tthis.options.position = {x: targetPos.left + this.target[0].offsetWidth, y: targetPos.top - 3};\r\n\r\n\t\ttooltip.setContent(\"&nbsp;\");\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: \"occupants.php\",\r\n\t\t\tdataType: \"JSON\",\r\n\t\t\tdata: \"systemID=\"+systemID,\r\n\t\t\tcache: false\r\n\t\t}).done(function(data) {\r\n\t\t\tif (data && data.occupants) {\r\n\t\t\t\tvar chars = \"<table>\";\r\n\r\n\t\t\t\t// Sort by characterName\r\n\t\t\t\tdata.occupants.sort(function(a, b) {\r\n\t\t\t\t\tif (a.characterName.toLowerCase() < b.characterName.toLowerCase()) return -1;\r\n\t\t\t\t\tif (a.characterName.toLowerCase() > b.characterName.toLowerCase()) return 1;\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t});\r\n\r\n\t\t\t\tfor (var x in data.occupants) {\r\n\t\t\t\t\tchars += \"<tr><td>\"+data.occupants[x].characterName+\"</td><td style='padding-left: 10px;'>\"+(data.occupants[x].shipTypeName?data.occupants[x].shipTypeName:\"\")+\"</td></tr>\";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tchars += \"</table>\";\r\n\t\t\t\ttooltip.setContent(chars);\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n});\r\n\r\n$(\"#chainTabs\").sortable({\r\n\titems: \"> .tab\",\r\n\taxis: \"x\",\r\n\tdelay: 150,\r\n\ttolerance: \"pointer\",\r\n\tcontainment: \"parent\",\r\n\tupdate: function(e, ui) {\r\n\t\tvar result = $(\"#chainTabs\").sortable(\"toArray\");\r\n\t\tvar newTabs = [];\r\n\r\n\t\tfor (var x in result) {\r\n\t\t\tnewTabs.push(options.chain.tabs[result[x]]);\r\n\t\t\t$(\"#chainTabs .tab:eq(\"+x+\")\").attr(\"id\", x);\r\n\t\t}\r\n\r\n\t\toptions.chain.active = $(\".tab.current\").index();\r\n\t\toptions.chain.tabs = newTabs;\r\n\t\toptions.save();\r\n\t}\r\n});\r\n\r\n$(\"#chainTabs\").on(\"click\", \".tab\", function(e) {\r\n\te.preventDefault();\r\n\tchain.setActiveTab($(this).hasClass(\"current\") ? null : $(this).index())\r\n});\r\n\r\n$(\"#chainTabs\").on(\"click\", \".closeTab\", function(e) {\r\n\te.stopPropagation();\r\n\tvar $tab = $(this).closest(\".tab\");\r\n\r\n\t$(\"#dialog-confirm #msg\").html(\"This tab will be removed, are you sure?\");\r\n\t$(\"#dialog-confirm\").dialog(\"option\", {\r\n\t\tbuttons: {\r\n\t\t\t\"Remove Tab\": function() {\r\n\t\t\t\tvar i = $tab.index();\r\n\r\n\t\t\t\toptions.chain.active = $(\".tab.current\").index();\r\n\t\t\t\toptions.chain.tabs.splice(i, 1);\r\n\t\t\t\toptions.save();\r\n\r\n\t\t\t\t$tab.remove();\r\n\t\t\t\tif ($(\"#chainTabs .tab.current\").length == 0) {\r\n\t\t\t\t\t$(\"#chainTabs .tab:last\").click();\r\n\t\t\t\t}\r\n\r\n\t\t\t\tfor (var x = 0, l = $(\"#chainTabs .tab\").length; x < l; x++) {\r\n\t\t\t\t\t$(\"#chainTabs .tab:eq(\"+x+\")\").attr(\"id\", x);\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t},\r\n\t\t\tCancel: function() {\r\n\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t}\r\n\t\t}\r\n\t}).dialog(\"open\");\r\n});\r\n\r\n$(\"#newTab\").on(\"click\", function() {\r\n\t// check if dialog is open\r\n\tif (!$(\"#dialog-newTab\").hasClass(\"ui-dialog-content\")) {\r\n\t\t$(\"#dialog-newTab\").dialog({\r\n\t\t\tresizable: false,\r\n\t\t\tminHeight: 0,\r\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\r\n\t\t\tbuttons: {\r\n\t\t\t\tOK: function() {\r\n\t\t\t\t\t$(\"#newTab_form\").submit();\r\n\t\t\t\t},\r\n\t\t\t\tCancel: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\topen: function() {\r\n\t\t\t\t$(\"#dialog-newTab .name\").val(viewingSystem).focus();\r\n\t\t\t\t$(\"#dialog-newTab .sigSystemsAutocomplete\").val(viewingSystem);\r\n\t\t\t},\r\n\t\t\tclose: function() {\r\n\t\t\t\tValidationTooltips.close();\r\n\t\t\t},\r\n\t\t\tcreate: function() {\r\n\t\t\t\t$(\"#dialog-newTab .sigSystemsAutocomplete\").inlinecomplete({source: tripwire.aSigSystems, maxSize: 10, delay: 0, renderer: 'system'});\r\n\r\n\t\t\t\t$(\"#newTab_form\").submit(function(e) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tvar $tab = $(\"#chainTab .tab\").clone();\r\n\t\t\t\t\tvar name = $(\"#dialog-newTab .name\").val();\r\n\t\t\t\t\tvar systemID = tripwire.getSystemIDsByNames($(\"#dialog-newTab .sigSystemsAutocomplete\").val());\r\n\t\t\t\t\tvar thera = $(\"#tabThera\")[0].checked ? true : false;\r\n\r\n\t\t\t\t\tif (!name) {\r\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-newTab .name\")}).setContent(\"Must have a name!\");\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t} else if (!systemID && $(\"#tabType1\")[0].checked) {\r\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-newTab .sigSystemsAutocomplete\")}).setContent(\"Must have valid systems (comma separated if multiple)!\");\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t} else if ($(\"#tabType2\")[0].checked) {\r\n\t\t\t\t\t\tsystemID = 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$tab.attr(\"id\", $(\"#chainTabs .tab\").length).find(\".name\").data(\"tab\", systemID).html(name);\r\n\t\t\t\t\toptions.chain.tabs.push({systemID: systemID, name: name, evescout: thera});\r\n\t\t\t\t\toptions.save();\r\n\r\n\t\t\t\t\t$(\"#chainTabs\").append($tab);\r\n\r\n\t\t\t\t\t$(\"#dialog-newTab\").dialog(\"close\");\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(\"#dialog-newTab .sigSystemsAutocomplete\").click(function(e) {\r\n\t\t\t\t\t$(\"#dialog-newTab #tabType1\").click();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t} else if (!$(\"#dialog-newTab\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-newTab\").dialog(\"open\");\r\n\t}\r\n});\r\n\r\n$(\"#chainTabs\").on(\"click\", \".editTab\", function(e) {\r\n\te.stopPropagation();\r\n\r\n\t// check if dialog is open\r\n\tif (!$(\"#dialog-editTab\").hasClass(\"ui-dialog-content\")) {\r\n\t\t$(\"#dialog-editTab\").dialog({\r\n\t\t\tresizable: false,\r\n\t\t\tminHeight: 0,\r\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\r\n\t\t\tbuttons: {\r\n\t\t\t\tOK: function() {\r\n\t\t\t\t\t$(\"#editTab_form\").submit();\r\n\t\t\t\t},\r\n\t\t\t\tCancel: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\topen: function() {\r\n\t\t\t\t$(\"#dialog-editTab .name\").val(options.chain.tabs[options.chain.active].name).focus();\r\n\t\t\t\t$(\"#dialog-editTab .sigSystemsAutocomplete\").val(options.chain.tabs[options.chain.active].systemID != 0 ? lookupMultiple(tripwire.systems, 'name', options.chain.tabs[options.chain.active].systemID) : \"\");\r\n\t\t\t\toptions.chain.tabs[options.chain.active].systemID != 0 ? $(\"#dialog-editTab #editTabType1\")[0].checked = true : $(\"#dialog-editTab #editTabType2\")[0].checked = true;\r\n\t\t\t\t$(\"#dialog-editTab #editTabThera\")[0].checked = options.chain.tabs[options.chain.active].evescout;\r\n\t\t\t},\r\n\t\t\tclose: function() {\r\n\t\t\t\tValidationTooltips.close();\r\n\t\t\t},\r\n\t\t\tcreate: function() {\r\n\t\t\t\t$(\"#dialog-editTab .sigSystemsAutocomplete\").inlinecomplete({source: tripwire.aSigSystems, renderer: 'system', maxSize: 10, delay: 0});\r\n\r\n\t\t\t\t$(\"#editTab_form\").submit(function(e) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tvar $tab = $(\"#chainTabs .tab\").eq([options.chain.active]);\r\n\t\t\t\t\tvar name = $(\"#dialog-editTab .name\").val();\r\n\t\t\t\t\tvar systemID = tripwire.getSystemIDsByNames($(\"#dialog-editTab .sigSystemsAutocomplete\").val());\r\n\t\t\t\t\tvar thera = $(\"#editTabThera\")[0].checked ? true : false;\r\n\r\n\t\t\t\t\tif (!name) {\r\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-editTab .name\")}).setContent(\"Must have a name!\");\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t} else if (!systemID && $(\"#editTabType1\")[0].checked) {\r\n\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-editTab .sigSystemsAutocomplete\")}).setContent(\"Must have valid systems (comma separated if multiple)!\");\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t} else if ($(\"#editTabType2\")[0].checked) {\r\n\t\t\t\t\t\tsystemID = 0;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$tab.attr(\"id\", $(\"#chainTabs .tab\").length).find(\".name\").data(\"tab\", systemID).html(name);\r\n\t\t\t\t\toptions.chain.tabs[options.chain.active] = {systemID: systemID, name: name, evescout: thera};\r\n\t\t\t\t\toptions.save();\r\n\t\t\t\t\tchain.redraw();\r\n\r\n\t\t\t\t\ttripwire.parse(tripwire.client, \"refresh\");\r\n\r\n\t\t\t\t\t//$(\"#chainTabs\").append($tab);\r\n\r\n\t\t\t\t\t$(\"#dialog-editTab\").dialog(\"close\");\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(\"#dialog-editTab .sigSystemsAutocomplete\").click(function(e) {\r\n\t\t\t\t\t$(\"#dialog-editTab #editTabType1\").click();\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\t} else if (!$(\"#dialog-editTab\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-editTab\").dialog(\"open\");\r\n\t}\r\n});\r\n\r\n// Signature column context menu\r\n$(\"#signaturesWidget #sigTable thead\").contextmenu({\r\n\tdelegate: \"th.sortable\",\r\n\tmenu: \"#signatureColumnMenu\",\r\n\tposition: function(event, ui) {\r\n        return {my: \"left top\", at: \"center\", of: ui.target};\r\n    },\r\n\tselect: function(e, ui) {\r\n\t\tvar col = $(ui.target).parent().parent().children().index($(ui.target).parent()) + 1;\r\n\r\n\t\tswitch(col) {\r\n\t\t\tcase 1:\r\n\t\t\t\tcolName = \"sigID\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2:\r\n\t\t\t\tcolName = \"sigType\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 3:\r\n\t\t\t\tcolName = \"sigAge\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 4:\r\n\t\t\t\tcolName = \"leadsTo\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 5:\r\n\t\t\t\tcolName = \"sigLife\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 6:\r\n\t\t\t\tcolName = \"sigMass\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tswitch(ui.cmd) {\r\n\t\t\tcase \"leftAlign\":\r\n\t\t\t\t$(\"#signaturesWidget #sigTable tbody td:nth-child(\"+ col +\")\").removeClass(\"centerAlign rightAlign\").addClass(\"leftAlign\");\r\n\t\t\t\toptions.signatures.alignment[colName] = \"leftAlign\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"centerAlign\":\r\n\t\t\t\t$(\"#signaturesWidget #sigTable tbody td:nth-child(\"+ col +\")\").removeClass(\"leftAlign rightAlign\").addClass(\"centerAlign\");\r\n\t\t\t\toptions.signatures.alignment[colName] = \"centerAlign\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"rightAlign\":\r\n\t\t\t\t$(\"#signaturesWidget #sigTable tbody td:nth-child(\"+ col +\")\").removeClass(\"centerAlign leftAlign\").addClass(\"rightAlign\");\r\n\t\t\t\toptions.signatures.alignment[colName] = \"rightAlign\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\toptions.save();\r\n\t},\r\n\tbeforeOpen: function(e, ui) {\r\n\t\tvar col = $(ui.target).parent().parent().children().index($(ui.target).parent()) + 1;\r\n\r\n\t\tswitch(col) {\r\n\t\t\tcase 1:\r\n\t\t\t\tcolName = \"sigID\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 2:\r\n\t\t\t\tcolName = \"sigType\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 3:\r\n\t\t\t\tcolName = \"sigAge\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 4:\r\n\t\t\t\tcolName = \"leadsTo\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 5:\r\n\t\t\t\tcolName = \"sigLife\";\r\n\t\t\t\tbreak;\r\n\t\t\tcase 6:\r\n\t\t\t\tcolName = \"sigMass\";\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\t$(this).contextmenu(\"enableEntry\", \"leftAlign\", true);\r\n\t\t$(this).contextmenu(\"enableEntry\", \"centerAlign\", true);\r\n\t\t$(this).contextmenu(\"enableEntry\", \"rightAlign\", true);\r\n\r\n\t\t$(this).contextmenu(\"enableEntry\", options.signatures.alignment[colName], false);\r\n\t}\r\n});\r\n\r\n// Chain Map Context Menu\r\n$(\"#chainParent\").contextmenu({\r\n\tappendTo: \"#chainParent\",\r\n\tdelegate: \".nodeSystem a\",\r\n\tposition: function(event, ui) {\r\n        return {my: \"left top-1\", at: \"right top\", of: ui.target};\r\n    },\r\n\tmenu: \"#chainMenu\",\r\n\tshow: {effect: \"slideDown\", duration: 150},\r\n\tselect: function(e, ui) {\r\n\t\tconst nodeElem = $(ui.target[0]).closest(\"[data-nodeid]\");\r\n\t\tvar id = nodeElem.data(\"nodeid\");\r\n\t\tvar row = nodeElem.attr(\"id\").replace(\"node\", \"\") -1;\r\n\r\n\t\tswitch(ui.cmd) {\r\n\t\t\tcase \"showInfo\":\r\n\t\t\t\ttripwire.esi.showInfo(id, options.tracking.active);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"setDest\":\r\n\t\t\t\ttripwire.esi.setDestination(id, options.tracking.active, true);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"addWay\":\r\n\t\t\t\ttripwire.esi.setDestination(id, options.tracking.active, false);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"showMap\":\r\n\t\t\t\t// CCPEVE.showMap(id);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"red\":\r\n\t\t\t\tnodeElem.hasClass(\"redNode\") ? $(this).contextmenu(\"removeFlare\", id, ui) : $(this).contextmenu(\"setFlare\", id, ui.cmd, ui);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"yellow\":\r\n\t\t\t\tnodeElem.hasClass(\"yellowNode\") ? $(this).contextmenu(\"removeFlare\", id, ui) : $(this).contextmenu(\"setFlare\", id, ui.cmd, ui);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"green\":\r\n\t\t\t\tnodeElem.hasClass(\"greenNode\") ? $(this).contextmenu(\"removeFlare\", id, ui) : $(this).contextmenu(\"setFlare\", id, ui.cmd, ui);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"mass\":\r\n\t\t\t\t$(\"#dialog-mass\").data(\"id\", nodeElem.data(\"sigid\")).data(\"systemID\", id).dialog(\"open\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"ping\":\r\n\t\t\t\t$(\"#dialog-ping\").data(\"id\", nodeElem.data(\"sigid\") || null).data(\"systemID\", id).dialog(\"open\");\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"collapse\":\r\n\t\t\t\tvar toggle = options.chain.tabs[options.chain.active] ? ($.inArray(id, options.chain.tabs[options.chain.active].collapsed) == -1 ? true : false) : true;\r\n\t\t\t\tchain.renderer.collapse(id, toggle);\r\n\t\t\t\tbreak;\r\n\t\t\tcase \"makeTab\":\r\n\t\t\t\tconst existingTabIndex = Object.index(options.chain.tabs, 'systemID', '' + id, false);\r\n\t\t\t\tif(undefined !== existingTabIndex) {\r\n\t\t\t\t\tchain.setActiveTab(existingTabIndex);\r\n\t\t\t\t} else {\r\n\t\t\t\t\tconst systemName = tripwire.systems[id].name;\r\n\t\t\t\t\toptions.chain.tabs.push({systemID: '' + id, name: systemName});\r\n\t\t\t\t\tvar newTab = $(\"#chainTab .tab\").clone();\r\n\t\t\t\t\tnewTab.attr('id', options.chain.tabs.length - 1).find(\".name\").data(\"tab\", id).html(systemName);\r\n\t\t\t\t\t$(\"#chainTabs\").append(newTab);\r\n\t\t\t\t\tchain.setActiveTab(options.chain.tabs.length - 1);\r\n\t\t\t\t}\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\t},\r\n\tbeforeOpen: function(e, ui) {\r\n\t\tvar wormholeID = $(ui.target[0]).closest(\"[data-nodeid]\").data(\"sigid\") || null;\r\n\t\tvar systemID = $(ui.target[0]).closest(\"[data-nodeid]\").data(\"nodeid\");\r\n\r\n\t\t// Add check for k-space\r\n\t\tif (tripwire.systems[systemID].class || !tripwire.esi.characters[options.tracking.active]) {\r\n\t\t\t$(this).contextmenu(\"enableEntry\", \"setDest\", false);\r\n\t\t\t$(this).contextmenu(\"enableEntry\", \"addWay\", false);\r\n\t\t\t$(this).contextmenu(\"enableEntry\", \"showMap\", false);\r\n\t\t} else {\r\n\t\t\t$(this).contextmenu(\"enableEntry\", \"setDest\", true);\r\n\t\t\t$(this).contextmenu(\"enableEntry\", \"addWay\", true);\r\n\t\t\t$(this).contextmenu(\"enableEntry\", \"showMap\", false);\r\n\t\t}\r\n\t\t\r\n\t\t// Add check for in-sig\r\n\t\tif (wormholeID) {\r\n\t\t\t$(this).contextmenu(\"enableEntry\", \"mass\", true);\r\n\t\t} else {\r\n\t\t\t$(this).contextmenu(\"enableEntry\", \"mass\", false);\r\n\t\t}\r\n\t\t\r\n\t\t// Add check for tab validity\r\n\t\tconst existingTab = Object.find(options.chain.tabs, 'systemID', '' + systemID, false);\r\n\t\t$('#makeTabMenuItem').text(existingTab ? 'View Tab' : 'Make Tab' );\r\n\t},\r\n\tcreate: function(e, ui) {\r\n\t\t// Fix some bad CSS from jQuery Position\r\n\t\t$(this).find(\".ui-front\").css(\"width\", \"10em\");\r\n\t\t$(this).find(\".ui-front\").css(\"position\", \"\");\r\n\r\n\t\t$(\"#dialog-mass\").dialog({\r\n\t\t\tautoOpen: false,\r\n\t\t\twidth: \"auto\",\r\n\t\t\theight: \"auto\",\r\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\r\n\t\t\tbuttons: {\r\n\t\t\t\tClose: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\topen: function() {\r\n\t\t\t\tvar wormholeID = $(this).data(\"id\");\r\n\t\t\t\tvar systemID = $(this).data(\"systemID\");\r\n\t\t\t\tvar wormhole = tripwire.client.wormholes[wormholeID];\r\n\t\t\t\tvar signature = tripwire.client.signatures[wormhole.initialID];\r\n\t\t\t\tvar otherSignature = tripwire.client.signatures[wormhole.secondaryID];\r\n\r\n\t\t\t\t$(\"#dialog-mass\").dialog(\"option\", \"title\", \"From \"+tripwire.systems[signature.systemID].name+\" to \"+tripwire.systems[otherSignature.systemID].name);\r\n\r\n\t\t\t\t$(\"#dialog-mass #massTable tbody tr\").remove();\r\n\r\n\t\t\t\tvar payload = {wormholeID: wormhole.id};\r\n\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: \"mass.php\",\r\n\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\tdata: payload,\r\n\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t}).done(function(data) {\r\n\t\t\t\t\tif (data && data.jumps) {\r\n                        var totalMass = 0;\r\n\t\t\t\t\t\tfor (x in data.jumps) {\r\n\t\t\t\t\t\t\tconst jumpMass = parseFloat(appData.mass[data.jumps[x].shipTypeID].mass);\r\n                            totalMass += jumpMass;\r\n\t\t\t\t\t\t\t$(\"#dialog-mass #massTable tbody\").append(\"<tr><td>\"+data.jumps[x].characterName+\"</td><td>\"+(data.jumps[x].toID == systemID ? \"In\" : \"Return\")+\"</td><td>\"+appData.mass[data.jumps[x].shipTypeID].typeName+\"</td><td>\"+Intl.NumberFormat().format(jumpMass)+\"Kg</td><td>\"+data.jumps[x].time+\"</td></tr>\");\r\n\t\t\t\t\t\t}\r\n                        $(\"#dialog-mass #massTable tbody\").append(\"<tr><td></td><td></td><td></td><th>\"+ Intl.NumberFormat().format(totalMass) +\"Kg</th><td></td></tr>\");\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t}\r\n\t\t});\r\n\r\n\t\t$.moogle.contextmenu.prototype.setFlare = function(systemID, flare, ui) {\r\n\t\t\tvar data = {\"systemID\": systemID, \"flare\": flare};\r\n\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: \"flares.php\",\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdata: data,\r\n\t\t\t\tdataType: \"JSON\"\r\n\t\t\t}).done(function(data) {\r\n\t\t\t\tif (data && data.result) {\r\n\t\t\t\t\t// $(ui.target[0]).closest(\"td\").removeClass(\"redNode yellowNode greenNode\").addClass(flare+\"Node\");\r\n\r\n\t\t\t\t\tchain.data.flares.flares.push({systemID: systemID, flare: flare, time: null});\r\n\t\t\t\t\tchain.flares(chain.data.flares);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\t$.moogle.contextmenu.prototype.removeFlare = function(systemID, ui) {\r\n\t\t\tvar data = {\"systemID\": systemID};\r\n\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: \"flares.php\",\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdata: data,\r\n\t\t\t\tdataType: \"JSON\"\r\n\t\t\t}).done(function(data) {\r\n\t\t\t\tif (data && data.result) {\r\n\t\t\t\t\t// $(ui.target[0]).closest(\"td\").removeClass(\"redNode yellowNode greenNode\");\r\n\r\n\t\t\t\t\tchain.data.flares.flares.splice(Object.index(chain.data.flares.flares, \"systemID\", systemID), 1);\r\n\t\t\t\t\tchain.flares(chain.data.flares);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t}\r\n});\r\n\r\n/** Format a signature ID like abc123 as ABC-123 for user display */\r\nfunction formatSignatureID(signatureID) {\r\n\treturn (!signatureID) ? '???-###' :\r\n\t\t(signatureID.length >= 3 ? signatureID.substring(0, 3).toUpperCase() : '') + \"-\" + (signatureID.length == 6 ? signatureID.substring(3, 6) : \"###\");\r\n}\r\n\r\n// Used to generate eve-survival guide link\r\nfunction linkSig(sigName) {\r\n\tvar wormholeSignatures = [\r\n\t\t// Ore sites\r\n\t\t\"Average Frontier Deposit\",\r\n\t\t\"Unexceptional Frontier Deposit\",\r\n\t\t\"Common Perimeter Deposit\",\r\n\t\t\"Exceptional Core Deposit\",\r\n\t\t\"Infrequent Core Deposit\",\r\n\t\t\"Unusual Core Deposit\",\r\n\t\t\"Rarified Core Deposit\",\r\n\t\t\"Isolated Core Deposit\",\r\n\t\t\"Ordinary Permiter Deposit\",\r\n\t\t\"Uncommon Core Deposit\",\r\n\r\n\t\t// Gas Sites\r\n\t\t\"Barren Perimeter Reservoir\",\r\n\t\t\"Minor Perimeter Reservoir\",\r\n\t\t\"Ordinary Perimeter Reservoir\",\r\n\t\t\"Sizeable Perimeter Reservoir\",\r\n\t\t\"Token Perimeter Reservoir\",\r\n\t\t\"Bountiful Frontier Reservoir\",\r\n\t\t\"Vast Frontier Reservoir\",\r\n\t\t\"Instrumental Core Reservoir\",\r\n\t\t\"Vital Core Reservoir\",\r\n\r\n\t\t// Class 1\r\n\t\t\"Perimeter Ambush Point\",\r\n\t\t\"Perimeter Camp\",\r\n\t\t\"Phase Catalyst Node\",\r\n\t\t\"The Line\",\r\n\t\t\"Forgotten Perimeter Coronation Platform\",\r\n\t\t\"Forgotten Perimeter Power Array\",\r\n\t\t\"Unsecured Perimeter Amplifier\",\r\n\t\t\"Unsecured Perimeter Information Center\",\r\n\r\n\t\t// Class 2\r\n\t\t\"Perimeter Checkpoint\",\r\n\t\t\"Perimeter Hangar\",\r\n\t\t\"The Ruins of Enclave Cohort 27\",\r\n\t\t\"Sleeper Data Sanctuary\",\r\n\t\t\"Forgotten Perimeter Gateway\",\r\n\t\t\"Forgotten Perimeter Habitation Coils\",\r\n\t\t\"Unsecured Perimeter Comms Relay\",\r\n\t\t\"Unsecured Perimeter Transponder Farm\",\r\n\r\n\t\t// Class 3\r\n\t\t\"Fortification Frontier Stronghold\",\r\n\t\t\"Outpost Frontier Stronghold\",\r\n\t\t\"Solar Cell\",\r\n\t\t\"The Oruze Construct\",\r\n\t\t\"Forgotten Frontier Quarantine Outpost\",\r\n\t\t\"Forgotten Frontier Recursive Depot\",\r\n\t\t\"Unsecured Frontier Database\",\r\n\t\t\"Unsecured Frontier Receiver\",\r\n\r\n\t\t// Class 4\r\n\t\t\"Frontier Barracks\",\r\n\t\t\"Frontier Command Post\",\r\n\t\t\"Integrated Terminus\",\r\n\t\t\"Sleeper Information Sanctum\",\r\n\t\t\"Forgotten Frontier Conversion Module\",\r\n\t\t\"Forgotten Frontier Evacuation Center\",\r\n\t\t\"Unsecured Frontier Digital Nexus\",\r\n\t\t\"Unsecured Frontier Trinary Hub\",\r\n\r\n\t\t// Class 5\r\n\t\t\"Core Garrison\",\r\n\t\t\"Core Stronghold\",\r\n\t\t\"Oruze Osobnyk\",\r\n\t\t\"Quarantine Area\",\r\n\t\t\"Forgotten Core Data Field\",\r\n\t\t\"Forgotten Core Information Pen\",\r\n\t\t\"Unsecured Frontier Enclave Relay\",\r\n\t\t\"Unsecured Frontier Server Bank\",\r\n\r\n\t\t// Class 6\r\n\t\t\"Core Citadel\",\r\n\t\t\"Core Bastion\",\r\n\t\t\"Strange Energy Readings\",\r\n\t\t\"The Mirror\",\r\n\t\t\"Forgotten Core Assembly Hall\",\r\n\t\t\"Forgotten Core Circuitry Disassembler\",\r\n\t\t\"Unsecured Core Backup Array\",\r\n\t\t\"Unsecured Core Emergence\"\r\n\t];\r\n\r\n\tif (wormholeSignatures.indexOf(sigName) > -1) {\r\n\t\treturn '<a href=\"http://eve-survival.org/wikka.php?wakka='+sigName.replace(/ /g, '')+'\" target=\"_blank\" class=\"siteLink\">'+sigName+'</a>';\r\n\t}\r\n\r\n\treturn sigName;\r\n}\r\n\r\n// Initialize tablesorter plugin on signaturesWidget table\r\n$(\"#sigTable\").tablesorter({\r\n\tsortReset: true,\r\n\twidgets: ['saveSort'],\r\n\ttextExtraction: {\r\n\t\t2: function(node) { return $(node).find(\"span\").data(\"age\"); }\r\n\t}\r\n});\r\n\r\n// Highlight signaturesWidget tr on click\r\n$(\"#sigTable tbody\").on(\"click\", \"tr\", function(e) {\r\n\tif (e.metaKey || e.ctrlKey) {\r\n\t\t// ctrl or cmd key\r\n\t\t$(this).toggleClass(\"selected\");\r\n\t} else if (e.shiftKey) {\r\n\t\t// shift key\r\n\t\t$(this).addClass(\"selected\");\r\n\t\t$(\"#sigTable tbody tr.selected:first\").nextUntil(\"#sigTable tbody tr.selected:last\").addBack().add(\"#sigTable tbody tr.selected:last\").addClass(\"selected\");\r\n\t} else {\r\n\t\t$(\"#sigTable tbody tr.selected\").removeClass(\"selected\");\r\n\t\t$(this).addClass(\"selected\");\r\n\t}\r\n});\r\n\r\n// Un-Highlight signaturesWidget tr on clicking outside\r\n$(document).click(function(e) {\r\n    if(!$(e.target).closest('#sigTable tbody').length && !$(e.target).closest('#edit-signature').length && !$(e.target).closest('#delete-signature').length) {\r\n\t\t$(\"#sigTable tbody tr.selected\").removeClass(\"selected\");\r\n    }\r\n});\r\n\r\n// Monitor custom 'classchange' event\r\n$(\"#sigTable tbody\").on(\"classchange\", \"tr\", function(e, className) {\r\n\t// Trigger signaturesWidget selected row change custom event\r\n\tif (className === \"selected\") {\r\n\t\t$(\"#signaturesWidget\").trigger(\"selected:change\");\r\n\t}\r\n});\r\n\r\n// Update signaturesWidget based on .selected rows change\r\n$(\"#signaturesWidget\").on(\"selected:change\", function() {\r\n\t// Enable/Disable delete icon\r\n\tif ($(\"#sigTable tr.selected\").length === 0) {\r\n\t\t$(\"#signaturesWidget #delete-signature\").addClass(\"disabled\");\r\n\t} else {\r\n\t\t$(\"#signaturesWidget #delete-signature\").removeClass(\"disabled\");\r\n\t}\r\n\r\n\t// Enable/Disable edit icon\r\n\tif ($(\"#sigTable tr.selected\").length === 1) {\r\n\t\t$(\"#signaturesWidget #edit-signature\").removeClass(\"disabled\");\r\n\t} else {\r\n\t\t$(\"#signaturesWidget #edit-signature\").addClass(\"disabled\");\r\n\t}\r\n})\r\n\r\n$(\"#dialog-error\").dialog({\r\n\tautoOpen: false,\r\n\tresizable: false,\r\n\tminHeight: 0,\r\n\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\tbuttons: {\r\n\t\tOk: function() {\r\n\t\t\t$(this).dialog(\"close\");\r\n\t\t}\r\n\t},\r\n\tcreate: function() {\r\n\t\t$(this).dialog(\"option\", \"show\", {effect: \"shake\", duration: 150, easing: \"easeOutElastic\"});\r\n\t}\r\n});\r\n\r\n$(\"#dialog-msg\").dialog({\r\n\tautoOpen: false,\r\n\tresizable: false,\r\n\tminHeight: 0,\r\n\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\tbuttons: {\r\n\t\tOk: function() {\r\n\t\t\t$(this).dialog(\"close\");\r\n\t\t}\r\n\t}\r\n});\r\n\r\n$(\"#dialog-confirm\").dialog({\r\n\tautoOpen: false,\r\n\tresizable: false,\r\n\tminHeight: 0,\r\n\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\tbuttons: {\r\n\t\tCancel: function() {\r\n\t\t\t$(this).dialog(\"close\");\r\n\t\t}\r\n\t}\r\n});\r\n\r\nif (window.location.href.indexOf(\"galileo\") != -1) {\r\n\tNotify.trigger(\"This is the test version of Tripwire.<br/>Please use <a href='https://tripwire.cloud-things.com'>Tripwire</a>\")\r\n}\r\n","/** Functions for rendering things relating to wormholes */\r\nconst wormholeRendering = new function() { \r\n\t/** Render a wormhole type (from appData.wormholes).\r\n\t* @param type The type object e.g. appData.wormholes.B274\r\n\t* @param key The wormhole type e.g. 'B274'\r\n\t* @param from What system, or type of system e.g. 'Class-2' the wormhole comes from. If omitted, the type object will be used\r\n\t* @param target As above but for the target of the wormhole\r\n\t*/\r\n\tthis.renderWormholeType = function(type, key, from, target) {\r\n\t\treturn ((key || type.key) ? '<b>' + (key || type.key || '') + '</b>: ' : '') +\r\n\t\t\tformatEndTypes(type.from, from) + '➔' + formatEndTypes(type.leadsTo, target) +\r\n\t\t\t(type.jump ? ' (' + this.renderMass(type.jump) + ')' : '')\r\n\t\t\t;\r\n\t};\r\n\t\r\n\t/** Render a mass number. */\r\n\tthis.renderMass = function(mass) { return (mass / 1e6) + 'kt'; }\r\n\t\r\n\tfunction formatEndTypes(types, override) {\r\n\t\tif(!types) { return '?'; }\r\n\t\ttypes = Array.isArray(types) ? types : [ types ];\r\n\t\t\r\n\t\tif(override) {\r\n\t\t\tconst overrideSystem = override.name ? override :\r\n\t\t\t\tsystemAnalysis.analyse(Object.index(appData.systems, \"name\", override, true) || override);\t// look up real system ID first\r\n\t\t\t\r\n\t\t\tconst eligibleTypes = types.filter(function(type) {\r\n\t\t\t\treturn overrideSystem.name == type || overrideSystem.genericSystemType == type;\r\n\t\t\t});\r\n\t\t\t\r\n\t\t\tif(eligibleTypes.length) { types = eligibleTypes; }\r\n\t\t}\r\n\t\t\r\n\t\treturn types.map(function(type) {\r\n\t\t\tconst systemID = Object.index(appData.systems, \"name\", type, true) || type;\t// look up real system ID first\r\n\t\t\tconst system = systemAnalysis.analyse(systemID);\r\n\t\t\treturn system ? '<span class=\"' + system.systemTypeClass + '\">' + (system.name || system.systemTypeName) + '</span>' : undefined }\r\n\t\t).filter(function(x) { return x !== undefined; }).join(',');\r\n\t};\r\n}","// Custom inlinecomplete + dropdown input\r\n$.widget(\"custom.inlinecomplete\", $.ui.autocomplete, {\r\n\t_create: function() {\r\n\t\tthis.options.source = this._coerceSource(this.options.source);\r\n\t\t\r\n\t\tif (!this.element.is(\"input\")) {\r\n\t\t\tthis._selectInit();\r\n\t\t}\r\n\r\n\t\t// Invoke the parent function\r\n\t\treturn this._super();\r\n\t},\r\n\t_value: function() {\r\n\t\t// Invoke the parent function\r\n\t\tvar originalReturn = this._superApply(arguments);\r\n\r\n\t\tthis.element.change();\r\n\r\n\t\treturn originalReturn;\r\n\t},\r\n\t_suggest: function(items) {\r\n\t\t// if (this.element.val() != items[0].value) {\r\n\t\t\t// this.element.val(items[0].value.substr(0, this.element.val().length));\r\n\t\t// }\r\n\r\n\t\t// Invoke the parent function\r\n\t\treturn this._super(items);\r\n\t},\r\n\t_coerceSource: function(source) {\r\n\t\t// Allow an object source like tripwire.systems - coerce it to an array\r\n\t\treturn $.isArray(source) ? source :\r\n\t\t\tObject.keys(source).map(function(k) { return Object.assign({ key: k }, source[k]); }.bind(this) );\r\n\t},\r\n\t_initSource: function() {\r\n\t\tthis.source = function(request, response) {\r\n\t\t\tvar matcher = new RegExp(\"^\" + $.ui.autocomplete.escapeRegex(request.term), \"i\");\r\n\t\t\tvar results = new Array(); // results array\r\n\t\t\tconst dataSource = this.options.source;\r\n\t\t\tvar maxSize = this.options.maxSize || 25; // maximum result size\r\n\t\t\t// simple loop for the options\r\n\t\t\tfor (var i = 0, l = dataSource.length; i < l; i++) {\r\n\t\t\t\tconst target = dataSource[i].name || dataSource[i].key || dataSource[i];\r\n\t\t\t\tif (matcher.test(target)) {\r\n\t\t\t\t\tresults.push( { value: target, label: target, content: typeof dataSource[i] === 'object' ? dataSource[i] : undefined });\r\n\r\n\t\t\t\t\tif (maxSize && request.term !== '' && results.length > maxSize) {\r\n\t\t\t\t\t\tbreak;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t // send response\r\n\t\t\t response(results);\r\n\t\t}\r\n\t},\t\r\n\t_renderItem: function( ul, item ) {\r\n\t\tif(item.content && this.options.renderer) {\r\n\t\t\tconst renderFunction = typeof this.options.renderer === 'function' ? this.options.renderer : renderers[this.options.renderer];\r\n\t\t\tconst renderResult = renderFunction(item.content);\r\n\t\t\treturn $( \"<li>\" )\r\n\t\t\t.html( '<span>' + renderResult + '</span>')\r\n\t\t\t.appendTo( ul );\r\n\t\t} else return this._super(ul, item);\r\n\t},\r\n\t_close: function(event) {\r\n\t\tthis.options.source = this.options.input_source ? this.options.input_source : this.options.source;\r\n\r\n\t\t// Invoke the parent function\r\n\t\treturn this._super(event);\r\n\t},\r\n\taddToSelect: function(value) {\r\n\t\tthis.options.select_added_value = value;\r\n\t\tthis.options.select_source.unshift(value);\r\n\t},\r\n\tremoveFromSelect: function(value) {\r\n\t\tif (value) {\r\n\t\t\tthis.options.select_source.splice(value, 1);\r\n\t\t} else if (this.options.select_added_value) {\r\n\t\t\tthis.options.select_source.splice(this.options.select_added_value, 1);\r\n\t\t}\r\n\t\tthis.options.select_added_value = null;\r\n\t},\r\n\t_selectInit: function() {\r\n\t\tthis.element.addClass(\"custom-combobox\");\r\n\t\tthis.wrapper = this.element;\r\n\t\tthis.element = this.wrapper.find(\"input:first\") || this.element;\r\n\t\tthis.select = this.wrapper.find(\"select:first\").remove();\r\n\r\n\t\tthis.options.input_source = this.options.source;\r\n\t\tthis.options.select_source = this.select.children(\"option[value!='']\").map(function() { return $.trim(this.text); }).toArray();\r\n\r\n\t\tthis._createShowAllButton();\r\n\t},\r\n\t_createShowAllButton: function() {\r\n        var that = this,\r\n          wasOpen = false;\r\n\r\n        $(\"<a>\")\r\n\t\t\t.attr(\"tabIndex\", that.element.prop(\"tabindex\"))\r\n\t\t\t.attr(\"title\", \"\")\r\n\t\t\t.appendTo(that.wrapper)\r\n\t\t\t.button({icons: {primary: \"ui-icon-triangle-1-s\"}, text: false})\r\n\t\t\t.removeClass(\"ui-corner-all\")\r\n\t\t\t.addClass(\"custom-combobox-toggle ui-corner-right\")\r\n\t\t\t.on(\"mousedown\", function() {\r\n\t\t\t\twasOpen = that.widget().is(\":visible\");\r\n\t\t\t})\r\n\t\t\t.on(\"click\", function() {\r\n\t\t\t\tthat.element.trigger(\"focus\");\r\n\r\n\t\t\t\t// Close if already visible\r\n\t\t\t\tif (wasOpen) {\r\n\t\t\t\t  return;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t// Pass empty string as value to search for, displaying all results\r\n\t\t\t\tif(that.options.customDropdown) {\r\n\t\t\t\t\tthat.options.select_source = that._coerceSource(that.options.customDropdown())\r\n\t\t\t\t}\r\n\t\t\t\tthat.options.source = that.options.select_source;\r\n\t\t\t\tthat._search(\"\");\r\n\t\t\t});\r\n\t},\r\n});\r\n\r\nconst renderers =  {\r\n\tsystem: function(system) {\r\n\t\treturn systemRendering.renderSystem(systemAnalysis.analyse(undefined, system), 'span');\r\n\t},\r\n\twormholeType: wormholeRendering.renderWormholeType\r\n};\r\n","const systemAnalysis = new function() {\r\n\tconst mutators = [];\r\n\tthis.addMutator = function(m) { mutators.push(m); }\r\n\t\r\n\t/** Extract attributes of the system, and allow mutators to add/modify them.\r\n\t\tOptionally, pass in a system object */\r\n\tthis.analyse = function(systemID, system) {\r\n\t\tif(!system) { system = appData.systems[systemID]; }\r\n\t\tif(!system) { system = getDummySystem(systemID); }\r\n\t\tif(!systemID) { systemID = system.systemID; }\r\n\t\tconst r = Object.assign({}, system);\r\n\t\t\r\n\t\t// Defaults or saved original values\r\n\t\tr.baseSecurity = 1 * system.security;\r\n\t\tr.pathSymbol = '■';\r\n\t\tr.systemTypeModifiers = [];\t\t\r\n\t\tr.systemID = systemID;\r\n\t\t\r\n\t\tmutators.forEach(function(m) { m.mutate(r, systemID); });\r\n\t\t\r\n\t\t// Calculated final values\r\n\t\tr.systemTypeClass = r.class ? 'wh class-' + r.class :\r\n\t\t\tr.factionID == 500026 ? 'triglavian' :\r\n\t\t\tr.security >= 0.45 ? 'hisec' :\r\n\t\t\tr.security > 0.0 ? 'lowsec' :\r\n\t\t\tr.security <= 0.0 ? 'nullsec' :\r\n\t\t\t'unknown';\r\n\t\tr.systemTypeName = r.class ? 'C' + r.class :\r\n\t\t\tr.factionID == 500026 ? 'Trig' :\r\n\t\t\tr.baseSecurity >= 0.45 ? 'HS' :\r\n\t\t\tr.baseSecurity > 0.0 ? 'LS' :\r\n\t\t\tr.baseSecurity <= 0.0 ? 'NS' :\r\n\t\t\t' ';\r\n\t\tr.genericSystemType = r.class ? 'Class-' + r.class :\r\n\t\t\tr.factionID == 500026 ? 'Triglavian' :\r\n\t\t\tr.baseSecurity >= 0.45 ? 'High-Sec' :\r\n\t\t\tr.baseSecurity > 0.0 ? 'Low-Sec' :\r\n\t\t\tr.baseSecurity <= 0.0 ? 'Null-Sec' :\r\n\t\t\t' ';\r\n\t\tr.effectClass = \r\n\t\t\tr.effect === 'Black Hole' ? 'blackhole' :\r\n\t\t\tr.effect === 'Cataclysmic Variable' ? 'cataclysmic-variable' :\r\n\t\t\tr.effect === 'Magnetar' ? 'magnetar' :\r\n\t\t\tr.effect === 'Pulsar' ? 'pulsar' :\r\n\t\t\tr.effect === 'Red Giant' ? 'red-giant' :\r\n\t\t\tr.effect === 'Wolf-Rayet Star' ? 'wolf-rayet' :\r\n\t\t\tundefined;\r\n\t\t\t\r\n\t\treturn r;\r\n\t};\r\n\t\r\n\t/** Create a dummy system object for fake IDs like 'Null-Sec', 'Class-5' etc */\r\n\tfunction getDummySystem(systemID) {\r\n\t\tconst leadsToPointer = typeof(systemID) === \"string\" && systemID.indexOf(\"|\") >= 0 ? appData.genericSystemTypes[systemID.substring(0, systemID.indexOf(\"|\"))]\r\n\t\t: appData.genericSystemTypes.indexOf(systemID) >= 0 ? systemID\r\n\t\t: appData.genericSystemTypes[systemID];\r\n\t\tconst nodeClass = \r\n\t\t\tleadsToPointer && leadsToPointer.substring(0, 6) == 'Class-' ? 1 * leadsToPointer.substring(6) :\r\n\t\t\tundefined;\r\n\t\tconst nodeSecurity = \r\n\t\t\tleadsToPointer == \"High-Sec\" ? 0.8 :\r\n\t\t\tleadsToPointer == \"Low-Sec\" ? 0.4 :\r\n\t\t\tleadsToPointer == \"Null-Sec\" ? -0.1 :\r\n\t\t\tundefined;\r\n\t\tconst nodeFaction = \r\n\t\t\tleadsToPointer == \"Triglavian\" ? 500026 :\r\n\t\t\tundefined;\r\n\t\t\r\n\t\treturn { security: nodeSecurity, class: nodeClass, factionID: nodeFaction };\r\n\t}\r\n}","const mutator_favourite = new _FavouriteMutator();\r\nsystemAnalysis.addMutator(mutator_favourite);\r\n\r\nfunction _FavouriteMutator() {\r\n\tconst _this = this;\r\n\r\n\tthis.mutate = function(system, systemID) {\r\n\t\tif(options.favorites.indexOf(systemID * 1) >= 0) {\r\n\t\t\tsystem.pathSymbol = '★';\r\n\t\t\tsystem.systemTypeModifiers.push('<span class=\"favorite active\" data-icon=\"star\"></span>');\t\t// star added by CSS\r\n\t\t}\r\n\t}\r\n}","const invasions = new _Invasions();\r\nsystemAnalysis.addMutator(invasions);\r\n\r\nfunction _Invasions() {\r\n\tconst _this = this;\r\n\tconst pathSymbolMap = {\r\n\t\tstellar_reconnaissance: '◆',\r\n\t\t\r\n\t\ttriglavian_minor_victory: '▽',\r\n\t\tescalating_liminality: '▽',\r\n\t\tfinal_liminality: '▼',\r\n\t\t\r\n\t\tedencom_minor_victory: '△',\r\n\t\tredoubt: '△', bulwark: '△',\r\n\t\tfortress: '▲',\r\n\t};\r\n\tconst textMap = {\r\n\t\tstellar_reconnaissance: 'Stellar Reconnaissance',\r\n\t\t\r\n\t\ttriglavian_minor_victory: 'Triglavian Minor Victory',\r\n\t\tescalating_liminality: 'Escalating Liminality',\r\n\t\tfinal_liminality: 'Final Liminality',\r\n\t\t\r\n\t\tedencom_minor_victory: 'EDENCOM Minor Victory',\r\n\t\tredoubt: 'Redoubt',\r\n\t\tbulwark: 'Bulwark',\r\n\t\tfortress: 'EDENCOM Fortress',\r\n\t}\r\n\tconst data = [{\"system_id\":30003088,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-10-04T12:29:02.888Z\",\"system_name\":\"Oyonata\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003894,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-10-01T18:28:09.852Z\",\"system_name\":\"Sabusi\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004302,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-30T15:36:50.977Z\",\"system_name\":\"Omigiav\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003539,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-30T14:11:30.759Z\",\"system_name\":\"Miakie\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005074,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-30T14:02:33.042Z\",\"system_name\":\"Daran\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003570,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-30T13:47:01.992Z\",\"system_name\":\"Elore\",\"system_security\":\"0.2\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30003573,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-28T15:38:24.368Z\",\"system_name\":\"Pertnineere\",\"system_security\":\"0.4\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30003463,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-28T15:38:14.299Z\",\"system_name\":\"Erlendur\",\"system_security\":\"0.5\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30002079,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.4\",\"updated_at\":\"2020-09-28T15:37:20.058Z\",\"system_name\":\"Krirald\",\"system_security\":\"0.2\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30002652,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.4\",\"updated_at\":\"2020-09-28T15:36:53.719Z\",\"system_name\":\"Ala\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30045331,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-28T15:36:28.616Z\",\"system_name\":\"Vaaralen\",\"system_security\":\"0.3\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003788,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-26T12:44:03.049Z\",\"system_name\":\"Intaki\",\"system_security\":\"0.1\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30002724,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-25T00:51:28.251Z\",\"system_name\":\"Assiettes\",\"system_security\":\"0.6\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30002999,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-24T12:03:23.037Z\",\"system_name\":\"Shastal\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000102,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-23T22:22:21.093Z\",\"system_name\":\"Dysa\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003919,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-22T10:22:11.970Z\",\"system_name\":\"Ashkoo\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004978,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-22T10:21:30.195Z\",\"system_name\":\"Pemene\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30004287,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-20T11:25:28.863Z\",\"system_name\":\"Esubara\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002051,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-20T11:25:09.478Z\",\"system_name\":\"Anher\",\"system_security\":\"0.5\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30003823,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-20T11:24:54.777Z\",\"system_name\":\"Kenninck\",\"system_security\":\"0.1\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30001400,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-18T14:03:33.048Z\",\"system_name\":\"Litiura\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30005251,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-18T09:42:27.550Z\",\"system_name\":\"Asanot\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005267,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-17T11:18:57.960Z\",\"system_name\":\"Bherdasopt\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002411,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.3\",\"updated_at\":\"2020-09-17T00:30:42.544Z\",\"system_name\":\"Skarkon\",\"system_security\":\"0.1\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30003587,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-15T01:16:50.021Z\",\"system_name\":\"Harner\",\"system_security\":\"0.1\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30003904,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-14T16:54:07.359Z\",\"system_name\":\"Col\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005209,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-14T16:53:54.556Z\",\"system_name\":\"Sibe\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004103,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-14T13:40:36.727Z\",\"system_name\":\"Kothe\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005219,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-13T09:34:00.331Z\",\"system_name\":\"Sigga\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002755,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-12T20:51:38.354Z\",\"system_name\":\"Usi\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003824,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-11T08:28:52.435Z\",\"system_name\":\"Archavoinet\",\"system_security\":\"0.6\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30002239,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-11T08:28:42.669Z\",\"system_name\":\"Rammi\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005005,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.5\",\"updated_at\":\"2020-09-10T21:09:12.196Z\",\"system_name\":\"Ignebaener\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30000021,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.8\",\"updated_at\":\"2020-09-09T21:16:25.577Z\",\"system_name\":\"Kuharah\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000118,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-09T08:08:17.988Z\",\"system_name\":\"Uanzin\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003794,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-07T23:26:42.297Z\",\"system_name\":\"Stacmon\",\"system_security\":\"0.6\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30003927,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-07T22:18:47.862Z\",\"system_name\":\"Zahefeus\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000109,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-07T20:54:30.351Z\",\"system_name\":\"Berta\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002797,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.9\",\"updated_at\":\"2020-09-06T13:33:29.649Z\",\"system_name\":\"Kaunokka\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30031392,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.4\",\"updated_at\":\"2020-09-06T13:33:15.544Z\",\"system_name\":\"Komo\",\"system_security\":\"0.8\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30004090,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-06T06:22:50.377Z\",\"system_name\":\"Aband\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000060,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-06T01:54:13.794Z\",\"system_name\":\"Janus\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003548,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-05T17:05:22.429Z\",\"system_name\":\"Barira\",\"system_security\":\"0.8\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000160,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-04T23:48:55.626Z\",\"system_name\":\"Reisen\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30004999,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-04T15:38:27.450Z\",\"system_name\":\"Ladistier\",\"system_security\":\"0.3\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30000113,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-04T07:07:27.574Z\",\"system_name\":\"Astabih\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004295,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-09-02T18:09:55.446Z\",\"system_name\":\"Keba\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30001413,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.2\",\"updated_at\":\"2020-09-02T08:11:42.869Z\",\"system_name\":\"Nani\",\"system_security\":\"0.8\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30002386,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-09-01T08:04:35.922Z\",\"system_name\":\"Gelfiven\",\"system_security\":\"0.6\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30004973,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-31T21:17:02.227Z\",\"system_name\":\"Caslemon\",\"system_security\":\"0.6\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30004231,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-31T20:32:52.884Z\",\"system_name\":\"Shakasi\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004284,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-31T20:32:43.772Z\",\"system_name\":\"Defsunun\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002266,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-31T10:38:02.368Z\",\"system_name\":\"Ahmak\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003932,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-29T23:12:29.549Z\",\"system_name\":\"Timudan\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004254,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-28T16:43:28.986Z\",\"system_name\":\"Fihrneh\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004244,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-28T07:55:35.187Z\",\"system_name\":\"Onanam\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002513,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-27T20:59:21.817Z\",\"system_name\":\"Dammalin\",\"system_security\":\"0.5\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30000206,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.5\",\"updated_at\":\"2020-08-27T14:06:44.066Z\",\"system_name\":\"Wirashoda\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30002048,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-27T11:14:57.970Z\",\"system_name\":\"Bei\",\"system_security\":\"0.6\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30003090,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-26T23:04:35.948Z\",\"system_name\":\"Saidusairos\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003478,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-26T00:06:02.331Z\",\"system_name\":\"Basan\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004289,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-25T11:33:32.949Z\",\"system_name\":\"Vaini\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30045345,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-24T21:16:26.292Z\",\"system_name\":\"Hirri\",\"system_security\":\"0.3\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30001358,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-24T08:44:18.165Z\",\"system_name\":\"Ossa\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003061,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-24T07:23:55.183Z\",\"system_name\":\"Mormelot\",\"system_security\":\"0.2\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30040141,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.4\",\"updated_at\":\"2020-08-23T11:05:21.929Z\",\"system_name\":\"Urhinichi\",\"system_security\":\"0.8\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003078,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-22T18:47:39.976Z\",\"system_name\":\"Erkinen\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002530,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-22T15:09:00.523Z\",\"system_name\":\"Avesber\",\"system_security\":\"0.8\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30003900,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-22T07:50:34.044Z\",\"system_name\":\"Ham\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002644,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-21T08:26:40.788Z\",\"system_name\":\"Ambeke\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30001401,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-21T00:44:17.584Z\",\"system_name\":\"Nonni\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30045328,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.7\",\"updated_at\":\"2020-08-20T14:35:34.268Z\",\"system_name\":\"Ahtila\",\"system_security\":\"0.6\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003480,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-20T11:19:04.711Z\",\"system_name\":\"Amod\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004141,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-20T01:50:23.539Z\",\"system_name\":\"Hiremir\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002770,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.1\",\"updated_at\":\"2020-08-18T14:53:00.972Z\",\"system_name\":\"Tunudan\",\"system_security\":\"0.4\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003504,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.7\",\"updated_at\":\"2020-08-18T14:46:27.787Z\",\"system_name\":\"Niarja\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002253,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-18T09:31:28.183Z\",\"system_name\":\"Arshat\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002737,\"status\":\"final_liminality\",\"derived_security_status\":\"0.0\",\"updated_at\":\"2020-08-16T21:29:53.121Z\",\"system_name\":\"Konola\",\"system_security\":\"0.7\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003398,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-16T17:38:55.577Z\",\"system_name\":\"Anbald\",\"system_security\":\"0.7\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30003490,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-15T20:27:08.919Z\",\"system_name\":\"Khopa\",\"system_security\":\"0.8\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30001696,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-14T06:57:31.468Z\",\"system_name\":\"Iro\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000192,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.3\",\"updated_at\":\"2020-08-14T01:51:38.839Z\",\"system_name\":\"Otanuomi\",\"system_security\":\"0.4\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30002772,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-13T11:24:31.714Z\",\"system_name\":\"Rairomon\",\"system_security\":\"0.6\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30005284,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-13T11:24:24.229Z\",\"system_name\":\"Promised Land\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30045354,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-13T07:37:02.262Z\",\"system_name\":\"Reitsato\",\"system_security\":\"0.2\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30005222,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-12T17:58:16.210Z\",\"system_name\":\"Serren\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003556,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-10T23:13:52.643Z\",\"system_name\":\"Arton\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005086,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-10T06:50:08.222Z\",\"system_name\":\"Arza\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000157,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.3\",\"updated_at\":\"2020-08-10T06:49:46.743Z\",\"system_name\":\"Otela\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003918,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-09T15:49:15.024Z\",\"system_name\":\"Hakana\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002385,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-09T00:34:34.831Z\",\"system_name\":\"Teonusude\",\"system_security\":\"0.6\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30002704,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-07T22:29:26.455Z\",\"system_name\":\"Adrallezoen\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30001372,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.9\",\"updated_at\":\"2020-08-07T19:29:54.183Z\",\"system_name\":\"Kino\",\"system_security\":\"0.7\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003908,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-07T07:00:48.775Z\",\"system_name\":\"Bashyam\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000012,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-06T09:30:28.248Z\",\"system_name\":\"Asabona\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005058,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-05T21:45:44.898Z\",\"system_name\":\"Neesher\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004305,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-05T21:24:35.293Z\",\"system_name\":\"Esaeel\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003883,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-05T20:44:57.150Z\",\"system_name\":\"Keberz\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003481,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-05T07:41:10.729Z\",\"system_name\":\"Unefsih\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003397,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-04T16:45:17.206Z\",\"system_name\":\"Bongveber\",\"system_security\":\"0.9\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30002702,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.4\",\"updated_at\":\"2020-08-04T11:15:48.842Z\",\"system_name\":\"Archee\",\"system_security\":\"0.4\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30003460,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-03T22:03:14.542Z\",\"system_name\":\"Offikatlin\",\"system_security\":\"0.4\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30004084,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-02T17:58:04.736Z\",\"system_name\":\"Ghesis\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003574,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-01T20:28:35.755Z\",\"system_name\":\"Boystin\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30005213,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-01T20:20:33.816Z\",\"system_name\":\"Hesarid\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005308,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-08-01T10:42:51.414Z\",\"system_name\":\"Jufvitte\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30002665,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-01T02:12:09.248Z\",\"system_name\":\"Misneden\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30000188,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-08-01T02:11:39.811Z\",\"system_name\":\"Hentogaira\",\"system_security\":\"0.6\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30002557,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-31T18:00:06.264Z\",\"system_name\":\"Atgur\",\"system_security\":\"0.5\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30003058,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-29T09:14:47.194Z\",\"system_name\":\"Olide\",\"system_security\":\"0.7\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30005334,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-28T23:28:39.525Z\",\"system_name\":\"Tierijev\",\"system_security\":\"0.8\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30003046,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.5\",\"updated_at\":\"2020-07-28T14:20:51.847Z\",\"system_name\":\"Angymonne\",\"system_security\":\"0.6\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30003514,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-07-27T18:47:08.094Z\",\"system_name\":\"Yeeramoun\",\"system_security\":\"0.8\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002760,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-26T11:44:38.056Z\",\"system_name\":\"Manjonakko\",\"system_security\":\"0.3\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30002506,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-23T18:07:27.688Z\",\"system_name\":\"Osoggur\",\"system_security\":\"0.5\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30005052,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-07-21T17:37:44.002Z\",\"system_name\":\"Soumi\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003931,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-20T16:54:45.398Z\",\"system_name\":\"Sassecho\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005255,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-20T09:34:48.342Z\",\"system_name\":\"Saphthar\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30020141,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.9\",\"updated_at\":\"2020-07-19T11:16:57.684Z\",\"system_name\":\"Senda\",\"system_security\":\"0.9\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30002795,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-18T01:59:01.724Z\",\"system_name\":\"Oshaima\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30000004,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-07-17T22:26:00.294Z\",\"system_name\":\"Jark\",\"system_security\":\"0.8\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004263,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-15T21:20:01.593Z\",\"system_name\":\"Feshur\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000062,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-15T15:49:03.146Z\",\"system_name\":\"Iosantin\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002241,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-13T01:22:41.989Z\",\"system_name\":\"Rimbah\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004981,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-12T11:24:07.265Z\",\"system_name\":\"Actee\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30002242,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-07-10T19:06:05.853Z\",\"system_name\":\"Mamenkhanar\",\"system_security\":\"0.7\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003558,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-10T13:51:31.889Z\",\"system_name\":\"Madimal\",\"system_security\":\"0.7\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30001376,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-09T16:04:24.621Z\",\"system_name\":\"Nourvukaiken\",\"system_security\":\"0.8\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30045329,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.4\",\"updated_at\":\"2020-07-08T10:41:47.622Z\",\"system_name\":\"Ichoriya\",\"system_security\":\"0.6\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30005252,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-07-07T23:49:41.522Z\",\"system_name\":\"Anzalaisio\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004257,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-07T17:15:51.416Z\",\"system_name\":\"Hakatiz\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004108,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-05T01:56:57.535Z\",\"system_name\":\"Chaneya\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000048,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-03T15:11:36.506Z\",\"system_name\":\"Ihal\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003482,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-02T20:56:41.226Z\",\"system_name\":\"Mista\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002225,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.8\",\"updated_at\":\"2020-07-01T14:11:27.451Z\",\"system_name\":\"Harva\",\"system_security\":\"0.8\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005263,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-01T13:43:12.530Z\",\"system_name\":\"Mozzidit\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005066,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-07-01T06:43:25.457Z\",\"system_name\":\"Kerying\",\"system_security\":\"0.2\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002986,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-28T17:43:41.096Z\",\"system_name\":\"Mendori\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30001381,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.1\",\"updated_at\":\"2020-06-27T00:02:01.315Z\",\"system_name\":\"Arvasaras\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30001447,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-25T02:19:25.407Z\",\"system_name\":\"Taisy\",\"system_security\":\"0.3\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30002700,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-24T13:40:05.882Z\",\"system_name\":\"Bawilan\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30001390,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-24T09:42:32.895Z\",\"system_name\":\"Pakkonen\",\"system_security\":\"0.4\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003076,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-23T09:02:12.462Z\",\"system_name\":\"Gammel\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003050,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-23T06:32:08.087Z\",\"system_name\":\"Odixie\",\"system_security\":\"0.6\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30000163,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-22T19:28:52.910Z\",\"system_name\":\"Akora\",\"system_security\":\"0.3\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003073,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-21T07:12:31.404Z\",\"system_name\":\"Netsalakka\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30001391,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-20T21:12:20.299Z\",\"system_name\":\"Piekura\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30002771,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-20T00:41:47.611Z\",\"system_name\":\"Kulelen\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30000005,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-19T14:36:55.956Z\",\"system_name\":\"Sasta\",\"system_security\":\"0.8\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005330,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-19T13:21:23.145Z\",\"system_name\":\"Arraron\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30000205,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-18T22:06:13.302Z\",\"system_name\":\"Obe\",\"system_security\":\"0.3\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003856,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-18T12:10:11.496Z\",\"system_name\":\"Athounon\",\"system_security\":\"0.1\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30004250,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-17T11:42:53.830Z\",\"system_name\":\"Chibi\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004268,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-17T08:56:42.286Z\",\"system_name\":\"Shenda\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005236,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-17T07:25:26.811Z\",\"system_name\":\"Noranim\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003829,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-16T22:17:39.177Z\",\"system_name\":\"Renarelle\",\"system_security\":\"0.3\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30005034,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-16T21:32:34.651Z\",\"system_name\":\"Bridi\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003074,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-16T21:31:28.344Z\",\"system_name\":\"Sasiekko\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003392,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-15T19:26:39.709Z\",\"system_name\":\"Eygfe\",\"system_security\":\"0.7\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30001445,\"status\":\"final_liminality\",\"derived_security_status\":\"0.0\",\"updated_at\":\"2020-06-15T03:38:02.163Z\",\"system_name\":\"Nalvula\",\"system_security\":\"0.4\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30010141,\"status\":\"final_liminality\",\"derived_security_status\":\"-0.2\",\"updated_at\":\"2020-06-14T01:12:53.428Z\",\"system_name\":\"Sakenta\",\"system_security\":\"1.0\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003809,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-13T20:25:21.879Z\",\"system_name\":\"Brellystier\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30001718,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-13T05:28:45.485Z\",\"system_name\":\"Paye\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004256,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-11T13:37:54.195Z\",\"system_name\":\"Edilkam\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002645,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-11T00:28:57.560Z\",\"system_name\":\"Carrou\",\"system_security\":\"0.4\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30045338,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-10T22:28:25.084Z\",\"system_name\":\"Hikkoken\",\"system_security\":\"0.3\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30004301,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-10T16:44:37.396Z\",\"system_name\":\"Anath\",\"system_security\":\"0.1\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002575,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-10T05:41:23.824Z\",\"system_name\":\"Sotrenzur\",\"system_security\":\"0.3\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30003515,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-08T06:49:36.637Z\",\"system_name\":\"Anila\",\"system_security\":\"0.7\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004100,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-08T03:04:19.196Z\",\"system_name\":\"Halibai\",\"system_security\":\"0.7\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002397,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-08T01:10:38.296Z\",\"system_name\":\"Horaka\",\"system_security\":\"0.6\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30002662,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-07T11:22:11.884Z\",\"system_name\":\"Pulin\",\"system_security\":\"0.5\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30001383,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-07T06:16:44.145Z\",\"system_name\":\"Vaajaita\",\"system_security\":\"0.5\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003854,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-06T19:17:57.398Z\",\"system_name\":\"Alamel\",\"system_security\":\"0.2\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30003464,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-06T19:16:59.888Z\",\"system_name\":\"Aldik\",\"system_security\":\"0.7\",\"system_sovereignty\":\"minmatar\"},{\"system_id\":30000182,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-06T19:04:22.126Z\",\"system_name\":\"Inaya\",\"system_security\":\"0.6\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30001660,\"status\":\"edencom_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-06T17:38:27.602Z\",\"system_name\":\"Dabrid\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30001685,\"status\":\"triglavian_minor_victory\",\"derived_security_status\":null,\"updated_at\":\"2020-06-06T17:34:50.620Z\",\"system_name\":\"Ordat\",\"system_security\":\"0.3\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005029,\"status\":\"final_liminality\",\"derived_security_status\":\"-1.0\",\"updated_at\":\"2020-06-06T15:44:51.914Z\",\"system_name\":\"Vale\",\"system_security\":\"0.7\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30045322,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-06T01:44:55.204Z\",\"system_name\":\"Samanuni\",\"system_security\":\"0.7\",\"system_sovereignty\":\"caldari\"},{\"system_id\":30003885,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-05T17:09:39.066Z\",\"system_name\":\"Arzanni\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004248,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-05T00:49:40.255Z\",\"system_name\":\"Haimeh\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003495,\"status\":\"final_liminality\",\"derived_security_status\":\"-1.0\",\"updated_at\":\"2020-06-04T23:08:13.644Z\",\"system_name\":\"Raravoss\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003541,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T16:55:17.838Z\",\"system_name\":\"Faswiba\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002651,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T15:38:07.592Z\",\"system_name\":\"Fasse\",\"system_security\":\"0.4\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30004150,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T04:02:40.650Z\",\"system_name\":\"Shaggoth\",\"system_security\":\"0.7\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30002251,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T04:02:40.650Z\",\"system_name\":\"Sadye\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30005260,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T04:02:40.650Z\",\"system_name\":\"Keri\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30000105,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T04:02:40.650Z\",\"system_name\":\"Abha\",\"system_security\":\"0.4\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30004992,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T04:02:40.650Z\",\"system_name\":\"Palmon\",\"system_security\":\"0.4\",\"system_sovereignty\":\"gallente\"},{\"system_id\":30002243,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T04:02:40.650Z\",\"system_name\":\"Seiradih\",\"system_security\":\"0.6\",\"system_sovereignty\":\"amarr\"},{\"system_id\":30003553,\"status\":\"fortress\",\"derived_security_status\":null,\"updated_at\":\"2020-06-03T04:02:40.650Z\",\"system_name\":\"Warouh\",\"system_security\":\"0.5\",\"system_sovereignty\":\"amarr\"}];\r\n\t\r\n\tthis.invasions = _.keyBy(data, function(x) { return x.system_id; });\r\n\t\r\n\t/** Update the system */\r\n\tthis.mutate = function(system, systemID) {\r\n\t\tconst systemInvasion = this.invasions[systemID];\r\n\t\tif(systemInvasion) {\r\n\t\t\tif(systemInvasion.derived_security_status) { system.security = 1 * systemInvasion.derived_security_status; }\r\n\t\t\tsystem.pathSymbol = pathSymbolMap[systemInvasion.status];\r\n\t\t\tconst tip = textMap[systemInvasion.status] +\r\n\t\t\t\t(systemInvasion.derived_security_status ? '<br>Effective security lowered to ' + systemInvasion.derived_security_status : '');\r\n\t\t\tsystem.systemTypeModifiers.push('<span class=\"invasion ' + systemInvasion.status + '\" data-tooltip=\"' + tip + '\">' + system.pathSymbol + '</span>');\r\n\t\t}\r\n\t}\r\n}","var guidance = (function (undefined) {\r\n\t\r\n\r\n\tvar sorter = function (a, b) {\r\n\t\treturn parseFloat (a) - parseFloat (b);\r\n\t}\r\n\r\n\tfunction adjustCostForOptions(mapCost, toSystem) {\t\t\r\n\t\tvar system = systemAnalysis.analyse(30000000 + 1 * toSystem);\r\n\t\tif(!system) { return mapCost; }\r\n\t\tif(options.chain.routeIgnore.enabled && options.chain.routeIgnore.systems.indexOf(system.name) >= 0) {\r\n\t\t\tmapCost += 100;\t// Penalty for an avoided system\r\n\t\t}\r\n\t\tswitch(options.chain.routeSecurity) {\r\n\t\t\tcase 'highsec': return mapCost + (system.security < 0.45 ? 100 : 0);\r\n\t\t\tcase 'avoid-high': return mapCost + (system.security >= 0.45 ? 100 : 0);\r\n\t\t\tcase 'avoid-null': return mapCost + (system.security <= 0.0 ? 100 : 0);\r\n\t\t\tdefault: return mapCost;\t// in case of some invalid option, default to shortest\r\n\t\t}\t\r\n\t}\r\n\t\r\n\tfunction adjustJumpCost(from, to, cost) {\r\n\t\treturn Guidance.jumpCostModifiers.reduce((cost, modifier) => modifier(from, to, cost), cost);\r\n\t}\r\n\r\n\t/** Find a path between the start and end nodes (which may be arrays), up to the path length limit */\r\n\tvar findPaths = function (map, start, end, limit) {\r\n\t\tif(!Array.isArray(start)) { start = [start]; } \r\n\t\tif(!Array.isArray(end)) { end = [end]; } \r\n\t\t\r\n\t\tstart = start.filter(function(x) { return map[x]; });\r\n\t\tend = end.filter(function(x) { return map[x]; });\r\n\t\t\r\n\t\tconst endsInStart = end.filter(function(x) { return start.indexOf(x) >= 0; });\r\n\t\tif(endsInStart.length) { return [endsInStart[0]]; }\r\n\t\t\r\n\t\tif(!(start.length && end.length)) { return null; }\t// both ends of path must be in network somewhere\r\n\r\n\t\tvar costs = {},\r\n\t\t    open = {'0': []},\r\n\t\t    predecessors = {},\r\n\t\t    keys;\r\n\t\t\r\n\t\tstart.forEach(function(x) { costs[x] = 0; open[0].push(x); });\r\n\r\n\t\tvar addToOpen = function (cost, vertex) {\r\n\t\t\tvar key = \"\" + cost;\r\n\t\t\tif (!open[key]) open[key] = [];\r\n\t\t\topen[key].push(vertex);\r\n\t\t}\r\n\r\n\t\twhile ((keys = Object.keys(open)).length) {\r\n\t\t\tkeys.sort(sorter);\r\n\r\n\t\t\tvar key = keys[0],\r\n\t\t\t    bucket = open[key],\r\n\t\t\t    node = bucket.shift(),\r\n\t\t\t    currentCost = parseFloat(key),\r\n\t\t\t    adjacentNodes = map[node] || {};\r\n\r\n\t\t\tif (!bucket.length) delete open[key];\r\n\t\t\tif(currentCost >= limit) { break; }\r\n\r\n\t\t\tfor (var vertexText in adjacentNodes) {\r\n\t\t\t\tconst vertex = 1 * vertexText;\r\n\t\t\t    if (adjacentNodes[vertex] !== undefined) {\r\n\t\t\t\t\tvar cost = 1 + adjustCostForOptions(adjacentNodes[vertex], vertex),\r\n\t\t\t\t\t    totalCost = cost + currentCost,\r\n\t\t\t\t\t    vertexCost = costs[vertex];\r\n\t\t\t\t\t\r\n\t\t\t\t\tcost = adjustJumpCost(node, vertex, cost);\r\n\r\n\t\t\t\t\tif ((cost > 0) && (vertexCost === undefined) || (vertexCost > totalCost)) {\r\n\t\t\t\t\t\tcosts[vertex] = totalCost;\r\n\t\t\t\t\t\taddToOpen(totalCost, vertex);\r\n\t\t\t\t\t\tpredecessors[vertex] = node;\r\n\t\t\t\t\t\tif(end.indexOf(vertex) >= 0) {\r\n\t\t\t\t\t\t\treturn extractShortest(predecessors, vertex);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\treturn null;\t// never hit any end node\r\n\t}\r\n\r\n\tvar extractShortest = function (predecessors, end) {\r\n\t\tvar nodes = [],\r\n\t\t    u = end;\r\n\r\n\t\twhile (u) {\r\n\t\t\tnodes.push(u);\r\n\t\t\tpredecessor = predecessors[u];\r\n\t\t\tu = predecessors[u];\r\n\t\t}\r\n\r\n\t\tnodes.reverse();\r\n\t\treturn nodes;\r\n\t}\r\n\r\n\t/** Find the best path that connects the given nodes, in that order. The limit will be applied to each path segment, not the path as a whole. */\r\n\tvar findMultiNodePath = function (map, nodes, limit) {\r\n\t\tvar start = nodes.shift(),\r\n\t\t    end,\r\n\t\t    predecessors,\r\n\t\t    path = [],\r\n\t\t    shortest;\r\n\r\n\t\twhile (nodes.length) {\r\n\t\t\tend = nodes.shift();\r\n\t\t\tshortest = findPaths(map, start, end, limit);\r\n\r\n\t\t\tif (shortest) {\r\n\t\t\t\tif (nodes.length) {\r\n\t\t\t\t\tpath.push.apply(path, shortest.slice(0, -1));\r\n\t\t\t\t} else {\r\n\t\t\t\t\treturn path.concat(shortest);\r\n\t\t\t\t}\r\n\t\t\t} else {\r\n\t\t\t\treturn null;\r\n\t\t\t}\r\n\r\n\t\t\tstart = end;\r\n\t\t}\r\n\t}\r\n\t\r\n\tvar Guidance = { kSpaceCache: {}, jumpCostModifiers: [] };\r\n\tGuidance.clearCache = function() { Guidance.kSpaceCache = {}; }\r\n\t\r\n\t/** Find the shortest path between start and end nodes on the given map.\r\n\tThe map should be a dictionary of node IDs where each entry is a dictionary of connected nodes and costs (see appData.map.shortest). An additional cost of 1 per jump will be added.\r\n\tYou may also specify a maximum path length limit, if no path under this length is found then no path will be returned, even if a longer one is available.\r\n\tStart and end nodes may be a single ID or an array of IDs. If arrays are used then a single shortest path between any combination of nodes will be returned */\r\n\tGuidance.findShortestPath = function (map, start, end, limit) {\r\n\t\tif(start > 30000000) { start -= 30000000; }\r\n\t\tif(end > 30000000) { end -= 30000000; }\r\n\t\t\r\n\t\tconst nodes = [start, end];\r\n\r\n\t\tconst cacheKey = nodes.join(',') + (limit ? '-' + limit : '');\r\n\t\tconst cachedPath = Guidance.kSpaceCache[cacheKey];\r\n\t\tif(cachedPath === undefined) {\r\n\t\t\treturn Guidance.kSpaceCache[cacheKey] = findPaths(map, start, end, limit);\r\n\t\t} else {\r\n\t\t\treturn cachedPath;\r\n\t\t}\r\n\t}\r\n\t\r\n\t/** Find the systems directly connected to this one. System IDs are in normal (+ 30000000) domain. */\r\n\tGuidance.connections = function(map, start) {\r\n\t\tif(start > 30000000) { start -= 30000000; }\r\n\t\treturn Object.keys(map[start] || {})\r\n\t\t\t.map(k => (k * 1))\r\n\t\t\t.map(k => {\r\n\t\t\t\tconst r = { systemID: k + 30000000 };\r\n\t\t\t\tif(0 > adjustJumpCost(start, k, 1)) { r.closed = true; }\r\n\t\t\t\treturn r;\r\n\t\t\t});\r\n\t}\r\n\r\n\treturn Guidance;\r\n})();\r\n","/** Functions for rendering things relating to systems or parts of the chain */\r\nconst systemRendering = new function() { \r\n\t/** Render a path, as returned from guidance.findShortestPath */\r\n\tthis.renderPath = function(path) {\r\n\t\tif(path.length <= 1 || path.length > options.chain.routingLimit) { return '' + path.length - 1; }\r\n\t\telse {\r\n\t\t\tvar systemMarkup = path\r\n\t\t\t.slice(0, path.length - 1).reverse()\r\n\t\t\t.map(function(s) {\r\n\t\t\t\tconst systemID = 30000000 + 1 * s;\r\n\t\t\t\tconst system = systemAnalysis.analyse(systemID);\r\n\t\t\t\tconst securityClass = system.systemTypeClass;\r\n\t\t\t\treturn '<span class=\"' + securityClass + '\" data-tooltip=\"' + system.name + ' (' + system.security + ')\" onclick=\"tripwire.systemChange(' + systemID + ')\">' + system.pathSymbol + '</span>';\r\n\t\t\t});\r\n\t\t\tvar r = '<span class=\"path\">';\r\n\t\t\tfor(var i = 0; i < systemMarkup.length; i++) {\r\n\t\t\t\tif(i > 0 && 0 == i % 5) { r += '|'; }\r\n\t\t\t\t\r\n\t\t\t\tr += systemMarkup[i];\t\t\t\t \r\n\t\t\t}\r\n\t\t\treturn r + '</span>';\r\n\t\t}\r\n\t}\r\n\t\r\n\tthis.renderEffect = function(system, tag) {\r\n\t\treturn system.effectClass ? \"<\" + tag + \" class='whEffect' data-icon='\"+system.effectClass+\"' data-tooltip='\"+system.effect+\"'></\" + tag + \">\" : '';\r\n\t}\r\n\t\r\n\tthis.renderSystem = function(systemInfo, tag) {\r\n\t\ttag = tag || 'a';\r\n\t\tconst text = systemInfo.name || systemInfo.genericSystemType;\r\n\t\treturn '<' + tag + (tag === 'a' ? ' href=\".?system=' + systemInfo.name + '\"' : '') + '>' + text + '</' + tag + '> (' + this.renderEffect(systemInfo, 'span') + '<span class=\"' + systemInfo.systemTypeClass + '\">' + systemInfo.systemTypeName + '</span>)';\r\n\t}\r\n};","const ChainMapRendererOrgchart = function(owner) {\r\n\tconst _this = this;\r\n\t\r\n\t/** Initialiser - callback from chart onload */\r\n\tthis.init = function() {\r\n\t\t_this.map = new google.visualization.OrgChart(document.getElementById(\"chainMap\"));\r\n\t\t_this.options = {allowHtml: true, allowCollapse: true, size: \"medium\", nodeClass: \"node\"};\r\n\r\n\t\tgoogle.visualization.events.addListener(_this.map, \"collapse\", _this.collapseHandler);\r\n\r\n\t\t_this.map.draw(new google.visualization.DataView(new google.visualization.DataTable({cols:[{label: \"System\", type: \"string\"}, {label: \"Parent\", type: \"string\"}]})), _this.options);\r\n\t}\r\n\t\r\n\t/** Is this renderer ready to accept draw calls? */\r\n\tthis.ready = function() { return !this.drawing && !!this.map; }\r\n\t\r\n\t/** Switch to this renderer. The renderer can be in a blank state; draw() will be called after */\r\n\tthis.switchTo = function() {\r\n\t\tdocument.getElementById('chainGrid').style.display = '';\r\n\t\tif(!_this.map) { google.charts.setOnLoadCallback(this.init); }\r\n\t}\r\n\t\r\n\t/** Switch away from this renderer. All node divs should be removed from the DOM */\r\n\tthis.switchFrom = function() {\r\n\t\tdocument.getElementById('chainGrid').style.display = 'none';\r\n\t\t_this.map.draw(new google.visualization.DataView(new google.visualization.DataTable({cols:[{label: \"System\", type: \"string\"}, {label: \"Parent\", type: \"string\"}]})), _this.options);\t\t\r\n\t}\r\n\t\r\n\t/** Redraw the map, based on the given node set, line overrides and list of collapsed systems */\r\n\tthis.draw = function(map, lines, collapsed) {\r\n\t\tthis.drawing = true;\r\n\t\tthis.map.draw(newView(map), this.options); \r\n\t\t\r\n\t\tfor (var x in collapsed) {\r\n\t\t\tconst s = collapsed[x];\r\n\t\t\tconst nodeId = $(\"#chainMap [data-nodeid='\"+s+\"']\").attr(\"id\");\r\n\t\t\tif (nodeId) {\r\n\t\t\t\tconst nodeVal = nodeId.split(\"node\")[1];\r\n\t\t\t\tthis.map.collapse(nodeVal - 1, true);\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tupdateLines(map, lines);\r\n\t\tthis.drawing = false;\r\n\t};\r\n\t\r\n\tconst newView = function(json) {\r\n\t\tconst view = new google.visualization.DataView(new google.visualization.DataTable(json));\r\n\t\treturn view;\r\n\t};\r\n\t\r\n\tconst updateLines = function(map, lines) {\r\n\t\t_this.lastLineData = { map: map, lines: lines };\r\n\t\tfunction drawNodeLine(system, parent, mode, signatureID) {\r\n\t\t\t/*\tfunction for drawing colored lines  */\r\n\t\t\tif(typeof mode == 'string') { mode = [mode]; }\r\n\r\n\t\t\tfunction addModes(jquerySelector, prefixes) { return doModeClasses(jquerySelector, prefixes, function(s, c) { s.addClass(c); }); }\r\n\t\t\tfunction removeModes(jquerySelector, prefixes) { return doModeClasses(jquerySelector, prefixes, function(s, c) { s.removeClass(c); }); }\r\n\t\t\tfunction doModeClasses(jquerySelector, prefixes, classFunc) {\r\n\t\t\t\tprefixes = prefixes || [];\r\n\t\t\t\tprefixes.push('');\r\n\t\t\t\tprefixes.forEach(function(prefix) { \r\n\t\t\t\t\tmode.forEach( function(mode) { classFunc(jquerySelector, (prefix.length ? prefix + '-' : '') + mode); });\r\n\t\t\t\t});\r\n\t\t\t\treturn jquerySelector;\r\n\t\t\t}\r\n\r\n\t\t\t// Find node in chainmap\r\n\t\t\t//var $node = $(\"#chainMap [data-nodeid='\"+system+\"']\").parent();\r\n\t\t\tvar $node = $(\"#chainMap #node\"+system).parent();\r\n\r\n\t\t\tif ($node.length == 0) {\r\n\t\t\t\treturn false;\r\n\t\t\t}\r\n\r\n\t\t\t// Get node # in this line\r\n\t\t\tvar nodeIndex = Math.ceil(($node[0].cellIndex + 1) / 2 - 1);\r\n\r\n\t\t\t// applly to my top line\r\n\t\t\tvar $connector = addModes($($node.parent().prev().children(\"td.google-visualization-orgchart-lineleft, td.google-visualization-orgchart-lineright\")[nodeIndex]), [ 'left', 'right' ]);\r\n\r\n\t\t\t// Find parent node\r\n\t\t\t//var $parent = $(\"#chainMap [data-nodeid='\"+parent+\"']\").parent();\r\n\t\t\tvar $parent = $(\"#chainMap #node\"+parent).parent();\r\n\r\n\t\t\tif ($parent.length == 0 || $connector.length == 0)\r\n\t\t\t\treturn false;\r\n\r\n\t\t\t// Find the col of my top line\r\n\t\t\tvar nodeCol = 0, connectorCell = $connector[0].cellIndex;\r\n\t\t\t$node.parent().prev().find(\"td\").each(function(index) {\r\n\t\t\t\tnodeCol += this.colSpan;\r\n\r\n\t\t\t\tif (index == connectorCell) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Get node # in this line\r\n\t\t\tvar parentIndex = Math.ceil(($parent[0].cellIndex + 1) / 2 - 1);\r\n\r\n\t\t\t// Compensate for non-parent nodes (slight performance hit ~10ms)\r\n\t\t\tvar newparentIndex = parentIndex;\r\n\t\t\tfor (var i = 0; i <= parentIndex; i++) {\r\n\t\t\t\tvar checkSystem = 0;//$node.parent().prev().prev().prev().find(\"td:has([data-nodeid]):eq(\"+i+\")\").find(\"[data-nodeid]\").data(\"nodeid\");\r\n\t\t\t\t$node.parent().prev().prev().prev().find(\"td > [data-nodeid]\").each(function(index) {\r\n\t\t\t\t\tif (index == i) {\r\n\t\t\t\t\t\tcheckSystem = $(this).attr(\"id\").replace(\"node\", \"\");//$(this).data(\"nodeid\");\r\n\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\tif ($.map(map.rows, function(node) { return node.c[1].v == checkSystem ? node : null; }).length <= 0) {\r\n\t\t\t\t\tnewparentIndex--;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tparentIndex = newparentIndex;\r\n\r\n\t\t\t// Apply to parent bottom line\r\n\t\t\tvar $connecte = addModes($($node.parent().prev().prev().children(\"td.google-visualization-orgchart-lineleft, td.google-visualization-orgchart-lineright\")[parentIndex]), [ 'left', 'right'] );\r\n\r\n\t\t\t// the beans\r\n\t\t\tvar col = 0, parent = false, me = false;\r\n\t\t\t$node.parent().prev().prev().find(\"td\").each(function(index, value) {\r\n\t\t\t\tcol += this.colSpan;\r\n\r\n\t\t\t\tif (me && parent) {\r\n\t\t\t\t\t// All done - get outta here\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} else if (typeof($connecte[0]) != \"undefined\" && $connecte[0].cellIndex == index) {\r\n\t\t\t\t\tparent = true;\r\n\r\n\t\t\t\t\taddModes($(this), ['left']);\r\n\r\n\t\t\t\t\t// remove bottom border that points to the right\r\n\t\t\t\t\tif (!me && col != nodeCol) {\r\n\t\t\t\t\t\taddModes($(this), ['bottom']);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// parent and node are same - we are done\r\n\t\t\t\t\tif (nodeCol == col) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\t\t\t\t} else if (col == nodeCol) {\r\n\t\t\t\t\tme = true;\r\n\r\n\t\t\t\t\taddModes($(this), [ 'bottom' ]);\r\n\t\t\t\t} else if (me || parent) {\r\n\t\t\t\t\tvar tempCol = 0, breaker = false, skip = false;\r\n\r\n\t\t\t\t\t$node.parent().prev().find(\"td\").each(function(index) {\r\n\t\t\t\t\t\ttempCol += this.colSpan;\r\n\r\n\t\t\t\t\t\tif (tempCol == col && ($(this).hasClass(\"google-visualization-orgchart-lineleft\") || $(this).hasClass(\"google-visualization-orgchart-lineright\"))) {\r\n\t\t\t\t\t\t\tif (parent == false) {\r\n\t\t\t\t\t\t\t\t// Stop looking cuz there is another node between us and parent\r\n\t\t\t\t\t\t\t\tbreaker = true;\r\n\t\t\t\t\t\t\t\tremoveModes($connecte, [ 'left', 'right' ]);\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t} else if (parent == true) {\r\n\t\t\t\t\t\t\t\t// Lets make sure there isnt a node between the parent and me\r\n\t\t\t\t\t\t\t\tremoveModes($connecte, [ 'left', 'right' ]);\r\n\r\n\t\t\t\t\t\t\t\t$node.parent().prev().prev().find(\"td\").each(function(index) {\r\n\t\t\t\t\t\t\t\t\tif (index >= $connecte[0].cellIndex) {\r\n\t\t\t\t\t\t\t\t\t\t// there is a node after parent but before me\r\n\t\t\t\t\t\t\t\t\t\tremoveModes($(this), [ 'bottom' ]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\tskip = true;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\tif (breaker) {\r\n\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tif (!skip) {\r\n\t\t\t\t\t\taddModes($(this), ['bottom'] );\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tfor (var x in lines) {\r\n\t\t\tdrawNodeLine(lines[x][0], lines[x][1], lines[x][2].concat(['connection']), lines[x][3]);\r\n\t\t}\r\n\t};\r\n\r\n\tthis.collapseHandler = function() {\t\t\r\n\t\tif(_this.drawing) { return; }\r\n\t\t\r\n\t\tconst collapsed = _this.map.getCollapsedNodes();\r\n\t\tconst collapsedSystems = [];\r\n\t\tfor (x in collapsed) {\r\n\t\t\tvar systemID = $(\"#chainMap #node\"+(collapsed[x] +1)).data(\"nodeid\");\r\n\t\t\tcollapsedSystems.push(systemID);\r\n\t\t}\r\n\t\towner.updateCollapsed(collapsedSystems);\r\n\t\t\r\n\t\tif(_this.lastLineData) { updateLines(_this.lastLineData.map, _this.lastLineData.lines); }\r\n\t}\r\n\r\n\r\n};","const ChainMapRendererRadial = function(owner) {\r\n\t/** Is this renderer ready to accept draw calls? */\r\n\tthis.ready = function() { return !this.drawing; }\r\n\t\r\n\t/** Switch to this renderer. The renderer can be in a blank state; draw() will be called after */\r\n\tthis.switchTo = function() {\r\n\t\tif(!document.getElementById('map-container')) {\r\n\t\t\tconst newDiv = document.createElement('div');\r\n\t\t\tnewDiv.id = 'map-container';\r\n\t\t\tnewDiv.className = 'radial-map';\r\n\t\t\tdocument.getElementById('chainMap').appendChild(newDiv);\r\n\t\t}\r\n\t\tthis.container = document.getElementById('map-container');\r\n\t\tthis.container.style.display = '';\r\n\t}\r\n\t\r\n\t/** Switch away from this renderer. All node divs should be removed from the DOM */\r\n\tthis.switchFrom = function() {\r\n\t\tconst div = document.getElementById('map-container');\r\n\t\tif(div) { div.parentNode.removeChild(div); }\r\n\t\tthis.container = null;\r\n\t}\r\n\t\r\n\tthis.collapse = function(systemID, collapse) {\r\n\t\tif(collapse) { this.mapData.collapsed.push(systemID); }\r\n\t\telse {  this.mapData.collapsed = this.mapData.collapsed.filter(x => x != systemID); }\r\n\t\towner.updateCollapsed(this.mapData.collapsed);\r\n\t\tdrawInner(this.mapData.map, this.mapData.lines, this.mapData.collapsed);\r\n\t}\r\n\t\r\n\t/** Redraw the map, based on the given node set, line overrides and list of collapsed systems */\r\n\tthis.draw = function(map, lines, collapsed) {\r\n\t\tthis.drawing = true;\r\n\t\tthis.mapData = {map: map, lines: lines, collapsed: collapsed};\r\n\t\t\r\n\t\t// Clear the map for a new one\r\n\t\t//this.switchFrom(); this.switchTo();\r\n\r\n\t\ttry { drawInner(map, lines, collapsed); }\r\n\t\tfinally { this.drawing = false; }\r\n\t}\r\n\t\r\n\tconst CIRCLE_SIZE = { x: 70, y: 60, first_ring_delta: 0.3,\r\n\t\tringX: function(ci) { return ci == 0 ? 0 : (ci + this.first_ring_delta) * this.x * options.chain.nodeSpacing.x},\r\n\t\tringY: function(ci) { return ci == 0 ? 0 : (ci + this.first_ring_delta) * this.y * options.chain.nodeSpacing.y},\r\n\t };\r\n\r\n\tconst _this = this;\r\n\tconst drawInner = function(map, lines, collapsed) {\r\n\t\tconst maps = [];\r\n\t\tconst nodesById = {};\r\n\t\t\r\n\t\t// First pass: arrange nodes into rings\r\n\t\tfor(var ri = 0; ri < map.rows.length; ri++) {\r\n\t\t\tconst item = map.rows[ri];\r\n\t\t\tconst inNode = item.c[0], id = inNode.v, parent = item.c[1].v;\r\n\t\t\t\r\n\t\t\tconst mapNode = { id: id, children: [], systemID: inNode.systemID, minArc: 0 };\r\n\t\t\t\r\n\t\t\tif(parent == null) {\r\n\t\t\t\tconst newMap =  { circles: [ { arc: 0, nodes: [ mapNode ] } ] };\r\n\t\t\t\tmapNode.map = newMap;\r\n\t\t\t\tmapNode.circle = 0;\r\n\t\t\t\tmaps.push(newMap);\r\n\t\t\t} else {\r\n\t\t\t\tconst parentNode = nodesById[parent];\r\n\t\t\t\tif(!parentNode) { throw 'Parent id ' + parent + ' not on map yet'; }\r\n\t\t\t\tparentNode.children.push(mapNode);\r\n\t\t\t\tmapNode.parent = parentNode;\r\n\t\t\t\tmapNode.connection = lines.filter(function(l) { return l[0] == id; })[0] || [id, parent, [], '?'];\r\n\t\t\t\tmapNode.styles = ['connection'].concat(mapNode.connection[2]);\r\n\t\t\t\tmapNode.map = parentNode.map;\r\n\t\t\t\tmapNode.circle = parentNode.circle + 1;\r\n\t\t\t\tif(mapNode.map.circles.length <= mapNode.circle) {\r\n\t\t\t\t\tmapNode.map.circles.push({ arc: 0, nodes:[mapNode] });\r\n\t\t\t\t} else { mapNode.map.circles[mapNode.circle].nodes.push(mapNode); }\r\n\t\t\t}\r\n\t\t\tnodesById[id] = mapNode;\r\n\t\t\tmapNode.markup = inNode.f;\r\n\t\t}\r\n\r\n\t\t// Second pass - for each map, find the allocation of arc needed for each node\r\n\t\tfor(var mi = 0; mi < maps.length; mi++) {\r\n\t\t\tconst map = maps[mi];\r\n\t\t\tfor(var ci = map.circles.length - 1; ci >= 1; ci--) {\t// don't need to calculate ring 0\r\n\t\t\t\tfor(var ni = 0; ni < map.circles[ci].nodes.length; ni++) {\r\n\t\t\t\t\tconst node = map.circles[ci].nodes[ni];\r\n\t\t\t\t\tnode.minArc *= ci / (ci + 1.0);\r\n\t\t\t\t\tif(node.minArc < 1 || collapsed.indexOf(node.systemID * 1) >= 0) { node.minArc = 1; }\r\n\t\t\t\t\tnode.parent.minArc += node.minArc;\r\n\t\t\t\t\tmap.circles[ci].arc += node.minArc;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t// Third pass - lay out each ring based on the arc values\r\n\t\tfor(var mi = 0; mi < maps.length; mi++) {\r\n\t\t\tconst map = maps[mi];\r\n\t\t\tvar mapDiv = document.getElementById(\"map\" + mi);\r\n\t\t\tif(!mapDiv) {\r\n\t\t\t\tmapDiv = document.createElement('div');\r\n\t\t\t\tmapDiv.id = \"map\" + mi;\r\n\t\t\t\tmapDiv.className = \"map-chain-wrapper\";\r\n\t\t\t}\r\n\t\t\tmapDiv.innerHTML = '<div class=\"map-outer-container\"><div class=\"map-inner-container\"><canvas class=\"map-drawing\" id=\"map-canvas-' + mi + '\"/></div></div>';\r\n\t\t\tconst innerContainer = mapDiv.firstChild.firstChild;\r\n\t\t\tdocument.getElementById('map-container').appendChild(mapDiv);\r\n\r\n\t\t\tmap.bounds = makeDivsForRing(innerContainer, 0, map.circles[0].nodes, 0, Math.PI * 2, collapsed);\r\n\t\t\tmap.domNode = mapDiv;\r\n\t\t\tmap.innerContainer = innerContainer;\r\n\t\t}\r\n\r\n\t\t// Fourth pass: update div and canvas bounds, and draw rings/links\r\n\t\tconst CANVAS_SCALE = 1;\r\n\t\tfor(var mi = 0; mi < maps.length; mi++) {\r\n\t\t\tconst map = maps[mi];\r\n\t\t\tconst finalPositions = {\r\n\t\t\t\tw: 200 + map.bounds.x[1] - map.bounds.x[0],\r\n\t\t\t\th: 100 + map.bounds.y[1] - map.bounds.y[0],\r\n\t\t\t\tcx: 100 - map.bounds.x[0],\r\n\t\t\t\tcy: 50 - map.bounds.y[0]\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// Fill the space available, if we didn't already\r\n\t\t\tif(maps.length == 1) {\r\n\t\t\t\tconst parentWidth = -38 + _this.container.offsetWidth;\t// 20px for map margins, 18 for scrollbar\r\n\t\t\t\tif(finalPositions.w < parentWidth) {\r\n\t\t\t\t\tfinalPositions.cx += 0.5 * (parentWidth - finalPositions.w);\r\n\t\t\t\t\tfinalPositions.w = parentWidth;\r\n\t\t\t\t}\r\n\t\t\t}\t\t\t\r\n\t\t\tconst parentHeight = document.getElementById('chainParent').offsetHeight;\r\n\t\t\tif(finalPositions.h < parentHeight) {\r\n\t\t\t\tfinalPositions.cy += 0.5 * (parentHeight - finalPositions.h);\r\n\t\t\t\tfinalPositions.h = parentHeight;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t// If there's enough space to centre the top level node now, do it\r\n\t\t\tif(finalPositions.h >= 2 * (map.bounds.y[1] > -map.bounds.y[0] ? map.bounds.y[1] : -map.bounds.y[0])) {\r\n\t\t\t\tfinalPositions.cy = finalPositions.h / 2;\r\n\t\t\t}\r\n\t\t\tif(finalPositions.w >= 2 * (map.bounds.x[1] > -map.bounds.x[0] ? map.bounds.x[1] : -map.bounds.x[0])) {\r\n\t\t\t\tfinalPositions.cx = finalPositions.w / 2;\r\n\t\t\t}\t\t\t\r\n\t\t\tmap.domNode.style.width = finalPositions.w + 'px';\r\n\t\t\tmap.domNode.style.height = finalPositions.h + 'px';\r\n\t\t\tconst outerContainer = map.domNode.firstChild;\r\n\t\t\touterContainer.style.left = finalPositions.cx + 'px';\r\n\t\t\touterContainer.style.top = finalPositions.cy + 'px';\r\n\t\t\tconst canvas = outerContainer.getElementsByTagName('canvas')[0];\r\n\t\t\tcanvas.width = CANVAS_SCALE * finalPositions.w;\r\n\t\t\tcanvas.style.width = finalPositions.w + 'px';\r\n\t\t\tcanvas.height = CANVAS_SCALE * finalPositions.h;\r\n\t\t\tcanvas.style.height = finalPositions.h + 'px';\r\n\t\t\tcanvas.style.left = -finalPositions.cx + 'px';\r\n\t\t\tcanvas.style.top = -finalPositions.cy + 'px';\r\n\t\t\tconst ctx = canvas.getContext('2d');\r\n\t\t\tctx.scale(CANVAS_SCALE, CANVAS_SCALE);\r\n\t\t\tctx.translate(finalPositions.cx, finalPositions.cy);\r\n\t\t\t\r\n\t\t\tfor(var ci = map.bounds.maxCi; ci >= 1; ci--) {\t// don't need to draw ring 0\r\n\t\t\t\tif(options.chain.gridlines) {\r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\tif(ctx.ellipse) {\r\n\t\t\t\t\t\tctx.lineWidth = 0.5;\r\n\t\t\t\t\t\tctx.setLineDash([]);\r\n\t\t\t\t\t\tctx.ellipse(0, 0, CIRCLE_SIZE.ringX(ci), CIRCLE_SIZE.ringY(ci), 0, 0, Math.PI * 2);\r\n\t\t\t\t\t}\r\n\t\t\t\t\tctx.strokeStyle = propertyFromCssClass('grid-default', 'color');\r\n\t\t\t\t\tctx.stroke();\t\t\r\n\t\t\t\t}\r\n\t\t\t\tif(ci >= map.circles.length) { continue; }\r\n\t\t\t\t\r\n\t\t\t\tctx.save();\r\n\t\t\t\tfor(var ni = 0; ni < map.circles[ci].nodes.length; ni++) {\r\n\t\t\t\t\tconst node = map.circles[ci].nodes[ni];\r\n\t\t\t\t\tif(!node.position) { continue; }\t// not drawn on map\r\n\t\t\t\t\tctx.beginPath();\r\n\t\t\t\t\tctx.moveTo(node.position.x, node.position.y);\r\n\t\t\t\t\tconst cp1 = radToCartesian({ r: node.radPosition.r - 0.5, theta: (node.radPosition.theta + 2 * node.parent.radPosition.theta) / 3.0 });\r\n\t\t\t\t\tconst cp2 = radToCartesian({ r: node.radPosition.r - 0.5, theta: (2 * node.radPosition.theta + node.parent.radPosition.theta) / 3.0 });\r\n\t\t\t\t\t\r\n\t\t\t\t\tif(ci > 1) {\t\t\t\t\r\n\t\t\t\t\t\tctx.bezierCurveTo(cp2.x, cp2.y, cp1.x, cp1.y, node.parent.position.x, node.parent.position.y);\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tctx.lineTo(node.parent.position.x, node.parent.position.y);\t\t\t\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst dist2 = (node.position.y - node.parent.position);\r\n\t\t\t\t\t\r\n\t\t\t\t\t// draw aura first\r\n\t\t\t\t\tif(options.chain.aura) {\r\n\t\t\t\t\t\tctx.save();\r\n\t\t\t\t\t\tctx.lineWidth = 1;\r\n\t\t\t\t\t\tconst auraColor = propertyFromCssClass(node.styles, 'color');\r\n\t\t\t\t\t\tctx.shadowBlur = 11;\r\n\t\t\t\t\t\tctx.shadowColor = auraColor;\r\n\t\t\t\t\t\tctx.strokeStyle = 'black';\r\n\t\t\t\t\t\tfor(let ai = 0; ai < 8; ai++)\r\n\t\t\t\t\t\t\tctx.stroke();\r\n\t\t\t\t\t\tctx.restore();\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tctx.lineWidth = parseInt(propertyFromCssClass(node.styles, 'border-width')) || 2;\r\n\t\t\t\t\tctx.strokeStyle = propertyFromCssClass(node.styles, 'border-top-color');\r\n\t\t\t\t\tctx.setLineDash ({ dashed: [5, 3] }[propertyFromCssClass(node.styles, 'border-top-style')] || []);\r\n\t\t\t\t\tctx.stroke();\r\n\t\t\t\t}\r\n\t\t\t\tctx.restore();\r\n\t\t\t}\t\r\n\t\t}\r\n\t\t\r\n\t\t// Remove any maps which aren't in use any more\r\n\t\tfor(var mi = maps.length; ; mi++) {\r\n\t\t\tconst div = document.getElementById('map' + mi);\r\n\t\t\tif(div) { div.parentNode.removeChild(div); }\r\n\t\t\telse { break; }\r\n\t\t}\r\n\t}\r\n\t\r\n\tfunction makeDivsForRing(innerContainer, ci, nodes, minRad, maxRad, collapsed) {\r\n\t\tconst bounds = { x: [0, 0], y: [0, 0], maxCi: ci };\r\n\t\tif(!nodes.length) { return bounds; }\r\n\t\tconst parentCollapsed = collapsed.indexOf(1 * (nodes[0].parent || {}).systemID) >= 0;\r\n\t\tconst max_nodes_per_rad = 1.4;\r\n\t\tif(ci > 0 && !parentCollapsed) {\r\n\t\t\tvar skipped = 0;\r\n\t\t\twhile(++skipped < 2 && nodes.length > max_nodes_per_rad * ci * (maxRad - minRad)) { ci++; }\r\n\t\t}\r\n\t\tconst totalArc = parentCollapsed ? nodes.length : nodes.reduce(function(acc, x) { return acc + x.minArc; }, 0);\r\n\t\tconst rads_per_arc = (maxRad - minRad) / totalArc;\r\n\t\tvar rad_offset = minRad;\r\n\t\tvar alignment_delta = 0;\r\n\t\t\r\n\t\tfor(var ni = 0; ni < nodes.length; ni++) {\r\n\t\t\tconst node = nodes[ni];\t\r\n\t\t\t\r\n\t\t\t// Make the node\r\n\t\t\tconst frag = document.createRange().createContextualFragment('<div class=\"node-wrapper\">' + node.markup + '</div>');\r\n\t\t\tnode.domNode = frag.firstChild;\r\n\t\t\tinnerContainer.appendChild(node.domNode);\r\n\t\t\tconst systemID = 1 * node.systemID;\r\n\t\t\t$(node.domNode).dblclick(() => _this.collapse(systemID, collapsed.indexOf(systemID) < 0));\r\n\t\t\t\r\n\t\t\t// Position the node\r\n\t\t\tconst dr = (parentCollapsed ? 1 : node.minArc) * rads_per_arc;\r\n\t\t\tconst rad_centre = rad_offset + (dr / 2);\r\n\t\t\t\r\n\t\t\tif(ci == 1 && ni == 0) { // First node on first ring should be axis aligned\r\n\t\t\t\talignment_delta -= rad_centre;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tnode.radPosition = { r: ci, theta: rad_centre + alignment_delta };\r\n\t\t\tnode.position = radToCartesian(node.radPosition);\r\n\t\t\t\r\n\t\t\tif(node.position.x < bounds.x[0]) { bounds.x[0] = node.position.x; }\r\n\t\t\tif(node.position.x > bounds.x[1]) { bounds.x[1] = node.position.x; }\r\n\t\t\tif(node.position.y < bounds.y[0]) { bounds.y[0] = node.position.y; }\r\n\t\t\tif(node.position.y > bounds.y[1]) { bounds.y[1] = node.position.y; }\r\n\t\t\t\r\n\t\t\tnode.domNode.style.left = node.position.x + 'px';\r\n\t\t\tnode.domNode.style.top = node.position.y + 'px';\r\n\t\t\t\r\n\t\t\tif(parentCollapsed) {\r\n\t\t\t\tnode.domNode.style.display = 'none';\r\n\t\t\t} else {\t\t\t\t\r\n\t\t\t\t// Do the segment of the next circle\r\n\t\t\t\tconst excess = (ci > 0 && dr > node.minArc * ci) ? dr - node.minArc * ci : 0;\r\n\t\t\t\tif(node.children.length) {\r\n\t\t\t\t\tconst nextBounds = makeDivsForRing(innerContainer, ci + 1, node.children, rad_offset + (0.5 * excess) + alignment_delta, rad_offset - (0.5 * excess) + alignment_delta + dr, collapsed);\r\n\t\t\t\t\tif(nextBounds.x[0] < bounds.x[0]) { bounds.x[0] = nextBounds.x[0]; }\r\n\t\t\t\t\tif(nextBounds.x[1] > bounds.x[1]) { bounds.x[1] = nextBounds.x[1]; }\r\n\t\t\t\t\tif(nextBounds.y[0] < bounds.y[0]) { bounds.y[0] = nextBounds.y[0]; }\r\n\t\t\t\t\tif(nextBounds.y[1] > bounds.y[1]) { bounds.y[1] = nextBounds.y[1]; }\r\n\t\t\t\t\tif(nextBounds.maxCi > bounds.maxCi) { bounds.maxCi = nextBounds.maxCi; }\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\trad_offset += dr;\r\n\t\t}\r\n\t\t\r\n\t\treturn bounds;\r\n\t}\r\n\r\n\tfunction radToCartesian(rad) {\r\n\t\treturn { \r\n\t\t\tx: CIRCLE_SIZE.ringX(rad.r) * Math.sin(rad.theta), \r\n\t\t\ty: CIRCLE_SIZE.ringY(rad.r) * Math.cos(rad.theta)\r\n\t\t};\r\n\r\n\t}\r\n\r\n\t/** https://stackoverflow.com/questions/40978050 */\r\n\tfunction propertyFromCssClass(className, property) {\r\n\t\tif(Array.isArray(className)) { className = className.join(' '); }\r\n\t\tvar elem = document.getElementById('temp-div-' + className);\r\n\t\tif(!elem) {\r\n\t\t  elem = document.createElement(\"div\");\r\n\t\t  elem.id = 'temp-div-' + className;\r\n\t\t  elem.style.cssText = \"position:fixed;left:-100px;top:-100px;width:1px;height:1px;\";\r\n\t\t  elem.className = className + ' temp';\r\n\t\t  document.body.appendChild(elem);  // required in some browsers\r\n\t\t  }\r\n\t  const prop = getComputedStyle(elem).getPropertyValue(property);\r\n\t  //document.body.removeChild(tmp);\r\n\t  return prop;\r\n\t}\t\r\n};","var chain = new function() {\r\n\tvar chain = this;\r\n\tthis.map, this.view, this.drawing, this.data = {};\r\n\t\r\n\tthirdPartySuppliers = [ /*thera*/ ];\r\n\r\n\t// Renderer should have:\r\n\t//  ready() - Whether the renderer is initialised and can accept draw calls\r\n\t// switchTo() - Make this renderer active. The renderer can be in a blank state; draw() will be called after\r\n\t// switchFrom() - Switch away from this renderer. All node divs should be removed from the DOM, other items can be removed or made invisible\r\n\t// draw(map, lines, collapsedSystems) - Redraw the map, based on the given node set, line overrides and list of collapsed systems \r\n\t// collapse(systemID, toggle) - marks the system as collapsed/not collapsed\r\n\t// If the renderer allows collapsing of nodes then it will call updateCollapsed on the owner (the chain) with a list of collapsed systems in the current tab\r\n\t\r\n\tconst renderers = { \r\n\t\torgChart: new ChainMapRendererOrgchart(this),\r\n\t\tradial: new ChainMapRendererRadial(this)\r\n\t};\r\n\t\r\n\tthis.renderer = renderers[options.chain.renderer];\r\n\tthis.renderer.switchTo();\r\n\t\r\n\tthis.useRenderer = function(name) {\r\n\t\tif(!renderers[name]) { throw 'Unknown renderer ' + name; }\r\n\t\tif(this.renderer != renderers[name]) {\r\n\t\t\tthis.renderer.switchFrom();\r\n\t\t\tthis.renderer = renderers[name];\r\n\t\t\tthis.renderer.switchTo();\r\n\t\t\tthis.redraw();\r\n\t\t}\r\n\t}\r\n\r\n\tthis.activity = function(data) {\r\n\t\t/*\tfunction for adding recent activity to chain map nodes\t*/\r\n\t\t//var data = typeof(data) !== \"undefined\" ? data : this.data.activity;\r\n\r\n\t\t// Hide all activity colored dots instead of checking each one\r\n\t\tvar elements = document.querySelectorAll(\"#chainMap .nodeActivity span\");\r\n\t\tfor (var i = 0, l = elements.length; i < l; ++i) {\r\n\t\t   elements[i].className = elements[i].className + \" invisible\";\r\n\t\t}\r\n\r\n\t\t// Loop through passed data and show dots by system\r\n\t\tvar elements = document.querySelectorAll(\"#chainMap [data-nodeid]\");\r\n\t\tfor (var i = 0, l = elements.length; i < l; ++i) {\r\n\t\t   var systemID = elements[i].getAttribute(\"data-nodeid\");\r\n\t\t   if (data[systemID]) {\r\n\t\t\t   var shipJumps = data[systemID].shipJumps;\r\n\t\t\t   var podKills = data[systemID].podKills;\r\n\t\t\t   var shipKills = data[systemID].shipKills;\r\n\t\t\t   var npcKills = data[systemID].npcKills;\r\n\t\t\t   var node = elements[i].getElementsByClassName(\"nodeActivity\")[0];\r\n\r\n\t\t\t   if (shipJumps > 0) {\r\n\t\t\t\t   var jumps = node.getElementsByClassName(\"jumps\")[0];\r\n\t\t\t\t   jumps.className = jumps.className.replace(/invisible/g, \"\");\r\n\t\t\t\t   jumps.setAttribute(\"data-tooltip\", shipJumps + \" Jumps\");\r\n\t\t\t   }\r\n\r\n\t\t\t   if (podKills > 0) {\r\n\t\t\t\t   var pods = node.getElementsByClassName(\"pods\")[0];\r\n\t\t\t\t   pods.className = pods.className.replace(/invisible/g, \"\");\r\n\t\t\t\t   pods.setAttribute(\"data-tooltip\", podKills + \" Pod Kills\");\r\n\t\t\t   }\r\n\r\n\t\t\t   if (shipKills > 0) {\r\n\t\t\t\t   var ships = node.getElementsByClassName(\"ships\")[0];\r\n\t\t\t\t   ships.className = ships.className.replace(/invisible/g, \"\");\r\n\t\t\t\t   ships.setAttribute(\"data-tooltip\", shipKills + \" Ship Kills\");\r\n\t\t\t   }\r\n\r\n\t\t\t   if (npcKills > 0) {\r\n\t\t\t\t   var npcs = node.getElementsByClassName(\"npcs\")[0];\r\n\t\t\t\t   npcs.className = npcs.className.replace(/invisible/g, \"\");\r\n\t\t\t\t   npcs.setAttribute(\"data-tooltip\", npcKills + \" NPC Kills\");\r\n\t\t\t   }\r\n\t\t   }\r\n\t\t}\r\n\r\n\t\tif (SystemActivityToolTips.attachedElements && SystemActivityToolTips.attachedElements.length > 0) {\r\n\t\t\tSystemActivityToolTips.detach($(\"#chainMap .whEffect\"));\r\n\t\t}\r\n\t\tSystemActivityToolTips.attach($(\"#chainMap .nodeActivity > span[data-tooltip]:not(.invisible)\"));\r\n\r\n\t\treturn data;\r\n\t}\r\n\r\n\tthis.occupied = function(data) {\r\n\t\t/*\tfunction for showing occupied icon  */\r\n\r\n\t\t// Hide all icons instead of checking each one\r\n\t\t$(\"#chainMap [data-icon='user'], #chainMap [data-icon='user'] + .badge\").addClass(\"invisible\");\r\n\r\n\t\t// Loop through passed data and show icons\r\n\t\tfor (var x in data) {\r\n\t\t\t$(\"#chainMap [data-nodeid='\"+data[x].systemID+\"'] [data-icon='user']\").removeClass(\"invisible\");\r\n\t\t\t$(\"#chainMap [data-nodeid='\"+data[x].systemID+\"'] [data-icon='user'] + .badge\").removeClass(\"invisible\").html(data[x].count);\r\n\t\t}\r\n\r\n\t\tOccupiedToolTips.attach($(\"#chainMap [data-icon='user']:not(.invisible)\"));\r\n\r\n\t\treturn data;\r\n\t}\r\n\r\n\tthis.flares = function(data) {\r\n\t\t/*\tfunction for coloring chain map nodes via flares  */\r\n\t\t//var data = typeof(data) !== \"undefined\" ? data : this.data.flares;\r\n\r\n\t\t// Remove all current node coloring instead of checking each one\r\n\t\t$(\"#chainMap div.node\").removeClass(\"redNode yellowNode greenNode\");\r\n\r\n\t\t// Remove all coloring from chain grid\r\n\t\t$(\"#chainGrid tr\").removeClass(\"red yellow green\");\r\n\r\n\t\t// Loop through passed data and add classes by system\r\n\t\tif (data) {\r\n\t\t\tfor (var x in data.flares) {\r\n\t\t\t\tvar systemID = data.flares[x].systemID;\r\n\t\t\t\tvar flare = data.flares[x].flare;\r\n\r\n\t\t\t\tvar row = ($(\"#chainMap [data-nodeid=\"+systemID+\"]\").addClass(flare+\"Node\").parent().index() - 1) / 3 * 2;\r\n\r\n\t\t\t\tif (row > 0) {\r\n\t\t\t\t\t$(\"#chainGrid tr:eq(\"+row+\")\").addClass(flare).next().addClass(flare);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\treturn data;\r\n\t}\r\n\r\n\tthis.grid = function() {\r\n\t\t/*  function for showing/hiding grid lines  */\r\n\t\t// This is an optional feature\r\n\t\tif (options.chain.gridlines == false) {\r\n\t\t\t$(\"#chainGrid tr\").addClass(\"hidden\");\r\n\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\t$(\"#chainGrid tr\").removeClass(\"hidden\");\r\n\t\t//$(\"#chainGrid\").css(\"width\", \"100%\");\r\n\r\n\t\t// Calculate how many rows have systems, max 0 hack to prevent negative numbers, and rows above this number get hidden\r\n\t\tvar rows = Math.max(0, $(\".google-visualization-orgchart-table tr:has(.node)\").length * 2 - 1);\r\n\t\t$(\"#chainGrid tr:gt(\"+rows+\")\").addClass(\"hidden\");\r\n\t}\r\n\r\n\tthis.nodes = function(map) {\r\n\t\tvar chain = {cols: [{label: \"System\", type: \"string\"}, {label: \"Parent\", type: \"string\"}], rows: []};\r\n\t\tvar frigTypes = [\"Q003\", \"E004\", \"L005\", \"Z006\", \"M001\", \"C008\", \"G008\", \"A009\", \"SML\" ];\r\n\t\tvar connections = [];\r\n\t\tvar chainMap = this;\r\n\r\n\t\tfunction formatStatics(statics) {\r\n\t\t\tif(!statics) { return ''; }\r\n\t\t\telse if(statics.length > 4) { return '<span class=\"multi-static\">+</span>'; }\r\n\t\t\t\r\n\t\t\tconst shortCodeMap = { 'High-Sec': 'H', 'Low-Sec': 'L', 'Null-Sec': 'N', 'Triglavian':'▼',\r\n\t\t\t\t'Class-1': '1', 'Class-2': '2', 'Class-3': '3', 'Class-4': '4', 'Class-5' : 5, 'Class-6': 6\r\n\t\t\t};\r\n\t\t\tconst classMap = { H: 'hisec', L: 'lowsec', N: 'nullsec', '▼': 'triglavian' };\r\n\t\t\treturn statics.map(function(s) {\r\n\t\t\t\tconst text = shortCodeMap[appData.wormholes[s].leadsTo];\r\n\t\t\t\tconst className = classMap[text] || 'class-' +  text;\r\n\t\t\t\tconst tip = appData.wormholes[s].leadsTo + ' via ' + s;\r\n\t\t\t\treturn '<span class=\"' + className + '\" data-tooltip=\"' + tip + '\">' + text + '</span>';\r\n\t\t\t}).join('');\r\n\t\t}\r\n\r\n\t\tfunction topLevel(systemID, id) {\r\n\t\t\tif (!systemID || !tripwire.systems[systemID])\r\n\t\t\t\treturn false;\r\n\t\t\tconst tab = options.chain.tabs[options.chain.active];\r\n\t\t\tconst tabName = tab && tab.systemID != 0 && 0 > tab.systemID.indexOf(',') ? options.chain.tabs[options.chain.active].name : undefined;\r\n\t\t\treturn makeSystemNode(systemID, id, null, null, tabName, '&nbsp;', ['top-level']);\r\n\t\t}\r\n\r\n\t\tfunction makeSystemNode(systemID, id, whId, inSigId, systemName, nodeTypeMarkup, additionalClasses) {\r\n\t\t\t// System type switch\r\n\t\t\tconst system = systemAnalysis.analyse(systemID);\r\n\t\t\tvar systemType = \"<span class='\" + system.systemTypeClass + \"'>\" + system.systemTypeName + system.systemTypeModifiers.join('') + \"</span>\";\r\n\t\t\t\r\n\t\t\tsystemName = _.escape(systemName);\r\n\t\t\tconst systemNameText = \r\n\t\t\t\toptions.chain.sigNameLocation == 'name' ? (systemName ? systemName : system.name ? system.name : '&nbsp;') :\r\n\t\t\t\toptions.chain.sigNameLocation == 'name_prefix' ?\r\n\t\t\t\t\t(systemName ? systemName + (system.name ? ' - ' + system.name : '') : (system.name ? system.name : '&nbsp;')) :\r\n\t\t\t\t(system.name ? system.name : '&nbsp;');\t\r\n\r\n\t\t\tvar node = {v: id, systemID: systemID };\r\n\t\t\tvar chainNode = \"<div id='node\"+id+\"' data-nodeid='\"+systemID+\"'\"\r\n\t\t\t\t+(whId ? \" data-sigid='\"+whId+\"'\" : '')\r\n\t\t\t\t+(inSigId ? \" data-inSigid='\"+inSigId+\"'\" : '')\r\n\t\t\t\t+\" class='node \" + ((additionalClasses || []).join(' ')) + \"'>\"\r\n\t\t\t\t\t\t\t+\t\"<div class='nodeIcons'>\"\r\n\t\t\t\t\t\t\t+\t\t\"<div style='float: left;'>\"\r\n\t\t\t\t\t\t\t+ systemRendering.renderEffect(system, 'i')\r\n\t\t\t\t\t\t\t+\t\t\"</div>\"\r\n\t\t\t\t\t\t\t+\t\t\"<div style='float: right;'>\"\r\n\t\t\t\t\t\t\t+\t\t\t\"<i data-icon='user' class='invisible'></i>\"\r\n\t\t\t\t\t\t\t+\t\t\t\"<span class='badge invisible'></span>\"\r\n\t\t\t\t\t\t\t+\t\t\"</div>\"\r\n\t\t\t\t\t\t\t+\t\"</div>\"\r\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeClass'>\"+systemType+\"</h4>\"\r\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeSystem'>\"\r\n\t\t\t\t\t\t\t+\t\t(system.name ? \"<a href='.?system=\"+system.name+\"'>\"+systemNameText+\"</a>\" : systemNameText)\r\n\t\t\t\t\t\t\t+\t\"</h4>\"\r\n\t\t\t\t\t\t\t+\t\"<h4 class='nodeType'>\" + nodeTypeMarkup + \"</h4>\"\r\n\t\t\t\t\t\t\t+\t\"<div class='statics'>\"\r\n\t\t\t\t\t\t\t+ formatStatics(system.name ? system.statics : [])\r\n\t\t\t\t\t\t\t+\t\"</div>\"\r\n\t\t\t\t\t\t\t+\t\"<div class='nodeActivity'>\"\r\n\t\t\t\t\t\t\t+\t\t\"<span class='jumps invisible'>&#9679;</span>&nbsp;<span class='pods invisible'>&#9679;</span>&nbsp;&nbsp;<span class='ships invisible'>&#9679;</span>&nbsp;<span class='npcs invisible'>&#9679;</span>\"\r\n\t\t\t\t\t\t\t+\t\"</div>\"\r\n\t\t\t\t\t\t\t+\"</div>\";\r\n\r\n\t\t\tnode.f = chainNode;\r\n\r\n\t\t\treturn node;\r\n\t\t}\r\n\t\t\r\n\t\tfunction makeCalcChildNode(childID, node, targetSystem) {\r\n\t\t\tvar path = guidance.findShortestPath(tripwire.map.shortest, targetSystem - 30000000, node.child.systemID - 30000000);\r\n\t\t\tif(!path) { return null; }\r\n\t\t\t\r\n\t\t\tvar calcNode = { calculated: true};\r\n\t\t\tcalcNode.life = \"Gate\";\r\n\t\t\tcalcNode.parent = {};\r\n\t\t\tcalcNode.parent.id = node.child.id;\r\n\t\t\tcalcNode.parent.systemID = node.child.systemID;\r\n\t\t\tcalcNode.parent.name = node.child.name;\r\n\t\t\tcalcNode.parent.type = node.child.type;\r\n\t\t\tcalcNode.parent.nth = node.child.nth;\r\n\r\n\t\t\tcalcNode.child = {};\r\n\t\t\tcalcNode.child.id = ++childID;\r\n\t\t\tcalcNode.child.systemID = targetSystem;\r\n\t\t\tcalcNode.child.name = tripwire.systems[targetSystem].name;\r\n\t\t\tcalcNode.child.path = path;\r\n\t\t\tcalcNode.child.jumps = path.length - 1;\r\n\t\t\tcalcNode.child.nth = null;\t\t\t\r\n\t\t\t\r\n\t\t\treturn { childID, calcNode };\r\n\t\t}\r\n\r\n\t\tfunction findLinks(system) {\r\n\t\t\tif (system[0] <= 0) return false;\r\n\r\n\t\t\tvar parentID = parseInt(system[1]), childID = chainList.length;\r\n\t\t\tconst connectedTo = [];\t// Local cache, in addition to usedLinks, for extra link sources\r\n\r\n\t\t\t/** Add the 'current' and 'favourite' calculated nodes if appropriate */\r\n\t\t\tconst addCalcChildNodes = function(node) {\r\n\t\t\t\tif ($(\"#show-viewing\").hasClass(\"active\") && tripwire.systems[node.child.systemID] && !tripwire.systems[viewingSystemID].class && !tripwire.systems[node.child.systemID].class && viewingSystemID != node.child.systemID ) {\r\n\t\t\t\t\tvar calcNode = makeCalcChildNode(childID, node, viewingSystemID);\r\n\t\t\t\t\tif(calcNode) {\r\n\t\t\t\t\t\tchildID = calcNode.childID;\r\n\r\n\t\t\t\t\t\tchainLinks.push(calcNode.calcNode);\r\n\t\t\t\t\t\tchainList.push([0, childID]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($(\"#show-favorite\").hasClass(\"active\") && tripwire.systems[node.child.systemID] && !tripwire.systems[node.child.systemID].class) {\r\n\t\t\t\t\tfor (var x in options.favorites) {\r\n\t\t\t\t\t\tif (tripwire.systems[options.favorites[x]].regionID >= 11000000 || tripwire.systems[node.child.systemID].regionID >= 11000000 || options.favorites[x] == node.child.systemID)\r\n\t\t\t\t\t\t\tcontinue;\r\n\r\n\t\t\t\t\t\tvar calcNode = makeCalcChildNode(childID, node, options.favorites[x]);\r\n\t\t\t\t\t\tif(calcNode) {\r\n\t\t\t\t\t\t\tchildID = calcNode.childID;\r\n\r\n\t\t\t\t\t\t\tchainLinks.push(calcNode.calcNode);\r\n\t\t\t\t\t\t\tchainList.push([0, childID]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\t\t\t\t\r\n\t\t\t};\r\n\r\n\t\t\tfor (var x in chainData) {\r\n\t\t\t\tvar wormhole = chainData[x];\t\t\t\t\r\n\t\t\t\tif ($.inArray(wormhole.id, usedLinks) == -1) {\r\n\t\t\t\t\tvar sig1, sig2, sig1Type, sig2Type,\r\n\t\t\t\t\t\tparent, child, parentType, childType;\r\n\t\t\t\t\tif (wormhole.parent == \"secondary\") {\r\n\t\t\t\t\t\tsig1 = tripwire.client.signatures[wormhole.secondaryID];\r\n\t\t\t\t\t\tsig2 = tripwire.client.signatures[wormhole.initialID];\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tsig1 = tripwire.client.signatures[wormhole.initialID];\r\n\t\t\t\t\t\tsig2 = tripwire.client.signatures[wormhole.secondaryID];\r\n\t\t\t\t\t}\r\n\t\t\t\t\tsig1Type = wormhole.type; sig2Type = 'K162';\r\n\t\t\t\t\t\r\n\t\t\t\t\tif (sig1 && sig1.systemID == system[0]) {\r\n\t\t\t\t\t\tparent = sig1; child = sig2;\r\n\t\t\t\t\t\tparentType = sig2Type; childType = sig1Type;\r\n\t\t\t\t\t} else if(sig2 && sig2.systemID == system[0]) {\r\n\t\t\t\t\t\tparent = sig2; child = sig1;\r\n\t\t\t\t\t\tchildType = sig2Type; parentType = sig1Type;\r\n\t\t\t\t\t} else { continue; }\r\n\t\t\t\t\t\r\n\t\t\t\t\tvar node = {};\r\n\t\t\t\t\tnode.id = wormhole.id;\r\n\t\t\t\t\tnode.life = wormhole.life;\r\n\t\t\t\t\tnode.mass = wormhole.mass;\r\n\t\t\t\t\tnode.time = parent.modifiedTime;\r\n\r\n\t\t\t\t\tnode.parent = {};\r\n\t\t\t\t\tnode.parent.id = parentID;\r\n\t\t\t\t\tnode.parent.systemID = tripwire.systems[parent.systemID] ? parent.systemID : parent.systemID + \"|\" + Math.floor(Math.random() * Math.floor(10000));\r\n\t\t\t\t\tnode.parent.name = child.name;\r\n\t\t\t\t\tnode.parent.type = parentType;\r\n\t\t\t\t\tnode.parent.typeBM = null;\r\n\t\t\t\t\tnode.parent.classBM = null;\r\n\t\t\t\t\tnode.parent.nth = null;\r\n\t\t\t\t\tnode.parent.signatureID = child.signatureID;\r\n\t\t\t\t\tnode.parent.sigIndex = child.id;\r\n\r\n\t\t\t\t\tnode.child = {};\r\n\t\t\t\t\tnode.child.id = ++childID;\r\n\t\t\t\t\tnode.child.systemID = tripwire.systems[child.systemID] ? child.systemID : child.systemID + \"|\" + Math.floor(Math.random() * Math.floor(10000));\r\n\t\t\t\t\tnode.child.name = parent.name;\r\n\t\t\t\t\tnode.child.type = childType;\r\n\t\t\t\t\tnode.child.typeBM = null;\r\n\t\t\t\t\tnode.child.classBM = null;\r\n\t\t\t\t\tnode.child.nth = null;\r\n\t\t\t\t\tnode.child.signatureID = parent.signatureID;\r\n\t\t\t\t\tnode.child.sigIndex = parent.id;\r\n\r\n\t\t\t\t\tchainLinks.push(node);\r\n\t\t\t\t\tchainList.push([node.child.systemID, node.child.id, system[2]]);\r\n\t\t\t\t\tusedLinks.push(node.id);\r\n\t\t\t\t\tif(tripwire.systems[child.systemID]) { connectedTo.push(1 * child.systemID); }\t// cast to number - sigs have the system as a string\r\n\t\t\t\t\t// usedLinks[system[2]].push(node.id);\r\n\t\t\t\t\t\r\n\t\t\t\t\taddCalcChildNodes(node);\t\t\t\t\t\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tthirdPartySuppliers.forEach(function(supplier) {\t\t\t\t\r\n\t\t\t\tconst ids = { parentID: parentID, nextChildID: ++childID };\r\n\t\t\t\tconst supplierNodes = supplier.findLinks(1 * system[0], ids);\r\n\t\t\t\tif(!supplierNodes) { return; }\r\n\t\t\t\tchildID = ids.nextChildID - 1;\r\n\r\n\t\t\t\tfor(var ti = 0; ti < supplierNodes.length; ti++) {\r\n\t\t\t\t\tvar supplierNode = supplierNodes[ti];\r\n\t\t\t\t\tif(0 > usedLinks.indexOf(supplierNode.id)) {\r\n\t\t\t\t\t\tif(0 > connectedTo.indexOf(supplierNode.child.systemID)) { // not in our map already\r\n\t\t\t\t\t\t\tsupplierNode.thirdParty = supplier.nodeNameSuffix;\r\n\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tchainLinks.push(supplierNode);\r\n\t\t\t\t\t\t\tchainList.push([supplierNode.child.systemID, supplierNode.child.id, system[2]]);\r\n\t\t\t\t\t\t\tconnectedTo.push(supplierNode.child.systemID);\t\t\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\taddCalcChildNodes(supplierNode);\t\t\r\n\t\t\t\t\t\t}\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t// Always want to do this, even if we didn't add it, because in that case the link is overridden by one on this mask, so it is 'used' even if not made visible\r\n\t\t\t\t\t\tusedLinks.push(supplierNode.id);\t\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t\t\r\n\t\tif ($(\"#chainTabs .current\").length > 0) {\r\n\t\t\tvar systems = $(\"#chainTabs .current .name\").data(\"tab\").toString().split(\",\");\r\n\t\t\tvar chainList = [];\r\n\t\t\tvar chainData = map;\r\n\t\t\tvar chainLinks = [];\r\n\t\t\tvar usedLinks = [];\r\n\r\n\t\t\tif (systems == 0) {\r\n                                let i = 0;\r\n                                Object.keys(map).slice()/*.reverse()*/.forEach(x => {\r\n\t\t\t\t        const parent = tripwire.client.signatures[map[x].initialID];\r\n\t\t\t\t        const child = tripwire.client.signatures[map[x].secondaryID];\r\n                                        if (parent && tripwire.systems[parent.systemID] && typeof(tripwire.systems[parent.systemID].class) == \"undefined\") {\r\n\t\t\t\t\t\ti++;\r\n\t\t\t\t\t\t// usedLinks[parent.systemID] = [];\r\n\t\t\t\t\t\tchain.rows.push({c: [topLevel(parent.systemID, i), {v: null}]});\r\n\t\t\t\t\t\tchainList.push([parent.systemID, i, parent.systemID]);\r\n                                        } else if (child && tripwire.systems[child.systemID] && typeof(tripwire.systems[child.systemID].class) == \"undefined\") {\r\n\t\t\t\t  \t        i++;\r\n\t\t\t\t  \t\t// usedLinks[child.systemID] = [];\r\n\t\t\t\t\t\tchain.rows.push({c: [topLevel(child.systemID, i), {v: null}]});\r\n\t\t\t\t\t\tchainList.push([child.systemID, i, child.systemID]);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t} else {\r\n\t\t\t\tfor (var x in systems) {\r\n\t\t\t\t\t// usedLinks[systems[x]] = [];\r\n\t\t\t\t\tchain.rows.push({c: [topLevel(systems[x], parseInt(x) + 1), {v: null}]});\r\n\t\t\t\t\tchainList.push([systems[x], parseInt(x) + 1, systems[x]]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tfor (var i = 0; i < chainList.length; i++) {\r\n\t\t\t\tfindLinks(chainList[i]);\r\n\t\t\t}\r\n\t\t} else {\r\n\t\t\t$(\"#chainError\").hide();\r\n\r\n\t\t\tvar row = {c: []};\r\n\t\t\tvar systemID = viewingSystemID;\r\n\r\n\t\t\trow.c.push(topLevel(systemID, 1), {v: null});\r\n\r\n\t\t\tchain.rows.push(row);\r\n\r\n\t\t\tvar chainList = [[systemID, 1]];\r\n\t\t\tvar chainData = map;\r\n\t\t\tvar chainLinks = [];\r\n\t\t\tvar usedLinks = [];\r\n\r\n\t\t\tfor (var i = 0; i < chainList.length; ++i) {\r\n\t\t\t\tfindLinks(chainList[i]);\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\tconst systemsInChainMap = {};\r\n\t\t\r\n\t\tfor (var x in chainLinks) {\r\n\t\t\tvar node = chainLinks[x];\r\n\t\t\tvar row = {c: []};\r\n\t\t\t\r\n\t\t\tconst sigText = options.chain[\"node-reference\"] == \"id\" ? (node.child.signatureID ? node.child.signatureID.substring(0, 3) : \"???\") :\r\n\t\t\t\t\t(node.child.type || \"(?)\") + sigFormat(node.child.typeBM, \"type\");\r\n\t\t\tconst nodeTypeMarkup = node.child.path ? \r\n\t\t\t\tsystemRendering.renderPath(node.child.path) :\r\n\t\t\t\t(node.child.sigIndex ? \"<a href='#' onclick='sigDialog.openSignatureDialog({data: { signature: \" + node.child.sigIndex + \", mode: \\\"update\\\" }}); return false;'>\" : '') + _.escape(\r\n\t\t\t\t\tnode.child.name && options.chain.sigNameLocation == 'ref' ? node.child.name :\r\n\t\t\t\t\tnode.child.name && options.chain.sigNameLocation == 'ref_prefix' ? node.child.name + ' - ' + sigText :\r\n\t\t\t\t\tsigText\r\n\t\t\t\t) + (node.child.sigIndex ? '</a>' : '');\r\n\t\t\tconst additionalClasses = node.calculated ? ['calc'] : systemsInChainMap[node.child.systemID] ? [ 'loop' ] : [];\r\n\t\t\tif(node.thirdParty) { additionalClasses.push('third-party', 'third-party-' + node.thirdParty); }\r\n\r\n\t\t\t// Connection modifiers\r\n\t\t\tvar modifiers = [];\t\t\t\r\n\t\t\tif (node.life == \"critical\") { modifiers.push('eol'); }\r\n\t\t\tif (node.mass == \"critical\") { modifiers.push('critical'); }\r\n\t\t\telse if (node.mass == \"destab\") { modifiers.push('destab'); }\r\n\t\t\t\r\n\t\t\tconst connectionWormhole = wormholeAnalysis.wormholeFromTypePair(node.parent.type, node.child.type) || \r\n\t\t\t\twormholeAnalysis.likelyWormhole(node.parent.systemID, node.child.systemID);\r\n\t\t\tif(connectionWormhole.jump) { \r\n\t\t\t\tmodifiers.push('jm-' + (connectionWormhole.jump / 1e6) + 'kt'); \r\n\t\t\t\tif(connectionWormhole.jump == 5000000) { modifiers.push('frig'); }\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tconst parentModifiers = (systemsInChainMap[node.parent.systemID] || { chainModifiers:[]}).chainModifiers;\r\n\t\t\trow.chainModifiers = modifiers.concat(parentModifiers.filter(function(p) { return modifiers.indexOf(p) < 0; }));\r\n\t\t\t\r\n\t\t\trow.chainModifiers.forEach(function(cm) { modifiers.push(cm + '-chain')});\r\n\t\t\t\r\n\t\t\t// Update result set (rows/connections)\r\n\t\t\tconst child = makeSystemNode(node.child.systemID, node.child.id, node.id, node.child.sigIndex, node.child.name, nodeTypeMarkup, additionalClasses.concat(modifiers));\r\n\r\n\t\t\tvar parent = {v: node.parent.id};\r\n\r\n\t\t\trow.c.push(child, parent);\r\n\t\t\tchain.rows.push(row);\r\n\t\t\tconnections.push(Array(child.v, parent.v, modifiers, node.id));\r\n\t\t\t\r\n\t\t\tconst parentPathHome = (systemsInChainMap[node.parent.systemID] || { pathHome:[]}).pathHome;\r\n\t\t\trow.pathHome = parentPathHome.concat(node.child);\r\n\t\t\t\r\n\t\t\tif(!node.calculated) { \r\n\t\t\t\tsystemsInChainMap[node.child.systemID] = row; // store for loops/chain modifiers\r\n\t\t\t}\t\r\n\t\t}\r\n\r\n\t\t// Apply critical/destab line colors\r\n\t\tconnections.reverse(); // so we apply to outer systems first\r\n\r\n\t\tconst exits = Object.keys(systemsInChainMap).filter(function(x) { return x < 31000000; });\r\n\t\treturn {map: chain, lines: connections, systemsInChainMap: systemsInChainMap, exits: exits};\r\n\t}\r\n\r\n\r\n\tthis.setActiveTab = function(newIndex) {\r\n\t\t$(\"#chainTabs .tab\").removeClass(\"current\");\r\n\t\toptions.chain.active = newIndex;\r\n\t\tif(newIndex != null) {\r\n\t\t\t$(\"#chainTabs .tab\").eq(newIndex).addClass('current');\r\n\t\t}\r\n\t\t\r\n\t\toptions.save();\r\n\t\tchain.redraw();\r\n\t\ttripwire.parse(tripwire.client, \"refresh\");\r\n\t}\r\n\r\n\tthis.redraw = function() {\r\n\t\tthis.useRenderer(options.chain.renderer);\r\n\t\t\r\n\t\tvar data = $.extend(true, {}, this.data);\r\n\t\tdata.map = $.extend(true, {}, data.rawMap);\r\n\r\n\t\tthis.draw(data);\r\n\t}\r\n\t\r\n\tvar drawRetryTimer = null;\r\n\r\n\tthis.draw = function(data) {\r\n\t\tvar data = typeof(data) !== \"undefined\" ? data : {};\r\n\t\tclearTimeout(drawRetryTimer);\r\n\r\n\t\t// We need to make sure Google chart is ready and we have signature data for this system before we begin, otherwise delay\r\n\t\tif (!this.renderer.ready() || (Object.keys(data.map||{}).length && !tripwire.client.signatures)) {\r\n\t\t\tdrawRetryTimer = setTimeout(function() { chain.draw(data) }, 100);\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tif (data.map) {\r\n\t\t\tthis.drawing = true;\r\n\r\n\t\t\tthis.data.rawMap = $.extend(true, {}, data.map);\r\n\r\n\t\t\t// if (options.chain.active == null || (options.chain.tabs[options.chain.active] && options.chain.tabs[options.chain.active].evescout == false)) {\r\n\t\t\t// \tif (options.masks.active != \"273.0\") {\r\n\t\t\t// \t\tfor (var i in data.map) {\r\n\t\t\t// \t\t\tif (data.map[i].mask == \"273.0\") {\r\n\t\t\t// \t\t\t\tdelete data.map[i];\r\n\t\t\t// \t\t\t}\r\n\t\t\t// \t\t}\r\n\t\t\t// \t}\r\n\t\t\t// }\r\n\r\n\t\t\t// Sort so we keep the chain map order the same\r\n\t\t\tObject.sort(data.map, \"id\");\r\n\r\n\t\t\t$.extend(data, this.nodes(data.map)); // 250ms -> <100ms\r\n\t\t\t$.extend(this.data, data);\r\n\t\t\t\r\n\t\t\tconst collapsedSystems = options.chain.tabs[options.chain.active] ? (options.chain.tabs[options.chain.active].collapsed || []) : [];\r\n\r\n\t\t\tthis.renderer.draw(data.map, data.lines, collapsedSystems); // 150ms\r\n\t\t\t//this.map.draw(this.newView(data.map), this.options); // 150ms\r\n\r\n//\t\t\tthis.renderer.lines(data); // 300ms\r\n\t\t\tthis.grid(); // 4ms\r\n\r\n\t\t\t// Apply current system style\r\n\t\t\t$(\"#chainMap [data-nodeid='\"+viewingSystemID+\"']\").parent().addClass(\"currentNode\"); // 0.1ms\r\n\r\n\t\t\t// Remove old system effect tooltips and add current ones\r\n\t\t\tif (WormholeTypeToolTips.attachedElements && WormholeTypeToolTips.attachedElements.length > 0) {\r\n\t\t\t\tWormholeTypeToolTips.detach($(\"#chainMap .whEffect\"));\r\n\t\t\t}\r\n\t\t\tWormholeTypeToolTips.attach($(\"#chainMap .whEffect[data-icon]\")); // 0.30ms\r\n\t\t\tWormholeRouteToolTips.attach($(\"#chainMap .path span[data-tooltip]\"));\r\n\t\t\tSystemActivityToolTips.attach($(\"#chainMap .nodeClass span[data-tooltip]\"));\r\n\t\t\t\r\n\t\t\tthis.drawing = false;\r\n\t\t\t\r\n\t\t\tsystemPanel.update();\r\n\t\t}\r\n\r\n\t\t// Gather latest system activity\r\n\t\tif (!this.data.activity || new Date() > this.data.activity.expires) {\r\n\t\t\tdata.activity = {};\r\n\t\t\ttripwire.esi.universeJumps()\r\n\t\t\t\t.done(function(results, status, request) {\r\n\t\t\t\t\tdata.activity.expires = new Date(request.getResponseHeader(\"expires\"));\r\n\t\t\t\t\t$.each(results, function(x) {\r\n\t\t\t\t\t\tdata.activity[results[x].system_id] = {\r\n\t\t\t\t\t\t\tsystemID: results[x].system_id,\r\n\t\t\t\t\t\t\tshipJumps: results[x].ship_jumps\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\t.then(function() {\r\n\t\t\t\t\t return tripwire.esi.universeKills()\r\n\t\t\t\t\t\t.done(function(results) {\r\n\t\t\t\t\t\t\t$.each(results, function(x) {\r\n\t\t\t\t\t\t\t\tif (data.activity[results[x].system_id]) {\r\n\t\t\t\t\t\t\t\t\tdata.activity[results[x].system_id].podKills = results[x].pod_kills;\r\n\t\t\t\t\t\t\t\t\tdata.activity[results[x].system_id].shipKills = results[x].ship_kills;\r\n\t\t\t\t\t\t\t\t\tdata.activity[results[x].system_id].npcKills = results[x].npc_kills;\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tdata.activity[results[x].system_id] = {\r\n\t\t\t\t\t\t\t\t\t\tsystemID: results[x].system_id,\r\n\t\t\t\t\t\t\t\t\t\tpodKills: results[x].pod_kills,\r\n\t\t\t\t\t\t\t\t\t\tshipKills: results[x].ship_kills,\r\n\t\t\t\t\t\t\t\t\t\tnpcKills: results[x].npc_kills,\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t})\r\n\t\t\t\t.then(function() {\r\n\t\t\t\t\tchain.data.activity = chain.activity(data.activity);\r\n\t\t\t\t});\r\n\t\t} else if (data.map) {\r\n\t\t\tchain.activity(this.data.activity);\r\n\t\t}\r\n\r\n\t\tif (data.occupied) { // 3ms\r\n\t\t\tthis.data.occupied = this.occupied(data.occupied);\r\n\t\t}\r\n\r\n\t\tif (data.flares) { // 20ms\r\n\t\t\tthis.data.flares = this.flares(data.flares);\r\n\t\t}\r\n\t}\r\n\r\n\tthis.updateCollapsed = function(collapsedSystems) {\r\n\t\tif (options.chain.tabs[options.chain.active]) {\r\n\t\t\toptions.chain.tabs[options.chain.active].collapsed = collapsedSystems;\r\n\t\t}\r\n\t\t\r\n\t\t// Apply current system style\r\n\t\t$(\"#chainMap [data-nodeid='\"+viewingSystemID+\"']\").parent().addClass(\"currentNode\");\r\n\r\n\t\tif (WormholeTypeToolTips.attachedElements && WormholeTypeToolTips.attachedElements.length > 0) {\r\n\t\t\tWormholeTypeToolTips.detach($(\"#chainMap .whEffect\"));\r\n\t\t}\r\n\t\tWormholeTypeToolTips.attach($(\"#chainMap .whEffect[data-icon]\"));\r\n\r\n\t\tchain.activity(chain.data.activity);\r\n\r\n\t\tchain.occupied(chain.data.occupied);\r\n\r\n\t\tchain.flares(chain.data.flares);\r\n\r\n\t\tchain.grid();\r\n\r\n\t\toptions.save();\r\n\t}\r\n\r\n}\r\n","var guidance_profiles = {\r\n\tblueLootSystems: [17,40,41,55,72,53,74,160,162,163,196,197,164,181,187,133,159,903,905,1002,1013,1021,1026,1032,1038,1045,1290,1359,1390,1361,1397,1395,1391,1676,1679,1677,1840,1842,1847,1848,1852,1854,1855,1858,1866,1868,1873,1874,1881,1883,1894,1896,1897,1901,1902,1907,1914,1918,1922,1931,1932,1938,1946,1951,1952,1958,1959,1961,1939,1978,2415,2418,2414,2558,2559,2560,2568,2569,2571,2572,2769,2815,2816,2771,2800,2975,2977,2980,2988,2993,2992,3017,3018,3024,3030,3048,3055,3025,3029,3053,3271,3275,3279,3280,3281,3283,3284,3287,3305,3307,3312,3317,3318,3321,3322,3324,3329,3333,3335,3338,3339,3342,3344,3361,3363,2058,2065,2067,3394,3404,3412,3447,3449,3467,3469,3389,3402,3413,3409,2059,2190,2252,3553,3554,3555,3556,2191,2193,2187,4077,4078,4079,4084,4111,4112,4114,4083,4239,4240,4241,4288,4291,4296,4621,4623,5010,5011,5020,5009,5018,5017,5030,5031,5034,5035,5039,5040,5043,5052,5054,5276,5275],\r\n\tchainExits: []\r\n}","const systemPanel = new function() {\r\n\tthis.update = function() {\r\n\t\t// Update dependent controls: Path to chain/home\r\n\t\tconst exits = chain.data.exits;\r\n\t\tvar html = [\r\n\t\t\trenderRoute((exits || []).map(function(x) { return x  - 30000000; }), true, 'chain', 'To chain'), \r\n\t\t\trenderRoute(guidance_profiles.blueLootSystems, false, 'blue-loot', 'Blue loot buyer')\r\n\t\t].filter(function(x) { return x; }).join('');\r\n\t\t$(\"#infoExtra\").html(html);\r\n\t\tTooltips.attach($(\"#infoExtra [data-tooltip]\"));\r\n\t};\r\n\t\r\n\tfunction renderRoute(targets, addPathHome, cssClass, categoryText) {\r\n\t\tconst path = targets ? guidance.findShortestPath(tripwire.map.shortest, viewingSystemID - 30000000, targets) : null;\r\n\t\tif(path) {\r\n\t\t\tconst inChain = path.length <= 1;\r\n\t\t\tconst exitSystem = path[path.length - 1] + 30000000;\r\n\t\t\tconst prefixText = inChain ? 'In chain: ' : (path.length - 1) + 'j from ' ;\r\n\t\t\tconst pathHomeText = addPathHome ? chain.data.systemsInChainMap[exitSystem].pathHome.slice().reverse()\r\n\t\t\t\t.map(function(n) { return '<a href=\".?system=' + tripwire.systems[n.systemID].name + '\">' + (n.name || tripwire.systems[n.systemID].name || '???') + '</a>'; })\r\n\t\t\t\t.join(' &gt; ') : '<a href=\".?system=' + tripwire.systems[exitSystem].name + '\">' + tripwire.systems[exitSystem].name + '</a>';\r\n\t\t\t\tconst pathToChainText = inChain ? '' : '<br/>' + systemRendering.renderPath(path.slice().reverse());\r\n\t\t\t\treturn '<div class=\"' + cssClass + '\">' + categoryText + ': ' + prefixText + pathHomeText + pathToChainText + '</div>';\r\n\t\t} else { return null; }\r\n\t}\r\n\r\n}();","tripwire.active = function(data) {\n    var editSigs = [];\n    var editComments = [];\n\n    for (var x in data) {\n        var activity = JSON.parse(data[x].activity);\n        editSigs.push(parseInt(activity.editSig));\n        editComments.push(parseInt(activity.editComment));\n\n        if (activity.editSig) {\n            $(\"#sigTable tr[data-id='\"+activity.editSig+\"']\")\n                //.attr('data-tooltip', sig.editing)\n                //.attr(\"title\", sig.editing)\n                .addClass(\"editing\")\n                .find(\"td\")\n                .animate({backgroundColor: \"#001b47\"}, 1000); //35240A - Yellow\n        }\n\n        if (activity.editComment && $(\"#commentWrapper .comment[data-id='\"+activity.editComment+\"'] .cke\").length > 0) {\n            $(\"#commentWrapper .comment[data-id='\"+activity.editComment+\"']\")\n                .addClass(\"editing\")\n                .find(\".commentStatus\").html(data[x].characterName + \" is editing\").fadeIn();\n        }\n    }\n\n    $(\"#sigTable tr.editing\").each(function() {\n        if ($.inArray($(this).data(\"id\"), editSigs) == -1) {\n            $(\"#sigTable tr[data-id='\"+$(this).data(\"id\")+\"']\")\n                //.attr('data-tooltip', '')\n                //.removeAttr(\"title\")\n                .removeClass(\"editing\")\n                .find(\"td\")\n                .animate({backgroundColor: \"#111\"}, 1000, null, function() {$(this).css({backgroundColor: \"\"});});\n        }\n    });\n\n    $(\"#commentWrapper .editing\").each(function() {\n        if ($.inArray($(this).data(\"id\"), editComments) == -1) {\n            $(\"#commentWrapper .editing[data-id='\"+$(this).data(\"id\")+\"']\")\n                .removeClass(\"editing\")\n                .find(\".commentStatus\").fadeOut(function() {$(this).html(\"\")});\n        }\n    });\n}\n","// Hanldes adding to Signatures section\r\n// ToDo: Use native JS\r\ntripwire.makeSigInfo = function(sig, wormhole) {\r\n\twormhole = wormhole ||\t// allow to be passed in to save this lookup\r\n\t\tObject.values(tripwire.client.wormholes).find(function (wh) { return wh.initialID == sig.id || wh.secondaryID == sig.id});\r\n\tif (!wormhole) return false;\r\n\tvar otherSignature = sig.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\r\n\tif (!otherSignature) return false;\r\n\r\n\tlet leadsTo;\r\n\tif (sig.name) {\r\n\t  leadsTo = tripwire.systems[otherSignature.systemID] ? \"<a href='.?system=\"+tripwire.systems[otherSignature.systemID].name+\"'>\"+_.escape(sig.name)+\"</a>\" : _.escape(sig.name);\r\n\t} else if (appData.genericSystemTypes[otherSignature.systemID]) {\r\n\t\tleadsTo = appData.genericSystemTypes[otherSignature.systemID];\r\n\t} else if (tripwire.systems[otherSignature.systemID]) {\r\n\t\tleadsTo = \"<a href='.?system=\"+tripwire.systems[otherSignature.systemID].name+\"'>\"+tripwire.systems[otherSignature.systemID].name+\"</a>\";\r\n\t} else {\r\n\t\tleadsTo = \"\";\r\n\t}\r\n\r\n\tconst wormholeTypeText = wormhole.type || \"???\";\r\n\treturn {\r\n\t\tid: sig.id,\r\n\t\tleadsTo: leadsTo,\r\n\t\twormhole: wormhole,\r\n\t\tformattedType: (wormhole[wormhole.parent+\"ID\"] == sig.id ? wormholeTypeText : (wormhole.parent ? \"[\" + wormholeTypeText + \"]\" : \"\")),\r\n\t\tlifeText: { critical: 'EOL', stable: 'Stable' }[wormhole.life] || wormhole.life,\r\n\t}\r\n}\r\n\r\ntripwire.addSig = function(add, option, disabled) {\r\n    var option = option || {};\r\n    var animate = typeof(option.animate) !== 'undefined' ? option.animate : true;\r\n    var disabled = disabled || false;\r\n    var wormhole = {};\r\n\r\n\tconst returnLinkText = add.signatureID ? '<a class=\"return-link\" href=\"#\" onclick=\"tripwire.setReturnSig(event, ' + add.id + ')\">&gt;&gt; Set ' + \r\n\t\t\t\tadd.signatureID.substring(0, 3).toUpperCase() + '-' + add.signatureID.substring(3) +\r\n\t\t\t\t' as return</a>'\r\n\t\t\t\t: '';\r\n\r\n    if (add.type == \"wormhole\") {\r\n\t\tconst sigInfo = tripwire.makeSigInfo(add);\r\n\t\tif(!sigInfo) return false;\r\n\t\t\r\n\t\twormhole = sigInfo.wormhole;\r\n\t\t\r\n\t\tconst leadsToText = sigInfo.leadsTo ? sigInfo.leadsTo : \r\n\t\t\tadd.signatureID && add.signatureID.length && add.signatureID[0] != '?' ? returnLinkText\r\n\t\t\t: '';\t\r\n\r\n        var row = \"<tr data-id='\"+add.id+\"' data-tooltip='' \"+ (disabled ? 'disabled=\"disabled\"' : '') +\">\"\r\n            + \"<td class='\"+ options.signatures.alignment.sigID +\"'>\"+formatSignatureID(add.signatureID)+\"</td>\"\r\n            + \"<td class='type-tooltip \"+ options.signatures.alignment.sigType +\"' data-tooltip=\\\"\"+this.whTooltip(wormhole)+\"\\\">\"+sigInfo.formattedType+\"</td>\"\r\n            + \"<td class='age-tooltip \"+ options.signatures.alignment.sigAge + (parseInt(add.lifeLength) === 0 ? \" disabled\" : \"\") +\"' data-tooltip='\"+this.ageTooltip(add)+\"'><span data-age='\"+add.lifeTime+\"'></span></td>\"\r\n            + \"<td class='\"+ options.signatures.alignment.leadsTo +\"'>\"+leadsToText+\"</td>\"\r\n            + \"<td class='\"+wormhole.life+\" \"+ options.signatures.alignment.sigLife +\"'>\"+sigInfo.lifeText+\"</td>\"\r\n            + \"<td class='\"+wormhole.mass+\" \"+ options.signatures.alignment.sigMass +\"'>\"+wormhole.mass+\"</td>\"\r\n            + \"</tr>\";\r\n\r\n        var tr = $(row);\r\n    } else {\r\n\t\tconst leadsToText = add.type === 'unknown' ? returnLinkText : \r\n\t\t\t(add.name ? linkSig(add.name) : '');\r\n        var row = \"<tr data-id='\"+add.id+\"' data-tooltip='' \"+ (disabled ? 'disabled=\"disabled\"' : '') +\">\"\r\n            + \"<td class='\"+ options.signatures.alignment.sigID +\"'>\"+formatSignatureID(add.signatureID)+\"</td>\"\r\n            + \"<td class='\"+ options.signatures.alignment.sigType +\"'>\"+add.type+\"</td>\"\r\n            + \"<td class='age-tooltip \"+ options.signatures.alignment.sigAge + (parseInt(add.lifeLength) === 0 ? \" disabled\" : \"\") +\"' data-tooltip='\"+this.ageTooltip(add)+\"'><span data-age='\"+add.lifeTime+\"'></span></td>\"\r\n            + \"<td class='\"+ options.signatures.alignment.leadsTo +\"' colspan='3'>\"+leadsToText+\"</td>\"\r\n            + \"</tr>\";\r\n\r\n        var tr = $(row);\r\n    }\r\n\r\n    Tooltips.attach($(tr).find(\"[data-tooltip]\"));\r\n\r\n    $(\"#sigTable\").append(tr);\r\n\r\n    // Add counter\r\n    if (wormhole.life == \"critical\") {\r\n        $(tr).find('span[data-age]').countdown({until: moment.utc(add.lifeLeft).toDate(), onExpiry: this.pastEOL, alwaysExpire: true, compact: true, format: this.ageFormat, serverSync: this.serverTime.getTime})\r\n            // .countdown('pause')\r\n            .addClass('critical')\r\n            // .countdown('resume');\r\n    } else {\r\n        $(tr).find('span[data-age]').countdown({since: moment.utc(add.lifeTime).toDate(), compact: true, format: this.ageFormat, serverSync: this.serverTime.getTime});\r\n    }\r\n\r\n    if (animate) {\r\n        $(tr)\r\n            .find('td')\r\n            .wrapInner('<div class=\"hidden\" />')\r\n            .parent()\r\n            .find('td > div')\r\n            .slideDown(700, function(){\r\n                $set = $(this);\r\n                $set.replaceWith($set.contents());\r\n            });\r\n\r\n        $(tr).find(\"td\").animate({backgroundColor: \"#004D16\"}, 1000).delay(1000).animate({backgroundColor: \"#111\"}, 1000, null, function() {$(this).css({backgroundColor: \"\"});});\r\n    }\r\n}\r\n\r\ntripwire.setReturnSig = function(event, sigToRemoveId) {\r\n\tevent.preventDefault();\r\n\tconst sigToUpdate = tripwire.signatures.returnSig;\r\n\tconst sigToRemove = tripwire.client.signatures[sigToRemoveId];\r\n\t\r\n\tif(!(sigToUpdate && sigToRemove)) { return; }\r\n\t\r\n\tsigDialog.overwriteSignature(sigToRemoveId, function(data) {\r\n\t\tsigToUpdate.signatureID = sigToRemove.signatureID;\r\n\t\t// we need the wormhole part to make refresh.php not think the sig isn't a wormhole any more\r\n\t\tconst payload = {\"signatures\": {\"update\": [ { wormhole: 'dummy', signatures: [ sigToUpdate ] } ] }};\r\n\t\ttripwire.refresh('refresh', payload);\r\n\t});\r\n}","// Handles API updates\ntripwire.API = function() {\n    this.indicator;\n    this.APIrefresh;\n\n    this.API.expire = function() {\n        var options = {since: tripwire.API.APIrefresh, until: null, format: \"MS\", layout: \"-{mnn}{sep}{snn}\"};\n        $(\"#APItimer\").countdown(\"option\", options);\n    }\n\n    this.API.refresh = function() {\n        $.ajax({\n            url: \"api_update.php\",\n            cache: false,\n            dataType: \"JSON\",\n            data: \"indicator=\"+tripwire.API.indicator\n        }).done(function(data) {\n            if (data && data.APIrefresh) {\n                tripwire.API.indicator = data.indicator;\n                tripwire.API.APIrefresh = new Date(data.APIrefresh);\n                activity.refresh(); //Refresh graph\n\n                var options = {until: tripwire.API.APIrefresh, since: null, layout: \"{mnn}{sep}{snn}\"};\n                $(\"#APItimer\").countdown(\"option\", options);\n                setTimeout(\"tripwire.API.refresh();\", $.countdown.periodsToSeconds($(\"#APItimer\").countdown('getTimes')) - 30);\n            } else if ($(\"#APItimer\").countdown(\"option\", \"layout\") !== \"-{mnn}{sep}{snn}\" && $.countdown.periodsToSeconds($(\"#APItimer\").countdown('getTimes')) > 120) {\n                setTimeout(\"tripwire.API.refresh();\", ($.countdown.periodsToSeconds($(\"#APItimer\").countdown('getTimes')) - 30) * 1000);\n            } else {\n                setTimeout(\"tripwire.API.refresh();\", 15000);\n            }\n        });\n    }\n\n    this.API.init = function() {\n        $.ajax({\n            url: \"api_update.php\",\n            cache: true,\n            dataType: \"JSON\",\n            data: \"init=true\"\n        }).done(function(data) {\n            tripwire.API.indicator = data.indicator;\n            tripwire.API.APIrefresh = new Date(data.APIrefresh);\n\n            $(\"#APItimer\").countdown({until: tripwire.API.APIrefresh, onExpiry: tripwire.API.expire, alwaysExpire: true, compact: true, format: \"MS\", serverSync: tripwire.serverTime.getTime, onTick: function(t) { $(\"#APIclock\").val(t[5] + 1).trigger(\"change\"); }})\n            var timer = $(\"#APItimer\").countdown(\"option\", \"layout\") === \"-{mnn}{sep}{snn}\" ? 15 : $.countdown.periodsToSeconds($(\"#APItimer\").countdown('getTimes')) - 30;\n            setTimeout(\"tripwire.API.refresh();\", timer * 1000);\n        });\n    }\n\n    this.API.init();\n}\n// tripwire.API();\n","const automapState = {\r\n\tpendingDecision: false\r\n};\r\n\r\ntripwire.autoMapper = function(from, to) {\r\n    var pods = [33328, 670];\r\n    var undo = [];\r\n\t\r\n    // Convert from & to from system name to system ID for diagnostic testing\r\n    // from = viewingSystemID;\r\n    // to = Object.index(tripwire.systems, 'name', to);\r\n\r\n    // Make sure the automapper is turned on & not disabled\r\n    if (!$(\"#toggle-automapper\").hasClass(\"active\") || $(\"#toggle-automapper\").hasClass(\"disabled\"))\r\n        return false;\r\n\r\n\t// Not waiting on a decision for the previous jump\r\n\tif(automapState.pendingDecision) {\r\n\t\tconsole.info('Not automapping because there is an automap dialog up');\r\n\t\treturn false;\r\n\t}\r\n\r\n    // Make sure from and to are valid systems\r\n    if (!tripwire.systems[from] || !tripwire.systems[to])\r\n        return false;\r\n\r\n    // Make sure from and to are not the same system\r\n    if (from == to)\r\n        return false;\r\n\t\r\n\t// Not into a special region e.g. abyssal space\r\n\tif(tripwire.systems[from].regionID > 12000000 || tripwire.systems[to].regionID > 12000000) {\r\n\t\tconsole.info('Not automapping into abyssal or other special space');\r\n\t\treturn false;\r\n\t}\r\n\t\r\n\t// Not into a special system\r\n\tconst noMapSystems = [30000142, 30002187];\t// Jita/Amarr\r\n\tif(noMapSystems.indexOf(from) >= 0 || noMapSystems.indexOf(to) >= 0) {\t\r\n\t\tconsole.info('Not automapping into likely pod-out destination');\r\n\t\treturn false;\r\n\t}\r\n\r\n    // Is pilot in a station?\r\n    if (tripwire.client.EVE && tripwire.client.EVE.stationID)\r\n        return false;\r\n\r\n    // Is pilot in a pod?\r\n    if (tripwire.client.EVE && tripwire.client.EVE.shipTypeID && $.inArray(parseInt(tripwire.client.EVE.shipTypeID), pods) >= 0)\r\n         return false;\r\n\r\n    // Is this a gate?\r\n    if (typeof(tripwire.map.shortest[from - 30000000]) != \"undefined\" && typeof(tripwire.map.shortest[from - 30000000][to - 30000000]) != \"undefined\")\r\n        return false;\r\n\r\n     // Is this an existing connection?\r\n     if ($.map(tripwire.client.wormholes,\r\n               function(wormhole) {\r\n                 const initial = tripwire.client.signatures[wormhole.initialID];\r\n                 const secondary = tripwire.client.signatures[wormhole.secondaryID];\r\n                 return initial && secondary &&\r\n                   ((initial.systemID == from && secondary.systemID == to) ||\r\n                    (initial.systemID == to && secondary.systemID == from))  ? wormhole : null;\r\n               }).length > 0) {\r\n       return false;\r\n     }\r\n\t \r\n\t // Are both systems already in chain? Loops do happen but it's much more likely ESI missed a jump\r\n\t function inChain(systemID) { return chain.data.map.rows.filter(r => r.c[0].systemID == systemID).length > 0; }\r\n\tif(inChain(from) && inChain(to)) {\r\n\t\tconsole.info('Not automapping because both systems are already in chain');\r\n\t\treturn false;\r\n\t}\t \r\n\r\n    var payload = {\"signatures\": {\"add\": [], \"update\": []}};\r\n    var sig, toClass;\r\n\r\n    if (tripwire.systems[to].class)\r\n        toClass = \"Class-\" + tripwire.systems[to].class;\r\n    else if (tripwire.systems[to].security >= 0.45)\r\n        toClass = \"High-Sec\";\r\n    else if (tripwire.systems[to].security > 0)\r\n        toClass = \"Low-Sec\";\r\n    else\r\n        toClass = \"Null-Sec\";\r\n\r\n    var wormholes = $.map(tripwire.client.wormholes, function(wormhole) {\r\n        if ( ( tripwire.client.signatures[wormhole.initialID] !== undefined ) && ( tripwire.client.signatures[wormhole.secondaryID] !== undefined ) ) {\r\n            // Find wormholes that have no set Leads To system, and their initial system is from the wormhole we just jumped from\r\n            if (tripwire.client.signatures[wormhole.initialID].systemID == from && !tripwire.systems[tripwire.client.signatures[wormhole.secondaryID].systemID]) {\r\n                if (appData.genericSystemTypes[tripwire.client.signatures[wormhole.secondaryID].systemID] == toClass) {\r\n                    // Find wormholes that Leads To is generically set to the class we just jumped into\r\n                    return wormhole;\r\n                } else if (wormhole.type && appData.wormholes[wormhole.type] && appData.wormholes[wormhole.type].leadsTo.replace(' ', '-') == toClass) {\r\n                    // Find wormholes that Type is known to lead to the class we just jumped into\r\n                    return wormhole;\r\n                } else if (tripwire.client.signatures[wormhole.secondaryID].systemID === null && (!wormhole.type || !appData.wormholes[wormhole.type])) {\r\n                    // Find wormholes that don't have a Type or any kind of Leads To entered\r\n                    return wormhole;\r\n                }\r\n            }\r\n        }\r\n    });\r\n\r\n    if (wormholes.length) {\r\n        if (wormholes.length > 1) {\r\n            $(\"#dialog-select-signature\").dialog({\r\n                autoOpen: true,\r\n                title: \"Which Signature?\",\r\n                width: 390,\r\n                buttons: {\r\n                    Cancel: function() {\r\n                        $(this).dialog(\"close\");\r\n                    },\r\n                    Ok: function() {\r\n                        var i = $(\"#dialog-select-signature [name=sig]:checked\").val();\r\n                        var wormhole = wormholes[i];\r\n                        var signature = tripwire.client.signatures[wormhole.initialID];\r\n                        var signature2 = tripwire.client.signatures[wormhole.secondaryID];\r\n\r\n                        payload.signatures.update.push({\r\n                            \"wormhole\": {\r\n                                \"id\": wormhole.id\r\n                            },\r\n                            \"signatures\": [\r\n                                {\r\n                                    \"id\": signature.id\r\n                                },\r\n                                {\r\n                                    \"id\": signature2.id,\r\n                                    \"systemID\": to\r\n                                }\r\n                            ]\r\n                        });\r\n\r\n                        var success = function(data) {\r\n                            if (data.resultSet && data.resultSet[0].result == true) {\r\n                                undo.push({\"wormhole\": wormhole, \"signatures\": [signature, signature2]});\r\n                                $(\"#dialog-select-signature\").dialog(\"close\");\r\n                            }\r\n                        }\r\n\r\n                        tripwire.refresh('refresh', payload, success);\r\n                    }\r\n                },\r\n                open: function() {\r\n\t\t\t\t\tautomapState.pendingDecision = true;\r\n                    $(\"#dialog-select-signature .optionsTable tbody\").empty();\r\n\t\t\t\t\t\r\n\t\t\t\t\tfunction formatSystem(systemID) {\r\n\t\t\t\t\t\tconst system = systemAnalysis.analyse(systemID);\r\n\t\t\t\t\t\treturn systemRendering.renderSystem(system);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tdocument.getElementById('select-sig-from').innerHTML = formatSystem(from);\r\n\t\t\t\t\tdocument.getElementById('select-sig-to').innerHTML = formatSystem(to);\r\n\r\n                    $.each(wormholes, function(i) {\r\n                        const signature = tripwire.client.signatures[wormholes[i].initialID];\r\n\t\t\t\t\t\tconst sigInfo = tripwire.makeSigInfo(signature, wormholes[i]);\r\n\t\t\t\t\t\t\r\n                        const tr = \"<tr>\"\r\n                          + \"<td><input type='radio' name='sig' value='\"+i+\"' id='sig\"+i+\"' /></td>\"\r\n\t\t\t\t\t\t  + \"<td class='centerAlign'>\" + formatSignatureID(signature.signatureID) + \"</td>\"\r\n\t\t\t\t\t\t  + \"<td class='centerAlign'>\" + sigInfo.formattedType + \"</td>\"\r\n\t\t\t\t\t\t  + \"<td class='centerAlign'>\" + sigInfo.leadsTo + \"</td>\"\r\n\t\t\t\t\t\t  + \"<td class='centerAlign \" + wormholes[i].life + \"'>\" + sigInfo.lifeText + \"</td>\"\r\n\t\t\t\t\t\t  + \"<td class='centerAlign \" + wormholes[i].mass + \"'>\" + wormholes[i].mass + \"</td>\"\r\n                          + \"</tr>\";\r\n\t\t\t\t\t\t  \r\n\t\t\t\t\t\tconst trElem = $(tr);\r\n                        $(trElem).find('td').wrapInner(\"<label for='sig\"+i+\"' />\");\r\n                        $(\"#dialog-select-signature .optionsTable tbody\").append(trElem);\r\n                    });\r\n                }, close: function() {\r\n\t\t\t\t\tautomapState.pendingDecision = false;\r\n\t\t\t\t}\r\n            });\r\n        } else {\r\n            var wormhole = wormholes[0];\r\n            var signature = tripwire.client.signatures[wormhole.initialID];\r\n            var signature2 = tripwire.client.signatures[wormhole.secondaryID];\r\n\r\n            payload.signatures.update.push({\r\n                \"wormhole\": {\r\n                    \"id\": wormhole.id\r\n                },\r\n                \"signatures\": [\r\n                    {\r\n                        \"id\": signature.id\r\n                    },\r\n                    {\r\n                        \"id\": signature2.id,\r\n                        \"systemID\": to\r\n                    }\r\n                ]\r\n            });\r\n            undo.push({\"wormhole\": wormhole, \"signatures\": [signature, signature2]});\r\n        }\r\n    } else {\r\n        // Nothing matches, create a new wormhole\r\n        payload.signatures.add.push({\r\n            \"wormhole\": {\r\n                \"type\": null,\r\n                \"parent\": \"initial\",\r\n                \"life\": \"stable\",\r\n                \"mass\": \"stable\"\r\n            },\r\n            \"signatures\": [\r\n                {\r\n                    \"systemID\": from,\r\n                    \"type\": \"wormhole\"\r\n                },\r\n                {\r\n                    \"systemID\": to,\r\n                    \"type\": \"wormhole\"\r\n                }\r\n            ]\r\n        });\r\n    }\r\n\r\n    if (payload.signatures.add.length || payload.signatures.update.length) {\r\n        var success = function(data) {\r\n            if (data.resultSet && data.resultSet[0].result == true) {\r\n                $(\"#undo\").removeClass(\"disabled\");\r\n\r\n                if (data.results) {\r\n                    if (viewingSystemID in tripwire.signatures.undo) {\r\n                        tripwire.signatures.undo[viewingSystemID].push({action: \"add\", signatures: data.results});\r\n                    } else {\r\n                        tripwire.signatures.undo[viewingSystemID] = [{action: \"add\", signatures: data.results}];\r\n                    }\r\n                }\r\n\r\n                if (undo.length) {\r\n                    if (viewingSystemID in tripwire.signatures.undo) {\r\n                        tripwire.signatures.undo[viewingSystemID].push({action: \"update\", signatures: undo});\r\n                    } else {\r\n                        tripwire.signatures.undo[viewingSystemID] = [{action: \"update\", signatures: undo}];\r\n                    }\r\n                }\r\n\r\n                sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\r\n            }\r\n        }\r\n\r\n        tripwire.refresh('refresh', payload, success);\r\n    }\r\n}\r\n","$(\"body\").on(\"dblclick\", \".comment\", function(e) {\r\n\te.preventDefault();\r\n\tdocument.getSelection().removeAllRanges();\r\n\t$(this).find(\".commentEdit\").click();\r\n})\r\n\r\n$(\"body\").on(\"click\", \".commentEdit\", function(e) {\r\n\te.preventDefault();\r\n\r\n\t// Prevent multiple editors\r\n\tif ($(\".cke\").length) return false;\r\n\r\n\tvar $comment = $(this).closest(\".comment\");\r\n\r\n\t$comment.find(\".commentToolbar\").hide();\r\n\r\n\tCKEDITOR.replace($comment.find(\".commentBody\").attr(\"id\"), CKConfig).on(\"instanceReady\", function() {\r\n\t\t$comment.find(\".commentStatus\").html(\"\");\r\n\t\t$comment.find(\".commentFooter\").show();\r\n\t\t$comment.find(\".commentFooter .commentControls\").show();\r\n\t});\r\n\r\n\ttripwire.activity.editComment = $comment.data(\"id\");\r\n\ttripwire.refresh('refresh');\r\n});\r\n\r\n$(\"body\").on(\"click\", \".commentSave, .commentCancel\", function(e) {\r\n\te.preventDefault();\r\n\tvar $this = $(this);\r\n\tif ($this.attr(\"disabled\")) return false;\r\n\r\n\tvar $comment = $this.closest(\".comment\");\r\n\t$this.attr(\"disabled\", \"true\");\r\n\r\n\tif ($this.hasClass(\"commentSave\")) {\r\n\t\tvar data = {\"mode\": \"save\", \"commentID\": $comment.data(\"id\"), \"systemID\": $comment.find(\".commentSticky\").hasClass(\"active\") ? 0 : viewingSystemID, \"comment\": CKEDITOR.instances[$comment.find(\".commentBody\").attr(\"id\")].getData()};\r\n\r\n\t\t$.ajax({\r\n\t\t\turl: \"comments.php\",\r\n\t\t\ttype: \"POST\",\r\n\t\t\tdata: data,\r\n\t\t\tdataType: \"JSON\"\r\n\t\t}).done(function(data) {\r\n\t\t\tif (data && data.result == true) {\r\n\t\t\t\t$comment.find(\".commentModified\").html(\"Edited by \" + data.comment.modifiedByName + \" at \" + data.comment.modifiedDate);\r\n\t\t\t\t$comment.find(\".commentCreated\").html(\"Posted by \" + data.comment.createdByName + \" at \" + data.comment.createdDate);\r\n\t\t\t\tTooltips.attach($comment.find(\"[data-tooltip]\"));\r\n\r\n\t\t\t\tCKEDITOR.instances[$comment.find(\".commentBody\").attr(\"id\")].destroy(false);\r\n\t\t\t\t$comment.attr(\"data-id\", data.comment.id);\r\n\t\t\t\t$comment.find(\".commentToolbar\").show();\r\n\t\t\t\t$comment.find(\".commentFooter\").hide();\r\n\t\t\t\t$this.removeAttr(\"disabled\");\r\n\t\t\t}\r\n\t\t});\r\n\t} else {\r\n\t\tCKEDITOR.instances[$comment.find(\".commentBody\").attr(\"id\")].destroy(true);\r\n\r\n\t\tif (!$comment.attr(\"data-id\")) {\r\n\t\t\t$comment.remove();\r\n\t\t} else {\r\n\t\t\t$comment.find(\".commentToolbar\").show();\r\n\t\t\t$comment.find(\".commentFooter\").hide();\r\n\t\t\t$this.removeAttr(\"disabled\");\r\n\t\t}\r\n\t}\r\n\r\n\t$comment.find(\".commentStatus\").html(\"\");\r\n\r\n\tdelete tripwire.activity.editComment;\r\n\ttripwire.refresh('refresh');\r\n});\r\n\r\n$(\"body\").on(\"click\", \".commentDelete\", function(e) {\r\n\te.preventDefault();\r\n\tvar $comment = $(this).closest(\".comment\");\r\n\r\n\t// check if dialog is open\r\n\tif (!$(\"#dialog-deleteComment\").hasClass(\"ui-dialog-content\")) {\r\n\t\t$(\"#dialog-deleteComment\").data(\"comment\", $comment).dialog({\r\n\t\t\tresizable: false,\r\n\t\t\tminHeight: 0,\r\n\t\t\tposition: {my: \"center\", at: \"center\", of: $(\"#notesWidget\")},\r\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\r\n\t\t\tbuttons: {\r\n\t\t\t\tDelete: function() {\r\n\t\t\t\t\t// Prevent duplicate submitting\r\n\t\t\t\t\t$(\"#dialog-deleteComment\").parent().find(\":button:contains('Delete')\").button(\"disable\");\r\n\r\n\t\t\t\t\tvar $comment = $(this).data(\"comment\");\r\n\t\t\t\t\tvar data = {\"mode\": \"delete\", \"commentID\": $comment.data(\"id\")};\r\n\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: \"comments.php\",\r\n\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\tdata: data,\r\n\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t}).done(function(data) {\r\n\t\t\t\t\t\tif (data && data.result == true) {\r\n\t\t\t\t\t\t\t$(\"#dialog-deleteComment\").dialog(\"close\");\r\n\t\t\t\t\t\t\t$comment.remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).always(function() {\r\n\t\t\t\t\t\t$(\"#dialog-deleteComment\").parent().find(\":button:contains('Delete')\").button(\"enable\");\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tCancel: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t} else if (!$(\"#dialog-deleteComment\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-deleteComment\").data(\"comment\", $comment).dialog(\"open\");\r\n\t}\r\n});\r\n\r\n$(\"body\").on(\"click\", \"#add-comment\", function(e) {\r\n\te.preventDefault();\r\n\r\n\t// Prevent multiple editors\r\n\tif ($(\".cke\").length) return false;\r\n\r\n\tvar $comment = $(\".comment:last\").clone();\r\n\tvar commentID = $(\".comment:visible:last .commentBody\").attr(\"id\") ? $(\".comment:visible:last .commentBody\").attr(\"id\").replace(\"comment\", \"\") + 1 : 0;\r\n\t$(\".comment:last\").before($comment);\r\n\r\n\t$comment.find(\".commentBody\").attr(\"id\", \"comment\" + commentID);\r\n\t$comment.removeClass(\"hidden\").find(\".commentEdit\").click();\r\n});\r\n\r\n$(\"body\").on(\"click\", \".commentSticky\", function(e) {\r\n\te.preventDefault();\r\n\tvar $comment = $(this).closest(\".comment\");\r\n\r\n\tvar data = {\"mode\": \"sticky\", \"commentID\": $comment.data(\"id\"), \"systemID\": $comment.find(\".commentSticky\").hasClass(\"active\") ? viewingSystemID : 0};\r\n\r\n\t$.ajax({\r\n\t\turl: \"comments.php\",\r\n\t\ttype: \"POST\",\r\n\t\tdata: data,\r\n\t\tdataType: \"JSON\"\r\n\t}).done(function(data) {\r\n\t\tif (data && data.result == true) {\r\n\t\t\t$comment.find(\".commentSticky\").hasClass(\"active\") ? $comment.find(\".commentSticky\").removeClass(\"active\") : $comment.find(\".commentSticky\").addClass(\"active\");\r\n\t\t}\r\n\t});\r\n});\r\n\r\nfunction commentSortHandler(sortOrder) {\r\n\tconst sortElem = document.getElementById('comment-sort');\r\n\tconst containerElem = document.getElementById('comment-container');\r\n\tsortOrder = sortOrder || sortElem.nextSort || getCookie('commentSort') || 'asc';\r\n\t\r\n\tswitch(sortOrder) {\r\n\t\tcase 'asc':\r\n\t\t\tsortElem.nextSort = 'desc';\r\n\t\t\tsortElem.setAttribute('data-icon', 'sort-asc');\r\n\t\t\tcontainerElem.style.flexDirection = 'column';\r\n\t\t\tbreak;\r\n\t\tcase 'desc':\r\n\t\t\tsortElem.nextSort = 'asc';\r\n\t\t\tsortElem.setAttribute('data-icon', 'sort-desc');\r\n\t\t\tcontainerElem.style.flexDirection = 'column-reverse';\r\n\t\t\tbreak;\r\n\t\tdefault: throw 'sort order somehow wrong';\r\n\t}\r\n\t\r\n\tsetCookie('commentSort', sortOrder, 3650);\r\n}\r\n\r\n$(\"body\").on(\"click\", \"#comment-sort\", function(e) {\r\n\tcommentSortHandler(undefined);\r\n});\r\n\r\ncommentSortHandler();","// Handles removing from Signatures section\ntripwire.deleteSig = function(key) {\n    var tr = $(\"#sigTable tr[data-id='\"+key+\"']\");\n\n    //Append empty space to prevent non-coloring\n    $(tr).find('td:empty, a:empty').append(\"&nbsp;\");\n\n    $(tr)\n        .find('td')\n        .wrapInner('<div />')\n        .parent()\n        .find('td > div').animate({backgroundColor: \"#4D0000\"}, 1000).delay(1000).animate({backgroundColor: \"#111\"}, 1000)\n        .slideUp(700, function(){\n            // Remove countdown reference\n            $(tr).find('span[data-age]').countdown(\"destroy\");\n\n            $(this).parent().parent().remove();\n            $(\"#sigTable\").trigger(\"update\");\n        });\n}\n","// Handles changing Signatures section\r\n// ToDo: Use native JS\r\ntripwire.editSig = function(edit, disabled) {\r\n    var disabled = disabled || false;\r\n    var wormhole = {};\r\n\r\n    if (edit.type == \"wormhole\") {\r\n\t\tconst sigInfo = tripwire.makeSigInfo(edit);\t// see addSignature.js\r\n\t\tif(!sigInfo) return false;\r\n\t\t\r\n\t\twormhole = sigInfo.wormhole;\r\n\r\n        var row = \"<tr data-id='\"+edit.id+\"' data-tooltip='' \"+ (disabled ? 'disabled=\"disabled\"' : '') +\">\"\r\n            + \"<td class='\"+ options.signatures.alignment.sigID +\"'>\"+formatSignatureID(edit.signatureID)+\"</td>\"\r\n            + \"<td class='type-tooltip \"+ options.signatures.alignment.sigType +\"' data-tooltip=\\\"\"+this.whTooltip(wormhole)+\"\\\">\"+sigInfo.formattedType+\"</td>\"\r\n            + \"<td class='age-tooltip \"+ options.signatures.alignment.sigAge + (parseInt(edit.lifeLength) === 0 ? \" disabled\" : \"\") +\"' data-tooltip='\"+this.ageTooltip(edit)+\"'><span data-age='\"+edit.lifeTime+\"'></span></td>\"\r\n            + \"<td class='\"+ options.signatures.alignment.leadsTo +\"'>\"+(sigInfo.leadsTo || \"\")+\"</td>\"\r\n            + \"<td class='\"+wormhole.life+\" \"+ options.signatures.alignment.sigLife +\"'>\"+sigInfo.lifeText+\"</td>\"\r\n            + \"<td class='\"+wormhole.mass+\" \"+ options.signatures.alignment.sigMass +\"'>\"+wormhole.mass+\"</td>\"\r\n            + \"</tr>\";\r\n\r\n        var tr = $(row);\r\n    } else {\r\n        var row = \"<tr data-id='\"+edit.id+\"' data-tooltip='' \"+ (disabled ? 'disabled=\"disabled\"' : '') +\">\"\r\n            + \"<td class='\"+ options.signatures.alignment.sigID +\"'>\"+formatSignatureID(edit.signatureID)+\"</td>\"\r\n            + \"<td class='\"+ options.signatures.alignment.sigType +\"'>\"+edit.type+\"</td>\"\r\n            + \"<td class='age-tooltip \"+ options.signatures.alignment.sigAge + (parseInt(edit.lifeLength) === 0 ? \" disabled\" : \"\") +\"' data-tooltip='\"+this.ageTooltip(edit)+\"'><span data-age='\"+edit.lifeTime+\"'></span></td>\"\r\n            + \"<td class='\"+ options.signatures.alignment.leadsTo +\"' colspan='3'>\"+(edit.name?linkSig(edit.name):'')+\"</td>\"\r\n            + \"</tr>\";\r\n\r\n        var tr = $(row);\r\n    }\r\n\r\n    Tooltips.attach($(tr).find(\"[data-tooltip]\"));\r\n\r\n    // Destroy the pervious countdown to prevent errors on a non-existant DOM element\r\n    $(\"#sigTable tr[data-id='\"+edit.id+\"']\").find('span[data-age]').countdown(\"destroy\");\r\n    $(\"#sigTable tr[data-id='\"+edit.id+\"']\").replaceWith(tr);\r\n\r\n    $(\"#sigTable\").trigger(\"update\");\r\n    // Update counter\r\n    if (wormhole.life == \"critical\") {\r\n        $(tr).find('span[data-age]').countdown({until: moment.utc(edit.lifeLeft).toDate(), onExpiry: this.pastEOL, alwaysExpire: true, compact: true, format: this.ageFormat, serverSync: this.serverTime.getTime})\r\n            .addClass('critical');\r\n    } else {\r\n        $(tr).find('span[data-age]').countdown({since: moment.utc(edit.lifeTime).toDate(), compact: true, format: this.ageFormat, serverSync: this.serverTime.getTime});\r\n    }\r\n\r\n    $(tr).effect(\"pulsate\");\r\n}\r\n","tripwire.esi = function() {\r\n    var baseUrl = \"https://esi.evetech.net\";\r\n    var userAgent = \"Tripwire Client \" + tripwire.version + \" (\" + window.location.hostname + \") - \" + window.navigator.userAgent;\r\n    var locationTimer, shipTimer, onlineTimer;\r\n    this.esi.connection = true;\r\n    this.esi.characters = {};\r\n    this.esi.oauth = { subject: \"\", accessToken: \"\"};\r\n\r\n    var scopeError = function(characterID) {\r\n        $(\"#tracking .tracking-clone[data-characterid='\"+ characterID +\"']\").find(\".alert\").show();\r\n    }\r\n\r\n\tvar isExpired = function(tokenExpire) {\r\n\t\treturn moment.utc(tokenExpire).subtract(5, \"minutes\").isBefore(moment());\r\n\t}\r\n\r\n    this.esi.location = function() {\r\n        clearTimeout(locationTimer);\r\n\r\n        for (characterID in tripwire.esi.characters) {\r\n            var character = tripwire.esi.characters[characterID];\r\n\r\n            // Check for expiring token\r\n            if (isExpired(character.tokenExpire)) {\r\n                tripwire.data.esi = {\"expired\": true};\r\n                continue;\r\n            }\r\n\r\n            const xhr = $.ajax({\r\n                url: baseUrl + \"/v1/characters/\"+ characterID +\"/location/?\" + $.param({\"token\": character.accessToken, \"user_agent\": userAgent}),\r\n                // headers: {\"Authorization\": \"Bearer \"+ character.accessToken, \"X-User-Agent\": userAgent},\r\n                type: \"GET\",\r\n                dataType: \"JSON\",\r\n                characterID: characterID\r\n            }).done(function(data, status, jqXHR) {\r\n                var character = tripwire.esi.characters[this.characterID];\r\n\r\n                if (character) {\r\n                    character.locationDate = moment(jqXHR.getResponseHeader(\"last-modified\"), \"ddd, DD MMMM YYYY HH:mm:ss\").format();\r\n\r\n                    if (character.systemID != data.solar_system_id) {\r\n                        character.systemID = data.solar_system_id || null;\r\n\t\t\t\t\t\tconst system = systemAnalysis.analyse(data.solar_system_id);\r\n                        character.systemName = system ? system.name : null;\r\n\r\n                        $(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"']\").find(\".system\").html(systemRendering.renderSystem(system) || \"&nbsp;\");\r\n\r\n                        // Send to Tripwire server on next refresh call\r\n                        tripwire.data.tracking[this.characterID] = {\r\n                            characterID: character.characterID,\r\n                            characterName: character.characterName,\r\n                            systemID: character.systemID,\r\n                            systemName: character.systemName,\r\n                            stationID: character.stationID,\r\n                            stationName: character.stationName,\r\n                            shipID: character.shipID,\r\n                            shipName: character.shipName,\r\n                            shipTypeID: character.shipTypeID,\r\n                            shipTypeName: character.shipTypeName};\r\n                    }\r\n\r\n                    if (character.stationID != data.station_id) {\r\n                        character.stationID = data.station_id || null;\r\n\r\n                        if (data.station_id) {\r\n                            tripwire.esi.stationLookup(data.station_id, this.characterID)\r\n                                .always(function(data) {\r\n                                    var character = tripwire.esi.characters[this.reference];\r\n\r\n                                    character.stationName = data.name || null;\r\n                                    $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference +\"']\").find(\".station\").html(data.name.substring(0, 17) + \"...\" || \"&nbsp;\").attr(\"data-tooltip\", data.name);\r\n                                    Tooltips.attach($(\"#tracking .tracking-clone[data-characterid='\"+ this.reference +\"'] .station[data-tooltip]\"));\r\n\r\n                                    // Send to Tripwire server on next refresh call\r\n                                    tripwire.data.tracking[this.reference] = {\r\n                                        characterID: character.characterID,\r\n                                        characterName: character.characterName,\r\n                                        systemID: character.systemID,\r\n                                        systemName: character.systemName,\r\n                                        stationID: character.stationID,\r\n                                        stationName: character.stationName,\r\n                                        shipID: character.shipID,\r\n                                        shipName: character.shipName,\r\n                                        shipTypeID: character.shipTypeID,\r\n                                        shipTypeName: character.shipTypeName};\r\n                                });\r\n                        } else {\r\n                            character.stationName = null;\r\n                            // $(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"']\").find(\".station\").html(\"&nbsp;\").attr(\"data-tooltip\", \"&nbsp;\");\r\n                            Tooltips.detach($(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"'] .station[data-tooltip]\"));\r\n\r\n                            // Send to Tripwire server on next refresh call\r\n                            tripwire.data.tracking[this.characterID] = {\r\n                                characterID: character.characterID,\r\n                                characterName: character.characterName,\r\n                                systemID: character.systemID,\r\n                                systemName: character.systemName,\r\n                                stationID: character.stationID,\r\n                                stationName: character.stationName,\r\n                                shipID: character.shipID,\r\n                                shipName: character.shipName,\r\n                                shipTypeID: character.shipTypeID,\r\n                                shipTypeName: character.shipTypeName};\r\n                        }\r\n                    }\r\n\r\n                    if (options.tracking.active == this.characterID) {\r\n                        tripwire.EVE(tripwire.esi.characters[options.tracking.active]);\r\n                    }\r\n                }\r\n            }).fail(function(data) {\r\n                if (data.status == 403) {\r\n                    tripwire.refresh(\"refresh\", {\"esi\": {\"expired\": true}});\r\n                }\r\n            }).always(function(data, status, jqXHR) {\r\n                if (status != \"success\" && status != \"abort\" && tripwire.esi.connection == true) {\r\n                    tripwire.esi.connection = false;\r\n                    $(\"#esiConnectionSuccess, #esiConnectionError\").click();\r\n                    Notify.trigger(\"ESI Connection Failed\", \"red\", false, \"esiConnectionError\");\r\n                } else if (status == \"success\" && tripwire.esi.connection == false) {\r\n                    tripwire.esi.connection = true;\r\n                    $(\"#esiConnectionSuccess, #esiConnectionError\").click();\r\n                    Notify.trigger(\"ESI Connection Resumed\", \"green\", 5000, \"esiConnectionSuccess\");\r\n                }\r\n            });\r\n            xhr.always(function(){\r\n                const warn = xhr.getResponseHeader('warning');\r\n                if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n            });\r\n        }\r\n\r\n        locationTimer = setTimeout(\"tripwire.esi.location()\", 5000);\r\n    }\r\n\r\n    this.esi.ship = function() {\r\n        clearTimeout(shipTimer);\r\n\r\n        for (characterID in tripwire.esi.characters) {\r\n            var character = tripwire.esi.characters[characterID];\r\n\r\n            // Check for expiring token\r\n            if (isExpired(character.tokenExpire)) {\r\n                tripwire.data.esi = {\"expired\": true};\r\n                continue;\r\n            }\r\n\r\n            const xhr = $.ajax({\r\n                url: baseUrl + \"/v1/characters/\"+ characterID +\"/ship/?\" + $.param({\"token\": character.accessToken, \"user_agent\": userAgent}),\r\n                // headers: {\"Authorization\": \"Bearer \"+ character.accessToken, \"X-User-Agent\": userAgent},\r\n                type: \"GET\",\r\n                dataType: \"JSON\",\r\n                characterID: characterID\r\n            }).done(function(data, status, jqXHR) {\r\n                var character = tripwire.esi.characters[this.characterID];\r\n\r\n                if (character) {\r\n                    character.shipDate = moment(jqXHR.getResponseHeader(\"last-modified\"), \"ddd, DD MMMM YYYY HH:mm:ss\").format();\r\n\r\n                    if (character.shipID != data.ship_item_id) {\r\n                        character.shipID = data.ship_item_id || null;\r\n\r\n                        // Send to Tripwire server on next refresh call\r\n                        tripwire.data.tracking[this.characterID] = {\r\n                            characterID: character.characterID,\r\n                            characterName: character.characterName,\r\n                            systemID: character.systemID,\r\n                            systemName: character.systemName,\r\n                            stationID: character.stationID,\r\n                            stationName: character.stationName,\r\n                            shipID: character.shipID,\r\n                            shipName: character.shipName,\r\n                            shipTypeID: character.shipTypeID,\r\n                            shipTypeName: character.shipTypeName};\r\n                    }\r\n\r\n                    if (character.shipName != data.ship_name) {\r\n                        character.shipName = data.ship_name || null;\r\n                        $(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"']\").find(\".shipname\").html(data.ship_name || \"&nbsp;\");\r\n\r\n                        // Send to Tripwire server on next refresh call\r\n                        tripwire.data.tracking[this.characterID] = {\r\n                            characterID: character.characterID,\r\n                            characterName: character.characterName,\r\n                            systemID: character.systemID,\r\n                            systemName: character.systemName,\r\n                            stationID: character.stationID,\r\n                            stationName: character.stationName,\r\n                            shipID: character.shipID,\r\n                            shipName: character.shipName,\r\n                            shipTypeID: character.shipTypeID,\r\n                            shipTypeName: character.shipTypeName};\r\n                    }\r\n\r\n                    if (character.shipTypeID != data.ship_type_id) {\r\n                        character.shipTypeID = data.ship_type_id || null;\r\n\r\n                        if (data.ship_type_id) {\r\n                            tripwire.esi.typeLookup(data.ship_type_id, this.characterID)\r\n                                .always(function(data) {\r\n                                    var character = tripwire.esi.characters[this.reference];\r\n\r\n                                    character.shipTypeName = data.name || null;\r\n                                    $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference +\"']\").find(\".ship\").html(data.name || \"&nbsp;\");\r\n\r\n                                    // Send to Tripwire server on next refresh call\r\n                                    tripwire.data.tracking[this.reference] = {\r\n                                        characterID: character.characterID,\r\n                                        characterName: character.characterName,\r\n                                        systemID: character.systemID,\r\n                                        systemName: character.systemName,\r\n                                        stationID: character.stationID,\r\n                                        stationName: character.stationName,\r\n                                        shipID: character.shipID,\r\n                                        shipName: character.shipName,\r\n                                        shipTypeID: character.shipTypeID,\r\n                                        shipTypeName: character.shipTypeName};\r\n                                });\r\n                        } else {\r\n                            character.shipTypeName = null;\r\n                            $(\"#tracking .tracking-clone[data-characterid='\"+ this.characterID +\"']\").find(\".ship\").html(\"&nbsp;\");\r\n\r\n                            // Send to Tripwire server on next refresh call\r\n                            tripwire.data.tracking[this.characterID] = {\r\n                                characterID: character.characterID,\r\n                                characterName: character.characterName,\r\n                                systemID: character.systemID,\r\n                                systemName: character.systemName,\r\n                                stationID: character.stationID,\r\n                                stationName: character.stationName,\r\n                                shipID: character.shipID,\r\n                                shipName: character.shipName,\r\n                                shipTypeID: character.shipTypeID,\r\n                                shipTypeName: character.shipTypeName};\r\n                        }\r\n                    }\r\n                }\r\n            }).fail(function(data) {\r\n                if (data.status == 403) {\r\n                    tripwire.refresh(\"refresh\", {\"esi\": {\"expired\": true}});\r\n                }\r\n            }).always(function(data, status, jqXHR) {\r\n                if (status != \"success\" && status != \"abort\" && tripwire.esi.connection == true) {\r\n                    tripwire.esi.connection = false;\r\n                    $(\"#esiConnectionSuccess, #esiConnectionError\").click();\r\n                    Notify.trigger(\"ESI Connection Failed\", \"red\", false, \"esiConnectionError\");\r\n                } else if (status == \"success\" && tripwire.esi.connection == false) {\r\n                    tripwire.esi.connection = true;\r\n                    $(\"#esiConnectionSuccess, #esiConnectionError\").click();\r\n                    Notify.trigger(\"ESI Connection Resumed\", \"green\", 5000, \"esiConnectionSuccess\");\r\n                }\r\n            });\r\n            xhr.always(function(){\r\n                const warn = xhr.getResponseHeader('warning');\r\n                if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n            });\r\n\r\n        }\r\n\r\n        shipTimer = setTimeout(\"tripwire.esi.ship()\", 5000);\r\n    }\r\n\r\n    this.esi.online = function() {\r\n        clearTimeout(onlineTimer);\r\n\r\n        for (characterID in tripwire.esi.characters) {\r\n            var character = tripwire.esi.characters[characterID];\r\n\r\n            tripwire.esi.characterStatus(character.characterID, character)\r\n                .done(function(data) {\r\n                    if (data.online) {\r\n                        $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference.characterID +\"']\").find(\".online\").removeClass(\"critical\").addClass(\"stable\");\r\n                    } else {\r\n                        $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference.characterID +\"']\").find(\".online\").removeClass(\"stable\").addClass(\"critical\");\r\n                    }\r\n                }).fail(function(data) {\r\n                    if (data && data.status == 403) {\r\n                        scopeError(this.reference.characterID);\r\n                    }\r\n                    $(\"#tracking .tracking-clone[data-characterid='\"+ this.reference.characterID +\"']\").find(\".online\").removeClass(\"stable\").addClass(\"critical\");\r\n                });\r\n        }\r\n\r\n        onlineTimer = setTimeout(\"tripwire.esi.online()\", 60000);\r\n    }\r\n\r\n    this.esi.typeLookup = function(typeID, reference) {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v3/universe/types/\"+ typeID +\"/?\" + $.param({\"user_agent\": userAgent}),\r\n            // headers: {\"X-User-Agent\": userAgent},\r\n            type: \"GET\",\r\n            dataType: \"JSON\",\r\n            reference: reference\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.stationLookup = function(stationID, reference) {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v2/universe/stations/\"+ stationID +\"/?\" + $.param({\"user_agent\": userAgent}),\r\n            // headers: {\"X-User-Agent\": userAgent},\r\n            type: \"GET\",\r\n            dataType: \"JSON\",\r\n            reference: reference\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.setDestination = function(destinationID, characterID, clear_waypoints, beginning) {\r\n        clear_waypoints = clear_waypoints ? clear_waypoints : false;\r\n        beginning = beginning ? beginning : false;\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v2/ui/autopilot/waypoint/?\" + $.param({destination_id: destinationID, clear_other_waypoints: clear_waypoints, add_to_beginning: beginning}),\r\n            headers: {\"Authorization\": \"Bearer \"+ tripwire.esi.characters[characterID].accessToken, \"X-User-Agent\": userAgent},\r\n            type: \"POST\",\r\n            dataType: \"JSON\"\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.showInfo = function(targetID, characterID) {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v1/ui/openwindow/information/?\" + $.param({target_id: targetID}),\r\n            headers: {\"Authorization\": \"Bearer \"+ tripwire.esi.characters[characterID].accessToken, \"X-User-Agent\": userAgent},\r\n            type: \"POST\",\r\n            dataType: \"JSON\"\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.characterStatus = function(characterID, reference) {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v2/characters/\" + characterID + \"/online/?\" + $.param({\"token\": tripwire.esi.characters[characterID].accessToken, \"user_agent\": userAgent}),\r\n            // headers: {\"Authorization\": \"Bearer \"+ tripwire.esi.characters[characterID].accessToken, \"X-User-Agent\": userAgent},\r\n            type: \"GET\",\r\n            dataType: \"JSON\",\r\n            reference: reference\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.eveStatus = function() {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v1/status/?\" + $.param({\"user_agent\": userAgent}),\r\n            // headers: {\"X-User-Agent\": userAgent},\r\n            type: \"GET\",\r\n            dataType: \"JSON\"\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.idLookup = function(eveIDs) {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v2/universe/names/?\" + $.param({\"user_agent\": userAgent}),\r\n            type: \"POST\",\r\n            dataType: \"JSON\",\r\n            contentType: \"application/json\",\r\n            processData: false,\r\n            data: JSON.stringify(eveIDs)\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.characterLookup = function(eveID, reference, async) {\r\n        var async = typeof(async) !== 'undefined' ? async : true;\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/latest/characters/\" + eveID + \"/?\" + $.param({\"user_agent\": userAgent}),\r\n            type: \"GET\",\r\n            dataType: \"JSON\",\r\n            async: async,\r\n            eveID: eveID,\r\n            reference: reference\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.corporationLookup = function(eveID, reference, async) {\r\n        var async = typeof(async) !== 'undefined' ? async : true;\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v4/corporations/\" + eveID + \"/?\" + $.param({\"user_agent\": userAgent}),\r\n            type: \"GET\",\r\n            dataType: \"JSON\",\r\n            async: async,\r\n            eveID: eveID,\r\n            reference: reference\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.allianceLookup = function(eveID, reference, async) {\r\n        var async = typeof(async) !== 'undefined' ? async : true;\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v3/alliances/\" + eveID + \"/?\" + $.param({\"user_agent\": userAgent}),\r\n            type: \"GET\",\r\n            dataType: \"JSON\",\r\n            async: async,\r\n            eveID: eveID,\r\n            reference: reference\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.search = function(searchString, categories, strict) {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/latest/characters/\" + tripwire.esi.oauth.subject + \"/search/?\" + $.param({\"user_agent\": userAgent}),\r\n            headers: {\"Authorization\": \"Bearer \"+ tripwire.esi.oauth.accessToken},\r\n            type: \"GET\",\r\n            dataType: \"JSON\",\r\n            contentType: \"application/json\",\r\n            data: {\"search\": searchString, \"categories\": categories, \"strict\": strict}\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.universeJumps = function() {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v1/universe/system_jumps/?\" + $.param({\"user_agent\": userAgent}),\r\n            type: \"GET\",\r\n            dataType: \"JSON\"\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    this.esi.universeKills = function() {\r\n        const xhr = $.ajax({\r\n            url: baseUrl + \"/v2/universe/system_kills/?\" + $.param({\"user_agent\": userAgent}),\r\n            type: \"GET\",\r\n            dataType: \"JSON\"\r\n        });\r\n        return xhr.always(function(){\r\n            const warn = xhr.getResponseHeader('warning');\r\n            if (warn) console.warn('ESI API Warning: ', warn, this.url);\r\n        });\r\n    }\r\n\r\n    // Wrapper to make lookups easier\r\n    this.esi.fullLookup = function(eveIDs) {\r\n        var promise = $.Deferred();\r\n\r\n        tripwire.esi.idLookup(eveIDs)\r\n            .done(function(data) {\r\n                for (item in data) {\r\n                    if (data[item].category == \"character\") {\r\n                        tripwire.esi.characterLookup(data[item].id, data[item], false)\r\n                            .done(function(characterData) {\r\n                                $.extend(data[item], characterData);\r\n                                tripwire.esi.corporationLookup(characterData.corporation_id, this.reference, false)\r\n                                    .done(function(corporationData) {\r\n                                        data[item].corporation = corporationData;\r\n                                        if (corporationData.alliance_id) {\r\n                                            tripwire.esi.allianceLookup(corporationData.alliance_id, this.reference, false)\r\n                                                .done(function(allianceData) {\r\n                                                    data[item].alliance = allianceData;\r\n                                                });\r\n                                        }\r\n                                    });\r\n                            });\r\n                    } else if (data[item].category == \"corporation\") {\r\n                        tripwire.esi.corporationLookup(data[item].id, data[item], false)\r\n                            .done(function(corporationData) {\r\n                                $.extend(data[item], corporationData);\r\n                                if (corporationData.alliance_id) {\r\n                                    tripwire.esi.allianceLookup(corporationData.alliance_id, this.reference, false)\r\n                                        .done(function(allianceData) {\r\n                                            data[item].alliance = allianceData;\r\n                                        });\r\n                                }\r\n                            })\r\n                    }\r\n                }\r\n\r\n                promise.resolve(data);\r\n            });\r\n\r\n        return promise;\r\n    }\r\n\r\n    // Parse main account oauth information out of refresh data. This is used\r\n    // to make authenticated ESI requests for enpoints that are not specific to\r\n    // tracking characters, e.g., mask access management.\r\n    this.esi.parseOauth = function(data) {\r\n        const _data = data || {}\r\n        tripwire.esi.oauth = {\r\n            subject: _data.subject,\r\n            accessToken: _data.accessToken\r\n        };\r\n    }\r\n\r\n    this.esi.parse = function(characters) {\r\n        for (characterID in tripwire.esi.characters) {\r\n            if (!(characterID in characters)) {\r\n                delete tripwire.esi.characters[characterID];\r\n                $(\"#tracking .tracking-clone[data-characterid='\"+ characterID +\"']\").remove();\r\n                if (options.tracking.active == characterID) {\r\n                    tripwire.EVE(false, true);\r\n                    $(\"#removeESI\").attr(\"disabled\", \"disabled\");\r\n                }\r\n            }\r\n        }\r\n\r\n        for (characterID in characters) {\r\n            if (options.tracking.active == \"new\") {\r\n                options.tracking.active = characterID;\r\n            }\r\n\r\n            if (!(characterID in tripwire.esi.characters)) {\r\n                var $clone = $(\"#tracking-clone\").clone();\r\n                $clone.attr(\"data-characterid\", characterID);\r\n                $clone.find(\".avatar img\").attr(\"src\", \"https://image.eveonline.com/Character/\"+ characterID +\"_32.jpg\");\r\n                $clone.find(\".name\").html(characters[characterID].characterName);\r\n                $clone.removeAttr(\"id\");\r\n                $clone.removeClass(\"hidden\");\r\n                $clone.addClass(\"tracking-clone\");\r\n\r\n                if (options.tracking.active == characterID) {\r\n                    $clone.addClass(\"active\");\r\n                    $(\"#removeESI\").removeAttr(\"disabled\");\t\t\t\t}\r\n\r\n                $(\"#tracking\").append($clone);\r\n                // Tooltips.attach($clone.find(\"[data-tooltip]\"));\r\n            }\r\n\r\n            tripwire.esi.characters[characterID] = characters[characterID];\r\n        }\r\n\t\t\r\n\t\tset_tracking_text();\r\n\r\n        tripwire.esi.ship();\r\n        tripwire.esi.location();\r\n        tripwire.esi.online();\r\n    }\r\n}\r\ntripwire.esi();\r\n","// Handles data from EVE in-game data\r\ntripwire.EVE = function(EVE, characterChange) {\r\n    var systemChange = this.client.EVE && this.client.EVE.systemChange || false;\r\n\r\n    if (EVE) {\r\n        // Automapper\r\n        if (!characterChange) {\r\n            // Did the system change or did it previously and we have yet to try an autoMapper call?\r\n            if ((this.client.EVE && this.client.EVE.systemID != EVE.systemID) || systemChange == true) {\r\n                systemChange = true;\r\n\r\n                // Check if location was updated after the last ship update\r\n                // if (moment(EVE.locationDate).isAfter(moment(this.client.EVE.shipDate))) {\r\n                    systemChange = false;\r\n                    tripwire.autoMapper(this.client.EVE.systemID, EVE.systemID);\r\n                // }\r\n            }\r\n        }\r\n\r\n        // System follower\r\n        if (!characterChange && options.buttons.follow && (this.client.EVE && this.client.EVE.systemID != EVE.systemID) && $(\".ui-dialog:visible\").length == 0) {\r\n            tripwire.systemChange(EVE.systemID);\r\n        }\r\n\r\n        if (!$(\"#search\").hasClass(\"active\")) {\r\n            $(\"#currentSpan\").show();\r\n        }\r\n\r\n        // Enable auto-mapper\r\n        $(\"#toggle-automapper\").removeClass(\"disabled\");\r\n\r\n        // Update current system\r\n        if (EVE.systemID) {\r\n            // add system to Leads To dropdown\r\n            if ($(\"#dialog-signature [data-autocomplete='sigSystems']\").hasClass(\"custom-combobox\")) {\r\n                $(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete(\"removeFromSelect\");\r\n                $(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete(\"addToSelect\", tripwire.systems[EVE.systemID]);\r\n            }\r\n            $(\"#EVEsystem\").html(systemRendering.renderSystem(systemAnalysis.analyse(EVE.systemID)));\r\n        }\r\n    } else {\r\n        // Update current system\r\n        $(\"#EVEsystem\").html(\"Not tracking\");\r\n        $(\"#currentSpan\").hide();\r\n        // Disable automapper\r\n        $(\"#toggle-automapper\").addClass(\"disabled\");\r\n        // remove system from Leads To dropdown\r\n        if ($(\"#dialog-signature [data-autocomplete='sigSystems']\").hasClass(\"custom-combobox\")) {\r\n            $(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete(\"removeFromSelect\");\r\n        }\r\n    }\r\n\r\n    this.client.EVE = {\r\n        characterID: EVE.characterID,\r\n        characterName: EVE.characterName,\r\n        systemID: EVE.systemID,\r\n        systemName: EVE.systemName,\r\n        shipTypeID: EVE.shipTypeID,\r\n        shipTypeName: EVE.shipTypeName,\r\n        stationID: EVE.stationID,\r\n        stationName: EVE.stationName,\r\n        locationDate: EVE.locationDate,\r\n        shipDate: EVE.shipDate,\r\n        systemChange: systemChange\r\n    };\r\n}\r\n","appData.genericSystemTypes = [\"Null-Sec\", \"Low-Sec\", \"High-Sec\", \"Class-1\", \"Class-2\", \"Class-3\", \"Class-4\", \"Class-5\", \"Class-6\", \"Class-13\", \"Triglavian\"];","tripwire.parse = function(server, mode) {\r\n    var data = $.extend(true, {}, server);\r\n\r\n    var updateSignatureTable = false;\r\n\tconst newSigsInSystem = { };\r\n\r\n    if (options.chain.active == null || (options.chain.tabs[options.chain.active] && options.chain.tabs[options.chain.active].evescout != true)) {\r\n        if (options.masks.active != \"273.0\") {\r\n            for (var key in data.signatures) {\r\n                if (data.signatures[key].mask == \"273.0\") {\r\n                    delete data.signatures[key];\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    if (mode == 'refresh') {\r\n        // preserve client.EVE across refresh otherwise tracking/automapper will be confused\r\n        var EVE = this.client.EVE;\r\n        this.client = server;\r\n        this.client.EVE = EVE;\r\n\r\n        for (var key in data.signatures) {\r\n            if (data.signatures[key].systemID != viewingSystemID) {\r\n                continue;\r\n            }\r\n\t\t\tnewSigsInSystem[key] = data.signatures[key];\r\n            var disabled = data.signatures[key].mask == \"273.0\" && options.masks.active != \"273.0\" ? true : false;\r\n\r\n            // Check for differences\r\n            if (!tripwire.signatures.list[key]) {\r\n\t\t\t\ttripwire.signatures.list[key] = data.signatures[key];\t// To reduce race condition chance\r\n                this.addSig(data.signatures[key], {animate: true}, disabled);\r\n                updateSignatureTable = true;\r\n            } else if (tripwire.signatures.list[key].modifiedTime !== data.signatures[key].modifiedTime) {\r\n                var edit = false;\r\n                for (column in data.signatures[key]) {\r\n                    if (data.signatures[key][column] != tripwire.signatures.list[key][column] && column != \"editing\") {\r\n                        edit = true;\r\n                    }\r\n                }\r\n\r\n                if (edit) {\r\n                    this.editSig(data.signatures[key], disabled);\r\n                } else {\r\n                    // this.sigEditing(data.signatures[key]);\r\n                }\r\n            }\r\n        }\r\n\r\n        // Sigs needing removal\r\n        for (var key in tripwire.signatures.list) {\r\n            if (!data.signatures[key]) {\r\n                this.deleteSig(key);\r\n            }\r\n        }\r\n    } else if (mode == 'init' || mode == 'change') {\r\n        this.client = server;\r\n\r\n        for (var key in data.signatures) {\r\n            if (data.signatures[key].systemID != viewingSystemID) {\r\n                continue;\r\n            }\r\n\t\t\tnewSigsInSystem[key] = data.signatures[key];\r\n            var disabled = data.signatures[key].mask == \"273.0\" && options.masks.active != \"273.0\" ? true : false;\r\n\t\t\t\r\n\t\t\tif(!tripwire.signatures.list[key]) {\r\n\t\t\t\tthis.addSig(data.signatures[key], {animate: false}, disabled);\r\n\t\t\t\tupdateSignatureTable = true;\r\n\t\t\t}\r\n            if (data.signatures[key].editing) {\r\n                this.sigEditing(data.signatures[key]);\r\n            }\r\n        }\r\n    } else { return; }\t// unknown type of parse request so do nothing\r\n\r\n    if (updateSignatureTable) {\r\n        $(\"#sigTable\").trigger(\"update\");\r\n    }\r\n    tripwire.signatures.list = data.signatures;\r\n\ttripwire.signatures.currentSystem = newSigsInSystem;\r\n\t\t\r\n    // set the sig count in the UI\r\n    var signatureCount = 0;\r\n    $.map(data.signatures, function(signature) {signature.systemID == viewingSystemID ? signatureCount++ : null;});\r\n    $(\"#signature-count\").html(signatureCount);\r\n}\r\n\r\n/** Find if there is an unknown return sig. The markup is always generated (in addSignature.js) */\r\ntripwire.updateReturnStatus = function() {\r\n\tconst inSigId = $(\"#chainMap [data-nodeid='\"+viewingSystemID+\"']:not(.calc)\").attr('data-insigid');\r\n\tconst wormholeId = $(\"#chainMap [data-nodeid='\"+viewingSystemID+\"']:not(.calc)\").attr('data-sigid');\r\n\tconst wormhole = tripwire.client.wormholes[wormholeId] || {};\r\n\t// One of the two ends should be in this system, In sig will be the wrong end, so find the other end\r\n\tconst returnSigId = wormhole.initialID == inSigId ? wormhole.secondaryID : wormhole.initialID;\r\n\ttripwire.signatures.returnSig = tripwire.signatures.list[returnSigId];\r\n\tconst needReturn = tripwire.signatures.returnSig && (tripwire.signatures.returnSig.signatureID == '???' || tripwire.signatures.returnSig.signatureID == '' || tripwire.signatures.returnSig.signatureID === null || tripwire.signatures.returnSig.signatureID === undefined);\r\n\tdocument.getElementById('sigTableWrapper').className = needReturn ? 'return-visible' : 'return-invisible';\t\r\n}","// Handles pasting sigs from EVE\r\ntripwire.pasteSignatures = function() {\r\n    var processing = false;\r\n\r\n    var rowParse = function(row) {\r\n        var scanner = {};\r\n        var columns = row.split(\"\t\"); // Split by tab\r\n        var validScanGroups = [\r\n            // English (en-us)\r\n            \"Cosmic Signature\",\r\n            \"Cosmic Anomaly\",\r\n\r\n            // French (fr)\r\n            \"Signature cosmique\",\r\n            \"Anomalie cosmique\",\r\n\r\n            // German (de)\r\n            \"Kosmische Anomalie\",\r\n            \"Kosmische Signatur\",\r\n\r\n            // Japanese (ja)\r\n            \"宇宙の特異点\",\r\n            \"宇宙のシグネチャ\",\r\n\r\n            // Korean (ko)\r\n            \"코즈믹 시그니처\",\r\n            \"코즈믹 어노말리\",\r\n\r\n            // Russian (ru)\r\n            \"Скрытый сигнал\",\r\n            \"Космическая аномалия\",\r\n        ];\r\n\r\n        var validTypes = {\r\n            // English (en-us)\r\n            \"Combat Site\": \"Combat\",\r\n            \"Data Site\": \"Data\",\r\n            \"Gas Site\": \"Gas\",\r\n            \"Ore Site\": \"Ore\",\r\n            \"Relic Site\": \"Relic\",\r\n            \"Wormhole\": \"Wormhole\",\r\n\r\n            // French (fr)\r\n            \"Site de combat\": \"Combat\",\r\n            \"Site de données\": \"Data\",\r\n            \"Site de collecte de gaz\": \"Gas\",\r\n            \"Site de minerai\": \"Ore\",\r\n            \"Site de reliques\": \"Relic\",\r\n            \"Trou de ver\": \"Wormhole\",\r\n\r\n            // German (de)\r\n            \"Kampfgebiet\": \"Combat\",\r\n            \"Datengebiet\": \"Data\",\r\n            \"Gasgebiet\": \"Gas\",\r\n            \"Mineraliengebiet\": \"Ore\",\r\n            \"Reliktgebiet\": \"Relic\",\r\n            \"Wurmloch\": \"Wormhole\",\r\n\r\n            // Japanese (ja)\r\n            \"戦闘サイト\": \"Combat\",\r\n            \"データサイト\": \"Data\",\r\n            \"ガスサイト\": \"Gas\",\r\n            \"鉱石サイト\": \"Ore\",\r\n            \"遺物サイト\": \"Relic\",\r\n            \"ワームホール\": \"Wormhole\",\r\n\r\n            // Korean (ko)\r\n            \"전투 사이트\": \"Combat\",\r\n            \"데이터 사이트\": \"Data\",\r\n            \"가스 사이트\": \"Gas\",\r\n            \"채광 사이트\": \"Ore\",\r\n            \"유물 사이트\": \"Relic\",\r\n            \"웜홀\": \"Wormhole\",\r\n\r\n            // Russian (ru)\r\n            \"Боевой район\": \"Combat\",\r\n            \"Информационный район\": \"Data\",\r\n            \"Газовый район\": \"Gas\",\r\n            \"Астероидный район\": \"Ore\",\r\n            \"Археологический район\": \"Relic\",\r\n            \"Червоточина\": \"Wormhole\",\r\n        };\r\n\r\n        for (var x in columns) {\r\n            if (columns[x].match(/^([A-Z]{3}[-]\\d{3})$/)) {\r\n                scanner.id = columns[x].split(\"-\");\r\n                continue;\r\n            }\r\n\r\n            if (columns[x].match(/(\\d([.|,]\\d)?[ ]?(%))/) || columns[x].match(/(\\d[.|,]?\\d+\\s?(UA|AU|AE|km|m|а.е.|км|м))/i)) { // Exclude scan % || AU\r\n                continue;\r\n            }\r\n\r\n            if ($.inArray(columns[x], validScanGroups) != -1) {\r\n                scanner.scanGroup = columns[x];\r\n                continue;\r\n            }\r\n\r\n            if (validTypes[columns[x]]) {\r\n                scanner.type = validTypes[columns[x]];\r\n                continue;\r\n            }\r\n\r\n            if (columns[x] != \"\") {\r\n                scanner.name = columns[x].trim();\r\n            }\r\n        }\r\n\r\n        if (!scanner.id || scanner.id.length !== 2) {\r\n            return false;\r\n        }\r\n\r\n        return scanner;\r\n    }\r\n\r\n    this.pasteSignatures.parsePaste = function(paste) {\r\n        var paste = paste.split(\"\\n\");\r\n        var payload = {\"signatures\": {\"add\": [], \"update\": []}, \"systemID\": viewingSystemID};\r\n        var undo = [];\r\n        processing = true;\r\n\r\n        for (var i in paste) {\r\n            var scanner = rowParse(paste[i]);\r\n\r\n            if (scanner.id) {\r\n                var signature = $.map(tripwire.client.signatures, function(signature) { if (signature.signatureID && signature.signatureID.toUpperCase() == scanner.id[0] + scanner.id[1] && signature.systemID == viewingSystemID) return signature; })[0];\r\n                if (signature) {\r\n                    // Update signature (only non-wormholes can be updated to a wormhole)\r\n                    if (scanner.type == \"Wormhole\" && signature.type != \"wormhole\") {\r\n                        var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0] || {};\r\n                        var otherSignature = wormhole.id ? (signature.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID]) : {};\r\n                        payload.signatures.update.push({\r\n                            \"wormhole\": {\r\n                                \"id\": wormhole.id || null,\r\n                                \"type\": wormhole.type || null,\r\n                                \"life\": wormhole.life || \"stable\",\r\n                                \"mass\": wormhole.mass || \"stable\"\r\n                            },\r\n                            \"signatures\": [\r\n                                {\r\n                                    \"id\": signature.id,\r\n                                    \"signatureID\": signature.signatureID,\r\n                                    \"systemID\": viewingSystemID,\r\n                                    \"type\": \"wormhole\",\r\n                                    \"name\": signature.name\r\n                                },\r\n                                {\r\n                                    \"id\": otherSignature.id || null,\r\n                                    \"signatureID\": otherSignature.signatureID || null,\r\n                                    \"systemID\": otherSignature.systemID || null,\r\n                                    \"type\": \"wormhole\",\r\n                                    \"name\": otherSignature.name\r\n                                }\r\n                            ]\r\n                        });\r\n\r\n                        if (tripwire.client.wormholes[wormhole.id]) {\r\n\t\t\t\t\t\t\tundo.push({\"wormhole\": tripwire.client.wormholes[wormhole.id], \"signatures\": [tripwire.client.signatures[signature.id], tripwire.client.signatures[otherSignature.id]]});\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t// used to be just a regular signature\r\n\t\t\t\t\t\t\tundo.push(tripwire.client.signatures[signature.id]);\r\n\t\t\t\t\t\t}\r\n                    // Make sure we are only updating when we have new info (we never turn wormholes into regular signatures)\r\n                    } else if (signature.type != \"wormhole\" && ((scanner.type && scanner.type.toLowerCase() != signature.type) || (scanner.name && scanner.name != signature.name))) {\r\n                        payload.signatures.update.push({\r\n                            \"id\": signature.id,\r\n                            \"systemID\": viewingSystemID,\r\n                            \"type\": scanner.type || 'unknown',\r\n                            \"name\": scanner.name,\r\n                            \"lifeLength\": options.signatures.pasteLife * 60 * 60\r\n                        });\r\n                        undo.push(tripwire.client.signatures[signature.id]);\r\n                    }\r\n                } else {\r\n                    // Add signature\r\n                    if (scanner.type == \"Wormhole\") {\r\n                        payload.signatures.add.push({\r\n                            \"wormhole\": {\r\n                                \"type\": null,\r\n                                \"parent\": \"initial\",\r\n                                \"life\": \"stable\",\r\n                                \"mass\": \"stable\"\r\n                            },\r\n                            \"signatures\": [\r\n                                {\r\n                                    \"signatureID\": scanner.id[0] + scanner.id[1],\r\n                                    \"systemID\": viewingSystemID,\r\n                                    \"type\": \"wormhole\",\r\n                                    \"lifeLength\": options.signatures.pasteLife * 60 * 60\r\n                                },\r\n                                {\r\n                                    \"signatureID\": null,\r\n                                    \"systemID\": null,\r\n                                    \"type\": \"wormhole\",\r\n                                    \"lifeLength\": options.signatures.pasteLife * 60 * 60\r\n                                }\r\n                            ]\r\n                        });\r\n                    } else {\r\n                        payload.signatures.add.push({\r\n                            \"signatureID\": scanner.id[0] + scanner.id[1],\r\n                            \"systemID\": viewingSystemID,\r\n                            \"type\": scanner.type || 'unknown',\r\n                            \"name\": scanner.name,\r\n                            \"lifeLength\": options.signatures.pasteLife * 60 * 60\r\n                        });\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n        if (payload.signatures.add.length || payload.signatures.update.length) {\r\n            var success = function(data) {\r\n                if (data.resultSet && data.resultSet[0].result == true) {\r\n                    $(\"#undo\").removeClass(\"disabled\");\r\n\r\n                    if (data.results) {\r\n                        if (viewingSystemID in tripwire.signatures.undo) {\r\n                            tripwire.signatures.undo[viewingSystemID].push({action: \"add\", signatures: data.results});\r\n                        } else {\r\n                            tripwire.signatures.undo[viewingSystemID] = [{action: \"add\", signatures: data.results}];\r\n                        }\r\n                    }\r\n\r\n                    if (undo.length) {\r\n                        if (viewingSystemID in tripwire.signatures.undo) {\r\n                            tripwire.signatures.undo[viewingSystemID].push({action: \"update\", signatures: undo});\r\n\t\t\t\t\t\t} else {\r\n                            tripwire.signatures.undo[viewingSystemID] = [{action: \"update\", signatures: undo}];\r\n\t\t\t\t\t\t}\r\n                    }\r\n\r\n                    sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\r\n                }\r\n            }\r\n\r\n            var always = function(data) {\r\n                processing = false;\r\n            }\r\n\r\n            tripwire.refresh('refresh', payload, success, always);\r\n        } else {\r\n            processing = false;\r\n        }\r\n    }\r\n\r\n    this.pasteSignatures.init = function() {\r\n        $(document).keydown(function(e)\t{\r\n            if ((e.metaKey || e.ctrlKey) && (e.keyCode == 86 || e.keyCode == 91) && !processing) {\r\n                //Abort - user is in input or textarea\r\n                if ($(document.activeElement).is(\"textarea, input\")) return;\r\n\r\n                $(\"#clipboard\").focus();\r\n            }\r\n        });\r\n\r\n        $(\"body\").on(\"click\", \"#fullPaste\", function(e) {\r\n            e.preventDefault();\r\n\r\n            var paste = $(this).data(\"paste\").split(\"\\n\");\r\n            var pasteIDs = [];\r\n            var removes = [];\r\n            var undo = [];\r\n\r\n            for (var i in paste) {\r\n                if (scan = rowParse(paste[i])) {\r\n                    pasteIDs.push((scan.id[0] + scan.id[1]).toLowerCase());\r\n                }\r\n            }\r\n\r\n            for (var i in tripwire.client.signatures) {\r\n                var signature = tripwire.client.signatures[i];\r\n\r\n                if (signature.systemID == viewingSystemID && signature.signatureID && $.inArray(signature.signatureID.toLowerCase(), pasteIDs) === -1 && signature.signatureID !== \"???\") {\r\n                    if (signature.type == \"wormhole\") {\r\n                        var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0] || {};\r\n                        var otherSignature = wormhole.id ? (signature.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID]) : {};\r\n                        if (wormhole.type !== \"GATE\") {\r\n                            removes.push(wormhole);\r\n                            undo.push({\"wormhole\": wormhole, \"signatures\": [signature, otherSignature]});\r\n                        }\r\n                    } else {\r\n                        removes.push(signature.id);\r\n                        undo.push(signature);\r\n                    }\r\n                }\r\n            }\r\n\r\n            if (removes.length > 0) {\r\n                var payload = {\"signatures\": {\"remove\": removes}};\r\n\r\n                var success = function(data) {\r\n                    if (data.resultSet && data.resultSet[0].result == true) {\r\n                        $(\"#undo\").removeClass(\"disabled\");\r\n                        if (viewingSystemID in tripwire.signatures.undo) {\r\n                            tripwire.signatures.undo[viewingSystemID].push({action: \"remove\", signatures: undo});\r\n                        } else {\r\n                            tripwire.signatures.undo[viewingSystemID] = [{action: \"remove\", signatures: undo}];\r\n                        }\r\n\r\n                        sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\r\n                    }\r\n                }\r\n\r\n                tripwire.refresh('refresh', payload, success);\r\n            }\r\n        });\r\n\r\n        $(\"#clipboard\").on(\"paste\", function(e) {\r\n            e.preventDefault();\r\n            var paste = window.clipboardData ? window.clipboardData.getData(\"Text\") : (e.originalEvent || e).clipboardData.getData('text/plain');\r\n\r\n            $(\"#clipboard\").blur();\r\n            Notify.trigger(\"Paste detected<br/>(<a id='fullPaste' href=''>Click to delete missing sigs</a>)\");\r\n            $(\"#fullPaste\").data(\"paste\", paste);\r\n            tripwire.pasteSignatures.parsePaste(paste);\r\n        });\r\n    }\r\n\r\n    this.pasteSignatures.init();\r\n}\r\ntripwire.pasteSignatures();\r\n","tripwire.redo = function() {\n    if (tripwire.signatures.redo[viewingSystemID].length > 0) {\n        $(\"#redo\").addClass(\"disabled\");\n        var lastIndex = tripwire.signatures.redo[viewingSystemID].length -1;\n        var data = {\"systemID\": viewingSystemID, \"signatures\": {\"add\": [], \"remove\": [], \"update\": []}};\n\n        var redoItem = tripwire.signatures.redo[viewingSystemID][lastIndex];\n        var undo = $.map(redoItem.signatures, function(signature) {\n            // grab the current signature so we can restore the way it is now\n            if (signature.wormhole && tripwire.client.wormholes[signature.wormhole.id]) {\n                // it was a wormhole and still is\n                return {\"wormhole\": tripwire.client.wormholes[signature.wormhole.id], \"signatures\": [tripwire.client.signatures[signature.signatures[0].id], tripwire.client.signatures[signature.signatures[1].id]]};\n            } else if (tripwire.client.signatures[signature.id] && tripwire.client.signatures[signature.id].type == \"wormhole\") {\n                // it was a regular signature but is now a wormhole\n                var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n                return {\"wormhole\": wormhole, \"signatures\": [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]};\n            } else if (signature.wormhole && tripwire.client.signatures[signature.signatures[0].id]) {\n                // it was a wormhole but is now a regular signature\n                return tripwire.client.signatures[signature.signatures[0].id];\n            } else {\n                // it was a regular signature and still is\n                return tripwire.client.signatures[signature.id];\n            }\n        });\n\n        switch(redoItem.action) {\n            case \"add\":\n                data.signatures.add = data.signatures.add.concat(redoItem.signatures);\n                break;\n            case \"remove\":\n                data.signatures.remove = data.signatures.remove.concat($.map(redoItem.signatures, function(signature) { return signature.wormhole ? signature.wormhole : signature.id }));\n                break;\n            case \"update\":\n                data.signatures.update = data.signatures.update.concat(redoItem.signatures);\n                break;\n        }\n\n        var success = function(data) {\n            if (data.resultSet && data.resultSet[0].result == true) {\n                tripwire.signatures.redo[viewingSystemID].pop();\n\n                $(\"#undo\").removeClass(\"disabled\");\n                if (viewingSystemID in tripwire.signatures.undo) {\n                    if (redoItem.action == \"add\") {\n                        // we are adding new signatures we removed so we need the new ids\n                        tripwire.signatures.undo[viewingSystemID].push({\"action\": redoItem.action, \"signatures\": data.results});\n                    } else if (redoItem.action == \"update\") {\n                        tripwire.signatures.undo[viewingSystemID].push({\"action\": redoItem.action, \"signatures\": undo});\n                    } else {\n                        tripwire.signatures.undo[viewingSystemID].push({action: redoItem.action, signatures: redoItem.signatures});\n                    }\n                } else {\n                    if (redoItem.action == \"add\") {\n                        tripwire.signatures.undo[viewingSystemID] = [{\"action\": redoItem.action, \"signatures\": data.results}];\n                    } else if (redoItem.action == \"update\") {\n                        tripwire.signatures.undo[viewingSystemID] = [{\"action\": redoItem.action, \"signatures\": undo}];\n                    } else {\n                        tripwire.signatures.undo[viewingSystemID] = [{action: redoItem.action, signatures: redoItem.signatures}];\n                    }\n                }\n\n                sessionStorage.setItem(\"tripwire_redo\", JSON.stringify(tripwire.signatures.redo));\n                sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n            }\n        }\n\n        var always = function(data) {\n            if (tripwire.signatures.redo[viewingSystemID].length > 0) {\n                $(\"#redo\").removeClass(\"disabled\");\n            }\n        }\n\n        tripwire.refresh('refresh', data, success, always);\n    }\n}\n","// Handles pulling TQ status & player count\r\ntripwire.serverStatus = function() {\r\n    this.data;\r\n    this.timer;\r\n\r\n    clearTimeout(tripwire.serverStatus.timer);\r\n\r\n    tripwire.esi.eveStatus()\r\n        .always(function(data) {\r\n            if (data && data.players && data.players > 0) {\r\n                if (!tripwire.serverStatus.data || tripwire.serverStatus.data.players !== data.players) {\r\n                    $('#serverStatus').html(\"<span class='\"+(data.players > 0 ? 'stable' : 'critical')+\"'>TQ</span>: \"+Intl.NumberFormat().format(data.players));\r\n\r\n                    if (tripwire.serverStatus.data) {\r\n                        $(\"#serverStatus\").effect('pulsate', {times: 5});\r\n                    }\r\n                }\r\n\r\n                tripwire.serverStatus.data = data;\r\n            } else {\r\n                $('#serverStatus').html(\"<span class='critical'>TQ</span>\");\r\n            }\r\n\r\n            tripwire.serverStatus.timer = setTimeout(\"tripwire.serverStatus();\", 15000);\r\n        });\r\n}\r\ntripwire.serverStatus();\r\n\r\ntripwire.updateServerTime = function() {\r\n\tdocument.getElementById('serverTime').innerText = moment.utc().format('HH:mm')\r\n};\r\nsetInterval(tripwire.updateServerTime, 5000);\r\ntripwire.updateServerTime();","tripwire.sync = function(mode, data, successCallback, alwaysCallback) {\r\n    var data = typeof(data) === \"object\" ? $.extend(true, {}, data) : {};\r\n\r\n    // Grab any pending changes\r\n    $.extend(true, data, tripwire.data);\r\n\r\n    // Remove old timer to prevent multiple\r\n    if (this.timer) clearTimeout(this.timer);\r\n    if (this.xhr) {\r\n\t\tconsole.log('Awaiting existing XHR ' + this.xhr.data.mode + ': ', this.xhr);\r\n\t\ttripwire.data = data;\r\n\t\tthis.timer = setTimeout(function() { tripwire.sync(mode, data, successCallback, alwaysCallback); }, 50);\r\n\t\treturn false;\r\n\t}\r\n\r\n    if (mode == 'refresh' || mode == 'change') {\r\n        data.signatureCount = tripwire.serverSignatureCount;\r\n        data.signatureTime = Object.maxTime(this.client.signatures, \"modifiedTime\");\r\n\r\n        data.flareCount = chain.data.flares ? chain.data.flares.flares.length : 0;\r\n        data.flareTime = chain.data.flares ? chain.data.flares.last_modified : 0;\r\n\r\n        data.commentCount = Object.keys(this.comments.data||{}).length;\r\n        data.commentTime = Object.maxTime(this.comments.data, \"modified\");\r\n\r\n        data.activity = this.activity;\r\n    } else {\r\n        // Expand Tripwire with JSON data from EVE Data Dump and other static data\r\n        $.extend(this, appData);\r\n\r\n        this.aSigSystems = Object.assign(\r\n\t\t\t// Using the index as a key here because numeric keys always come first and we want these before real systems\r\n\t\t\t// see https://stackoverflow.com/questions/47881998/\r\n\t\t\tappData.genericSystemTypes.reduce(function(o, s, i) { o[i] = systemAnalysis.analyse(s); o[i].name = s; return o; }, {} ),\r\n\t\t\tthis.systems);\r\n\t\t\r\n        $(\".systemsAutocomplete\").inlinecomplete({source: this.systems, renderer: 'system', maxSize: 10, delay: 0});\r\n    }\r\n\r\n    data.mode = mode != \"init\" ? \"refresh\" : \"init\";\r\n    data.systemID = viewingSystemID;\r\n    data.systemName = viewingSystem;\r\n    data.instance = tripwire.instance;\r\n    data.version = tripwire.version;\r\n\r\n    this.xhr = $.ajax({\r\n        url: \"refresh.php\",\r\n        data: data,\r\n        type: \"POST\",\r\n        dataType: \"JSON\",\r\n        cache: false\r\n    }).done(function(data) {\r\n        if (data) {\r\n            tripwire.server = data;\r\n            if(data.signatures) { // Save this count before we delete entries\r\n                tripwire.serverSignatureCount = Object.keys(data.signatures||{}).length;\r\n            }\r\n\r\n            if (data.wormholes) {\r\n                // Purge bad wormhole signatures\r\n                var wormholeInitialIDs = {};\r\n                var wormholeSecondaryIDs = {};\r\n                Object.values(data.wormholes).forEach(function (wh) {\r\n                    wormholeInitialIDs[parseInt(wh.initialID)] = wh.id;\r\n                    wormholeSecondaryIDs[parseInt(wh.secondaryID)] = wh.id;\r\n                })\r\n                for (var i in data.signatures) {\r\n                  if (data.signatures[i].type == \"wormhole\") {\r\n                    var id = data.signatures[i].id;\r\n                    if (wormholeInitialIDs[id] === undefined && wormholeSecondaryIDs[id] === undefined) {\r\n                      delete data.signatures[i];\r\n                    }\r\n                  }\r\n                }\r\n            }\r\n\r\n            if (data.esi) {\r\n                tripwire.esi.parse(data.esi);\r\n            }\r\n\r\n            if (data.oauth) {\r\n                tripwire.esi.parseOauth(data.oauth);\r\n            }\r\n\r\n            if (data.sync) {\r\n                tripwire.serverTime.time = new Date(data.sync);\r\n            }\r\n\r\n            if (data.signatures) {\r\n                tripwire.parse(data, mode);\r\n            }\r\n\r\n            if (data.comments) {\r\n                tripwire.comments.parse(data.comments);\r\n            }\r\n\r\n            if (data.wormholes || data.occupied || data.flares) {\r\n                tripwire.chainMap.parse({\"map\": data.wormholes || null, \"occupied\": data.occupied || null, \"flares\": data.flares || null});\r\n            } else if (chain.data.occupied && chain.data.occupied.length && !data.occupied) {\r\n                // send update to remove all occupied system indicators\r\n                tripwire.chainMap.parse({\"occupied\": []});\r\n            }\r\n\r\n\t\t\ttripwire.updateReturnStatus();\r\n\r\n            tripwire.active(data.activity);\r\n\r\n            if (data.notify && !$(\"#serverNotification\")[0]) Notify.trigger(data.notify, \"yellow\", false, \"serverNotification\");\r\n\t\t\t\r\n\t\t\t$('[data-command=ping]')[data.discord_integration ? 'show' : 'hide']();\r\n        }\r\n\r\n        tripwire.data = {tracking: {}, esi: {}};\r\n        successCallback ? successCallback(data) : null;\r\n    }).always(function(data, status) {\r\n        tripwire.timer = setTimeout(\"tripwire.refresh();\", tripwire.refreshRate);\r\n\r\n        alwaysCallback ? alwaysCallback(data) : null;\r\n\r\n        if (data.status == 403) {\r\n            window.location.href = \".\";\r\n        } else if (status != \"success\" && status != \"abort\" && tripwire.connected == true) {\r\n            tripwire.connected = false;\r\n            $(\"#ConnectionSuccess\").click();\r\n            Notify.trigger(\"Error syncing with server\", \"red\", false, \"connectionError\");\r\n        } else if (status == \"success\" && tripwire.connected == false) {\r\n            tripwire.connected = true;\r\n            $(\"#connectionError\").click();\r\n            Notify.trigger(\"Successfully reconnected with server\", \"green\", 5000, \"connectionSuccess\");\r\n        }\r\n\t\t\r\n\t\ttripwire.xhr = null;\r\n    });\r\n\tthis.xhr.data = data;\r\n\t\r\n    return true;\r\n}\r\ntripwire.sync(\"init\");\r\n","// Change the currently viewed system\r\ntripwire.systemChange = function(systemID, mode) {\r\n\tconst system = systemAnalysis.analyse(systemID);\r\n\tif(!system) { return; }\r\n\t\t\r\n    if (mode != \"init\") {\r\n        $(\"#infoSecurity\").removeClass();\r\n        $(\"#infoStatics\").empty();\r\n\r\n        viewingSystem = system.name;\r\n        viewingSystemID = systemID;\r\n\r\n        // Reset activity\r\n        activity.refresh(true);\r\n\r\n        // Reset signatures\r\n        $(\"#sigTable span[data-age]\").countdown(\"destroy\");\r\n        $(\"#sigTable tbody\").empty();\r\n        $(\"#signature-count\").html(0);\r\n        tripwire.signatures.list = {};\r\n        tripwire.client.signatures = null;\r\n\r\n        // Reset chain map\r\n        chain.redraw();\r\n\r\n        // Reset comments\r\n        $(\"#notesWidget .content .comment:visible\").remove();\r\n        tripwire.comments.data = null;\r\n\r\n        // Change the URL & history\r\n        history.replaceState(null, null, \"?system=\"+viewingSystem);\r\n\r\n        tripwire.refresh(\"change\");\r\n    }\r\n\r\n    // Change the title\r\n    document.title = system.name + \" - \" + app_name;\r\n\r\n    $(\"#infoSystem\").text(system.name);\r\n\r\n    // Current system favorite\r\n    $.inArray(parseInt(viewingSystemID), options.favorites) != -1 ? $(\"#system-favorite\").attr(\"data-icon\", \"star\").addClass(\"active\") : $(\"#system-favorite\").attr(\"data-icon\", \"star-empty\").removeClass(\"active\");\r\n\t\r\n    if (system.class) {\r\n        // Security\r\n        $(\"#infoSecurity\").html(\"<span class='wh pointer'>Class \" + system.class + \"</span>\");\r\n\r\n        // Effects\r\n        if (system.effect) {\r\n            var tooltip = \"<table cellpadding=\\\"0\\\" cellspacing=\\\"1\\\">\";\r\n            for (var x in tripwire.effects[system.effect]) {\r\n                var effect = tripwire.effects[system.effect][x].name;\r\n                var base = tripwire.effects[system.effect][x].base;\r\n                var bad = tripwire.effects[system.effect][x].bad;\r\n                var whClass = system.class > 6 ? 6 : system.class;\r\n                var modifier = 0;\r\n\r\n                switch (Math.abs(base)) {\r\n                    case 15:\r\n                        modifier = base > 0 ? 7 : -7;\r\n                        break;\r\n                    case 30:\r\n                        modifier = base > 0 ? 14 : -14;\r\n                        break;\r\n                    case 60:\r\n                        modifier = base > 0 ? 28 : -28;\r\n                        break;\r\n                }\r\n\r\n                tooltip += \"<tr><td>\" + effect + \"</td><td style=\\\"padding-left: 25px; text-align: right;\\\" class=\\\"\" + (bad ? \"critical\" : \"stable\") + \"\\\">\";\r\n                tooltip += base + (modifier * (whClass -1)) + \"%</td></tr>\";\r\n            }\r\n            tooltip += \"</table>\";\r\n            $(\"#infoSecurity\").append(\"&nbsp;<span class='pointer' data-tooltip='\" + tooltip + \"'>\" + system.effect + \"</span>\");\r\n        }\r\n\r\n        // Statics\r\n        for (var x in system.statics) {\r\n            var type = system.statics[x];\r\n            var wormhole = appData.wormholes[type];\r\n            var color = \"wh\";\r\n\r\n            switch (wormhole.leadsTo) {\r\n                case \"High-Sec\":\r\n                    color = \"hisec\";\r\n                    break;\r\n                case \"Low-Sec\":\r\n                    color = \"lowsec\";\r\n                    break;\r\n                case \"Null-Sec\":\r\n                    color = \"nullsec\";\r\n                    break;\r\n            }\r\n\r\n            $(\"#infoStatics\").append(\"<div><span class='\"+ color +\"'>&#9679;</span> <b class='\"+ color +\"'>\"+ wormhole.leadsTo +\"</b> via <span>\"+ wormholeRendering.renderWormholeType(wormhole, type, system) +\"</span></div>\");\r\n        }\r\n\r\n        // Faction\r\n        $(\"#infoFaction\").html(\"&nbsp;\");\r\n    } else {\r\n        // Security\r\n\t\tconst securityText = {HS: 'High-Sec', LS: 'Low-Sec', NS: 'Null-Sec', 'Trig': 'Triglavian' }[system.systemTypeName];\r\n       $(\"#infoSecurity\").addClass(system.systemTypeClass).html(securityText + \" \" + system.baseSecurity.toFixed(2) + system.systemTypeModifiers.join(' '));\r\n\r\n        // Faction\r\n        if(fw) { $(\"#infoFaction\").html(fw.factionMarkup(system)); }\r\n\t\t\r\n\t\t// Gates\r\n\t\tconst connections = guidance.connections(tripwire.map.shortest, viewingSystemID);\r\n\t\tif(connections.length) {\r\n\t\t\t$('#infoStatics').append('<p><b>Gates</b>: ' + connections.map(c => {\r\n\t\t\t\tconst system = systemAnalysis.analyse(c.systemID);\r\n\t\t\t\treturn c.closed ? '<s>' + system.name + '</s> (closed)' : systemRendering.renderSystem(system); \r\n\t\t\t}).join(', ') + '</p>');\r\n\t\t}\r\n\t\t\r\n\t\t// Route to favourites\r\n\t\tfor (var fi in options.favorites) {\r\n\t\t\tconst f = options.favorites[fi];\r\n\t\t\tconst path = guidance.findShortestPath(tripwire.map.shortest, f, viewingSystemID);\r\n\t\t\tif(path) { $('#infoStatics').append('<p><b><a href=\".?system=' + tripwire.systems[f].name + '\">' +tripwire.systems[f].name + '</a></b>: ' + systemRendering.renderPath(path) + '</p>'); }\r\n\t\t}\r\n    }\r\n\r\n\tTooltips.attach($(\"#infoStatics [data-tooltip]\"));\r\n    Tooltips.attach($(\"#infoSecurity [data-tooltip]\"));\r\n\r\n    // Region\r\n    $(\"#infoRegion\").text(tripwire.regions[system.regionID].name);\r\n\r\n    // Info Links\r\n    $(\"#infoWidget .infoLink\").each(function() {\r\n        this.href = $(this).data(\"href\").replace(/\\$systemName/gi, system.name).replace(/\\$systemID/gi, systemID);\r\n    });\r\n\r\n    // Reset undo/redo\r\n    tripwire.signatures.undo[systemID] && tripwire.signatures.undo[systemID].length > 0 ? $(\"#undo\").removeClass(\"disabled\") : $(\"#undo\").addClass(\"disabled\");\r\n    tripwire.signatures.redo[systemID] && tripwire.signatures.redo[systemID].length > 0 ? $(\"#redo\").removeClass(\"disabled\") : $(\"#redo\").addClass(\"disabled\");\r\n\r\n    // Reset delete signature icon\r\n    $(\"#sigTable tr.selected\").length == 0 ? $(\"#signaturesWidget #delete-signature\").addClass(\"disabled\") : $(\"#signaturesWidget #delete-signature\").removeClass(\"disabled\");\r\n}\r\n\r\nsetTimeout(() => tripwire.systemChange(viewingSystemID, \"init\"), 0);\r\n","var tutorial;\r\n\r\n// infoWidget\r\n$(\"#infoWidget .tutorial\").click(function() {\r\n    tutorial = introJs().setOptions({\r\n        showStepNumbers: false,\r\n        steps: [\r\n            {\r\n                element: document.querySelector(\"#infoWidget\"),\r\n                intro: \"<h4>System information widget</h4><br/><p>Displays information on the currently <b>selected</b> Tripwire system.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#infoGeneral\"),\r\n                intro: \"<p>This section includes:<br/>System Name<br/>Security Rating<br/>Region<br/>Owning Faction Name</p><br/><p>If the selected system is a wormhole with a system effect, that will also be shown - hover over it to view the effect breakdown.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#activityGraph\"),\r\n                intro: \"<p>For K space systems, a graph is shown here containing hourly ship jump and kill information from the EVE API.</p><br/><p>Each category can be toggled by clicking the keys above the graph, and the time period selected with the links below.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#infoStatics\"),\r\n                intro: \"<p>If a wormhole system is selected, its static wormhole types will appear here. (A static is a wormhole which is always present; when it is closed or expires, a new one will spawn.)</p><br/><p>In K space, the route to each of your favorite systems is shown here.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#favorite-control-wrapper\"),\r\n                intro: \"<p>Use the star to toggle whether this is a 'favorite' system. It shows orange when the current system is a favorite. The other button shows the Favorites panel which will show you all your favorite systems.</p><br/><p>'Favorite' systems in K space can be shown in the chain map, and in the routing panel to the lower left.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#show-favorite\"),\r\n                intro: \"<p>Use this toggle to show favorite systems and their routes on the chain map.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#infoExtra\"),\r\n                intro: \"<p>For K space systems, the shortest route to the currently visible chain will be shown here, along with the route within the chain.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#infoLinks\"),\r\n                intro: \"<p>These are some quick links to various sites for this specific system.</p>\"\r\n            },\t\t\t\r\n        ]\r\n    }).start();\r\n});\r\n\r\n// signaturesWidget\r\n$(\"#signaturesWidget .tutorial\").click(function() {\r\n    tutorial = introJs().setOptions({\r\n        showStepNumbers: false,\r\n        steps: [\r\n            {\r\n                element: document.querySelector(\"#signaturesWidget\"),\r\n                intro: \"<h4>System signatures widget</h4><br/><p>Displays all signatures and wormholes in the currently <b>selected</b> Tripwire system.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#add-signature\"),\r\n                intro: \"<p>Add new signatures and wormholes manually by clicking the + icon.</p><br/><p>Copy & Paste EVE scanner results anywhere once Tripwire has focus to add or update signatures, repeated pastes will only update with new information.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#delete-signature\"),\r\n                intro: \"<p>Click here or use the keyboard shortcut <b>DELETE</b> to delete <b>selected</b> signatures from this system.</p><br/><p>Click on a row to select it, click multiple rows to delete multiple signatures at once, click a selected row again to unselect it.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#signature-count\"),\r\n                intro: \"<p>This shows the current count of signatures, including wormholes, in the selected system.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#undo\"),\r\n                intro: \"<p>Click here or use the keyboard shortcut <b>CTRL-Z</b> to undo the last changes you made in this sytem (this includes clipboard pasted changes).</p><br/><p>You can undo multiple times as history is kept in the browser.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#redo\"),\r\n                intro: \"<p>Click here or use the keyboard shortcut <b>CTRL-Y</b> to redo the last changes you made in this system (this includes clipboard pasted changes).</p><br/><p>You can redo multiple times as history is kept in the browser.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#toggle-automapper\"),\r\n                intro: \"<p>Click here to toggle the Auto-mapper feature on (orange) or off.</p><br/><p>This feature only works when an in-game character is being actively tracked, otherwise this icon appears disabled.</p><br/><p>The automapper will watch for a change in your in-game system not via a star gate and try to automatically add or update wormholes.</p><br/><p>First it tries to seach for wormholes already added but missing a leads to system, this includes via wormhole type (B274) or with a leads to of 'High-Sec' for example.</p><br/><p>Next it searches for wormholes without any type or leads to at all.</p><br/><p>Finally if there are no wormholes or they all have a leads to system already, it will add a new wormhole.</p><br/><p>If at any time if finds multiple wormholes it can update, a dialog window will appear asking which wormhole you want to update.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#sigTable\"),\r\n                intro: \"<p>Each column can be sorted by clicking the column label, sort by multiple columns by holding the shift key.</p><br/><p>Right-click a column to change the text-alignment.</p>\"\r\n            }\r\n        ]\r\n    }).start();\r\n});\r\n\r\n// notesWidget\r\n$(\"#notesWidget .tutorial\").click(function(e) {\r\n    e.preventDefault();\r\n\r\n    tutorial = introJs().setOptions({\r\n        showStepNumbers: false,\r\n        exitOnEsc: false,\r\n        exitOnOverlayClick: false,\r\n        skipLabel: \"Abort\",\r\n        steps: [\r\n            {\r\n                element: document.querySelector(\"#notesWidget\"),\r\n                intro: \"<h4>System notes widget</h4><br/><p>Displays comments based on the currently <b>selected</b> Tripwire system.</p><br/><p>The rest of this tutorial will guide you through actually adding a comment, but don't worry we will switch you to your private Tripwire mask so we don't disturb anyone else.</p><br/><p>When you finish or leave this tutorial we will switch you back to your previous Tripwire mask.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#add-comment\"),\r\n                intro: \"<p>Now click the + icon to begin adding a new comment in this system (\" + viewingSystem + \").</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#notesWidget\"),\r\n                intro: \"<p>Type some basic text now and click save.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#notesWidget\"),\r\n                intro: \"<p>This is our newly created comment. Hover over the comment with your mouse to see additional information and controls.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#notesWidget\"),\r\n                intro: \"<p>You can click the 'pin' or 'sticky' button to toggle showing this comment for every system, not just this system.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#notesWidget\"),\r\n                intro: \"<p>Use the <b>Edit</b> to modify a comment and <b>Delete</b> to remove a comment.</p><br/><p>You can also quickly edit any comment by simply doubling clicking anywhere on it.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#notesWidget\"),\r\n                intro: \"<p>Click on the <b>Edit</b> now on our comment.</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#notesWidget\"),\r\n                intro: \"<p>The toolbar at the top allows you to customize your notes.</p><br/><p>You can also click on the <b>Maximize/Minimize</b> button (the far right toolbar icon) to edit this comment in full screen mode.</p><br/><p>In full screen mode you will see 1 new button added to the toolbar to view the source code of the comment where you can write HTML, CSS, and even Javascript in your notes!</p>\"\r\n            },\r\n            {\r\n                element: document.querySelector(\"#notesWidget\"),\r\n                intro: \"<p>This concludes the tutorial, we will now switch you back to your previous Tripwire mask and delete the comment we created.</p>\"\r\n            }\r\n        ]\r\n    }).start();\r\n\r\n    tutorial.onchange(function(element) {\r\n        switch(tutorial._currentStep) {\r\n            case 1:\r\n                $(\".introjs-prevbutton, .introjs-nextbutton\").hide();\r\n\r\n                console.log(\"switch mask to private\");\r\n                tutorial.previousMask = options.masks.active;\r\n                options.masks.active = options.character.id + \".1\";\r\n                options.save();\r\n\r\n                tutorial.stepFunc = function() {\r\n                    setTimeout(function() {\r\n                        tutorial._options.steps[2].element = $(\"#notesWidget\").find(\".comment:has(.cke_toolbar)\")[0];\r\n                        tutorial.setOption(\"steps\", tutorial._options.steps);\r\n\r\n                        tutorial.exiting = false;\r\n                        tutorial.exit().start().goToStep(3);\r\n                        tutorial.exiting = true;\r\n                    }, 200);\r\n                }\r\n\r\n                $(\"#notesWidget #add-comment\").on(\"click\", tutorial.stepFunc);\r\n                break;\r\n            case 2:\r\n                $(\".introjs-prevbutton, .introjs-nextbutton\").hide();\r\n                $(\"#notesWidget #add-comment\").off(\"click\", tutorial.stepFunc);\r\n\r\n                tutorial.stepFunc = function() {\r\n                    tutorial.comment = $(this).closest(\".comment\");\r\n                    setTimeout(function() {\r\n                        tutorial._options.steps[3].element = tutorial.comment[0];\r\n                        tutorial._options.steps[4].element = tutorial.comment.find(\".commentSticky\")[0];\r\n                        tutorial._options.steps[5].element = tutorial.comment.find(\".commentControls\")[0];\r\n                        tutorial._options.steps[6].element = tutorial.comment.find(\".commentControls\")[0];\r\n                        tutorial.setOption(\"steps\", tutorial._options.steps);\r\n\r\n                        tutorial.exiting = false;\r\n                        tutorial.exit().start().goToStep(4);\r\n                        tutorial.exiting = true;\r\n                    }, 200);\r\n                }\r\n\r\n                $(\"#notesWidget\").on(\"click\", \".commentSave\", tutorial.stepFunc);\r\n                break;\r\n            case 6:\r\n                $(\".introjs-prevbutton, .introjs-nextbutton\").hide();\r\n                $(\"#notesWidget\").off(\"click\", \".commentSave\", tutorial.stepFunc);\r\n\r\n                tutorial.stepFunc = function() {\r\n                    setTimeout(function() {\r\n                        tutorial._options.steps[7].element = $(\"#notesWidget\").find(\".comment:has(.cke_toolbar)\")[0];\r\n                        tutorial._options.steps[8].element = $(\"#notesWidget\").find(\".comment:has(.cke_toolbar)\")[0];\r\n                        tutorial.setOption(\"steps\", tutorial._options.steps);\r\n\r\n                        tutorial.exiting = false;\r\n                        tutorial.exit().start().goToStep(8);\r\n                        tutorial.exiting = true;\r\n                    }, 200);\r\n                }\r\n\r\n                $(\"#notesWidget\").on(\"click\", \".commentEdit\", tutorial.stepFunc);\r\n                break;\r\n        }\r\n    });\r\n\r\n    tutorial.onexit(function() {\r\n        if (tutorial.exiting) {\r\n            $(\".commentCancel:visible\").click();\r\n            // delete the tutorial comment that was created\r\n            if (tutorial.comment) {\r\n                var data = {\"mode\": \"delete\", \"commentID\": tutorial.comment.data(\"id\")};\r\n\r\n                $.ajax({\r\n                    url: \"comments.php\",\r\n                    type: \"POST\",\r\n                    data: data,\r\n                    dataType: \"JSON\"\r\n                }).done(function(data) {\r\n                    if (data && data.result == true) {\r\n                        tutorial.comment.remove();\r\n                    }\r\n                });\r\n            }\r\n\r\n            if (tutorial.previousMask) {\r\n                setTimeout(function() {\r\n                    console.log(\"change mask back, delete comment\", tutorial.previousMask);\r\n                    options.masks.active = tutorial.previousMask;\r\n                    options.save();\r\n                }, 200);\r\n            }\r\n\r\n            // remove event listeners\r\n            $(\"#notesWidget #add-comment\").off(\"click\", tutorial.stepFunc);\r\n            $(\"#notesWidget\").off(\"click\", \".commentSave\", tutorial.stepFunc);\r\n            $(\"#notesWidget\").off(\"click\", \".commentEdit\", tutorial.stepFunc);\r\n            $(\"#notesWidget\").off(\"click\", \".cke_toolgroup:has(.cke_button__toolbarswitch)\", tutorial.stepFunc);\r\n        }\r\n    });\r\n\r\n    tutorial.previousMask;\r\n    tutorial.comment;\r\n    tutorial.stepFunc;\r\n    tutorial.exiting = true;\r\n});\r\n","tripwire.undo = function() {\n    if (tripwire.signatures.undo[viewingSystemID].length > 0) {\n        $(\"#undo\").addClass(\"disabled\");\n        var lastIndex = tripwire.signatures.undo[viewingSystemID].length -1;\n        var data = {\"systemID\": viewingSystemID, \"signatures\": {\"add\": [], \"remove\": [], \"update\": []}};\n\n        var undoItem = tripwire.signatures.undo[viewingSystemID][lastIndex];\n        var redo = $.map(undoItem.signatures, function(signature) {\n            // grab the current signature so we can restore the way it is now\n            if (signature.wormhole && tripwire.client.wormholes[signature.wormhole.id]) {\n                // it was a wormhole and still is\n                return {\"wormhole\": tripwire.client.wormholes[signature.wormhole.id], \"signatures\": [tripwire.client.signatures[signature.signatures[0].id], tripwire.client.signatures[signature.signatures[1].id]]};\n            } else if (tripwire.client.signatures[signature.id] && tripwire.client.signatures[signature.id].type == \"wormhole\") {\n                // it was a regular signature but is now a wormhole\n                var wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n                return {\"wormhole\": wormhole, \"signatures\": [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]};\n            } else if (signature.wormhole && tripwire.client.signatures[signature.signatures[0].id]) {\n                // it was a wormhole but is now a regular signature\n                return tripwire.client.signatures[signature.signatures[0].id];\n            } else {\n                // it was a regular signature and still is\n                return tripwire.client.signatures[signature.id];\n            }\n        });\n\n        switch(undoItem.action) {\n            case \"add\":\n                data.signatures.remove = data.signatures.remove.concat($.map(undoItem.signatures, function(signature) { return signature.wormhole ? signature.wormhole : signature.id }));\n                break;\n            case \"remove\":\n                data.signatures.add = data.signatures.add.concat(undoItem.signatures);\n                break;\n            case \"update\":\n                data.signatures.update = data.signatures.update.concat(undoItem.signatures);\n                break;\n        }\n\n        var success = function(data) {\n            if (data.resultSet && data.resultSet[0].result == true) {\n                tripwire.signatures.undo[viewingSystemID].pop();\n\n                $(\"#redo\").removeClass(\"disabled\");\n                if (viewingSystemID in tripwire.signatures.redo) {\n                    if (undoItem.action == \"remove\") {\n                        // we are adding new signatures we removed so we need the new ids\n                        tripwire.signatures.redo[viewingSystemID].push({\"action\": undoItem.action, \"signatures\": data.results});\n                    } else if (undoItem.action == \"update\") {\n                        tripwire.signatures.redo[viewingSystemID].push({\"action\": undoItem.action, \"signatures\": redo});\n                    } else {\n                        tripwire.signatures.redo[viewingSystemID].push({\"action\": undoItem.action, \"signatures\": undoItem.signatures});\n                    }\n                } else {\n                    if (undoItem.action == \"remove\") {\n                        tripwire.signatures.redo[viewingSystemID] = [{\"action\": undoItem.action, \"signatures\": data.results}];\n                    } else if (undoItem.action == \"update\") {\n                        tripwire.signatures.redo[viewingSystemID] = [{\"action\": undoItem.action, \"signatures\": redo}];\n                    } else {\n                        tripwire.signatures.redo[viewingSystemID] = [{\"action\": undoItem.action, \"signatures\": undoItem.signatures}];\n                    }\n                }\n\n                sessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n                sessionStorage.setItem(\"tripwire_redo\", JSON.stringify(tripwire.signatures.redo));\n            }\n        }\n\n        var always = function(data) {\n            if (tripwire.signatures.undo[viewingSystemID].length > 0) {\n                $(\"#undo\").removeClass(\"disabled\");\n            }\n        }\n\n        tripwire.refresh('refresh', data, success, always);\n    }\n}\n","var activity = new function() {\r\n\tthis.graph;\r\n\tthis.options;\r\n\tthis.view;\r\n\tthis.span = 24;\r\n\tthis.columns = [\r\n\t\t{id: \"time\", label: \"Time\", role: \"domain\", type: \"string\", calc: function(d, r) { return d.getValue(r, 0) + \"h\"; }},\r\n\t\t{id: \"jumps\", label: \"Jumps\", role: \"data\", type: \"number\", sourceColumn: 1, column: 1, title: \"Jumps\"},\r\n\t\t{id: \"podkills\", label: \"Pod Kills\", role: \"data\", type: \"number\", sourceColumn: 2, column: 2, title: \"Pod Kills\"},\r\n\t\t{id: \"shipkills\", label: \"Ship Kills\", role: \"data\", type: \"number\", sourceColumn: 3, column: 3, title: \"Ship Kills\"},\r\n\t\t{id: \"npckills\", label: \"NPC Kills\", role: \"data\", type: \"number\", sourceColumn: 4, column: 4, title: \"NPC Kills\"},\r\n\t\t//{id: \"annotationLabel\", label: \"Test\", role: \"annotation\", type: \"string\", sourceColumn: 5, title: \"Test\"},\r\n\t\t//{id: \"annotationText\", label: \"Test\", role: \"annotationText\", type: \"string\", sourceColumn: 6, title: \"Test\"}\r\n\t];\r\n\r\n\tthis.getData = function(span, cache) {\r\n\t\tvar span = typeof(span) !== \"undefined\" ? span : this.span;\r\n\t\tvar cache = typeof(cache) !== \"undefined\" ? cache : true;\r\n\r\n\t\t// Google hasn't finished loading yet\r\n\t\tif (!activity.graph) {\r\n\t\t\t\tsetTimeout(function() {activity.getData(span, cache)}, 500);\r\n\t\t\t\treturn false;\r\n\t\t}\r\n\r\n\t\treturn $.ajax({\r\n\t\t\turl: \"activity_graph.php\",\r\n\t\t\tdata: {systemID: viewingSystemID, time: span},\r\n\t\t\ttype: \"GET\",\r\n\t\t\tdataType: \"JSON\",\r\n\t\t\tcache: cache\r\n\t\t}).done(function(json) {\r\n\t\t\tif (json) {\r\n\t\t\t\tjson.rows.reverse();\r\n\t\t\t\tactivity.view = new google.visualization.DataView(new google.visualization.DataTable(json));\r\n\t\t\t\tactivity.view.setColumns(activity.columns);\r\n\t\t\t\tactivity.graph.draw(activity.view, activity.options);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\tthis.selectHandler = function() {\r\n\t\tvar selections = activity.graph.getSelection();\r\n\r\n\t\tif (selections[0] && selections[0].row == null) {\r\n\t\t\tvar c = selections[0].column;\r\n\r\n\t\t\tif (activity.columns[c].sourceColumn) {\r\n\t\t\t\t//activity.columns[c].calc = function() { return null };\r\n\t\t\t\tactivity.columns[c].label = activity.columns[c].title + \" (off)\";\r\n\t\t\t\tdelete activity.columns[c].sourceColumn;\r\n\t\t\t} else {\r\n\t\t\t\tactivity.columns[c].sourceColumn = activity.columns[c].column;\r\n\t\t\t\tactivity.columns[c].label = activity.columns[c].title;\r\n\t\t\t\t//delete activity.columns[c].calc;\r\n\t\t\t}\r\n\r\n\t\t\tactivity.view.setColumns(activity.columns);\r\n\t\t\tactivity.options.animation.duration = 0;\r\n\t\t\tactivity.graph.draw(activity.view, activity.options);\r\n\t\t\tactivity.options.animation.duration = 500;\r\n\t\t}\r\n\t}\r\n\r\n\tthis.init = function() {\r\n\t\tactivity.graph = new google.visualization.AreaChart(document.getElementById(\"activityGraph\"));\r\n\t\tactivity.options = {\r\n\t\t\tisStacked: false,\r\n\t\t\tbackgroundColor: \"transparent\",\r\n\t\t\thAxis: {textStyle: {color: \"#999\", fontName: \"Verdana\", fontSize: 10}, showTextEvery: 3},\r\n\t\t\tvAxis: {textStyle: {color: \"#666\", fontName: \"Verdana\", fontSize: 10}, viewWindowMode: \"maximized\", viewWindow: {min: 0}, maxValue: 5},\r\n\t\t\tgridlineColor: \"#454545\",\r\n\t\t\tpointSize: 2,\r\n\t\t\tlineWidth: 1,\r\n\t\t\theight: 150,\r\n\t\t\tchartArea: {left: \"10%\", top: \"5%\", width: \"88%\", height: \"85%\"},\r\n\t\t\tlegend: {position: \"in\", textStyle: {color: \"#CCC\", fontName: \"Verdana\", fontSize: 8.5}},\r\n\t\t\tanimation: {duration: 500, easing: \"inAndout\"},\r\n\t\t\ttooltip: {showColorCode: true},\r\n\t\t\tannotations: {style: \"line\", textStyle: {fontSize: 12, color: \"#ccc\"}, domain: 0},\r\n\t\t\tfocusTarget: \"category\"\r\n\t\t}\r\n\r\n\t\tgoogle.visualization.events.addListener(activity.graph, \"select\", activity.selectHandler);\r\n\r\n\t\tactivity.getData(activity.span);\r\n\t}\r\n\r\n\tthis.time = function(span) {\r\n\t\tswitch(span) {\r\n\t\t\tcase 24:\r\n\t\t\t\tthis.options.hAxis.showTextEvery = 3;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 48:\r\n\t\t\t\tthis.options.hAxis.showTextEvery = 6;\r\n\t\t\t\tbreak;\r\n\t\t\tcase 168:\r\n\t\t\t\tthis.options.hAxis.showTextEvery = 24;\r\n\t\t\t\tbreak;\r\n\t\t}\r\n\r\n\t\tthis.span = span;\r\n\t\tthis.getData(span);\r\n\t}\r\n\r\n\tthis.redraw = function() {\r\n\t\tthis.graph.draw(this.view, this.options);\r\n\t}\r\n\r\n\tthis.refresh = function(cache) {\r\n\t\tthis.getData(this.span, cache);\r\n\t}\r\n\r\n\tgoogle.charts.setOnLoadCallback(this.init);\r\n}\r\n","var CKConfig = {\n\tskin: \"custom\",\n\theight: 100,\n\tallowedContent: true,\n\textraPlugins: \"toolbarswitch,autogrow,autolink\",\n\tenterMode: CKEDITOR.ENTER_BR,\n\tremoveDialogTabs: 'link:advanced',\n\tautoGrow_onStartup: true,\n\tautoGrow_minHeight: 100,\n\ttoolbar_minToolbar: [\n\t\t{name: \"basicstyles\", items: [\"Bold\", \"Italic\", \"Underline\", \"Strike\"]},\n\t\t{name: \"paragraph\", items: [\"BulletedList\", \"Outdent\", \"Indent\"]},\n\t\t{name: \"links\", items: [\"Link\"]},\n\t\t{name: \"colors\", items: [\"TextColor\", \"BGColor\"]},\n\t\t{name: \"styles\", items: [\"FontSize\"]},\n\t\t{name: \"tools\", items: [\"Toolbarswitch\"]}\n\t],\n\ttoolbar_maxToolbar: [\n\t\t{name: \"basicstyles\", items: [\"Bold\", \"Italic\", \"Underline\", \"Strike\", \"Subscript\", \"Superscript\"]},\n\t\t{name: \"paragraph\", items: [\"NumberedList\", \"BulletedList\", \"Outdent\", \"Indent\"]},\n\t\t{name: \"links\", items: [\"Link\"]},\n\t\t{name: \"colors\", items: [\"TextColor\", \"BGColor\"]},\n\t\t{name: \"styles\", items: [\"FontSize\", \"Font\"]},\n\t\t{name: \"tools\", items: [\"Source\", \"Toolbarswitch\"]}\n\t],\n\ttoolbar: \"minToolbar\",\n\tsmallToolbar: \"minToolbar\",\n\tmaximizedToolbar: \"maxToolbar\",\n\tfontSize_style: {\n\t    element:        'span',\n\t    styles:         { 'font-size': '#(size)' },\n\t    overrides:      [ { element :'font', attributes: { 'size': null } } ]\n\t}\n}\n\nCKEDITOR.on(\"instanceLoaded\", function(cke) {\n\tcke.editor.on(\"contentDom\", function() {\n\t\tcke.editor.on(\"key\", function(e) {\n\t\t\tif (e.data.keyCode == 27) {\n\t\t\t\t// escape key cancels\n\t\t\t\t$(cke.editor.element.$).closest(\".comment\").find(\".commentCancel\").click();\n\t\t\t\treturn false;\n\t\t\t} else if (e.data.domEvent.$.altKey && e.data.domEvent.$.keyCode == 83) {\n\t\t\t\t// alt+s saves\n\t\t\t\t$(cke.editor.element.$).closest(\".comment\").find(\".commentSave\").click();\n\t\t\t\treturn false;\n\t\t\t}\n\t\t});\n\t});\n\n\t$(\".cke_combo__font a\")\n\t\t.removeClass(\"cke_combo_button\")\n\t\t.addClass(\"cke_button cke_button_off\")\n\t\t.html('<span class=\"cke_button_icon\">&nbsp;</span>')\n\n\t$(\".cke_combo__fontsize a\")\n\t\t.removeClass(\"cke_combo_button\")\n\t\t.addClass(\"cke_button cke_button_off\")\n\t\t.html('<span class=\"cke_button_icon\">&nbsp;</span>')\n});\n\nCKEDITOR.on(\"instanceReady\", function(cke) {\n\t// ensure focus on init\n\tcke.editor.focus();\n\n\tvar s = cke.editor.getSelection(); // getting selection\n\tvar selected_ranges = s.getRanges(); // getting ranges\n\tvar node = selected_ranges[0].startContainer; // selecting the starting node\n\tvar parents = node.getParents(true);\n\n\tnode = parents[parents.length - 2].getFirst();\n\n\tif (!node) return false;\n\n\twhile (true) {\n\t\tvar x = node.getNext();\n\t\tif (x == null) {\n\t\t\tbreak;\n\t\t}\n\t\tnode = x;\n\t}\n\n\ts.selectElement(node);\n\tselected_ranges = s.getRanges();\n\tselected_ranges[0].collapse(false);  //  false collapses the range to the end of the selected node, true before the node.\n\ts.selectRanges(selected_ranges);  // putting the current selection there\n});\n\nCKEDITOR.on(\"dialogDefinition\", function(ev) {\n\tif (ev.data.name == 'link') {\n\t\tev.data.definition.getContents('target').get('linkTargetType')['default'] = '_blank';\n\t}\n});\n","const fw = new _FactionWarfare();\r\n\r\nfunction _FactionWarfare() {\r\n\tconst _this = this;\r\n\tthis.listeners = [];\r\n\tthis.data = null;\r\n\tthis.systems = {};\r\n\tthis.SamanuniAthounonGateOpen = true;\r\n\t\r\n\t/** Refresh the FW data from the public ESI endpoint */\r\n\tthis.refresh = function() {\r\n\t\t$.ajax({\r\n\t\t\turl: 'cached_third_party.php?key=fw',\r\n\t\t\ttype: \"GET\",\r\n\t\t\tdataType: \"JSON\"\r\n\t\t}).done(function(data, status, xhr) {\t\r\n\t\t\tif(!_.isEqual(data, _this.data)) {\r\n\t\t\t\tconsole.info('Updating faction warfare status');\r\n\t\t\t\t_this.data = data;\r\n\t\t\t\t_this.parse(data);\r\n\t\t\t\ttripwire.systemChange(viewingSystemID);\r\n\t\t\t\tguidance.clearCache();\r\n\t\t\t}\r\n\t\t}).fail(function(xhr, status, error) {\r\n\t\t\tconsole.warn('Failed to fetch FW data from ESI: ' + status, error);\r\n\t\t});\r\n\t};\t\r\n\t\r\n\tthis.parse = function(data) {\r\n\t\tthis.systems = {};\r\n\t\tfor(var i = 0; i < data.length; i++) { this.systems[data[i].solar_system_id] = data[i]; }\r\n\t\tthis.SamanuniAthounonGateOpen = this.systems[30003856].occupier_faction_id == 500001;\r\n\t}\r\n\t\r\n\t// Guidance plugin\r\n\tthis.adjustJumpCost = function(from, to, cost) {\r\n\t\tconst gateOpen = this.SamanuniAthounonGateOpen || !((from == 3856 && to == 45322) || (to == 3856 && from == 45322));\r\n\t\treturn gateOpen ? cost : -1;\r\n\t}.bind(this);\t// because it's called from outside\r\n\tguidance.jumpCostModifiers.push(this.adjustJumpCost);\r\n\t\r\n\t/** Gets the markup for faction text for a system. If it's in FW, it will show contested status; if not it will just show the faction */\r\n\tthis.factionMarkup = function(system) {\r\n\t\treturn system.factionID ? (\r\n\t\t\t_this.systems[system.systemID] ? \r\n\t\t\t\tappData.factions[_this.systems[system.systemID].occupier_faction_id].name + ' (FW: ' + \r\n\t\t\t\t\t(_this.systems[system.systemID].contested == 'uncontested' ? 'uncontested' : \r\n\t\t\t\t\t\tMath.floor(100 * _this.systems[system.systemID].victory_points / _this.systems[system.systemID].victory_points_threshold) + '% contested') + ')'\r\n\t\t\t\t: appData.factions[system.factionID].name\r\n\t\t) : \"&nbsp;\";\r\n\t};\r\n\t\r\n\tsetInterval(this.refresh, 3600000);\r\n\tthis.refresh();\t\r\n}","const wormholeAnalysis = new function() {\r\n\t/** Finds the ID for a target system or system type for the given system name text and wormhole type.\r\n\t@param systemText The name of a system, or a system class from appData.genericSystemTypes, e.g. 'Low-Sec'\r\n\t@param wormholeType The type text of a wormhole e.g. 'U210'\r\n\t@return An ID - either a systemID (31001031), a system type ID (7) or null if there isn't enough information */\r\n\tthis.targetSystemID = function(systemText, wormholeType) {\r\n\t\tconst lookupText = systemText || (appData.wormholes[(wormholeType + '').toUpperCase()] || {}).leadsTo;\r\n\t\tif(!lookupText) { return null; }\r\n\t\tif (Object.index(appData.systems, \"name\", lookupText, true)) {\r\n\t\t\t// Leads To is a normal EVE system, so use the sytem ID\r\n\t\t\treturn Object.index(appData.systems, \"name\", lookupText, true)\r\n\t\t} else if (wormholeType && appData.wormholes[wormholeType.toUpperCase()]) {\r\n\t\t\t// Leads To can be determined by the wormhole type, so lets use what we know it leads to\r\n\t\t\tif (appData.genericSystemTypes.findIndex((item) => lookupText.replace(' ', '-').toLowerCase() === item.toLowerCase()) > -1) {\r\n\t\t\t\treturn appData.genericSystemTypes.findIndex((item) => lookupText.replace(' ', '-').toLowerCase() === item.toLowerCase());\r\n\t\t\t}\r\n\t\t} else if (appData.genericSystemTypes.findIndex((item) => lookupText.toLowerCase() === item.toLowerCase()) !== -1) {\r\n\t\t\t// Leads To is one of the valid types we allow, so use of of those indexes as reference\r\n\t\t\treturn appData.genericSystemTypes.findIndex((item) => systemText.toLowerCase() === item.toLowerCase());\r\n\t\t} else { return null; }\r\n\t};\r\n\t\r\n\t/** Get all the eligible wormhole types for this connection.\r\n\tIf both systems are known (e.g. C3 to C2) then only wormhole types matching that specific connection will be returned. If either side is unknown then all connections to/from the known side are listed, which will be quite large. If both are unknown then return null (as it could be any wormhole).\r\n\t@param sourceID The system ID, type ID (into genericSystemType) or chain format string (e.g. 2|1232) for the source system\r\n\t@param targetID As above for the target system\r\n\t@param dataSource A source set of wormhole types to evaluate (defaults to appData.wormholes)\r\n\t@return An object of the form { from: [...], to: [...] } where each list is the wormhole types (from appData.wormholes) eligible for that direction */\r\n\tthis.eligibleWormholeTypes = function(sourceDef, targetDef, dataSource) {\r\n\t\tconst coerce = function(def) { return def === undefined || def === null || def.genericSystemType ? def : systemAnalysis.analyse(def); };\r\n\t\tconst source = coerce(sourceDef), target = coerce(targetDef);\r\n\t\t\r\n\t\tif(!source && !target) { return null; }\r\n\t\t\r\n\t\tconst from = [], to = [];\r\n\t\tconst matches = function(possibleSystems, exclusions, system) {\r\n\t\t\tif(typeof possibleSystems === 'string') { possibleSystems = [possibleSystems]; }\r\n\t\t\treturn (!system) || (\r\n\t\t\t\t((!possibleSystems) || (possibleSystems.indexOf(system.name) >= 0 || possibleSystems.indexOf(system.genericSystemType) >= 0)) && \r\n\t\t\t\t((!exclusions) || exclusions.indexOf(system.genericSystemType) < 0)\t// no exclusion\r\n\t\t\t);\r\n\t\t}\r\n\t\tObject.entries(dataSource || appData.wormholes).forEach(function(e) {\r\n\t\t\tconst wt = e[1], key = e[0];\r\n\t\t\tif(matches(wt.from, wt.notFrom, source) && matches(wt.leadsTo, wt.notLeadsTo, target)) { from.push(objAndKey(wt, key)); }\r\n\t\t\tif(matches(wt.from, wt.notFrom, target) && matches(wt.leadsTo, wt.notLeadsTo, source)) { to.push(objAndKey(wt, key)); }\r\n\t\t});\r\n\t\treturn { from: from, to: to };\r\n\t}\r\n\t\r\n\tfunction objAndKey(o, k) { return o && Object.assign({key: k}, o); }\r\n\t\r\n\t/** Placeholder wormholes which don't have an exact known type, but still provide some information */\r\n\tthis.dummyWormholes = {\r\n\t\t\"GATE\": { from: [ \"Null-Sec\", \"Low-Sec\", \"High-Sec\", \"Triglavian\"], leadsTo: [ \"Null-Sec\", \"Low-Sec\", \"High-Sec\", \"Triglavian\"] },\r\n\t\t\"SML\": { \"jump\": 5000000 },\r\n\t\t\"MED\": { \"jump\": 62000000 },\r\n\t\t\"LRG\": { \"jump\": 375000000 },\r\n\t\t\"XLG\": { \"jump\": 2000000000 }\r\n\t};\r\n\t\r\n\t/** Get the wormhole type object from the type names for a sig pair. One of the types is probably K162 */\r\n\tthis.wormholeFromTypePair = function(type1, type2) {\r\n\t\treturn appData.wormholes[type1] || appData.wormholes[type2] ||\r\n\t\t\tthis.dummyWormholes[type1] || this.dummyWormholes[type2] ||\r\n\t\t\tundefined;\t// we don't know anything\r\n\t}\r\n\t\r\n\tthis.likelyWormhole = function(system1, system2) {\r\n\t\tconst class1 = systemAnalysis.analyse(system1).class,\r\n\t\t\tclass2 = systemAnalysis.analyse(system2).class;\r\n\t\treturn this.dummyWormholes[\r\n\t\t\tclass1 == 13 || class2 == 13 ? 'SML' :\r\n\t\t\tclass1 == 1 || class2 == 1 ? 'MED' :\r\n\t\t\tclass1 >= 5 && class2 >= 5 ? 'XLG' :\r\n\t\t\t'LRG'\r\n\t\t];\r\n\t}\r\n}","$(\"#admin\").click(function(e) {\r\n\te.preventDefault();\r\n\r\n\tif ($(this).hasClass(\"disabled\")) {\r\n\t\treturn false;\r\n\t}\r\n\r\n\tif (!$(\"#dialog-admin\").hasClass(\"ui-dialog-content\")) {\r\n\t\tvar refreshTimer = null;\r\n\t\tvar $total = null;\r\n\t\tvar $ajax = null;\r\n\r\n\t\tfunction refreshWindow() {\r\n\t\t\tif ($ajax) $ajax.abort();\r\n\t\t\t$total.html(\"Total: \" + $(\"#dialog-admin .window .hasFocus table tr[data-id]\").length);\r\n\r\n\t\t\t$ajax = $.ajax({\r\n\t\t\t\turl: \"admin.php\",\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdata: {mode: $(\"#dialog-admin .menu .active\").attr(\"data-window\")},\r\n\t\t\t\tdataType: \"JSON\"\r\n\t\t\t}).done(function(data) {\r\n\t\t\t\tif (data && data.results) {\r\n\t\t\t\t\tvar rows = data.results;\r\n\t\t\t\t\tvar ids = [];\r\n\r\n\t\t\t\t\tfor (var i = 0, l = rows.length; i < l; i++) {\r\n\t\t\t\t\t\tvar $row = $(\"#dialog-admin .window .hasFocus tbody tr[data-id='\"+ rows[i].id +\"']\");\r\n\t\t\t\t\t\tids.push(rows[i].id);\r\n\r\n\t\t\t\t\t\tif ($row.length) {\r\n\t\t\t\t\t\t\tfor (col in rows[i]) {\r\n\t\t\t\t\t\t\t\tvar $col = $row.find(\"[data-col='\"+col+\"']\");\r\n\t\t\t\t\t\t\t\t$col.html(($col.attr(\"data-format\") == \"number\" ? Intl.NumberFormat().format(rows[i][col]) : rows[i][col]) || \"&nbsp;\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t$row = $(\"#dialog-admin .window .hasFocus table tr.hidden\").clone();\r\n\t\t\t\t\t\t\t$row.attr(\"data-id\", rows[i].id);\r\n\r\n\t\t\t\t\t\t\tfor (col in rows[i]) {\r\n\t\t\t\t\t\t\t\tvar $col = $row.find(\"[data-col='\"+col+\"']\");\r\n\t\t\t\t\t\t\t\t$col.html(($col.attr(\"data-format\") == \"number\" ? Intl.NumberFormat().format(rows[i][col]) : rows[i][col]) || \"&nbsp;\");\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t$row.removeClass(\"hidden\");\r\n\r\n\t\t\t\t\t\t\t$(\"#dialog-admin .window .hasFocus tbody\").append($row);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$(\"#dialog-admin .window .hasFocus table tr[data-id]\").each(function() {\r\n\t\t\t\t\t\tif ($.inArray($(this).data(\"id\").toString(), ids) == -1) {\r\n\t\t\t\t\t\t\t$(this).remove();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(\"#dialog-admin .window .hasFocus table\").trigger(\"update\", [true]);\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(\"#dialog-admin .window .hasFocus table tr[data-id]\").remove();\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$total.html(\"Total: \" + $(\"#dialog-admin .window .hasFocus table tr[data-id]\").length);\r\n\t\t\t});\r\n\r\n\t\t\tif ($(\"#dialog-admin\").dialog(\"isOpen\") && $(\"#dialog-admin .menu .active\").attr(\"data-refresh\")) {\r\n\t\t\t\trefreshTimer = setTimeout(refreshWindow, $(\"#dialog-admin .menu .active\").attr(\"data-refresh\"));\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t$(\"#dialog-admin\").dialog({\r\n\t\t\tautoOpen: true,\r\n\t\t\tmodal: true,\r\n\t\t\theight: 350,\r\n\t\t\twidth: 800,\r\n\t\t\tbuttons: {\r\n\t\t\t\tClose: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcreate: function() {\r\n\t\t\t\t// menu toggle\r\n\t\t\t\t$(\"#dialog-admin\").on(\"click\", \".menu li\", function(e) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\t$menuItem = $(this);\r\n\t\t\t\t\tclearTimeout(refreshTimer);\r\n\r\n\t\t\t\t\t$(\"#dialog-admin .menu .active\").removeClass(\"active\");\r\n\t\t\t\t\t$menuItem.addClass(\"active\");\r\n\t\t\t\t\t$(\"div.ui-dialog[aria-describedby='dialog-admin'] .ui-dialog-traypane\").html(\"\");\r\n\r\n\t\t\t\t\t$(\"#dialog-admin .window [data-window]\").removeClass(\"hasFocus\").hide();\r\n\t\t\t\t\t$(\"#dialog-admin .window [data-window='\"+ $menuItem.data(\"window\") +\"']\").addClass(\"hasFocus\").show();\r\n\r\n\t\t\t\t\trefreshWindow();\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(\"#dialog-admin [data-sortable='true']\").tablesorter({\r\n\t\t\t\t\tsortReset: true,\r\n\t\t\t\t\twidgets: ['saveSort'],\r\n\t\t\t\t\tsortList: [[0,0]]\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// dialog bottom tray\r\n\t\t\t\t$($(this)[0].parentElement).find(\".ui-dialog-buttonpane\").append(\"<div class='ui-dialog-traypane'></div>\");\r\n\t\t\t\t$total = $(\"div.ui-dialog[aria-describedby='dialog-admin'] .ui-dialog-traypane\");\r\n\t\t\t},\r\n\t\t\topen: function() {\r\n\t\t\t\t$menuItem = $(\"#dialog-admin .menu li.active\");\r\n\t\t\t\trefreshWindow();\r\n\t\t\t},\r\n\t\t\tclose: function() {\r\n\t\t\t\tclearTimeout(refreshTimer);\r\n\t\t\t}\r\n\t\t});\r\n\t} else if (!$(\"#dialog-admin\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-admin\").dialog(\"open\");\r\n\t}\r\n});\r\n","// Dialog effects\r\n$(\"#wrapper\").addClass(\"transition\");\r\n\r\n$(document).on(\"dialogopen\", \".ui-dialog\", function (event, ui) {\r\n\t// Add additional full screen overlay for 2nd level dialog\r\n\tif ($(\".ui-dialog:visible\").length == 2 && $(this).hasClass(\"dialog-modal\"))\r\n\t\t$(\"body\").append($(\"<div id='overlay' class='overlay' />\").css(\"z-index\", $(this).css(\"z-index\") - 1));\r\n\telse if ($(\"#overlay\"))\r\n\t\t$(\"#overlay\").css(\"z-index\", $(this).css(\"z-index\") - 1);\r\n\r\n\tif (!$(this).hasClass(\"dialog-noeffect\"))\r\n\t\t$(\"#wrapper\").addClass(\"blur\");\r\n});\r\n\r\n$(document).on(\"dialogclose\", \".ui-dialog\", function (event, ui) {\r\n\tif (!$(\".ui-dialog\").is(\":visible\"))\r\n\t\t$(\"#wrapper\").removeClass(\"blur\");\r\n\r\n\tif ($(\".ui-dialog:visible\").length == 1)\r\n\t\t$(\"#overlay\").remove();\r\n\telse if ($(\"#overlay\"))\r\n\t\t$(\"#overlay\").css(\"z-index\", $(this).css(\"z-index\") - 2);\r\n\r\n\t//if ($(\".ui-dialog:visible\").length == 0 && options.buttons.follow && viewingSystemID != tripwire.client.EVE.systemID)\r\n\t//\twindow.location = \"?system=\"+tripwire.client.EVE.systemName;\r\n});\r\n\r\n","$(\".options\").click(function(e) {\r\n\te.preventDefault();\r\n\r\n\tif ($(this).hasClass(\"disabled\"))\r\n\t\treturn false;\r\n\r\n\t$(\"#dialog-options\").dialog({\r\n\t\tautoOpen: false,\r\n\t\twidth: 450,\r\n\t\tminHeight: 400,\r\n\t\tmodal: true,\r\n\t\tbuttons: {\r\n\t\t\tSave: function() {\r\n\t\t\t\t// Options\r\n\t\t\t\tvar data = {mode: \"set\", options: JSON.stringify(options)};\r\n\t\t\t\tvar maskChange = false;\r\n\r\n\t\t\t\t$(\"#dialog-options\").parent().find(\".ui-dialog-buttonpane button:contains('Save')\").attr(\"disabled\", true).addClass(\"ui-state-disabled\");\r\n\r\n\t\t\t\toptions.chain.typeFormat = $(\"#dialog-options #typeFormat\").val();\r\n\t\t\t\toptions.chain.classFormat = $(\"#dialog-options #classFormat\").val();\r\n\t\t\t\t\r\n\t\t\t\toptions.chain.sigNameLocation = $(\"#dialog-options #chainSigNameLocation\").val();\r\n\t\t\t\toptions.chain.routingLimit = 1 * $(\"#dialog-options #chainRoutingLimit\").val();\r\n\t\t\t\toptions.chain.routeSecurity = $(\"#dialog-options #chainRouteSecurity\").val();\r\n\t\t\t\toptions.chain.routeIgnore.enabled = $(\"#dialog-options #route-ignore-enabled\").prop('checked');\r\n\t\t\t\toptions.chain.routeIgnore.systems = $(\"#dialog-options #route-ignore\").val().split(\",\").map(x => x.trim());\r\n\r\n\t\t\t\toptions.chain.gridlines = JSON.parse($(\"#dialog-options input[name=gridlines]:checked\").val());\r\n\t\t\t\toptions.chain.aura = JSON.parse($(\"#dialog-options input[name=aura]:checked\").val());\r\n\r\n\t\t\t\toptions.chain.nodeSpacing.x = $(\"#dialog-options #node-spacing-x-slider\").slider(\"value\");\r\n\t\t\t\toptions.chain.nodeSpacing.y = $(\"#dialog-options #node-spacing-y-slider\").slider(\"value\");\r\n\t\t\t\t\r\n\t\t\t\toptions.chain[\"node-reference\"] = $(\"#dialog-options input[name=node-reference]:checked\").val();\r\n\t\t\t\t\r\n\t\t\t\toptions.chain.renderer = $(\"#dialog-options #renderer\").val();\r\n\r\n\t\t\t\toptions.signatures.editType = $(\"#dialog-options #editType\").val();\r\n\r\n\t\t\t\toptions.signatures.pasteLife = $(\"#dialog-options #pasteLife\").val();\r\n\r\n\t\t\t\toptions.signatures.copySeparator = $(\"#dialog-options #copySeparator\").val();\r\n\r\n\t\t\t\toptions.background = $(\"#dialog-options #background-image\").val();\r\n\r\n\t\t\t\toptions.uiscale = $(\"#dialog-options #uiscale-slider\").slider(\"value\");\r\n\r\n\t\t\t\tif (options.masks.active != $(\"#dialog-options input[name='mask']:checked\").val()) {\r\n\t\t\t\t\tmaskChange = true;\r\n\t\t\t\t}\r\n\r\n\t\t\t\toptions.masks.active = $(\"#dialog-options input[name='mask']:checked\").val();\r\n\r\n\t\t\t\toptions.apply();\r\n\t\t\t\toptions.save() // Performs AJAX\r\n\t\t\t\t\t.done(function() {\r\n\t\t\t\t\t\tif (maskChange) {\r\n\t\t\t\t\t\t\t// Reset signatures\r\n\t\t\t\t\t\t\t$(\"#sigTable span[data-age]\").countdown(\"destroy\");\r\n\t\t\t\t\t\t\t$(\"#sigTable tbody\").empty()\r\n\t\t\t\t\t\t\t$(\"#signature-count\").html(0);\r\n\t\t\t\t\t\t\ttripwire.signatures.list = {};\r\n\t\t\t\t\t\t\ttripwire.client.signatures = [];\r\n\r\n\t\t\t\t\t\t\ttripwire.refresh('change');\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\r\n\r\n\t\t\t\t$(\"#dialog-options\").dialog(\"close\");\r\n\t\t\t\t$(\"#dialog-options\").parent().find(\".ui-dialog-buttonpane button:contains('Save')\").attr(\"disabled\", false).removeClass(\"ui-state-disabled\");\r\n\r\n\t\t\t\t// toggle mask admin icon\r\n\t\t\t\t$(\"#dialog-options input[name='mask']:checked\").data(\"admin\") ? $(\"#admin\").removeClass(\"disabled\") : $(\"#admin\").addClass(\"disabled\");\r\n\t\t\t},\r\n\t\t\tReset: function() {\r\n\t\t\t\t$(\"#dialog-confirm #msg\").html(\"Settings will be reset to defaults temporarily.<br/><br/><p><em>Save settings to make changes permanent.</em></p>\");\r\n\t\t\t\t$(\"#dialog-confirm\").dialog(\"option\", {\r\n\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\tReset: function() {\r\n\t\t\t\t\t\t\toptions.reset();\r\n\t\t\t\t\t\t\toptions.apply();\r\n\r\n\t\t\t\t\t\t\t$(\"#dialog-options\").dialog(\"close\");\r\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}).dialog(\"open\");\r\n\t\t\t},\r\n\t\t\tClose: function() {\r\n\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t}\r\n\t\t},\r\n\t\topen: function() {\r\n\t\t\t// Get user stats data\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: \"user_stats.php\",\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdataType: \"JSON\"\r\n\t\t\t}).done(function(data) {\r\n\t\t\t\tfor (i in data.stats) {\r\n\t\t\t\t\tfor (x in data.stats[i]) {\r\n\t\t\t\t\t\t$(\"#optionsAccordion #\"+ x).text(data.stats[i][x]);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t$(\"#optionsAccordion #systems_visited\").text(data.system_visits);\r\n\t\t\t\t$(\"#optionsAccordion #logins\").text(data.account.logins);\r\n\t\t\t\t$(\"#optionsAccordion #lastLogin\").text(data.account.lastLogin);\r\n\t\t\t\t$(\"#optionsAccordion #username\").text(data.username);\r\n\t\t\t});\r\n\r\n\t\t\t// Get masks\r\n\t\t\t$.ajax({\r\n\t\t\t\turl: \"masks.php\",\r\n\t\t\t\ttype: \"POST\",\r\n\t\t\t\tdataType: \"JSON\"\r\n\t\t\t}).done(function(response) {\r\n\t\t\t\tif (response && response.masks) {\r\n\t\t\t\t\t$(\"#dialog-options #masks #default\").html(\"\");\r\n\t\t\t\t\t$(\"#dialog-options #masks #personal\").html(\"\");\r\n\t\t\t\t\t$(\"#dialog-options #masks #corporate\").html(\"\");\r\n\r\n\t\t\t\t\tfor (var x in response.masks) {\r\n\t\t\t\t\t\tvar mask = response.masks[x];\r\n\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t+ '<input type=\"radio\" name=\"mask\" id=\"mask'+x+'\" value=\"'+mask.mask+'\" class=\"selector\" data-owner=\"'+mask.owner+'\" data-admin=\"'+mask.admin+'\" />'\r\n\t\t\t\t\t\t\t+ '<label for=\"mask'+x+'\"><img src=\"'+mask.img+'\" />'\r\n\t\t\t\t\t\t\t+  (mask.optional ? '<i class=\"closeIcon\" onclick=\"return false;\" data-icon=\"red-giant\"><i data-icon=\"times\"></i></i>' : '')\r\n\t\t\t\t\t\t\t+ '<span class=\"selector_label\">'+mask.label+'</span></label>');\r\n\r\n\t\t\t\t\t\t$(\"#dialog-options #masks #\"+mask.type).append(node);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"find\" id=\"findp\" value=\"personal\" class=\"selector\" disabled=\"disabled\" />'\r\n\t\t\t\t\t\t+ '<label for=\"findp\"><i data-icon=\"search\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i></label>');\r\n\t\t\t\t\t$(\"#dialog-options #masks #personal\").append(node);\r\n\r\n\t\t\t\t\tif (init.admin == \"1\") {\r\n\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"find\" id=\"findc\" value=\"corporate\" class=\"selector\" disabled=\"disabled\" />'\r\n\t\t\t\t\t\t\t+ '<label for=\"findc\"><i data-icon=\"search\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i></label>');\r\n\t\t\t\t\t\t$(\"#dialog-options #masks #corporate\").append(node);\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$(\"#dialog-options input[name='mask']\").filter(\"[value='\"+response.masks[response.active].mask+\"']\").attr(\"checked\", true).trigger(\"change\");\r\n\r\n\t\t\t\t\t// toggle mask admin icon\r\n\t\t\t\t\tresponse.masks[response.active].admin ? $(\"#admin\").removeClass(\"disabled\") : $(\"#admin\").addClass(\"disabled\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#dialog-options #editType\").val(options.signatures.editType);\r\n\t\t\t$(\"#dialog-options #pasteLife\").val(options.signatures.pasteLife);\r\n\t\t\t$(\"#dialog-options #copySeparator\").val(options.signatures.copySeparator);\r\n\t\t\t$(\"#dialog-options #typeFormat\").val(options.chain.typeFormat);\r\n\t\t\t$(\"#dialog-options #chainRoutingLimit\").val(options.chain.routingLimit);\r\n\t\t\t$(\"#dialog-options #chainSigNameLocation\").val(options.chain.sigNameLocation);\r\n\t\t\t$(\"#dialog-options #chainRouteSecurity\").val(options.chain.routeSecurity);\r\n\t\t\t$(\"#dialog-options #route-ignore-enabled\").prop('checked', options.chain.routeIgnore.enabled);\r\n\t\t\t$(\"#dialog-options #route-ignore\").val(options.chain.routeIgnore.systems.join(','));\r\n\t\t\t$(\"#dialog-options #renderer\").val(options.chain.renderer);\r\n\t\t\t$(\"#dialog-options #classFormat\").val(options.chain.classFormat);\r\n\t\t\t$(\"#dialog-options input[name='node-reference'][value='\"+options.chain[\"node-reference\"]+\"']\").prop(\"checked\", true);\r\n\t\t\t$(\"#dialog-options input[name='gridlines'][value='\"+options.chain.gridlines+\"']\").prop(\"checked\", true);\r\n\t\t\t$(\"#dialog-options input[name='aura'][value='\"+options.chain.aura+\"']\").prop(\"checked\", true);\r\n\t\t\t$(\"#dialog-options #node-spacing-x-slider\").slider(\"value\", options.chain.nodeSpacing.x);\r\n\t\t\t$(\"#dialog-options #node-spacing-y-slider\").slider(\"value\", options.chain.nodeSpacing.y);\r\n\t\t\t$(\"#dialog-options #background-image\").val(options.background);\r\n\t\t},\r\n\t\tcreate: function() {\r\n\t\t\t$(\"#optionsAccordion\").accordion({heightStyle: \"content\", collapsible: true, active: false});\r\n\t\t\tfunction setUpSlider(id, value, change) {\r\n\t\t\t\t$(\"#\" + id).slider({\r\n\t\t\t\t\tmin: 0.7,\r\n\t\t\t\t\tmax: 1.4,\r\n\t\t\t\t\tstep: 0.05,\r\n\t\t\t\t\tvalue: value || 1.0,\r\n\t\t\t\t\tchange: change,\r\n\t\t\t\t\tslide: function(e, ui) {\r\n\t\t\t\t\t\t$(\"label[for='\" + id + \"']\").html(ui.value);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(\"label[for='\" + id + \"']\").html($(\"#\" + id).slider(\"value\"));\r\n\t\t\t}\r\n\t\t\tsetUpSlider('uiscale-slider', options.uiscale, function(e, ui) {\r\n\t\t\t\t\t\t$(\"body\").css(\"zoom\", ui.value);\r\n\t\t\t\t\t});\r\n\t\t\tsetUpSlider('node-spacing-x-slider', options.chain.nodeSpacing.x);\r\n\t\t\tsetUpSlider('node-spacing-y-slider', options.chain.nodeSpacing.y);\r\n\r\n\t\t\t$(\"#dialog-pwChange\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tminHeight: 0,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tSave: function() {\r\n\t\t\t\t\t\t$(\"#pwForm\").submit();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tclose: function() {\r\n\t\t\t\t\t$(\"#pwForm input[name='password'], #pwForm input[name='confirm']\").val(\"\");\r\n\t\t\t\t\t$(\"#pwError\").text(\"\").hide();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#pwChange\").click(function() {\r\n\t\t\t\t$(\"#dialog-pwChange\").dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#pwForm\").submit(function(e) {\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t$(\"#pwError\").text(\"\").hide();\r\n\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: \"options.php\",\r\n\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\tdata: $(this).serialize(),\r\n\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t$(\"#dialog-msg #msg\").text(\"Password changed\");\r\n\t\t\t\t\t\t$(\"#dialog-msg\").dialog(\"open\");\r\n\r\n\t\t\t\t\t\t$(\"#dialog-pwChange\").dialog(\"close\");\r\n\t\t\t\t\t} else if (response && response.error) {\r\n\t\t\t\t\t\t$(\"#pwError\").text(response.error).show(\"slide\", {direction: \"up\"});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$(\"#pwError\").text(\"Unknown error\").show(\"slide\", {direction: \"up\"});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#dialog-usernameChange\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tminHeight: 0,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tSave: function() {\r\n\t\t\t\t\t\t$(\"#usernameForm\").submit();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\topen: function() {\r\n\t\t\t\t\t$(\"#usernameForm #username\").html($(\"#dialog-options #username\").html());\r\n\t\t\t\t},\r\n\t\t\t\tclose: function() {\r\n\t\t\t\t\t$(\"#usernameForm [name='username']\").val(\"\");\r\n\t\t\t\t\t$(\"#usernameError\").text(\"\").hide();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#usernameChange\").click(function() {\r\n\t\t\t\t$(\"#dialog-usernameChange\").dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#usernameForm\").submit(function(e) {\r\n\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t$(\"#usernameError\").text(\"\").hide();\r\n\r\n\t\t\t\t$.ajax({\r\n\t\t\t\t\turl: \"options.php\",\r\n\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\tdata: $(this).serialize(),\r\n\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t$(\"#dialog-msg #msg\").text(\"Username changed\");\r\n\t\t\t\t\t\t$(\"#dialog-msg\").dialog(\"open\");\r\n\r\n\t\t\t\t\t\t$(\"#dialog-options #username\").html(response.result);\r\n\r\n\t\t\t\t\t\t$(\"#dialog-usernameChange\").dialog(\"close\");\r\n\t\t\t\t\t} else if (response && response.error) {\r\n\t\t\t\t\t\t$(\"#usernameError\").text(response.error).show(\"slide\", {direction: \"up\"});\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$(\"#usernameError\").text(\"Unknown error\").show(\"slide\", {direction: \"up\"});\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t});\r\n\r\n\t\t\t// Mask selections\r\n\t\t\t$(\"#masks\").on(\"change\", \"input.selector:checked\", function() {\r\n\t\t\t\tif ($(this).data(\"owner\")) {\r\n\t\t\t\t\t$(\"#maskControls #edit\").removeAttr(\"disabled\");\r\n\t\t\t\t\t$(\"#maskControls #delete\").removeAttr(\"disabled\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(\"#maskControls #edit\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\t\t$(\"#maskControls #delete\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\t}\r\n\r\n\t\t\t\tif ($(this).val() != 0.0 && $(this).val().split(\".\")[1] == 0) {\r\n\t\t\t\t\t$(\"#dialog-options #leave\").removeAttr(\"disabled\");\r\n\t\t\t\t} else {\r\n\t\t\t\t\t$(\"#dialog-options #leave\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t// Mask join\r\n\t\t\t$(\"#dialog-joinMask\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tresizable: false,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tAdd: function() {\r\n\t\t\t\t\t\tvar mask = $(\"#dialog-joinMask #results input:checked\");\r\n\t\t\t\t\t\tvar label = $(\"#dialog-joinMask #results input:checked+label\");\r\n\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\tdata: {mask: mask.val(), mode: \"join\"},\r\n\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t\t\tlabel.css(\"width\", \"\");\r\n\t\t\t\t\t\t\t\tlabel.find(\".info\").remove();\r\n\t\t\t\t\t\t\t\tlabel.append('<i class=\"closeIcon\" onclick=\"return false;\" data-icon=\"red-giant\"><i data-icon=\"times\"></i></i>');\r\n\r\n\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #\"+response.type+\" input.selector:last\").before(mask).before(label);\r\n\t\t\t\t\t\t\t\t$(\"#dialog-joinMask\").dialog(\"close\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t},\r\n\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcreate: function() {\r\n\t\t\t\t\t$(\"#dialog-joinMask form\").submit(function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t$(\"#dialog-joinMask #results\").html(\"\");\r\n\t\t\t\t\t\t$(\"#dialog-joinMask #loading\").show();\r\n\t\t\t\t\t\t$(\"#dialog-joinMask input[type='submit']\").attr(\"disabled\", \"disabled\");\r\n\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\tdata: $(this).serialize(),\r\n\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t}).then(function(response) {\r\n\t\t\t\t\t\t\tif (response && response.results && response.results.length) {\r\n\t\t\t\t\t\t\t\treturn tripwire.esi.fullLookup(response.eveIDs)\r\n\t\t\t\t\t\t\t\t\t.done(function(results) {\r\n\t\t\t\t\t\t\t\t\t\tif (results) {\r\n\t\t\t\t\t\t\t\t\t\t\tfor (var x in results) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar mask = response.results[x];\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"radio\" name=\"mask\" id=\"mask'+mask.mask+'\" value=\"'+mask.mask+'\" class=\"selector\" data-owner=\"false\" data-admin=\"'+mask.admin+'\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"mask'+mask.mask+'\" style=\"width: 100%; margin-left: -5px;\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<img src=\"'+mask.img+'\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">'+mask.label+'</span>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].name + '<br/>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].category == \"character\" ? results[x].corporation.name +'<br/>' : null)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].alliance ? results[x].alliance.name : '')+'<br/>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t</div>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '</label>');\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-joinMask #results\").append(node);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t} else if (response && response.error) {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(response.error);\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unknown error\");\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}).then(function() {\r\n\t\t\t\t\t\t\t$(\"#dialog-joinMask #loading\").hide();\r\n\t\t\t\t\t\t\t$(\"#dialog-joinMask input[type='submit']\").removeAttr(\"disabled\");\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t})\r\n\t\t\t\t},\r\n\t\t\t\tclose: function() {\r\n\t\t\t\t\t$(\"#dialog-joinMask #results\").html(\"\");\r\n\t\t\t\t\t$(\"#dialog-joinMask input[name='name']\").val(\"\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#dialog-options #masks\").on(\"click\", \"input[name='find']+label\", function() {\r\n\t\t\t\t$(\"#dialog-joinMask input[name='find']\").val($(this).prev().val());\r\n\t\t\t\t$(\"#dialog-joinMask\").dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t// Mask leave\r\n\t\t\t$(\"#dialog-options #masks\").on(\"click\", \".closeIcon\", function() {\r\n\t\t\t\tvar mask = $(this).closest(\"input.selector+label\").prev();\r\n\r\n\t\t\t\t$(\"#dialog-confirm #msg\").text(\"Are you sure you want to remove this mask?\");\r\n\r\n\t\t\t\t$(\"#dialog-confirm\").dialog(\"option\", {\r\n\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\tRemove: function() {\r\n\t\t\t\t\t\t\tvar send = {mode: \"leave\", mask: mask.val()};\r\n\r\n\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\t\tdata: send,\r\n\t\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t\t\t\tmask.next().remove();\r\n\t\t\t\t\t\t\t\t\tmask.remove();\r\n\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\r\n\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unable to delete\");\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}).dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t// Mask delete\r\n\t\t\t$(\"#maskControls #delete\").click(function() {\r\n\t\t\t\tvar mask = $(\"#masks input.selector:checked\");\r\n\r\n\t\t\t\t$(\"#dialog-confirm #msg\").text(\"Are you sure you want to delete this mask?\");\r\n\t\t\t\t$(\"#dialog-confirm\").dialog(\"option\", {\r\n\t\t\t\t\tbuttons: {\r\n\t\t\t\t\t\tDelete: function() {\r\n\t\t\t\t\t\t\tvar send = {mode: \"delete\", mask: mask.val()};\r\n\r\n\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\t\tdata: send,\r\n\t\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t\t\t\tmask.next().remove();\r\n\t\t\t\t\t\t\t\t\tmask.remove();\r\n\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-confirm\").dialog(\"close\");\r\n\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unable to delete\");\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}).dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t// User Create mask\r\n\t\t\t$(\"#dialog-createMask\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tCreate: function() {\r\n\t\t\t\t\t\t$(\"#dialog-createMask form\").submit();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcreate: function() {\r\n\t\t\t\t\t$(\"#dialog-createMask #accessList\").on(\"click\", \"#create_add+label\", function() {\r\n\t\t\t\t\t\t$(\"#dialog-EVEsearch\").dialog(\"open\");\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(\"#dialog-createMask form\").submit(function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\tdata: $(this).serialize(),\r\n\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t\t\t// Get masks\r\n\t\t\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\t\t\tif (response && response.masks) {\r\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #default\").html(\"\");\r\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #personal\").html(\"\");\r\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #corporate\").html(\"\");\r\n\r\n\t\t\t\t\t\t\t\t\t\tfor (var x in response.masks) {\r\n\t\t\t\t\t\t\t\t\t\t\tvar mask = response.masks[x];\r\n\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"radio\" name=\"mask\" id=\"mask'+x+'\" value=\"'+mask.mask+'\" class=\"selector\" data-owner=\"'+mask.owner+'\" data-admin=\"'+mask.admin+'\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"mask'+x+'\"><img src=\"'+mask.img+'\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t+  (mask.optional ? '<i class=\"closeIcon\" onclick=\"return false;\" data-icon=\"red-giant\"><i data-icon=\"times\"></i></i>' : '')\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<span class=\"selector_label\">'+mask.label+'</span></label>');\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #\"+mask.type).append(node);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"find\" id=\"findp\" value=\"personal\" class=\"selector\" disabled=\"disabled\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"findp\"><i data-icon=\"search\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i></label>');\r\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #personal\").append(node);\r\n\r\n\t\t\t\t\t\t\t\t\t\tif (init.admin == \"1\") {\r\n\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"checkbox\" name=\"find\" id=\"findc\" value=\"corporate\" class=\"selector\" disabled=\"disabled\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"findc\"><i data-icon=\"search\" style=\"font-size: 3em; margin-left: 16px; margin-top: 16px; display: block;\"></i></label>');\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options #masks #corporate\").append(node);\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t\t\t\t$(\"#dialog-options input[name='mask']\").filter(\"[value='\"+response.masks[response.active].mask+\"']\").attr(\"checked\", true).trigger(\"change\");\r\n\r\n\t\t\t\t\t\t\t\t\t\t// toggle mask admin icon\r\n\t\t\t\t\t\t\t\t\t\tresponse.masks[response.active].admin ? $(\"#admin\").removeClass(\"disabled\") : $(\"#admin\").addClass(\"disabled\");\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t\t\t\t$(\"#dialog-createMask\").dialog(\"close\");\r\n\t\t\t\t\t\t\t} else if (response && response.error) {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(response.error);\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unknown error\");\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(\"#dialog-createMask select\").selectmenu({width: 100});\r\n\t\t\t\t},\r\n\t\t\t\topen: function() {\r\n\t\t\t\t\t$(\"#dialog-createMask input[name='name']\").val(\"\");\r\n\t\t\t\t\t$(\"#dialog-createMask #accessList :not(.static)\").remove();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#maskControls #create\").click(function() {\r\n\t\t\t\t$(\"#dialog-createMask\").dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#dialog-createMask #accessList\").on(\"click\", \".maskRemove\", function() {\r\n\t\t\t\t$(this).closest(\"input.selector+label\").prev().remove();\r\n\t\t\t\t$(this).closest(\"label\").remove();\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#dialog-editMask\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tSave: function() {\r\n\t\t\t\t\t\t$(\"#dialog-editMask form\").submit();\r\n\t\t\t\t\t},\r\n\t\t\t\t\tCancel: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcreate: function() {\r\n\t\t\t\t\t$(\"#dialog-editMask #accessList\").on(\"click\", \".maskRemove\", function() {\r\n\t\t\t\t\t\t$(this).closest(\"input.selector+label\").prev().attr(\"name\", \"deletes[]\").hide();\r\n\t\t\t\t\t\t$(this).closest(\"label\").hide();\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(\"#dialog-editMask #accessList\").on(\"click\", \"#edit_add+label\", function() {\r\n\t\t\t\t\t\t$(\"#dialog-EVEsearch\").dialog(\"open\");\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t\t$(\"#dialog-editMask form\").submit(function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\t\tdata: $(this).serialize(),\r\n\t\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t\t}).done(function(response) {\r\n\t\t\t\t\t\t\tif (response && response.result) {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-editMask\").dialog(\"close\");\r\n\t\t\t\t\t\t\t} else if (response && response.error) {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(response.error);\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Unknown error\");\r\n\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\topen: function() {\r\n\t\t\t\t\tvar mask = $(\"#dialog-options input[name='mask']:checked\").val();\r\n\t\t\t\t\t$(\"#dialog-editMask input[name='mask']\").val(mask);\r\n\t\t\t\t\t$(\"#dialog-editMask #accessList label.static\").hide();\r\n\t\t\t\t\t$(\"#dialog-editMask #loading\").show();\r\n\t\t\t\t\t$(\"#dialog-editMask #name\").text($(\"#dialog-options input[name='mask']:checked+label .selector_label\").text());\r\n\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: \"masks.php\",\r\n\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\tdata: {mode: \"edit\", mask: mask},\r\n\t\t\t\t\t\tdataType: \"JSON\"\r\n\t\t\t\t\t}).then(function(response) {\r\n\t\t\t\t\t\tif (response && response.results && response.results.length) {\r\n\t\t\t\t\t\t\treturn tripwire.esi.fullLookup(response.results)\r\n\t\t\t\t\t\t\t\t.done(function(results) {\r\n\t\t\t\t\t\t\t\t\tif (results) {\r\n\t\t\t\t\t\t\t\t\t\tfor (var x in results) {\r\n\t\t\t\t\t\t\t\t\t\t\tif (results[x].category == \"character\") {\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"checkbox\" checked=\"checked\" onclick=\"return false\" name=\"\" id=\"edit_'+results[x].id+'_1373\" value=\"'+results[x].id+'_1373\" class=\"selector\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"edit_'+results[x].id+'_1373\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/Character/'+results[x].id+'_64.jpg\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">Character</span>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].name + '<br/>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].corporation.name+'<br/>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].alliance ? results[x].alliance.name : '')+'<br/>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t<input type=\"button\" class=\"maskRemove\" value=\"Remove\" style=\"position: absolute; bottom: 3px; right: 3px;\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t</div>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '</label>');\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-editMask #accessList .static:first\").before(node);\r\n\t\t\t\t\t\t\t\t\t\t\t} else if (results[x].category == \"corporation\") {\r\n\t\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<input type=\"checkbox\" checked=\"checked\" onclick=\"return false\" name=\"\" id=\"edit_'+results[x].id+'_2\" value=\"'+results[x].id+'_2\" class=\"selector\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"edit_'+results[x].id+'_2\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/Corporation/'+results[x].id+'_64.png\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">Corporation</span>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].name+'<br/>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].alliance ? results[x].alliance.name : '')+'<br/>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t<input type=\"button\" class=\"maskRemove\" value=\"Remove\" style=\"position: absolute; bottom: 3px; right: 3px;\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t</div>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t+ '</label>');\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-editMask #accessList .static:first\").before(node);\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}).then(function(response) {\r\n\t\t\t\t\t\t$(\"#dialog-editMask #accessList label.static\").show();\r\n\t\t\t\t\t\t$(\"#dialog-editMask #loading\").hide();\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tclose: function() {\r\n\t\t\t\t\t$(\"#dialog-editMask #accessList :not(.static)\").remove();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\r\n\t\t\t$(\"#maskControls #edit\").click(function() {\r\n\t\t\t\t$(\"#dialog-editMask\").dialog(\"open\");\r\n\t\t\t});\r\n\r\n\t\t\t// EVE search dialog\r\n\t\t\t$(\"#dialog-EVEsearch\").dialog({\r\n\t\t\t\tautoOpen: false,\r\n\t\t\t\tdialogClass: \"ui-dialog-shadow dialog-noeffect dialog-modal\",\r\n\t\t\t\tbuttons: {\r\n\t\t\t\t\tAdd: function() {\r\n\t\t\t\t\t\tif ($(\"#accessList input[value='\"+$(\"#EVESearchResults input\").val()+\"']\").length) {\r\n\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"Already has access\");\r\n\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$(\"#EVESearchResults .info\").append('<input type=\"button\" class=\"maskRemove\" value=\"Remove\" style=\"position: absolute; bottom: 3px; right: 3px;\" />');\r\n\t\t\t\t\t\t$(\"#EVESearchResults input:checked\").attr(\"checked\", \"checked\");\r\n\t\t\t\t\t\t$(\"#EVESearchResults input:checked\").attr(\"onclick\", \"return false\");\r\n\r\n\t\t\t\t\t\tvar nodes = $(\"#EVESearchResults .maskNode:has(input:checked)\");\r\n\r\n\t\t\t\t\t\tif ($(\"#dialog-createMask\").dialog(\"isOpen\"))\r\n\t\t\t\t\t\t\t$(\"#dialog-createMask #accessList .static:first\").before(nodes);\r\n\t\t\t\t\t\telse if ($(\"#dialog-editMask\").dialog(\"isOpen\"))\r\n\t\t\t\t\t\t\t$(\"#dialog-editMask #accessList .static:first\").before(nodes);\r\n\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t},\r\n\t\t\t\t\tClose: function() {\r\n\t\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t\t}\r\n\t\t\t\t},\r\n\t\t\t\tcreate: function() {\r\n\t\t\t\t\t$(\"#EVEsearch\").submit(function(e) {\r\n\t\t\t\t\t\te.preventDefault();\r\n\r\n\t\t\t\t\t\tif ($(\"#EVEsearch input[name='name']\").val() == \"\") {\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t$(\"#EVESearchResults, #searchCount\").html(\"\");\r\n\t\t\t\t\t\t$(\"#EVEsearch #searchSpinner\").show();\r\n\t\t\t\t\t\t$(\"#EVEsearch input[type='submit']\").attr(\"disabled\", \"disabled\");\r\n\t\t\t\t\t\t$(\"#dialog-EVEsearch\").parent().find(\".ui-dialog-buttonpane button:contains('Add')\").attr(\"disabled\", true).addClass(\"ui-state-disabled\");\r\n\r\n\t\t\t\t\t\ttripwire.esi.search($(\"#EVEsearch input[name='name']\").val(), $(\"#EVEsearch input[name='category']:checked\").val(), $(\"#EVEsearch input[name='exact']\")[0].checked)\r\n\t\t\t\t\t\t\t.done(function(results) {\r\n\t\t\t\t\t\t\t\tif (results && (results.character || results.corporation)) {\r\n\t\t\t\t\t\t\t\t\t// limit results\r\n\t\t\t\t\t\t\t\t\tresults = $.merge(results.character || [], results.corporation || []);\r\n\t\t\t\t\t\t\t\t\ttotal = results.length;\r\n\t\t\t\t\t\t\t\t\tresults = results.slice(0, 10);\r\n\t\t\t\t\t\t\t\t\treturn tripwire.esi.fullLookup(results)\r\n\t\t\t\t\t\t\t\t\t\t.done(function(results) {\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#EVEsearch #searchCount\").html(\"Found: \"+total+\"<br/>Showing: \"+(total<10?total:10));\r\n\t\t\t\t\t\t\t\t\t\t\tif (results) {\r\n\t\t\t\t\t\t\t\t\t\t\t\tfor (var x in results) {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tif (results[x].category == \"character\") {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<div class=\"maskNode\"><input type=\"checkbox\" name=\"adds[]\" id=\"find_'+results[x].id+'_1373\" value=\"'+results[x].id+'_1373\" class=\"selector\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"find_'+results[x].id+'_1373\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/Character/'+results[x].id+'_64.jpg\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">Character</span>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].name + '<br/>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].corporation.name+'<br/>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].alliance ? results[x].alliance.name : '')+'<br/>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t</div>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '</label></div>');\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#EVESearchResults\").append(node);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t} else if (results[x].category == \"corporation\") {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tvar node = $(''\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<div class=\"maskNode\"><input type=\"checkbox\" name=\"adds[]\" id=\"find_'+results[x].id+'_2\" value=\"'+results[x].id+'_2\" class=\"selector\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '<label for=\"find_'+results[x].id+'_2\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<img src=\"https://image.eveonline.com/Corporation/'+results[x].id+'_64.png\" />'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<span class=\"selector_label\">Corporation</span>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t<div class=\"info\">'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+results[x].name+'<br/>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t\t'+(results[x].alliance ? results[x].alliance.name : '')+'<br/>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '\t</div>'\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t+ '</label></div>');\r\n\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t$(\"#EVESearchResults\").append(node);\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t}).always(function() {\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#EVEsearch #searchSpinner\").hide();\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#EVEsearch input[type='submit']\").removeAttr(\"disabled\");\r\n\t\t\t\t\t\t\t\t\t\t\t$(\"#dialog-EVEsearch\").parent().find(\".ui-dialog-buttonpane button:contains('Add')\").removeAttr(\"disabled\").removeClass(\"ui-state-disabled\");\r\n\t\t\t\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error #msg\").text(\"No Results\");\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-error\").dialog(\"open\");\r\n\r\n\t\t\t\t\t\t\t\t\t$(\"#EVEsearch #searchSpinner\").hide();\r\n\t\t\t\t\t\t\t\t\t$(\"#EVEsearch input[type='submit']\").removeAttr(\"disabled\");\r\n\t\t\t\t\t\t\t\t\t$(\"#dialog-EVEsearch\").parent().find(\".ui-dialog-buttonpane button:contains('Add')\").removeAttr(\"disabled\").removeClass(\"ui-state-disabled\");\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t});\r\n\t\t\t\t},\r\n\t\t\t\tclose: function() {\r\n\t\t\t\t\t$(\"#EVEsearch input[name='name']\").val(\"\");\r\n\t\t\t\t\t$(\"#EVESearchResults, #searchCount\").html(\"\");\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t}\r\n\t});\r\n\r\n\t$(\"#dialog-options\").dialog(\"open\");\r\n});\r\n","\t\t$(\"#dialog-ping\").dialog({\r\n\t\t\tautoOpen: false,\r\n\t\t\theight: \"auto\",\r\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\r\n\t\t\tbuttons: {\r\n\t\t\t\tSend: function() {\r\n\t\t\t\t\tvar payload = {systemName: this.systemName, systemText: this.systemText, message: $('#ping-text').val() };\r\n\t\t\t\t\tconst _this = this;\r\n\t\t\t\t\t$.ajax({\r\n\t\t\t\t\t\turl: \"ping.php\",\r\n\t\t\t\t\t\ttype: \"POST\",\r\n\t\t\t\t\t\tdata: payload,\r\n\t\t\t\t\t\tdataType: \"text\"\r\n\t\t\t\t\t}).done(function(data) {\t$(_this).dialog(\"close\"); })\r\n\t\t\t\t\t.fail(function(xhr, status, error) { console.log(status, error); });\r\n\t\t\t\t},\r\n\t\t\t\tCancel: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t},\r\n\t\t\t},\r\n\t\t\topen: function() {\r\n\t\t\t\tconst wormholeID = $(this).data(\"id\");\r\n\t\t\t\tconst systemID = $(this).data(\"systemID\");\r\n\t\t\t\tconst wormhole = tripwire.client.wormholes[wormholeID];\r\n\t\t\t\tconst fromSignature = wormhole ? tripwire.client.signatures[wormhole.initialID] : { name: null};\r\n\t\t\t\t\r\n\t\t\t\tthis.systemName = tripwire.systems[systemID].name;\r\n\t\t\t\tthis.systemText = this.systemName + (fromSignature.name !== null && fromSignature.name.length ? ' (' + fromSignature.name + ')' : '');\r\n\t\t\t\t\r\n\t\t\t\t$(\"#dialog-ping\").dialog(\"option\", \"title\", \"Ping about \"+this.systemText);\r\n\t\t\t\t$('#ping-text').val('');\r\n\t\t\t\t$('#ping-text').focus();\r\n\t\t\t}\r\n\t\t});","$(\"#signaturesWidget\").on(\"click\", \"#delete-signature\", function(e) {\n\te.preventDefault();\n\n\tif ($(this).closest(\"tr\").attr(\"disabled\")) {\n\t\treturn false;\n\t} else if ($(\"#sigTable tr.selected\").length == 0) {\n\t\treturn false;\n\t} else if ($(\"#dialog-sigEdit\").hasClass(\"ui-dialog-content\") && $(\"#dialog-sigEdit\").dialog(\"isOpen\")) {\n\t\t$(\"#dialog-sigEdit\").parent().effect(\"shake\", 300);\n\t\treturn false;\n\t}\n\n\t// check if dialog is open\n\tif (!$(\"#dialog-deleteSig\").hasClass(\"ui-dialog-content\")) {\n\t\t$(\"#dialog-deleteSig\").dialog({\n\t\t\tresizable: false,\n\t\t\tminHeight: 0,\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\n\t\t\tbuttons: {\n\t\t\t\tDelete: function() {\n\t\t\t\t\t// Prevent duplicate submitting\n\t\t\t\t\t$(\"#dialog-deleteSig\").parent().find(\":button:contains('Delete')\").button(\"disable\");\n\t\t\t\t\tvar payload = {\"signatures\": {\"remove\": []}, \"systemID\": viewingSystemID};\n\t\t\t\t\tvar undo = [];\n\n\t\t\t\t\tvar signatures = $.map($(\"#sigTable tr.selected\"), function(n) {\n\t\t\t\t\t\tvar signature = tripwire.client.signatures[$(n).data(\"id\")];\n\t\t\t\t\t\tif (signature.type != \"wormhole\") {\n\t\t\t\t\t\t\tundo.push(signature);\n\t\t\t\t\t\t\treturn signature.id;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\n\t\t\t\t\t\t\tundo.push({\"wormhole\": wormhole, \"signatures\": [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]});\n\t\t\t\t\t\t\treturn wormhole;\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t\tpayload.signatures.remove = signatures;\n\n\t\t\t\t\tvar success = function(data) {\n\t\t\t\t\t\tif (data.resultSet && data.resultSet[0].result == true) {\n\t\t\t\t\t\t\t$(\"#dialog-deleteSig\").dialog(\"close\");\n\n\t\t\t\t\t\t\t$(\"#undo\").removeClass(\"disabled\");\n\t\t\t\t\t\t\tif (viewingSystemID in tripwire.signatures.undo) {\n\t\t\t\t\t\t\t\ttripwire.signatures.undo[viewingSystemID].push({action: \"remove\", signatures: undo});\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\ttripwire.signatures.undo[viewingSystemID] = [{action: \"remove\", signatures: undo}];\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\tsessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar always = function(data) {\n\t\t\t\t\t\t$(\"#dialog-deleteSig\").parent().find(\":button:contains('Delete')\").button(\"enable\");\n\t\t\t\t\t}\n\n\t\t\t\t\ttripwire.refresh('refresh', payload, success, always);\n\t\t\t\t},\n\t\t\t\tCancel: function() {\n\t\t\t\t\t$(this).dialog(\"close\");\n\t\t\t\t}\n\t\t\t},\n\t\t\tclose: function() {\n\t\t\t\t$(\"#sigTable tr.selected\").removeClass(\"selected\");\n\t\t\t\t//$(\"#sigTable .sigDelete\").removeClass(\"invisible\");\n\t\t\t}\n\t\t});\n\t} else if (!$(\"#dialog-deleteSig\").dialog(\"isOpen\")) {\n\t\t$(\"#dialog-deleteSig\").dialog(\"open\");\n\t}\n});\n","const sigDialog = {};\r\nconst sigDialogVM = {};\r\n\r\nsigDialog.openSignatureDialog = function(e) {\r\n\tif(e.preventDefault) { e.preventDefault(); }\t// Allow calls with fake event-like objects too\r\n\tsigDialogVM.mode = e.data.mode;\r\n\t\r\n\tswitch(sigDialogVM.mode) {\r\n\t\tcase 'update':\r\n\t\t\tif (e.data.source == \"sig-row\") {\r\n\t\t\t\t$(\"#sigTable tr.selected\").removeClass(\"selected\");\r\n\t\t\t\t$(this).closest(\"tr\").addClass(\"selected\");\r\n\t\t\t\tsigDialogVM.sigId = $(this).data('id');\r\n\t\t\t} else if (e.data.source == \"edit-sig\") {\r\n\t\t\t\tvar elements = $(\"#sigTable tbody tr.selected\");\r\n\t\t\t\tif (elements.length !== 1) {\r\n\t\t\t\t\treturn false;\r\n\t\t\t\t} else {\r\n\t\t\t\t\tsigDialogVM.sigId = $(elements[0]).data('id');\r\n\t\t\t\t}\r\n\t\t\t} else { sigDialogVM.sigId = e.data.signature; }\r\n\t\t\tbreak;\r\n\t\tdefault: delete sigDialogVM.sigId;\r\n\t}\r\n\t\r\n\tsigDialogVM.viewingSystemID = ( sigDialogVM.sigId ) ? tripwire.client.signatures[sigDialogVM.sigId].systemID : viewingSystemID;\r\n\tsigDialogVM.viewingSystem = tripwire.systems[sigDialogVM.viewingSystemID];\r\n\t\r\n\tif (!$(\"#dialog-signature\").hasClass(\"ui-dialog-content\")) {\r\n\t\t$(\"#dialog-signature\").dialog({\r\n\t\t\tautoOpen: true,\r\n\t\t\tresizable: false,\r\n\t\t\tdialogClass: \"dialog-noeffect ui-dialog-shadow\",\r\n\t\t\tposition: {my: \"center\", at: \"center\", of: $(\"#signaturesWidget\")},\r\n\t\t\tbuttons: {\r\n\t\t\t\tSave: function() {\r\n\t\t\t\t\t$(\"#form-signature\").submit();\r\n\t\t\t\t},\r\n\t\t\t\tAdd: function() {\r\n\t\t\t\t\t$(\"#form-signature\").submit();\r\n\t\t\t\t},\r\n\t\t\t\tCancel: function() {\r\n\t\t\t\t\t$(this).dialog(\"close\");\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcreate: function() {\r\n\t\t\t\tvar aSigWormholes = Object.assign({}, appData.wormholes, wormholeAnalysis.dummyWormholes, { K162: {} } );\r\n\r\n\t\t\t\t$(\"#dialog-signature [name='signatureType'], #dialog-signature [name='signatureLife']\").selectmenu({width: 100});\r\n\t\t\t\t$(\"#dialog-signature [name='wormholeLife'], #dialog-signature [name='wormholeMass']\").selectmenu({width: 80});\r\n\t\t\t\t$(\"#dialog-signature [data-autocomplete='sigSystems']\").inlinecomplete({source: tripwire.aSigSystems, renderer: 'system', maxSize: 10, delay: 0});\r\n\t\t\t\t\r\n\t\t\t\tfunction getTargetName() { return $(\"#dialog-signature .leadsTo:visible\").val(); }\r\n\t\t\t\tfunction getTargetSystem() {\r\n\t\t\t\t\treturn wormholeAnalysis.targetSystemID(getTargetName(), undefined);\t\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\tfunction sigTypeDropdownFiller(extractor) {\r\n\t\t\t\t\treturn function() {\r\n\t\t\t\t\t\tconst eligible = wormholeAnalysis.eligibleWormholeTypes(sigDialogVM.viewingSystemID, getTargetSystem());\r\n\t\t\t\t\t\treturn extractor(eligible);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tfunction renderInbound(item) {\t// Render with the type of the systems, if we know, so we don't get \"from: [drifter wormholes]\" if we know we're in a C2\r\n\t\t\t\t\treturn wormholeRendering.renderWormholeType(item, item.key, getTargetName(), sigDialogVM.viewingSystem.name);\r\n\t\t\t\t}\r\n\t\t\t\tfunction renderOutbound(item) {\t// As above\r\n\t\t\t\t\treturn wormholeRendering.renderWormholeType(item, item.key, sigDialogVM.viewingSystem.name, getTargetName());\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\t$(\"#dialog-signature [data-autocomplete='sigTypeFrom']\").inlinecomplete({source: aSigWormholes, renderer: renderOutbound, maxSize: 10, delay: 0, customDropdown: sigTypeDropdownFiller(function(x) { return x.from; })});\r\n\t\t\t\t$(\"#dialog-signature [data-autocomplete='sigTypeTo']\").inlinecomplete({source: aSigWormholes, renderer: renderInbound, maxSize: 10, delay: 0, customDropdown: sigTypeDropdownFiller(function(x) { return x.to; })});\r\n\r\n\t\t\t\t$(\"#dialog-signature #durationPicker\").durationPicker();\r\n\t\t\t\t$(\"#dialog-signature #durationPicker\").on(\"change\", function() {\r\n\t\t\t\t\t// prevent negative values\r\n\t\t\t\t\tif (this.value < 0) {\r\n\t\t\t\t\t\tthis.value = 0;\r\n\t\t\t\t\t\t$(this).change();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Ensure first signature ID field only accepts letters\r\n\t\t\t\t$(\"#dialog-signature [name='signatureID_Alpha'], #dialog-signature [name='signatureID2_Alpha']\").on(\"input\", function() {\r\n\t\t\t\t\twhile (!/^[a-zA-Z?]*$/g.test(this.value)) {\r\n\t\t\t\t\t\tthis.value = this.value.substring(0, this.value.length -1);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Move to the numeric ID after filling out alpha ID\r\n\t\t\t\t$(\"#dialog-signature [name='signatureID_Alpha']\").on(\"input\", function() {\r\n\t\t\t\t\tif (this.value.length === 3) {\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureID_Numeric']\").select();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(\"#dialog-signature [name='signatureID2_Alpha']\").on(\"input\", function() {\r\n\t\t\t\t\tif (this.value.length === 3) {\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureID2_Numeric']\").select();\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Ensure second signature ID field only accepts numbers\r\n\t\t\t\t$(\"#dialog-signature [name='signatureID_Numeric'], #dialog-signature [name='signatureID2_Numeric']\").on(\"input\", function() {\r\n\t\t\t\t\twhile (!/^[0-9?]*$/g.test(this.value)) {\r\n\t\t\t\t\t\tthis.value = this.value.substring(0, this.value.length -1);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Select value on click\r\n\t\t\t\t$(\"#dialog-signature .signatureID, #dialog-signature .wormholeType\").on(\"click\", function() {\r\n\t\t\t\t\t$(this).select();\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Auto fill opposite side wormhole w/ K162\r\n\t\t\t\t$(\"#dialog-signature .wormholeType\").on(\"input, change\", function() {\r\n\t\t\t\t\tif (this.value.length > 0 && aSigWormholes[this.value.toUpperCase()] != -1 && this.value.toUpperCase() != \"K162\") {\r\n\t\t\t\t\t\t$(\"#dialog-signature .wormholeType\").not(this).val(\"K162\");\r\n\r\n\t\t\t\t\t\t// Also auto calculate duration\r\n\t\t\t\t\t\tif (appData.wormholes[this.value.toUpperCase()]) {\r\n\t\t\t\t\t\t\t$(\"#dialog-signature #durationPicker\").val(appData.wormholes[this.value.toUpperCase()].life.substring(0, 2) * 60 * 60).change();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (this.value.toUpperCase() === \"K162\") {\r\n\t\t\t\t\t\tif (aSigWormholes[$(\"#dialog-signature .wormholeType\").not(this).val().toUpperCase()] || $(\"#dialog-signature .wormholeType\").not(this).val().toUpperCase() === \"K162\") {\r\n\t\t\t\t\t\t\t$(\"#dialog-signature .wormholeType\").not(this).val(\"????\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else if (this.value == \"????\") {\r\n\t\t\t\t\t\t$(\"#dialog-signature .wormholeType\").not(this).val(\"K162\");\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\r\n\t\t\t\t// Toggle between wormhole and regular signatures\r\n\t\t\t\t$(\"#dialog-signature\").on(\"selectmenuchange\", \"[name='signatureType']\", function() {\r\n\t\t\t\t\tif (this.value == \"wormhole\") {\r\n\t\t\t\t\t\t$(\"#dialog-signature #site\").slideUp(200, function() { $(this).hide(0); });\r\n\t\t\t\t\t\t$(\"#dialog-signature #wormhole\").slideDown(200, function() { $(this).show(200); });\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$(\"#dialog-signature #site\").slideDown(200, function() { $(this).show(200); });\r\n\t\t\t\t\t\t$(\"#dialog-signature #wormhole\").slideUp(200, function() { $(this).hide(0); });\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tValidationTooltips.close();\r\n\t\t\t\t});\r\n\r\n\t\t\t\t$(\"#form-signature\").submit(function(e) {\r\n\t\t\t\t\te.preventDefault();\r\n\t\t\t\t\tvar form = $(this).serializeObject();\r\n\t\t\t\t\tvar valid = true;\r\n\t\t\t\t\tValidationTooltips.close();\r\n\r\n\t\t\t\t\t// Validate full signature ID fields (blank | 3 characters)\r\n\t\t\t\t\t$.each($(\"#dialog-signature .signatureID:visible\"), function() {\r\n\t\t\t\t\t\tif (this.value.length > 0 && this.value.length < 3) {\r\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Must be 3 characters in length!\");\r\n\t\t\t\t\t\t\t$(this).select();\r\n\t\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (!valid) return false;\r\n\r\n\t\t\t\t\t// Validate full signature ID doesn't already exist in current system\r\n\t\t\t\t\tif (form.signatureID_Alpha.length === 3 && form.signatureID_Numeric.length === 3) {\r\n\t\t\t\t\t\tfor(var sigKey in tripwire.client.signatures) {\r\n\t\t\t\t\t\t\tconst existing = tripwire.client.signatures[sigKey];\r\n\t\t\t\t\t\t\tif((existing.id != sigDialogVM.sigId) && // not the sig we are editing\r\n\t\t\t\t\t\t\t\t(existing.signatureID == form.signatureID_Alpha.toLowerCase() + form.signatureID_Numeric) && // same name\r\n\t\t\t\t\t\t\t\t(existing.systemID == sigDialogVM.viewingSystemID) // in current system\r\n\t\t\t\t\t\t\t) {\r\n\t\t\t\t\t\t\t\tValidationTooltips.open({target: $(\"#dialog-signature .signatureID:first\")}).setContent(\"Signature ID already exists! <input type='button' autofocus='true' id='overwrite' value='Overwrite' style='margin-bottom: -4px; margin-top: -4px; font-size: 0.8em;' data-id='\"+ sigKey +\"' />\");\r\n\t\t\t\t\t\t\t\t$(\"#overwrite\").focus();\r\n\t\t\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (!valid) return false;\r\n\r\n\t\t\t\t\t// Validate wormhole types (blank | wormhole)\r\n\t\t\t\t\t$.each($(\"#dialog-signature .wormholeType:visible\"), function() {\r\n\t\t\t\t\t\tif (this.value.length > 0 && !aSigWormholes[this.value.toUpperCase()] && this.value != \"????\") {\r\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Must be a valid wormhole type!\");\r\n\t\t\t\t\t\t\t$(this).select();\r\n\t\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (!valid) return false;\r\n\r\n\t\t\t\t\t// Validate leads to system (blank | system)\r\n\t\t\t\t\t$.each($(\"#dialog-signature .leadsTo:visible\"), function() {\r\n\t\t\t\t\t\tif (this.value.length > 0 && appData.genericSystemTypes.findIndex((item) => this.value.toLowerCase() === item.toLowerCase()) == -1 && !findSystemID(this.value)) {\r\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Must be a valid leads to system!\");\r\n\t\t\t\t\t\t\t$(this).select();\r\n\t\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (!valid) return false;\r\n\r\n\t\t\t\t\t// Validate leads to isn't the viewing system which causes a inner loop\r\n\t\t\t\t\t$.each($(\"#dialog-signature .leadsTo:visible\"), function() {\r\n\t\t\t\t\t\tif (this.value.length > 0 && this.value.toLowerCase() === sigDialogVM.viewingSystem.name.toLowerCase()) {\r\n\t\t\t\t\t\t\tValidationTooltips.open({target: $(this)}).setContent(\"Wormhole cannot lead to the same system it comes from!\");\r\n\t\t\t\t\t\t\t$(this).select();\r\n\t\t\t\t\t\t\tvalid = false;\r\n\t\t\t\t\t\t\treturn false;\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t});\r\n\t\t\t\t\tif (!valid) return false;\r\n\r\n\t\t\t\t\tvar payload = {};\r\n\t\t\t\t\tvar undo = [];\r\n\t\t\t\t\tif (form.signatureType === \"wormhole\") {\r\n\t\t\t\t\t\tvar signature = {\r\n\t\t\t\t\t\t\t\"signatureID\": form.signatureID_Alpha + form.signatureID_Numeric,\r\n\t\t\t\t\t\t\t\"systemID\": sigDialogVM.viewingSystemID,\r\n\t\t\t\t\t\t\t\"type\": \"wormhole\",\r\n\t\t\t\t\t\t\t\"name\": form.wormholeName,\r\n\t\t\t\t\t\t\t\"lifeLength\": form.signatureLength\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar leadsTo = wormholeAnalysis.targetSystemID(form.leadsTo, form.wormholeType);\r\n\r\n\t\t\t\t\t\tvar signature2 = {\r\n\t\t\t\t\t\t\t\"signatureID\": form.signatureID2_Alpha + form.signatureID2_Numeric,\r\n\t\t\t\t\t\t\t\"systemID\": leadsTo,\r\n\t\t\t\t\t\t\t\"type\": \"wormhole\",\r\n\t\t\t\t\t\t\t\"name\": form.wormholeName2,\r\n\t\t\t\t\t\t\t\"lifeLength\": form.signatureLength\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tvar type = null;\r\n\t\t\t\t\t\tvar parent = null;\r\n\t\t\t\t\t\tif (form.wormholeType.length > 0 && aSigWormholes[form.wormholeType.toUpperCase()] && form.wormholeType.toUpperCase() != \"K162\") {\r\n\t\t\t\t\t\t\tparent = \"initial\";\r\n\t\t\t\t\t\t\ttype = form.wormholeType.toUpperCase();\r\n\t\t\t\t\t\t} else if (form.wormholeType2.length > 0 && aSigWormholes[form.wormholeType2.toUpperCase()] && form.wormholeType2.toUpperCase() != \"K162\") {\r\n\t\t\t\t\t\t\tparent = \"secondary\";\r\n\t\t\t\t\t\t\ttype = form.wormholeType2.toUpperCase();\r\n\t\t\t\t\t\t} else if (form.wormholeType.toUpperCase() == \"K162\") {\r\n\t\t\t\t\t\t\tparent = \"secondary\";\r\n\t\t\t\t\t\t\ttype = \"????\";\r\n\t\t\t\t\t\t} else if (form.wormholeType2.toUpperCase() == \"K162\") {\r\n\t\t\t\t\t\t\tparent = \"initial\";\r\n\t\t\t\t\t\t\ttype = \"????\";\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvar wormhole = {\r\n\t\t\t\t\t\t\t\"type\": type,\r\n\t\t\t\t\t\t\t\"parent\": parent,\r\n\t\t\t\t\t\t\t\"life\": form.wormholeLife,\r\n\t\t\t\t\t\t\t\"mass\": form.wormholeMass\r\n\t\t\t\t\t\t};\r\n\t\t\t\t\t\tif (sigDialogVM.mode == \"update\") {\r\n\t\t\t\t\t\t\tsignature.id = $(\"#dialog-signature\").data(\"signatureid\");\r\n\t\t\t\t\t\t\tsignature2.id = $(\"#dialog-signature\").data(\"signature2id\");\r\n\t\t\t\t\t\t\twormhole.id = $(\"#dialog-signature\").data(\"wormholeid\");\r\n\r\n\t\t\t\t\t\t\t// Update the initial and type based on which side of the wormhole we are editing\r\n\t\t\t\t\t\t\tif (tripwire.client.wormholes[wormhole.id]) {\r\n\t\t\t\t\t\t\t\tif (form.wormholeType.length > 0 && aSigWormholes[form.wormholeType.toUpperCase()] && form.wormholeType.toUpperCase() != \"K162\") {\r\n\t\t\t\t\t\t\t\t\twormhole.parent = tripwire.client.wormholes[wormhole.id].initialID == signature.id ? \"initial\" : \"secondary\";\r\n\t\t\t\t\t\t\t\t\twormhole.type = form.wormholeType.toUpperCase();\r\n\t\t\t\t\t\t\t\t} else if (form.wormholeType2.length > 0 && aSigWormholes[form.wormholeType2.toUpperCase()] && form.wormholeType2.toUpperCase() != \"K162\") {\r\n\t\t\t\t\t\t\t\t\twormhole.parent = tripwire.client.wormholes[wormhole.id].initialID == signature.id ? \"secondary\" : \"initial\";\r\n\t\t\t\t\t\t\t\t\twormhole.type = form.wormholeType2.toUpperCase();\r\n\t\t\t\t\t\t\t\t} else if (form.wormholeType.toUpperCase() == \"K162\") {\r\n\t\t\t\t\t\t\t\t\twormhole.parent = tripwire.client.wormholes[wormhole.id].initialID == signature.id ? \"secondary\" : \"initial\";\r\n\t\t\t\t\t\t\t\t\twormhole.type = \"????\";\r\n\t\t\t\t\t\t\t\t} else if (form.wormholeType2.toUpperCase() == \"K162\") {\r\n\t\t\t\t\t\t\t\t\twormhole.parent = tripwire.client.wormholes[wormhole.id].initialID == signature.id ? \"initial\" : \"secondary\";\r\n\t\t\t\t\t\t\t\t\twormhole.type = \"????\";\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tpayload = {\"signatures\": {\"update\": [{\"wormhole\": wormhole, \"signatures\": [signature, signature2]}]}};\r\n\r\n\t\t\t\t\t\t\tif (tripwire.client.wormholes[wormhole.id]) {\r\n\t\t\t\t\t\t\t\t\t//used to be a wormhole\r\n\t\t\t\t\t\t\t\t\tundo.push({\"wormhole\": tripwire.client.wormholes[wormhole.id], \"signatures\": [tripwire.client.signatures[signature.id], tripwire.client.signatures[signature2.id]]});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t// used to be just a regular signature\r\n\t\t\t\t\t\t\t\t\tundo.push(tripwire.client.signatures[signature.id]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tpayload = {\"signatures\": {\"add\": [{\"wormhole\": wormhole, \"signatures\": [signature, signature2]}]}};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tif (sigDialogVM.mode == \"update\") {\r\n\t\t\t\t\t\t\tvar signature = {\r\n\t\t\t\t\t\t\t\t\"id\": $(\"#dialog-signature\").data(\"signatureid\"),\r\n\t\t\t\t\t\t\t\t\"signatureID\": form.signatureID_Alpha + form.signatureID_Numeric,\r\n\t\t\t\t\t\t\t\t\"systemID\": sigDialogVM.viewingSystemID,\r\n\t\t\t\t\t\t\t\t\"type\": form.signatureType,\r\n\t\t\t\t\t\t\t\t\"name\": form.signatureName,\r\n\t\t\t\t\t\t\t\t\"lifeLength\": form.signatureLength\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tpayload = {\"signatures\": {\"update\": [signature]}};\r\n\r\n\t\t\t\t\t\t\tif (tripwire.client.signatures[signature.id].type == \"wormhole\") {\r\n\t\t\t\t\t\t\t\t//used to be a wormhole\r\n\t\t\t\t\t\t\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\r\n\t\t\t\t\t\t\t\tvar signature2 = signature.id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\r\n\t\t\t\t\t\t\t\tundo.push({\"wormhole\": tripwire.client.wormholes[wormhole.id], \"signatures\": [tripwire.client.signatures[signature.id], tripwire.client.signatures[signature2.id]]});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t// used to be just a regular signature\r\n\t\t\t\t\t\t\t\tundo.push(tripwire.client.signatures[signature.id]);\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tvar signature = {\r\n\t\t\t\t\t\t\t\t\"signatureID\": form.signatureID_Alpha + form.signatureID_Numeric,\r\n\t\t\t\t\t\t\t\t\"systemID\": sigDialogVM.viewingSystemID,\r\n\t\t\t\t\t\t\t\t\"type\": form.signatureType,\r\n\t\t\t\t\t\t\t\t\"name\": form.signatureName,\r\n\t\t\t\t\t\t\t\t\"lifeLength\": form.signatureLength\r\n\t\t\t\t\t\t\t};\r\n\t\t\t\t\t\t\tpayload = {\"signatures\": {\"add\": [signature]}};\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Save')\").button(\"disable\");\r\n\r\n\t\t\t\t\tvar success = function(data) {\r\n\t\t\t\t\t\tif (data.resultSet && data.resultSet[0].result == true) {\r\n\t\t\t\t\t\t\t$(\"#dialog-signature\").dialog(\"close\");\r\n\r\n\t\t\t\t\t\t\t$(\"#undo\").removeClass(\"disabled\");\r\n\r\n\t\t\t\t\t\t\tif (sigDialogVM.mode == \"add\") {\r\n\t\t\t\t\t\t\t\tundo = data.results;\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tif (sigDialogVM.viewingSystemID in tripwire.signatures.undo) {\r\n\t\t\t\t\t\t\t\ttripwire.signatures.undo[sigDialogVM.viewingSystemID].push({action: sigDialogVM.mode, signatures: undo});\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\ttripwire.signatures.undo[sigDialogVM.viewingSystemID] = [{action: sigDialogVM.mode, signatures: undo}];\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\tsessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tvar always = function() {\r\n\t\t\t\t\t\t$(\"#sigEditForm input[type=submit]\").removeAttr(\"disabled\");\r\n\t\t\t\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Save')\").button(\"enable\");\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\ttripwire.refresh('refresh', payload, success, always);\r\n\t\t\t\t});\r\n\t\t\t},\r\n\t\t\topen: function() {\r\n\t\t\t\t$(\"#dialog-signature\").data(\"signatureid\", \"\");\r\n\t\t\t\t$(\"#dialog-signature\").data(\"signature2id\", \"\");\r\n\t\t\t\t$(\"#dialog-signature\").data(\"wormholeid\", \"\");\r\n\r\n\t\t\t\t$(\"#dialog-signature input\").val(\"\");\r\n\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(\"unknown\").selectmenu(\"refresh\");\r\n\r\n\t\t\t\t$(\"#dialog-signature [name='wormholeLife']\").val(\"stable\").selectmenu(\"refresh\");\r\n\t\t\t\t$(\"#dialog-signature [name='wormholeMass']\").val(\"stable\").selectmenu(\"refresh\");\r\n\r\n\t\t\t\t$(\"#dialog-signature #site\").show();\r\n\t\t\t\t$(\"#dialog-signature #wormhole\").hide();\r\n\r\n\t\t\t\t// Side labels\r\n\t\t\t\t$(\"#dialog-signature .sideLabel:first\").html(sigDialogVM.viewingSystem.name + \" Side\");\r\n\t\t\t\t$(\"#dialog-signature .sideLabel:last\").html(\"Other Side\");\r\n\r\n\t\t\t\t// Default signature life\r\n\t\t\t\t$(\"#dialog-signature #durationPicker\").val(options.signatures.pasteLife * 60 * 60).change();\r\n\r\n\t\t\t\tvar id = sigDialogVM.sigId;\r\n\t\t\t\tif (sigDialogVM.mode == \"update\" && id && tripwire.client.signatures[id]) {\r\n\t\t\t\t\tvar signature = tripwire.client.signatures[id];\r\n\t\t\t\t\t$(\"#dialog-signature\").data(\"signatureid\", id);\r\n\r\n\t\t\t\t\t// Change the dialog buttons\r\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Add')\").hide();\r\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Save')\").show();\r\n\r\n\t\t\t\t\t// Change the dialog title\r\n\t\t\t\t\t$(\"#dialog-signature\").dialog(\"option\", \"title\", \"Edit Signature\");\r\n\r\n\t\t\t\t\tif (signature.type == \"wormhole\") {\r\n\t\t\t\t\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == id || wormhole.secondaryID == id) return wormhole; })[0];\r\n\t\t\t\t\t\tvar otherSignature = id == wormhole.initialID ? tripwire.client.signatures[wormhole.secondaryID] : tripwire.client.signatures[wormhole.initialID];\r\n\t\t\t\t\t\t$(\"#dialog-signature\").data(\"signature2id\", otherSignature.id);\r\n\t\t\t\t\t\t$(\"#dialog-signature\").data(\"wormholeid\", wormhole.id);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tconst sigAlpha = signature.signatureID ? signature.signatureID.substr(0, 3) : \"???\";\r\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Alpha']\").val(sigAlpha);\r\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Numeric']\").val(signature.signatureID ? signature.signatureID.substr(3, 5) : \"\");\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(signature.type).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='wormholeName']\").val(signature.name);\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='leadsTo']\").val(tripwire.systems[otherSignature.systemID] ? tripwire.systems[otherSignature.systemID].name : (appData.genericSystemTypes[otherSignature.systemID] ? appData.genericSystemTypes[otherSignature.systemID] : \"\"));\r\n\r\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID2_Alpha']\").val(otherSignature.signatureID ? otherSignature.signatureID.substr(0, 3) : \"???\");\r\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID2_Numeric']\").val(otherSignature.signatureID ? otherSignature.signatureID.substr(3, 5) : \"\");\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='wormholeName2']\").val(otherSignature.name);\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='wormholeLife']\").val(wormhole.life).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='wormholeMass']\").val(wormhole.mass).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\r\n\r\n\t\t\t\t\t\tif (wormhole[wormhole.parent+\"ID\"] == signature.id) {\r\n\t\t\t\t\t\t\t$(\"#dialog-signature input[name='wormholeType']\").val(wormhole.type).change();\r\n\t\t\t\t\t\t} else if (wormhole[wormhole.parent+\"ID\"] == otherSignature.id) {\r\n\t\t\t\t\t\t\t$(\"#dialog-signature input[name='wormholeType2']\").val(wormhole.type).change();\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t$(\"#dialog-signature #durationPicker\").val(signature.lifeLength).change();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// Focus the sig ID, if it isn't set, otherwise the sig name\r\n\t\t\t\t\t\tif(sigAlpha != '???') { $(\"#dialog-signature input[name='wormholeName']\").select(); }\r\n\t\t\t\t\t\telse { $(\"#dialog-signature input[name='signatureID_Alpha']\").select(); }\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Alpha']\").val(signature.signatureID ? signature.signatureID.substr(0, 3) : \"???\");\r\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Numeric']\").val(signature.signatureID ? signature.signatureID.substr(3, 5) : \"\");\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(signature.type).selectmenu(\"refresh\").trigger(\"selectmenuchange\");\r\n\t\t\t\t\t\t$(\"#dialog-signature [name='signatureName']\").val(signature.name);\r\n\t\t\t\t\t\t$(\"#dialog-signature #durationPicker\").val(signature.lifeLength).change();\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\t// Not a wormhole - always focus the sig ID\r\n\t\t\t\t\t\t$(\"#dialog-signature input[name='signatureID_Alpha']\").select();\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// Hightlight first ID section, if not set, otherwise the name\r\n\t\t\t\t} else {\r\n\t\t\t\t\t// Change the dialog buttons\r\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Add')\").show();\r\n\t\t\t\t\t$(\"#dialog-signature\").parent().find(\"button:contains('Save')\").hide();\r\n\r\n\t\t\t\t\t// Change the dialog title\r\n\t\t\t\t\t$(\"#dialog-signature\").dialog(\"option\", \"title\", \"Add Signature\");\r\n\r\n\t\t\t\t\t$(\"#dialog-signature [name='signatureType']\").val(options.signatures.editType || \"unknown\").selectmenu(\"refresh\")\r\n\t\t\t\t\tif ($(\"#dialog-signature [name='signatureType']\").val() === \"wormhole\") {\r\n\t\t\t\t\t\t$(\"#dialog-signature #site\").hide();\r\n\t\t\t\t\t\t$(\"#dialog-signature #wormhole\").show();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tclose: function() {\r\n\t\t\t\tValidationTooltips.close();\r\n\t\t\t\t$(\"#sigTable tr.selected\").removeClass(\"selected\");\r\n\t\t\t\t$(\"#dialog-signature\").data(\"signatureid\", \"\");\r\n\t\t\t\t$(\"#dialog-signature\").data(\"signature2id\", \"\");\r\n\t\t\t\t$(\"#dialog-signature\").data(\"wormholeid\", \"\");\r\n\t\t\t}\r\n\t\t});\r\n\t} else if (!$(\"#dialog-signature\").dialog(\"isOpen\")) {\r\n\t\t$(\"#dialog-signature\").dialog(\"open\");\r\n\t}\r\n};\r\n\r\n$(\"#sigTable tbody\").on(\"dblclick\", \"tr\", {mode: \"update\", source:\"sig-row\"}, sigDialog.openSignatureDialog);\r\n$(\"#edit-signature\").on(\"click\", {mode: \"update\", source:\"edit-sig\"}, sigDialog.openSignatureDialog);\r\n$(\"#add-signature\").click({mode: \"add\"}, sigDialog.openSignatureDialog);\r\n\r\n// Signature overwrite. Attached to document because the element gets recreated each time\r\nsigDialog.overwriteSignature = function(sigToRemove, completeFunction, always) {\r\n\tvar payload = {\"signatures\": {\"remove\": []}, \"systemID\": viewingSystemID};\r\n\tvar undo = [];\r\n\r\n\tvar signature = tripwire.client.signatures[sigToRemove];\r\n\tif (signature.type != \"wormhole\") {\r\n\t\tundo.push(signature);\r\n\t\tpayload.signatures.remove.push(signature.id);\r\n\t} else {\r\n\t\tvar wormhole = $.map(tripwire.client.wormholes, function(wormhole) { if (wormhole.initialID == signature.id || wormhole.secondaryID == signature.id) return wormhole; })[0];\r\n\t\tundo.push({\"wormhole\": wormhole, \"signatures\": [tripwire.client.signatures[wormhole.initialID], tripwire.client.signatures[wormhole.secondaryID]]});\r\n\t\tpayload.signatures.remove.push(wormhole);\r\n\t}\r\n\r\n\tvar success = function(data) {\r\n\t\t$(\"#undo\").removeClass(\"disabled\");\r\n\t\tif (viewingSystemID in tripwire.signatures.undo) {\r\n\t\t\ttripwire.signatures.undo[viewingSystemID].push({action: \"remove\", signatures: undo});\r\n\t\t} else {\r\n\t\t\ttripwire.signatures.undo[viewingSystemID] = [{action: \"remove\", signatures: undo}];\r\n\t\t}\r\n\r\n\t\tsessionStorage.setItem(\"tripwire_undo\", JSON.stringify(tripwire.signatures.undo));\r\n\t\t\r\n\t\tcompleteFunction(data);\r\n\t}\r\n\r\n\ttripwire.refresh('refresh', payload, success, always);\r\n}\r\n\r\n/** Delegate the next action after sig overwrite to the save dialog */\r\nsigDialog.delegateSave = function(data) {\r\n\tif (data.resultSet && data.resultSet[0].result == true) {\r\n\t\tValidationTooltips.close();\r\n\r\n\t\tif ($(\"#dialog-signature\").parent().find(\":button:contains('Save')\")) {\r\n\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Save')\").click();\r\n\t\t} else {\r\n\t\t\t$(\"#dialog-signature\").parent().find(\":button:contains('Add')\").click();\r\n\t\t}\r\n\t}\r\n}\r\n\r\n$(document).on(\"click\", \"#overwrite\", function() { \r\n\t$(\"#overwrite\").attr(\"disable\", true);\r\n\tsigDialog.overwriteSignature($(this).data(\"id\"), sigDialog.delegateSave, function() {\r\n\t\t$(\"#overwrite\").removeAttr(\"disable\");\r\n\t}); \r\n});\r\n"]}